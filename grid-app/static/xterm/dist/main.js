/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./main.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./main.js":
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./xterm.js/xterm */ \"./xterm.js/xterm.js\");\n/* harmony import */ var _xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _xterm_js_addons_attach_attach__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./xterm.js/addons/attach/attach */ \"./xterm.js/addons/attach/attach.js\");\n/* harmony import */ var _xterm_js_addons_attach_attach__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_xterm_js_addons_attach_attach__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _xterm_js_addons_fit_fit__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./xterm.js/addons/fit/fit */ \"./xterm.js/addons/fit/fit.js\");\n/* harmony import */ var _xterm_js_addons_fit_fit__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_xterm_js_addons_fit_fit__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _xterm_js_addons_fullscreen_fullscreen__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./xterm.js/addons/fullscreen/fullscreen */ \"./xterm.js/addons/fullscreen/fullscreen.js\");\n/* harmony import */ var _xterm_js_addons_fullscreen_fullscreen__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_xterm_js_addons_fullscreen_fullscreen__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _xterm_js_addons_search_search__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./xterm.js/addons/search/search */ \"./xterm.js/addons/search/search.js\");\n/* harmony import */ var _xterm_js_addons_search_search__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_xterm_js_addons_search_search__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _xterm_js_addons_winptyCompat_winptyCompat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./xterm.js/addons/winptyCompat/winptyCompat */ \"./xterm.js/addons/winptyCompat/winptyCompat.js\");\n/* harmony import */ var _xterm_js_addons_winptyCompat_winptyCompat__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_xterm_js_addons_winptyCompat_winptyCompat__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n\n\n_xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__[\"applyAddon\"](_xterm_js_addons_attach_attach__WEBPACK_IMPORTED_MODULE_1__);\n_xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__[\"applyAddon\"](_xterm_js_addons_fit_fit__WEBPACK_IMPORTED_MODULE_2__);\n_xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__[\"applyAddon\"](_xterm_js_addons_fullscreen_fullscreen__WEBPACK_IMPORTED_MODULE_3__);\n_xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__[\"applyAddon\"](_xterm_js_addons_search_search__WEBPACK_IMPORTED_MODULE_4__);\n_xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__[\"applyAddon\"](_xterm_js_addons_winptyCompat_winptyCompat__WEBPACK_IMPORTED_MODULE_5__);\n\n(function(){\n\n    var TermManager = function(app){\n\n      var terminalContainer = document.getElementById('terminal-container')\n    \n      var protocol,\n        socketURL,\n        socket,\n        pid;\n    \n      var _this = this;\n      var term;\n    \n      this.app = app;\n    \n      this.init = function(){\n        this.uiInit();\n        this.createTerminal();\n      }\n            \n      this.isFocused = function(){\n        return this.term.isFocused;\n      }\n    \n      this.showTab = function(selector){\n\n        $('.dev-tabs .tab[data-tab=\"'+selector+'\"]').addClass('current').siblings().removeClass('current');\n\n        // hide both\n        $('.dev-tabs .terminal, .dev-tabs .console').hide();\n    \n        // show selected\n        $('.dev-tabs .' + selector).show();\n      }\n    \n      this.uiInit = function(){\n        // Tabbed area\n        $('.dev-tabs .tab').click(function(){\n\n          var selector = $(this).attr('data-tab');\n          _this.showTab(selector);\n          \n        });\n      }\n    \n      this.runRealTerminal = function(){\n        term.attach(socket);\n        term._initialized = true;\n        \n        // initialize to wd\n        // term.send(\"cd /home/user\\nclear\\n\")\n      }\n    \n      this.createTerminal = function(){\n    \n        // Clean terminal\n        while (terminalContainer.children.length) {\n          terminalContainer.removeChild(terminalContainer.children[0]);\n        }\n        term = new _xterm_js_xterm__WEBPACK_IMPORTED_MODULE_0__({\n          cursorBlink: true,\n          scrollback: 1000,\n          tabStopWidth: 8\n        });\n        this.term = term;\n        \n        window.term = term;  // Expose `term` to window for debugging purposes\n        term.on('resize', function (size) {\n          if (!pid) {\n            return;\n          }\n          var cols = size.cols,\n              rows = size.rows,\n              url = '/terminals/' + pid + '/size?cols=' + cols + '&rows=' + rows;\n    \n          fetch(url, {method: 'POST'});\n        });\n        \n        protocol = (location.protocol === 'https:') ? 'wss://' : 'ws://';\n        var port = 3000;\n    \n        // get port cookie\n        function getCookie(name) {\n            var value = \"; \" + document.cookie;\n            var parts = value.split(\"; \" + name + \"=\");\n            if (parts.length == 2) return parts.pop().split(\";\").shift();\n        }\n        port = getCookie(\"term_port\");\n    \n        socketURL = protocol + location.hostname + ((port) ? (':' + port) : '') + '/terminals/';\n        var fetchUrl = 'http://' + location.hostname + ((port) ? (':' + port) : '');\n    \n        term.open(terminalContainer);\n        term.winptyCompatInit();\n        term.fit();\n        term.focus();\n    \n        var paramFetchUrl = fetchUrl+'/terminals?cols=' + term.cols + '&rows=' + term.rows;\n    \n        fetch(paramFetchUrl, {method: 'POST'}).then(function (res) {\n    \n          res.text().then(function (processId) {\n            pid = processId;\n            socketURL += processId;\n            socket = new WebSocket(socketURL);\n            socket.onopen = _this.runRealTerminal;\n            socket.onclose = function(e){\n              console.log(e);\n            };\n            socket.onerror = function(e){\n              console.log(e);\n            };\n          });\n        });\n\n      }\n\n   }\n\n   window.TermManager = TermManager;\n\n})();\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9tYWluLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbWFpbi5qcz8xZDUwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFRlcm1pbmFsIGZyb20gJy4veHRlcm0uanMveHRlcm0nO1xuaW1wb3J0ICogYXMgYXR0YWNoIGZyb20gJy4veHRlcm0uanMvYWRkb25zL2F0dGFjaC9hdHRhY2gnO1xuaW1wb3J0ICogYXMgZml0IGZyb20gJy4veHRlcm0uanMvYWRkb25zL2ZpdC9maXQnO1xuaW1wb3J0ICogYXMgZnVsbHNjcmVlbiBmcm9tICcuL3h0ZXJtLmpzL2FkZG9ucy9mdWxsc2NyZWVuL2Z1bGxzY3JlZW4nO1xuaW1wb3J0ICogYXMgc2VhcmNoIGZyb20gJy4veHRlcm0uanMvYWRkb25zL3NlYXJjaC9zZWFyY2gnO1xuaW1wb3J0ICogYXMgd2lucHR5Q29tcGF0IGZyb20gJy4veHRlcm0uanMvYWRkb25zL3dpbnB0eUNvbXBhdC93aW5wdHlDb21wYXQnO1xuXG5cblRlcm1pbmFsLmFwcGx5QWRkb24oYXR0YWNoKTtcblRlcm1pbmFsLmFwcGx5QWRkb24oZml0KTtcblRlcm1pbmFsLmFwcGx5QWRkb24oZnVsbHNjcmVlbik7XG5UZXJtaW5hbC5hcHBseUFkZG9uKHNlYXJjaCk7XG5UZXJtaW5hbC5hcHBseUFkZG9uKHdpbnB0eUNvbXBhdCk7XG5cbihmdW5jdGlvbigpe1xuXG4gICAgdmFyIFRlcm1NYW5hZ2VyID0gZnVuY3Rpb24oYXBwKXtcblxuICAgICAgdmFyIHRlcm1pbmFsQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlcm1pbmFsLWNvbnRhaW5lcicpXG4gICAgXG4gICAgICB2YXIgcHJvdG9jb2wsXG4gICAgICAgIHNvY2tldFVSTCxcbiAgICAgICAgc29ja2V0LFxuICAgICAgICBwaWQ7XG4gICAgXG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgdmFyIHRlcm07XG4gICAgXG4gICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICBcbiAgICAgIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMudWlJbml0KCk7XG4gICAgICAgIHRoaXMuY3JlYXRlVGVybWluYWwoKTtcbiAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgdGhpcy5pc0ZvY3VzZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gdGhpcy50ZXJtLmlzRm9jdXNlZDtcbiAgICAgIH1cbiAgICBcbiAgICAgIHRoaXMuc2hvd1RhYiA9IGZ1bmN0aW9uKHNlbGVjdG9yKXtcblxuICAgICAgICAkKCcuZGV2LXRhYnMgLnRhYltkYXRhLXRhYj1cIicrc2VsZWN0b3IrJ1wiXScpLmFkZENsYXNzKCdjdXJyZW50Jykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnY3VycmVudCcpO1xuXG4gICAgICAgIC8vIGhpZGUgYm90aFxuICAgICAgICAkKCcuZGV2LXRhYnMgLnRlcm1pbmFsLCAuZGV2LXRhYnMgLmNvbnNvbGUnKS5oaWRlKCk7XG4gICAgXG4gICAgICAgIC8vIHNob3cgc2VsZWN0ZWRcbiAgICAgICAgJCgnLmRldi10YWJzIC4nICsgc2VsZWN0b3IpLnNob3coKTtcbiAgICAgIH1cbiAgICBcbiAgICAgIHRoaXMudWlJbml0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gVGFiYmVkIGFyZWFcbiAgICAgICAgJCgnLmRldi10YWJzIC50YWInKS5jbGljayhmdW5jdGlvbigpe1xuXG4gICAgICAgICAgdmFyIHNlbGVjdG9yID0gJCh0aGlzKS5hdHRyKCdkYXRhLXRhYicpO1xuICAgICAgICAgIF90aGlzLnNob3dUYWIoc2VsZWN0b3IpO1xuICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICBcbiAgICAgIHRoaXMucnVuUmVhbFRlcm1pbmFsID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdGVybS5hdHRhY2goc29ja2V0KTtcbiAgICAgICAgdGVybS5faW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICBcbiAgICAgICAgLy8gaW5pdGlhbGl6ZSB0byB3ZFxuICAgICAgICAvLyB0ZXJtLnNlbmQoXCJjZCAvaG9tZS91c2VyXFxuY2xlYXJcXG5cIilcbiAgICAgIH1cbiAgICBcbiAgICAgIHRoaXMuY3JlYXRlVGVybWluYWwgPSBmdW5jdGlvbigpe1xuICAgIFxuICAgICAgICAvLyBDbGVhbiB0ZXJtaW5hbFxuICAgICAgICB3aGlsZSAodGVybWluYWxDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgdGVybWluYWxDb250YWluZXIucmVtb3ZlQ2hpbGQodGVybWluYWxDb250YWluZXIuY2hpbGRyZW5bMF0pO1xuICAgICAgICB9XG4gICAgICAgIHRlcm0gPSBuZXcgVGVybWluYWwoe1xuICAgICAgICAgIGN1cnNvckJsaW5rOiB0cnVlLFxuICAgICAgICAgIHNjcm9sbGJhY2s6IDEwMDAsXG4gICAgICAgICAgdGFiU3RvcFdpZHRoOiA4XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRlcm0gPSB0ZXJtO1xuICAgICAgICBcbiAgICAgICAgd2luZG93LnRlcm0gPSB0ZXJtOyAgLy8gRXhwb3NlIGB0ZXJtYCB0byB3aW5kb3cgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlc1xuICAgICAgICB0ZXJtLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICAgIGlmICghcGlkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjb2xzID0gc2l6ZS5jb2xzLFxuICAgICAgICAgICAgICByb3dzID0gc2l6ZS5yb3dzLFxuICAgICAgICAgICAgICB1cmwgPSAnL3Rlcm1pbmFscy8nICsgcGlkICsgJy9zaXplP2NvbHM9JyArIGNvbHMgKyAnJnJvd3M9JyArIHJvd3M7XG4gICAgXG4gICAgICAgICAgZmV0Y2godXJsLCB7bWV0aG9kOiAnUE9TVCd9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBwcm90b2NvbCA9IChsb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicpID8gJ3dzczovLycgOiAnd3M6Ly8nO1xuICAgICAgICB2YXIgcG9ydCA9IDMwMDA7XG4gICAgXG4gICAgICAgIC8vIGdldCBwb3J0IGNvb2tpZVxuICAgICAgICBmdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gXCI7IFwiICsgZG9jdW1lbnQuY29va2llO1xuICAgICAgICAgICAgdmFyIHBhcnRzID0gdmFsdWUuc3BsaXQoXCI7IFwiICsgbmFtZSArIFwiPVwiKTtcbiAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT0gMikgcmV0dXJuIHBhcnRzLnBvcCgpLnNwbGl0KFwiO1wiKS5zaGlmdCgpO1xuICAgICAgICB9XG4gICAgICAgIHBvcnQgPSBnZXRDb29raWUoXCJ0ZXJtX3BvcnRcIik7XG4gICAgXG4gICAgICAgIHNvY2tldFVSTCA9IHByb3RvY29sICsgbG9jYXRpb24uaG9zdG5hbWUgKyAoKHBvcnQpID8gKCc6JyArIHBvcnQpIDogJycpICsgJy90ZXJtaW5hbHMvJztcbiAgICAgICAgdmFyIGZldGNoVXJsID0gJ2h0dHA6Ly8nICsgbG9jYXRpb24uaG9zdG5hbWUgKyAoKHBvcnQpID8gKCc6JyArIHBvcnQpIDogJycpO1xuICAgIFxuICAgICAgICB0ZXJtLm9wZW4odGVybWluYWxDb250YWluZXIpO1xuICAgICAgICB0ZXJtLndpbnB0eUNvbXBhdEluaXQoKTtcbiAgICAgICAgdGVybS5maXQoKTtcbiAgICAgICAgdGVybS5mb2N1cygpO1xuICAgIFxuICAgICAgICB2YXIgcGFyYW1GZXRjaFVybCA9IGZldGNoVXJsKycvdGVybWluYWxzP2NvbHM9JyArIHRlcm0uY29scyArICcmcm93cz0nICsgdGVybS5yb3dzO1xuICAgIFxuICAgICAgICBmZXRjaChwYXJhbUZldGNoVXJsLCB7bWV0aG9kOiAnUE9TVCd9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICBcbiAgICAgICAgICByZXMudGV4dCgpLnRoZW4oZnVuY3Rpb24gKHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgcGlkID0gcHJvY2Vzc0lkO1xuICAgICAgICAgICAgc29ja2V0VVJMICs9IHByb2Nlc3NJZDtcbiAgICAgICAgICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoc29ja2V0VVJMKTtcbiAgICAgICAgICAgIHNvY2tldC5vbm9wZW4gPSBfdGhpcy5ydW5SZWFsVGVybWluYWw7XG4gICAgICAgICAgICBzb2NrZXQub25jbG9zZSA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzb2NrZXQub25lcnJvciA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9XG5cbiAgIH1cblxuICAgd2luZG93LlRlcm1NYW5hZ2VyID0gVGVybU1hbmFnZXI7XG5cbn0pKCk7XG5cblxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./main.js\n");

/***/ }),

/***/ "./xterm.js/addons/attach/attach.js":
/*!******************************************!*\
  !*** ./xterm.js/addons/attach/attach.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction attach(term, socket, bidirectional, buffered) {\n    bidirectional = (typeof bidirectional == 'undefined') ? true : bidirectional;\n    term.socket = socket;\n    term._flushBuffer = function () {\n        term.write(term._attachSocketBuffer);\n        term._attachSocketBuffer = null;\n    };\n    term._pushToBuffer = function (data) {\n        if (term._attachSocketBuffer) {\n            term._attachSocketBuffer += data;\n        }\n        else {\n            term._attachSocketBuffer = data;\n            setTimeout(term._flushBuffer, 10);\n        }\n    };\n    var myTextDecoder;\n    term._getMessage = function (ev) {\n        var str;\n        if (typeof ev.data === \"object\") {\n            if (ev.data instanceof ArrayBuffer) {\n                if (!myTextDecoder) {\n                    myTextDecoder = new TextDecoder();\n                }\n                str = myTextDecoder.decode(ev.data);\n            }\n            else {\n                throw \"TODO: handle Blob?\";\n            }\n        }\n        if (buffered) {\n            term._pushToBuffer(str || ev.data);\n        }\n        else {\n            term.write(str || ev.data);\n        }\n    };\n    term._sendData = function (data) {\n        if (socket.readyState !== 1) {\n            return;\n        }\n        socket.send(data);\n    };\n    socket.addEventListener('message', term._getMessage);\n    if (bidirectional) {\n        term.on('data', term._sendData);\n    }\n    socket.addEventListener('close', term.detach.bind(term, socket));\n    socket.addEventListener('error', term.detach.bind(term, socket));\n}\nexports.attach = attach;\n;\nfunction detach(term, socket) {\n    term.off('data', term._sendData);\n    socket = (typeof socket == 'undefined') ? term.socket : socket;\n    if (socket) {\n        socket.removeEventListener('message', term._getMessage);\n    }\n    delete term.socket;\n}\nexports.detach = detach;\n;\nfunction apply(terminalConstructor) {\n    terminalConstructor.prototype.attach = function (socket, bidirectional, buffered) {\n        return attach(this, socket, bidirectional, buffered);\n    };\n    terminalConstructor.prototype.detach = function (socket) {\n        return detach(this, socket);\n    };\n}\nexports.apply = apply;\n\n//# sourceMappingURL=attach.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi94dGVybS5qcy9hZGRvbnMvYXR0YWNoL2F0dGFjaC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3h0ZXJtLmpzL2FkZG9ucy9hdHRhY2gvYXR0YWNoLmpzP2E0OGUiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBhdHRhY2godGVybSwgc29ja2V0LCBiaWRpcmVjdGlvbmFsLCBidWZmZXJlZCkge1xuICAgIGJpZGlyZWN0aW9uYWwgPSAodHlwZW9mIGJpZGlyZWN0aW9uYWwgPT0gJ3VuZGVmaW5lZCcpID8gdHJ1ZSA6IGJpZGlyZWN0aW9uYWw7XG4gICAgdGVybS5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgdGVybS5fZmx1c2hCdWZmZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRlcm0ud3JpdGUodGVybS5fYXR0YWNoU29ja2V0QnVmZmVyKTtcbiAgICAgICAgdGVybS5fYXR0YWNoU29ja2V0QnVmZmVyID0gbnVsbDtcbiAgICB9O1xuICAgIHRlcm0uX3B1c2hUb0J1ZmZlciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmICh0ZXJtLl9hdHRhY2hTb2NrZXRCdWZmZXIpIHtcbiAgICAgICAgICAgIHRlcm0uX2F0dGFjaFNvY2tldEJ1ZmZlciArPSBkYXRhO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGVybS5fYXR0YWNoU29ja2V0QnVmZmVyID0gZGF0YTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQodGVybS5fZmx1c2hCdWZmZXIsIDEwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIG15VGV4dERlY29kZXI7XG4gICAgdGVybS5fZ2V0TWVzc2FnZSA9IGZ1bmN0aW9uIChldikge1xuICAgICAgICB2YXIgc3RyO1xuICAgICAgICBpZiAodHlwZW9mIGV2LmRhdGEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIGlmIChldi5kYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW15VGV4dERlY29kZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbXlUZXh0RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdHIgPSBteVRleHREZWNvZGVyLmRlY29kZShldi5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IFwiVE9ETzogaGFuZGxlIEJsb2I/XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJ1ZmZlcmVkKSB7XG4gICAgICAgICAgICB0ZXJtLl9wdXNoVG9CdWZmZXIoc3RyIHx8IGV2LmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGVybS53cml0ZShzdHIgfHwgZXYuZGF0YSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRlcm0uX3NlbmREYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKHNvY2tldC5yZWFkeVN0YXRlICE9PSAxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgc29ja2V0LnNlbmQoZGF0YSk7XG4gICAgfTtcbiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRlcm0uX2dldE1lc3NhZ2UpO1xuICAgIGlmIChiaWRpcmVjdGlvbmFsKSB7XG4gICAgICAgIHRlcm0ub24oJ2RhdGEnLCB0ZXJtLl9zZW5kRGF0YSk7XG4gICAgfVxuICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIHRlcm0uZGV0YWNoLmJpbmQodGVybSwgc29ja2V0KSk7XG4gICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGVybS5kZXRhY2guYmluZCh0ZXJtLCBzb2NrZXQpKTtcbn1cbmV4cG9ydHMuYXR0YWNoID0gYXR0YWNoO1xuO1xuZnVuY3Rpb24gZGV0YWNoKHRlcm0sIHNvY2tldCkge1xuICAgIHRlcm0ub2ZmKCdkYXRhJywgdGVybS5fc2VuZERhdGEpO1xuICAgIHNvY2tldCA9ICh0eXBlb2Ygc29ja2V0ID09ICd1bmRlZmluZWQnKSA/IHRlcm0uc29ja2V0IDogc29ja2V0O1xuICAgIGlmIChzb2NrZXQpIHtcbiAgICAgICAgc29ja2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0ZXJtLl9nZXRNZXNzYWdlKTtcbiAgICB9XG4gICAgZGVsZXRlIHRlcm0uc29ja2V0O1xufVxuZXhwb3J0cy5kZXRhY2ggPSBkZXRhY2g7XG47XG5mdW5jdGlvbiBhcHBseSh0ZXJtaW5hbENvbnN0cnVjdG9yKSB7XG4gICAgdGVybWluYWxDb25zdHJ1Y3Rvci5wcm90b3R5cGUuYXR0YWNoID0gZnVuY3Rpb24gKHNvY2tldCwgYmlkaXJlY3Rpb25hbCwgYnVmZmVyZWQpIHtcbiAgICAgICAgcmV0dXJuIGF0dGFjaCh0aGlzLCBzb2NrZXQsIGJpZGlyZWN0aW9uYWwsIGJ1ZmZlcmVkKTtcbiAgICB9O1xuICAgIHRlcm1pbmFsQ29uc3RydWN0b3IucHJvdG90eXBlLmRldGFjaCA9IGZ1bmN0aW9uIChzb2NrZXQpIHtcbiAgICAgICAgcmV0dXJuIGRldGFjaCh0aGlzLCBzb2NrZXQpO1xuICAgIH07XG59XG5leHBvcnRzLmFwcGx5ID0gYXBwbHk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWF0dGFjaC5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./xterm.js/addons/attach/attach.js\n");

/***/ }),

/***/ "./xterm.js/addons/fit/fit.js":
/*!************************************!*\
  !*** ./xterm.js/addons/fit/fit.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction proposeGeometry(term) {\n    if (!term.element.parentElement) {\n        return null;\n    }\n    var parentElementStyle = window.getComputedStyle(term.element.parentElement);\n    var parentElementHeight = parseInt(parentElementStyle.getPropertyValue('height'));\n    var parentElementWidth = Math.max(0, parseInt(parentElementStyle.getPropertyValue('width')) - 17);\n    var elementStyle = window.getComputedStyle(term.element);\n    var elementPaddingVer = parseInt(elementStyle.getPropertyValue('padding-top')) + parseInt(elementStyle.getPropertyValue('padding-bottom'));\n    var elementPaddingHor = parseInt(elementStyle.getPropertyValue('padding-right')) + parseInt(elementStyle.getPropertyValue('padding-left'));\n    var availableHeight = parentElementHeight - elementPaddingVer;\n    var availableWidth = parentElementWidth - elementPaddingHor;\n    var geometry = {\n        cols: Math.floor(availableWidth / term.renderer.dimensions.actualCellWidth),\n        rows: Math.floor(availableHeight / term.renderer.dimensions.actualCellHeight)\n    };\n    return geometry;\n}\nexports.proposeGeometry = proposeGeometry;\n;\nfunction fit(term) {\n    var geometry = proposeGeometry(term);\n    if (geometry) {\n        if (term.rows !== geometry.rows || term.cols !== geometry.cols) {\n            term.renderer.clear();\n            term.resize(geometry.cols, geometry.rows);\n        }\n    }\n}\nexports.fit = fit;\n;\nfunction apply(terminalConstructor) {\n    terminalConstructor.prototype.proposeGeometry = function () {\n        return proposeGeometry(this);\n    };\n    terminalConstructor.prototype.fit = function () {\n        return fit(this);\n    };\n}\nexports.apply = apply;\n\n//# sourceMappingURL=fit.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi94dGVybS5qcy9hZGRvbnMvZml0L2ZpdC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3h0ZXJtLmpzL2FkZG9ucy9maXQvZml0LmpzP2MxYWMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBwcm9wb3NlR2VvbWV0cnkodGVybSkge1xuICAgIGlmICghdGVybS5lbGVtZW50LnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBwYXJlbnRFbGVtZW50U3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXJtLmVsZW1lbnQucGFyZW50RWxlbWVudCk7XG4gICAgdmFyIHBhcmVudEVsZW1lbnRIZWlnaHQgPSBwYXJzZUludChwYXJlbnRFbGVtZW50U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnaGVpZ2h0JykpO1xuICAgIHZhciBwYXJlbnRFbGVtZW50V2lkdGggPSBNYXRoLm1heCgwLCBwYXJzZUludChwYXJlbnRFbGVtZW50U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnd2lkdGgnKSkgLSAxNyk7XG4gICAgdmFyIGVsZW1lbnRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRlcm0uZWxlbWVudCk7XG4gICAgdmFyIGVsZW1lbnRQYWRkaW5nVmVyID0gcGFyc2VJbnQoZWxlbWVudFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctdG9wJykpICsgcGFyc2VJbnQoZWxlbWVudFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctYm90dG9tJykpO1xuICAgIHZhciBlbGVtZW50UGFkZGluZ0hvciA9IHBhcnNlSW50KGVsZW1lbnRTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLXJpZ2h0JykpICsgcGFyc2VJbnQoZWxlbWVudFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctbGVmdCcpKTtcbiAgICB2YXIgYXZhaWxhYmxlSGVpZ2h0ID0gcGFyZW50RWxlbWVudEhlaWdodCAtIGVsZW1lbnRQYWRkaW5nVmVyO1xuICAgIHZhciBhdmFpbGFibGVXaWR0aCA9IHBhcmVudEVsZW1lbnRXaWR0aCAtIGVsZW1lbnRQYWRkaW5nSG9yO1xuICAgIHZhciBnZW9tZXRyeSA9IHtcbiAgICAgICAgY29sczogTWF0aC5mbG9vcihhdmFpbGFibGVXaWR0aCAvIHRlcm0ucmVuZGVyZXIuZGltZW5zaW9ucy5hY3R1YWxDZWxsV2lkdGgpLFxuICAgICAgICByb3dzOiBNYXRoLmZsb29yKGF2YWlsYWJsZUhlaWdodCAvIHRlcm0ucmVuZGVyZXIuZGltZW5zaW9ucy5hY3R1YWxDZWxsSGVpZ2h0KVxuICAgIH07XG4gICAgcmV0dXJuIGdlb21ldHJ5O1xufVxuZXhwb3J0cy5wcm9wb3NlR2VvbWV0cnkgPSBwcm9wb3NlR2VvbWV0cnk7XG47XG5mdW5jdGlvbiBmaXQodGVybSkge1xuICAgIHZhciBnZW9tZXRyeSA9IHByb3Bvc2VHZW9tZXRyeSh0ZXJtKTtcbiAgICBpZiAoZ2VvbWV0cnkpIHtcbiAgICAgICAgaWYgKHRlcm0ucm93cyAhPT0gZ2VvbWV0cnkucm93cyB8fCB0ZXJtLmNvbHMgIT09IGdlb21ldHJ5LmNvbHMpIHtcbiAgICAgICAgICAgIHRlcm0ucmVuZGVyZXIuY2xlYXIoKTtcbiAgICAgICAgICAgIHRlcm0ucmVzaXplKGdlb21ldHJ5LmNvbHMsIGdlb21ldHJ5LnJvd3MpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5maXQgPSBmaXQ7XG47XG5mdW5jdGlvbiBhcHBseSh0ZXJtaW5hbENvbnN0cnVjdG9yKSB7XG4gICAgdGVybWluYWxDb25zdHJ1Y3Rvci5wcm90b3R5cGUucHJvcG9zZUdlb21ldHJ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcHJvcG9zZUdlb21ldHJ5KHRoaXMpO1xuICAgIH07XG4gICAgdGVybWluYWxDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZml0KHRoaXMpO1xuICAgIH07XG59XG5leHBvcnRzLmFwcGx5ID0gYXBwbHk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZpdC5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./xterm.js/addons/fit/fit.js\n");

/***/ }),

/***/ "./xterm.js/addons/fullscreen/fullscreen.js":
/*!**************************************************!*\
  !*** ./xterm.js/addons/fullscreen/fullscreen.js ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction toggleFullScreen(term, fullscreen) {\n    var fn;\n    if (typeof fullscreen == 'undefined') {\n        fn = (term.element.classList.contains('fullscreen')) ? 'remove' : 'add';\n    }\n    else if (!fullscreen) {\n        fn = 'remove';\n    }\n    else {\n        fn = 'add';\n    }\n    term.element.classList[fn]('fullscreen');\n}\nexports.toggleFullScreen = toggleFullScreen;\n;\nfunction apply(terminalConstructor) {\n    terminalConstructor.prototype.toggleFullScreen = function (fullscreen) {\n        return toggleFullScreen(this, fullscreen);\n    };\n}\nexports.apply = apply;\n\n//# sourceMappingURL=fullscreen.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi94dGVybS5qcy9hZGRvbnMvZnVsbHNjcmVlbi9mdWxsc2NyZWVuLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4veHRlcm0uanMvYWRkb25zL2Z1bGxzY3JlZW4vZnVsbHNjcmVlbi5qcz84YTg5Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gdG9nZ2xlRnVsbFNjcmVlbih0ZXJtLCBmdWxsc2NyZWVuKSB7XG4gICAgdmFyIGZuO1xuICAgIGlmICh0eXBlb2YgZnVsbHNjcmVlbiA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBmbiA9ICh0ZXJtLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmdWxsc2NyZWVuJykpID8gJ3JlbW92ZScgOiAnYWRkJztcbiAgICB9XG4gICAgZWxzZSBpZiAoIWZ1bGxzY3JlZW4pIHtcbiAgICAgICAgZm4gPSAncmVtb3ZlJztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZuID0gJ2FkZCc7XG4gICAgfVxuICAgIHRlcm0uZWxlbWVudC5jbGFzc0xpc3RbZm5dKCdmdWxsc2NyZWVuJyk7XG59XG5leHBvcnRzLnRvZ2dsZUZ1bGxTY3JlZW4gPSB0b2dnbGVGdWxsU2NyZWVuO1xuO1xuZnVuY3Rpb24gYXBwbHkodGVybWluYWxDb25zdHJ1Y3Rvcikge1xuICAgIHRlcm1pbmFsQ29uc3RydWN0b3IucHJvdG90eXBlLnRvZ2dsZUZ1bGxTY3JlZW4gPSBmdW5jdGlvbiAoZnVsbHNjcmVlbikge1xuICAgICAgICByZXR1cm4gdG9nZ2xlRnVsbFNjcmVlbih0aGlzLCBmdWxsc2NyZWVuKTtcbiAgICB9O1xufVxuZXhwb3J0cy5hcHBseSA9IGFwcGx5O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1mdWxsc2NyZWVuLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./xterm.js/addons/fullscreen/fullscreen.js\n");

/***/ }),

/***/ "./xterm.js/addons/search/SearchHelper.js":
/*!************************************************!*\
  !*** ./xterm.js/addons/search/SearchHelper.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SearchHelper = (function () {\n    function SearchHelper(_terminal) {\n        this._terminal = _terminal;\n    }\n    SearchHelper.prototype.findNext = function (term) {\n        if (!term || term.length === 0) {\n            return false;\n        }\n        var result;\n        var startRow = this._terminal.buffer.ydisp;\n        if (this._terminal.selectionManager.selectionEnd) {\n            startRow = this._terminal.selectionManager.selectionEnd[1];\n        }\n        for (var y = startRow + 1; y < this._terminal.buffer.ybase + this._terminal.rows; y++) {\n            result = this._findInLine(term, y);\n            if (result) {\n                break;\n            }\n        }\n        if (!result) {\n            for (var y = 0; y < startRow; y++) {\n                result = this._findInLine(term, y);\n                if (result) {\n                    break;\n                }\n            }\n        }\n        return this._selectResult(result);\n    };\n    SearchHelper.prototype.findPrevious = function (term) {\n        if (!term || term.length === 0) {\n            return false;\n        }\n        var result;\n        var startRow = this._terminal.buffer.ydisp;\n        if (this._terminal.selectionManager.selectionStart) {\n            startRow = this._terminal.selectionManager.selectionStart[1];\n        }\n        for (var y = startRow - 1; y >= 0; y--) {\n            result = this._findInLine(term, y);\n            if (result) {\n                break;\n            }\n        }\n        if (!result) {\n            for (var y = this._terminal.buffer.ybase + this._terminal.rows - 1; y > startRow; y--) {\n                result = this._findInLine(term, y);\n                if (result) {\n                    break;\n                }\n            }\n        }\n        return this._selectResult(result);\n    };\n    SearchHelper.prototype._findInLine = function (term, y) {\n        var lowerStringLine = this._terminal.buffer.translateBufferLineToString(y, true).toLowerCase();\n        var lowerTerm = term.toLowerCase();\n        var searchIndex = lowerStringLine.indexOf(lowerTerm);\n        if (searchIndex >= 0) {\n            return {\n                term: term,\n                col: searchIndex,\n                row: y\n            };\n        }\n    };\n    SearchHelper.prototype._selectResult = function (result) {\n        if (!result) {\n            return false;\n        }\n        this._terminal.selectionManager.setSelection(result.col, result.row, result.term.length);\n        this._terminal.scrollLines(result.row - this._terminal.buffer.ydisp, false);\n        return true;\n    };\n    return SearchHelper;\n}());\nexports.SearchHelper = SearchHelper;\n\n//# sourceMappingURL=SearchHelper.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi94dGVybS5qcy9hZGRvbnMvc2VhcmNoL1NlYXJjaEhlbHBlci5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3h0ZXJtLmpzL2FkZG9ucy9zZWFyY2gvU2VhcmNoSGVscGVyLmpzPzNmNDkiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU2VhcmNoSGVscGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTZWFyY2hIZWxwZXIoX3Rlcm1pbmFsKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsID0gX3Rlcm1pbmFsO1xuICAgIH1cbiAgICBTZWFyY2hIZWxwZXIucHJvdG90eXBlLmZpbmROZXh0ID0gZnVuY3Rpb24gKHRlcm0pIHtcbiAgICAgICAgaWYgKCF0ZXJtIHx8IHRlcm0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgdmFyIHN0YXJ0Um93ID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnlkaXNwO1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwuc2VsZWN0aW9uTWFuYWdlci5zZWxlY3Rpb25FbmQpIHtcbiAgICAgICAgICAgIHN0YXJ0Um93ID0gdGhpcy5fdGVybWluYWwuc2VsZWN0aW9uTWFuYWdlci5zZWxlY3Rpb25FbmRbMV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgeSA9IHN0YXJ0Um93ICsgMTsgeSA8IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZSArIHRoaXMuX3Rlcm1pbmFsLnJvd3M7IHkrKykge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5fZmluZEluTGluZSh0ZXJtLCB5KTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdGFydFJvdzsgeSsrKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5fZmluZEluTGluZSh0ZXJtLCB5KTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0UmVzdWx0KHJlc3VsdCk7XG4gICAgfTtcbiAgICBTZWFyY2hIZWxwZXIucHJvdG90eXBlLmZpbmRQcmV2aW91cyA9IGZ1bmN0aW9uICh0ZXJtKSB7XG4gICAgICAgIGlmICghdGVybSB8fCB0ZXJtLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIHZhciBzdGFydFJvdyA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ZGlzcDtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLnNlbGVjdGlvbk1hbmFnZXIuc2VsZWN0aW9uU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXJ0Um93ID0gdGhpcy5fdGVybWluYWwuc2VsZWN0aW9uTWFuYWdlci5zZWxlY3Rpb25TdGFydFsxXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciB5ID0gc3RhcnRSb3cgLSAxOyB5ID49IDA7IHktLSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5fZmluZEluTGluZSh0ZXJtLCB5KTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgZm9yICh2YXIgeSA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZSArIHRoaXMuX3Rlcm1pbmFsLnJvd3MgLSAxOyB5ID4gc3RhcnRSb3c7IHktLSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuX2ZpbmRJbkxpbmUodGVybSwgeSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdFJlc3VsdChyZXN1bHQpO1xuICAgIH07XG4gICAgU2VhcmNoSGVscGVyLnByb3RvdHlwZS5fZmluZEluTGluZSA9IGZ1bmN0aW9uICh0ZXJtLCB5KSB7XG4gICAgICAgIHZhciBsb3dlclN0cmluZ0xpbmUgPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIudHJhbnNsYXRlQnVmZmVyTGluZVRvU3RyaW5nKHksIHRydWUpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhciBsb3dlclRlcm0gPSB0ZXJtLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhciBzZWFyY2hJbmRleCA9IGxvd2VyU3RyaW5nTGluZS5pbmRleE9mKGxvd2VyVGVybSk7XG4gICAgICAgIGlmIChzZWFyY2hJbmRleCA+PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRlcm06IHRlcm0sXG4gICAgICAgICAgICAgICAgY29sOiBzZWFyY2hJbmRleCxcbiAgICAgICAgICAgICAgICByb3c6IHlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlYXJjaEhlbHBlci5wcm90b3R5cGUuX3NlbGVjdFJlc3VsdCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZWxlY3Rpb25NYW5hZ2VyLnNldFNlbGVjdGlvbihyZXN1bHQuY29sLCByZXN1bHQucm93LCByZXN1bHQudGVybS5sZW5ndGgpO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5zY3JvbGxMaW5lcyhyZXN1bHQucm93IC0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnlkaXNwLCBmYWxzZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIFNlYXJjaEhlbHBlcjtcbn0oKSk7XG5leHBvcnRzLlNlYXJjaEhlbHBlciA9IFNlYXJjaEhlbHBlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2VhcmNoSGVscGVyLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./xterm.js/addons/search/SearchHelper.js\n");

/***/ }),

/***/ "./xterm.js/addons/search/search.js":
/*!******************************************!*\
  !*** ./xterm.js/addons/search/search.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SearchHelper_1 = __webpack_require__(/*! ./SearchHelper */ \"./xterm.js/addons/search/SearchHelper.js\");\nfunction findNext(terminal, term) {\n    if (!terminal._searchHelper) {\n        terminal.searchHelper = new SearchHelper_1.SearchHelper(terminal);\n    }\n    return terminal.searchHelper.findNext(term);\n}\nexports.findNext = findNext;\n;\nfunction findPrevious(terminal, term) {\n    if (!terminal._searchHelper) {\n        terminal.searchHelper = new SearchHelper_1.SearchHelper(terminal);\n    }\n    return terminal.searchHelper.findPrevious(term);\n}\nexports.findPrevious = findPrevious;\n;\nfunction apply(terminalConstructor) {\n    terminalConstructor.prototype.findNext = function (term) {\n        return findNext(this, term);\n    };\n    terminalConstructor.prototype.findPrevious = function (term) {\n        return findPrevious(this, term);\n    };\n}\nexports.apply = apply;\n//# sourceMappingURL=search.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi94dGVybS5qcy9hZGRvbnMvc2VhcmNoL3NlYXJjaC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3h0ZXJtLmpzL2FkZG9ucy9zZWFyY2gvc2VhcmNoLmpzP2EyY2IiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU2VhcmNoSGVscGVyXzEgPSByZXF1aXJlKFwiLi9TZWFyY2hIZWxwZXJcIik7XG5mdW5jdGlvbiBmaW5kTmV4dCh0ZXJtaW5hbCwgdGVybSkge1xuICAgIGlmICghdGVybWluYWwuX3NlYXJjaEhlbHBlcikge1xuICAgICAgICB0ZXJtaW5hbC5zZWFyY2hIZWxwZXIgPSBuZXcgU2VhcmNoSGVscGVyXzEuU2VhcmNoSGVscGVyKHRlcm1pbmFsKTtcbiAgICB9XG4gICAgcmV0dXJuIHRlcm1pbmFsLnNlYXJjaEhlbHBlci5maW5kTmV4dCh0ZXJtKTtcbn1cbmV4cG9ydHMuZmluZE5leHQgPSBmaW5kTmV4dDtcbjtcbmZ1bmN0aW9uIGZpbmRQcmV2aW91cyh0ZXJtaW5hbCwgdGVybSkge1xuICAgIGlmICghdGVybWluYWwuX3NlYXJjaEhlbHBlcikge1xuICAgICAgICB0ZXJtaW5hbC5zZWFyY2hIZWxwZXIgPSBuZXcgU2VhcmNoSGVscGVyXzEuU2VhcmNoSGVscGVyKHRlcm1pbmFsKTtcbiAgICB9XG4gICAgcmV0dXJuIHRlcm1pbmFsLnNlYXJjaEhlbHBlci5maW5kUHJldmlvdXModGVybSk7XG59XG5leHBvcnRzLmZpbmRQcmV2aW91cyA9IGZpbmRQcmV2aW91cztcbjtcbmZ1bmN0aW9uIGFwcGx5KHRlcm1pbmFsQ29uc3RydWN0b3IpIHtcbiAgICB0ZXJtaW5hbENvbnN0cnVjdG9yLnByb3RvdHlwZS5maW5kTmV4dCA9IGZ1bmN0aW9uICh0ZXJtKSB7XG4gICAgICAgIHJldHVybiBmaW5kTmV4dCh0aGlzLCB0ZXJtKTtcbiAgICB9O1xuICAgIHRlcm1pbmFsQ29uc3RydWN0b3IucHJvdG90eXBlLmZpbmRQcmV2aW91cyA9IGZ1bmN0aW9uICh0ZXJtKSB7XG4gICAgICAgIHJldHVybiBmaW5kUHJldmlvdXModGhpcywgdGVybSk7XG4gICAgfTtcbn1cbmV4cG9ydHMuYXBwbHkgPSBhcHBseTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlYXJjaC5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./xterm.js/addons/search/search.js\n");

/***/ }),

/***/ "./xterm.js/addons/winptyCompat/winptyCompat.js":
/*!******************************************************!*\
  !*** ./xterm.js/addons/winptyCompat/winptyCompat.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction winptyCompatInit(terminal) {\n    var isWindows = ['Windows', 'Win16', 'Win32', 'WinCE'].indexOf(navigator.platform) >= 0;\n    if (!isWindows) {\n        return;\n    }\n    terminal.on('linefeed', function () {\n        var line = terminal.buffer.lines.get(terminal.buffer.ybase + terminal.buffer.y - 1);\n        var lastChar = line[terminal.cols - 1];\n        if (lastChar[3] !== 32) {\n            var nextLine = terminal.buffer.lines.get(terminal.buffer.ybase + terminal.buffer.y);\n            nextLine.isWrapped = true;\n        }\n    });\n}\nexports.winptyCompatInit = winptyCompatInit;\nfunction apply(terminalConstructor) {\n    terminalConstructor.prototype.winptyCompatInit = function () {\n        winptyCompatInit(this);\n    };\n}\nexports.apply = apply;\n\n//# sourceMappingURL=winptyCompat.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi94dGVybS5qcy9hZGRvbnMvd2lucHR5Q29tcGF0L3dpbnB0eUNvbXBhdC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3h0ZXJtLmpzL2FkZG9ucy93aW5wdHlDb21wYXQvd2lucHR5Q29tcGF0LmpzPzAyNDciXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiB3aW5wdHlDb21wYXRJbml0KHRlcm1pbmFsKSB7XG4gICAgdmFyIGlzV2luZG93cyA9IFsnV2luZG93cycsICdXaW4xNicsICdXaW4zMicsICdXaW5DRSddLmluZGV4T2YobmF2aWdhdG9yLnBsYXRmb3JtKSA+PSAwO1xuICAgIGlmICghaXNXaW5kb3dzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGVybWluYWwub24oJ2xpbmVmZWVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGluZSA9IHRlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQodGVybWluYWwuYnVmZmVyLnliYXNlICsgdGVybWluYWwuYnVmZmVyLnkgLSAxKTtcbiAgICAgICAgdmFyIGxhc3RDaGFyID0gbGluZVt0ZXJtaW5hbC5jb2xzIC0gMV07XG4gICAgICAgIGlmIChsYXN0Q2hhclszXSAhPT0gMzIpIHtcbiAgICAgICAgICAgIHZhciBuZXh0TGluZSA9IHRlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQodGVybWluYWwuYnVmZmVyLnliYXNlICsgdGVybWluYWwuYnVmZmVyLnkpO1xuICAgICAgICAgICAgbmV4dExpbmUuaXNXcmFwcGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy53aW5wdHlDb21wYXRJbml0ID0gd2lucHR5Q29tcGF0SW5pdDtcbmZ1bmN0aW9uIGFwcGx5KHRlcm1pbmFsQ29uc3RydWN0b3IpIHtcbiAgICB0ZXJtaW5hbENvbnN0cnVjdG9yLnByb3RvdHlwZS53aW5wdHlDb21wYXRJbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB3aW5wdHlDb21wYXRJbml0KHRoaXMpO1xuICAgIH07XG59XG5leHBvcnRzLmFwcGx5ID0gYXBwbHk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdpbnB0eUNvbXBhdC5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./xterm.js/addons/winptyCompat/winptyCompat.js\n");

/***/ }),

/***/ "./xterm.js/xterm.js":
/*!***************************!*\
  !*** ./xterm.js/xterm.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var require;var require;(function(f){if(true){module.exports=f()}else { var g; }})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CircularList_1 = require(\"./utils/CircularList\");\nexports.CHAR_DATA_ATTR_INDEX = 0;\nexports.CHAR_DATA_CHAR_INDEX = 1;\nexports.CHAR_DATA_WIDTH_INDEX = 2;\nexports.CHAR_DATA_CODE_INDEX = 3;\nexports.MAX_BUFFER_SIZE = 4294967295;\nvar Buffer = (function () {\n    function Buffer(_terminal, _hasScrollback) {\n        this._terminal = _terminal;\n        this._hasScrollback = _hasScrollback;\n        this.clear();\n    }\n    Object.defineProperty(Buffer.prototype, \"lines\", {\n        get: function () {\n            return this._lines;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Buffer.prototype, \"hasScrollback\", {\n        get: function () {\n            return this._hasScrollback && this.lines.maxLength > this._terminal.rows;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Buffer.prototype, \"isCursorInViewport\", {\n        get: function () {\n            var absoluteY = this.ybase + this.y;\n            var relativeY = absoluteY - this.ydisp;\n            return (relativeY >= 0 && relativeY < this._terminal.rows);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Buffer.prototype._getCorrectBufferLength = function (rows) {\n        if (!this._hasScrollback) {\n            return rows;\n        }\n        var correctBufferLength = rows + this._terminal.options.scrollback;\n        return correctBufferLength > exports.MAX_BUFFER_SIZE ? exports.MAX_BUFFER_SIZE : correctBufferLength;\n    };\n    Buffer.prototype.fillViewportRows = function () {\n        if (this._lines.length === 0) {\n            var i = this._terminal.rows;\n            while (i--) {\n                this.lines.push(this._terminal.blankLine());\n            }\n        }\n    };\n    Buffer.prototype.clear = function () {\n        this.ydisp = 0;\n        this.ybase = 0;\n        this.y = 0;\n        this.x = 0;\n        this._lines = new CircularList_1.CircularList(this._getCorrectBufferLength(this._terminal.rows));\n        this.scrollTop = 0;\n        this.scrollBottom = this._terminal.rows - 1;\n        this.setupTabStops();\n    };\n    Buffer.prototype.resize = function (newCols, newRows) {\n        var newMaxLength = this._getCorrectBufferLength(newRows);\n        if (newMaxLength > this._lines.maxLength) {\n            this._lines.maxLength = newMaxLength;\n        }\n        if (this._lines.length > 0) {\n            if (this._terminal.cols < newCols) {\n                var ch = [this._terminal.defAttr, ' ', 1, 32];\n                for (var i = 0; i < this._lines.length; i++) {\n                    if (this._lines.get(i) === undefined) {\n                        this._lines.set(i, this._terminal.blankLine(undefined, undefined, newCols));\n                    }\n                    while (this._lines.get(i).length < newCols) {\n                        this._lines.get(i).push(ch);\n                    }\n                }\n            }\n            var addToY = 0;\n            if (this._terminal.rows < newRows) {\n                for (var y = this._terminal.rows; y < newRows; y++) {\n                    if (this._lines.length < newRows + this.ybase) {\n                        if (this.ybase > 0 && this._lines.length <= this.ybase + this.y + addToY + 1) {\n                            this.ybase--;\n                            addToY++;\n                            if (this.ydisp > 0) {\n                                this.ydisp--;\n                            }\n                        }\n                        else {\n                            this._lines.push(this._terminal.blankLine(undefined, undefined, newCols));\n                        }\n                    }\n                }\n            }\n            else {\n                for (var y = this._terminal.rows; y > newRows; y--) {\n                    if (this._lines.length > newRows + this.ybase) {\n                        if (this._lines.length > this.ybase + this.y + 1) {\n                            this._lines.pop();\n                        }\n                        else {\n                            this.ybase++;\n                            this.ydisp++;\n                        }\n                    }\n                }\n            }\n            if (newMaxLength < this._lines.maxLength) {\n                var amountToTrim = this._lines.length - newMaxLength;\n                if (amountToTrim > 0) {\n                    this._lines.trimStart(amountToTrim);\n                    this.ybase = Math.max(this.ybase - amountToTrim, 0);\n                    this.ydisp = Math.max(this.ydisp - amountToTrim, 0);\n                }\n                this._lines.maxLength = newMaxLength;\n            }\n            if (this.y >= newRows) {\n                this.y = newRows - 1;\n            }\n            if (addToY) {\n                this.y += addToY;\n            }\n            if (this.x >= newCols) {\n                this.x = newCols - 1;\n            }\n            this.scrollTop = 0;\n        }\n        this.scrollBottom = newRows - 1;\n    };\n    Buffer.prototype.translateBufferLineToString = function (lineIndex, trimRight, startCol, endCol) {\n        if (startCol === void 0) { startCol = 0; }\n        if (endCol === void 0) { endCol = null; }\n        var lineString = '';\n        var line = this.lines.get(lineIndex);\n        if (!line) {\n            return '';\n        }\n        var startIndex = startCol;\n        endCol = endCol || line.length;\n        var endIndex = endCol;\n        for (var i = 0; i < line.length; i++) {\n            var char = line[i];\n            lineString += char[exports.CHAR_DATA_CHAR_INDEX];\n            if (char[exports.CHAR_DATA_WIDTH_INDEX] === 0) {\n                if (startCol >= i) {\n                    startIndex--;\n                }\n                if (endCol >= i) {\n                    endIndex--;\n                }\n            }\n            else {\n                if (char[exports.CHAR_DATA_CHAR_INDEX].length > 1) {\n                    if (startCol > i) {\n                        startIndex += char[exports.CHAR_DATA_CHAR_INDEX].length - 1;\n                    }\n                    if (endCol > i) {\n                        endIndex += char[exports.CHAR_DATA_CHAR_INDEX].length - 1;\n                    }\n                }\n            }\n        }\n        if (trimRight) {\n            var rightWhitespaceIndex = lineString.search(/\\s+$/);\n            if (rightWhitespaceIndex !== -1) {\n                endIndex = Math.min(endIndex, rightWhitespaceIndex);\n            }\n            if (endIndex <= startIndex) {\n                return '';\n            }\n        }\n        return lineString.substring(startIndex, endIndex);\n    };\n    Buffer.prototype.setupTabStops = function (i) {\n        if (i != null) {\n            if (!this.tabs[i]) {\n                i = this.prevStop(i);\n            }\n        }\n        else {\n            this.tabs = {};\n            i = 0;\n        }\n        for (; i < this._terminal.cols; i += this._terminal.options.tabStopWidth) {\n            this.tabs[i] = true;\n        }\n    };\n    Buffer.prototype.prevStop = function (x) {\n        if (x == null) {\n            x = this.x;\n        }\n        while (!this.tabs[--x] && x > 0)\n            ;\n        return x >= this._terminal.cols ? this._terminal.cols - 1 : x < 0 ? 0 : x;\n    };\n    Buffer.prototype.nextStop = function (x) {\n        if (x == null) {\n            x = this.x;\n        }\n        while (!this.tabs[++x] && x < this._terminal.cols)\n            ;\n        return x >= this._terminal.cols ? this._terminal.cols - 1 : x < 0 ? 0 : x;\n    };\n    return Buffer;\n}());\nexports.Buffer = Buffer;\n\n\n\n},{\"./utils/CircularList\":30}],2:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"./Buffer\");\nvar EventEmitter_1 = require(\"./EventEmitter\");\nvar BufferSet = (function (_super) {\n    __extends(BufferSet, _super);\n    function BufferSet(_terminal) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._normal = new Buffer_1.Buffer(_this._terminal, true);\n        _this._normal.fillViewportRows();\n        _this._alt = new Buffer_1.Buffer(_this._terminal, false);\n        _this._activeBuffer = _this._normal;\n        _this.setupTabStops();\n        return _this;\n    }\n    Object.defineProperty(BufferSet.prototype, \"alt\", {\n        get: function () {\n            return this._alt;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BufferSet.prototype, \"active\", {\n        get: function () {\n            return this._activeBuffer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BufferSet.prototype, \"normal\", {\n        get: function () {\n            return this._normal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BufferSet.prototype.activateNormalBuffer = function () {\n        this._alt.clear();\n        this._activeBuffer = this._normal;\n        this.emit('activate', this._normal);\n    };\n    BufferSet.prototype.activateAltBuffer = function () {\n        this._alt.fillViewportRows();\n        this._activeBuffer = this._alt;\n        this.emit('activate', this._alt);\n    };\n    BufferSet.prototype.resize = function (newCols, newRows) {\n        this._normal.resize(newCols, newRows);\n        this._alt.resize(newCols, newRows);\n    };\n    BufferSet.prototype.setupTabStops = function (i) {\n        this._normal.setupTabStops(i);\n        this._alt.setupTabStops(i);\n    };\n    return BufferSet;\n}(EventEmitter_1.EventEmitter));\nexports.BufferSet = BufferSet;\n\n\n\n},{\"./Buffer\":1,\"./EventEmitter\":7}],3:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.wcwidth = (function (opts) {\n    var COMBINING_BMP = [\n        [0x0300, 0x036F], [0x0483, 0x0486], [0x0488, 0x0489],\n        [0x0591, 0x05BD], [0x05BF, 0x05BF], [0x05C1, 0x05C2],\n        [0x05C4, 0x05C5], [0x05C7, 0x05C7], [0x0600, 0x0603],\n        [0x0610, 0x0615], [0x064B, 0x065E], [0x0670, 0x0670],\n        [0x06D6, 0x06E4], [0x06E7, 0x06E8], [0x06EA, 0x06ED],\n        [0x070F, 0x070F], [0x0711, 0x0711], [0x0730, 0x074A],\n        [0x07A6, 0x07B0], [0x07EB, 0x07F3], [0x0901, 0x0902],\n        [0x093C, 0x093C], [0x0941, 0x0948], [0x094D, 0x094D],\n        [0x0951, 0x0954], [0x0962, 0x0963], [0x0981, 0x0981],\n        [0x09BC, 0x09BC], [0x09C1, 0x09C4], [0x09CD, 0x09CD],\n        [0x09E2, 0x09E3], [0x0A01, 0x0A02], [0x0A3C, 0x0A3C],\n        [0x0A41, 0x0A42], [0x0A47, 0x0A48], [0x0A4B, 0x0A4D],\n        [0x0A70, 0x0A71], [0x0A81, 0x0A82], [0x0ABC, 0x0ABC],\n        [0x0AC1, 0x0AC5], [0x0AC7, 0x0AC8], [0x0ACD, 0x0ACD],\n        [0x0AE2, 0x0AE3], [0x0B01, 0x0B01], [0x0B3C, 0x0B3C],\n        [0x0B3F, 0x0B3F], [0x0B41, 0x0B43], [0x0B4D, 0x0B4D],\n        [0x0B56, 0x0B56], [0x0B82, 0x0B82], [0x0BC0, 0x0BC0],\n        [0x0BCD, 0x0BCD], [0x0C3E, 0x0C40], [0x0C46, 0x0C48],\n        [0x0C4A, 0x0C4D], [0x0C55, 0x0C56], [0x0CBC, 0x0CBC],\n        [0x0CBF, 0x0CBF], [0x0CC6, 0x0CC6], [0x0CCC, 0x0CCD],\n        [0x0CE2, 0x0CE3], [0x0D41, 0x0D43], [0x0D4D, 0x0D4D],\n        [0x0DCA, 0x0DCA], [0x0DD2, 0x0DD4], [0x0DD6, 0x0DD6],\n        [0x0E31, 0x0E31], [0x0E34, 0x0E3A], [0x0E47, 0x0E4E],\n        [0x0EB1, 0x0EB1], [0x0EB4, 0x0EB9], [0x0EBB, 0x0EBC],\n        [0x0EC8, 0x0ECD], [0x0F18, 0x0F19], [0x0F35, 0x0F35],\n        [0x0F37, 0x0F37], [0x0F39, 0x0F39], [0x0F71, 0x0F7E],\n        [0x0F80, 0x0F84], [0x0F86, 0x0F87], [0x0F90, 0x0F97],\n        [0x0F99, 0x0FBC], [0x0FC6, 0x0FC6], [0x102D, 0x1030],\n        [0x1032, 0x1032], [0x1036, 0x1037], [0x1039, 0x1039],\n        [0x1058, 0x1059], [0x1160, 0x11FF], [0x135F, 0x135F],\n        [0x1712, 0x1714], [0x1732, 0x1734], [0x1752, 0x1753],\n        [0x1772, 0x1773], [0x17B4, 0x17B5], [0x17B7, 0x17BD],\n        [0x17C6, 0x17C6], [0x17C9, 0x17D3], [0x17DD, 0x17DD],\n        [0x180B, 0x180D], [0x18A9, 0x18A9], [0x1920, 0x1922],\n        [0x1927, 0x1928], [0x1932, 0x1932], [0x1939, 0x193B],\n        [0x1A17, 0x1A18], [0x1B00, 0x1B03], [0x1B34, 0x1B34],\n        [0x1B36, 0x1B3A], [0x1B3C, 0x1B3C], [0x1B42, 0x1B42],\n        [0x1B6B, 0x1B73], [0x1DC0, 0x1DCA], [0x1DFE, 0x1DFF],\n        [0x200B, 0x200F], [0x202A, 0x202E], [0x2060, 0x2063],\n        [0x206A, 0x206F], [0x20D0, 0x20EF], [0x302A, 0x302F],\n        [0x3099, 0x309A], [0xA806, 0xA806], [0xA80B, 0xA80B],\n        [0xA825, 0xA826], [0xFB1E, 0xFB1E], [0xFE00, 0xFE0F],\n        [0xFE20, 0xFE23], [0xFEFF, 0xFEFF], [0xFFF9, 0xFFFB],\n    ];\n    var COMBINING_HIGH = [\n        [0x10A01, 0x10A03], [0x10A05, 0x10A06], [0x10A0C, 0x10A0F],\n        [0x10A38, 0x10A3A], [0x10A3F, 0x10A3F], [0x1D167, 0x1D169],\n        [0x1D173, 0x1D182], [0x1D185, 0x1D18B], [0x1D1AA, 0x1D1AD],\n        [0x1D242, 0x1D244], [0xE0001, 0xE0001], [0xE0020, 0xE007F],\n        [0xE0100, 0xE01EF]\n    ];\n    function bisearch(ucs, data) {\n        var min = 0;\n        var max = data.length - 1;\n        var mid;\n        if (ucs < data[0][0] || ucs > data[max][1])\n            return false;\n        while (max >= min) {\n            mid = (min + max) >> 1;\n            if (ucs > data[mid][1])\n                min = mid + 1;\n            else if (ucs < data[mid][0])\n                max = mid - 1;\n            else\n                return true;\n        }\n        return false;\n    }\n    function wcwidthBMP(ucs) {\n        if (ucs === 0)\n            return opts.nul;\n        if (ucs < 32 || (ucs >= 0x7f && ucs < 0xa0))\n            return opts.control;\n        if (bisearch(ucs, COMBINING_BMP))\n            return 0;\n        if (isWideBMP(ucs)) {\n            return 2;\n        }\n        return 1;\n    }\n    function isWideBMP(ucs) {\n        return (ucs >= 0x1100 && (ucs <= 0x115f ||\n            ucs === 0x2329 ||\n            ucs === 0x232a ||\n            (ucs >= 0x2e80 && ucs <= 0xa4cf && ucs !== 0x303f) ||\n            (ucs >= 0xac00 && ucs <= 0xd7a3) ||\n            (ucs >= 0xf900 && ucs <= 0xfaff) ||\n            (ucs >= 0xfe10 && ucs <= 0xfe19) ||\n            (ucs >= 0xfe30 && ucs <= 0xfe6f) ||\n            (ucs >= 0xff00 && ucs <= 0xff60) ||\n            (ucs >= 0xffe0 && ucs <= 0xffe6)));\n    }\n    function wcwidthHigh(ucs) {\n        if (bisearch(ucs, COMBINING_HIGH))\n            return 0;\n        if ((ucs >= 0x20000 && ucs <= 0x2fffd) || (ucs >= 0x30000 && ucs <= 0x3fffd)) {\n            return 2;\n        }\n        return 1;\n    }\n    var control = opts.control | 0;\n    var table = null;\n    function init_table() {\n        var CODEPOINTS = 65536;\n        var BITWIDTH = 2;\n        var ITEMSIZE = 32;\n        var CONTAINERSIZE = CODEPOINTS * BITWIDTH / ITEMSIZE;\n        var CODEPOINTS_PER_ITEM = ITEMSIZE / BITWIDTH;\n        table = (typeof Uint32Array === 'undefined')\n            ? new Array(CONTAINERSIZE)\n            : new Uint32Array(CONTAINERSIZE);\n        for (var i = 0; i < CONTAINERSIZE; ++i) {\n            var num = 0;\n            var pos = CODEPOINTS_PER_ITEM;\n            while (pos--)\n                num = (num << 2) | wcwidthBMP(CODEPOINTS_PER_ITEM * i + pos);\n            table[i] = num;\n        }\n        return table;\n    }\n    return function (num) {\n        num = num | 0;\n        if (num < 32)\n            return control | 0;\n        if (num < 127)\n            return 1;\n        var t = table || init_table();\n        if (num < 65536)\n            return t[num >> 4] >> ((num & 15) << 1) & 3;\n        return wcwidthHigh(num);\n    };\n})({ nul: 0, control: 0 });\n\n\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CHARSETS = {};\nexports.DEFAULT_CHARSET = exports.CHARSETS['B'];\nexports.CHARSETS['0'] = {\n    '`': '\\u25c6',\n    'a': '\\u2592',\n    'b': '\\u0009',\n    'c': '\\u000c',\n    'd': '\\u000d',\n    'e': '\\u000a',\n    'f': '\\u00b0',\n    'g': '\\u00b1',\n    'h': '\\u2424',\n    'i': '\\u000b',\n    'j': '\\u2518',\n    'k': '\\u2510',\n    'l': '\\u250c',\n    'm': '\\u2514',\n    'n': '\\u253c',\n    'o': '\\u23ba',\n    'p': '\\u23bb',\n    'q': '\\u2500',\n    'r': '\\u23bc',\n    's': '\\u23bd',\n    't': '\\u251c',\n    'u': '\\u2524',\n    'v': '\\u2534',\n    'w': '\\u252c',\n    'x': '\\u2502',\n    'y': '\\u2264',\n    'z': '\\u2265',\n    '{': '\\u03c0',\n    '|': '\\u2260',\n    '}': '\\u00a3',\n    '~': '\\u00b7'\n};\nexports.CHARSETS['A'] = {\n    '#': ''\n};\nexports.CHARSETS['B'] = null;\nexports.CHARSETS['4'] = {\n    '#': '',\n    '@': '',\n    '[': 'ij',\n    '\\\\': '',\n    ']': '|',\n    '{': '',\n    '|': 'f',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['C'] =\n    exports.CHARSETS['5'] = {\n        '[': '',\n        '\\\\': '',\n        ']': '',\n        '^': '',\n        '`': '',\n        '{': '',\n        '|': '',\n        '}': '',\n        '~': ''\n    };\nexports.CHARSETS['R'] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['Q'] = {\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '^': '',\n    '`': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['K'] = {\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['Y'] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '`': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['E'] =\n    exports.CHARSETS['6'] = {\n        '@': '',\n        '[': '',\n        '\\\\': '',\n        ']': '',\n        '^': '',\n        '`': '',\n        '{': '',\n        '|': '',\n        '}': '',\n        '~': ''\n    };\nexports.CHARSETS['Z'] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '{': '',\n    '|': '',\n    '}': ''\n};\nexports.CHARSETS['H'] =\n    exports.CHARSETS['7'] = {\n        '@': '',\n        '[': '',\n        '\\\\': '',\n        ']': '',\n        '^': '',\n        '`': '',\n        '{': '',\n        '|': '',\n        '}': '',\n        '~': ''\n    };\nexports.CHARSETS['='] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '^': '',\n    '_': '',\n    '`': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\n\n\n\n},{}],5:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CompositionHelper = (function () {\n    function CompositionHelper(textarea, compositionView, terminal) {\n        this.textarea = textarea;\n        this.compositionView = compositionView;\n        this.terminal = terminal;\n        this.isComposing = false;\n        this.isSendingComposition = false;\n        this.compositionPosition = { start: null, end: null };\n    }\n    CompositionHelper.prototype.compositionstart = function () {\n        this.isComposing = true;\n        this.compositionPosition.start = this.textarea.value.length;\n        this.compositionView.textContent = '';\n        this.compositionView.classList.add('active');\n    };\n    CompositionHelper.prototype.compositionupdate = function (ev) {\n        var _this = this;\n        this.compositionView.textContent = ev.data;\n        this.updateCompositionElements();\n        setTimeout(function () {\n            _this.compositionPosition.end = _this.textarea.value.length;\n        }, 0);\n    };\n    CompositionHelper.prototype.compositionend = function () {\n        this.finalizeComposition(true);\n    };\n    CompositionHelper.prototype.keydown = function (ev) {\n        if (this.isComposing || this.isSendingComposition) {\n            if (ev.keyCode === 229) {\n                return false;\n            }\n            else if (ev.keyCode === 16 || ev.keyCode === 17 || ev.keyCode === 18) {\n                return false;\n            }\n            else {\n                this.finalizeComposition(false);\n            }\n        }\n        if (ev.keyCode === 229) {\n            this.handleAnyTextareaChanges();\n            return false;\n        }\n        return true;\n    };\n    CompositionHelper.prototype.finalizeComposition = function (waitForPropogation) {\n        var _this = this;\n        this.compositionView.classList.remove('active');\n        this.isComposing = false;\n        this.clearTextareaPosition();\n        if (!waitForPropogation) {\n            this.isSendingComposition = false;\n            var input = this.textarea.value.substring(this.compositionPosition.start, this.compositionPosition.end);\n            this.terminal.handler(input);\n        }\n        else {\n            var currentCompositionPosition_1 = {\n                start: this.compositionPosition.start,\n                end: this.compositionPosition.end,\n            };\n            this.isSendingComposition = true;\n            setTimeout(function () {\n                if (_this.isSendingComposition) {\n                    _this.isSendingComposition = false;\n                    var input = void 0;\n                    if (_this.isComposing) {\n                        input = _this.textarea.value.substring(currentCompositionPosition_1.start, currentCompositionPosition_1.end);\n                    }\n                    else {\n                        input = _this.textarea.value.substring(currentCompositionPosition_1.start);\n                    }\n                    _this.terminal.handler(input);\n                }\n            }, 0);\n        }\n    };\n    CompositionHelper.prototype.handleAnyTextareaChanges = function () {\n        var _this = this;\n        var oldValue = this.textarea.value;\n        setTimeout(function () {\n            if (!_this.isComposing) {\n                var newValue = _this.textarea.value;\n                var diff = newValue.replace(oldValue, '');\n                if (diff.length > 0) {\n                    _this.terminal.handler(diff);\n                }\n            }\n        }, 0);\n    };\n    CompositionHelper.prototype.updateCompositionElements = function (dontRecurse) {\n        var _this = this;\n        if (!this.isComposing) {\n            return;\n        }\n        if (this.terminal.buffer.isCursorInViewport) {\n            var cellHeight = Math.ceil(this.terminal.charMeasure.height * this.terminal.options.lineHeight);\n            var cursorTop = this.terminal.buffer.y * cellHeight;\n            var cursorLeft = this.terminal.buffer.x * this.terminal.charMeasure.width;\n            this.compositionView.style.left = cursorLeft + 'px';\n            this.compositionView.style.top = cursorTop + 'px';\n            this.compositionView.style.height = cellHeight + 'px';\n            this.compositionView.style.lineHeight = cellHeight + 'px';\n            var compositionViewBounds = this.compositionView.getBoundingClientRect();\n            this.textarea.style.left = cursorLeft + 'px';\n            this.textarea.style.top = cursorTop + 'px';\n            this.textarea.style.width = compositionViewBounds.width + 'px';\n            this.textarea.style.height = compositionViewBounds.height + 'px';\n            this.textarea.style.lineHeight = compositionViewBounds.height + 'px';\n        }\n        if (!dontRecurse) {\n            setTimeout(function () { return _this.updateCompositionElements(true); }, 0);\n        }\n    };\n    ;\n    CompositionHelper.prototype.clearTextareaPosition = function () {\n        this.textarea.style.left = '';\n        this.textarea.style.top = '';\n    };\n    ;\n    return CompositionHelper;\n}());\nexports.CompositionHelper = CompositionHelper;\n\n\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar C0;\n(function (C0) {\n    C0.NUL = '\\x00';\n    C0.SOH = '\\x01';\n    C0.STX = '\\x02';\n    C0.ETX = '\\x03';\n    C0.EOT = '\\x04';\n    C0.ENQ = '\\x05';\n    C0.ACK = '\\x06';\n    C0.BEL = '\\x07';\n    C0.BS = '\\x08';\n    C0.HT = '\\x09';\n    C0.LF = '\\x0a';\n    C0.VT = '\\x0b';\n    C0.FF = '\\x0c';\n    C0.CR = '\\x0d';\n    C0.SO = '\\x0e';\n    C0.SI = '\\x0f';\n    C0.DLE = '\\x10';\n    C0.DC1 = '\\x11';\n    C0.DC2 = '\\x12';\n    C0.DC3 = '\\x13';\n    C0.DC4 = '\\x14';\n    C0.NAK = '\\x15';\n    C0.SYN = '\\x16';\n    C0.ETB = '\\x17';\n    C0.CAN = '\\x18';\n    C0.EM = '\\x19';\n    C0.SUB = '\\x1a';\n    C0.ESC = '\\x1b';\n    C0.FS = '\\x1c';\n    C0.GS = '\\x1d';\n    C0.RS = '\\x1e';\n    C0.US = '\\x1f';\n    C0.SP = '\\x20';\n    C0.DEL = '\\x7f';\n})(C0 = exports.C0 || (exports.C0 = {}));\n;\n\n\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter = (function () {\n    function EventEmitter() {\n        this._events = this._events || {};\n    }\n    EventEmitter.prototype.on = function (type, listener) {\n        this._events[type] = this._events[type] || [];\n        this._events[type].push(listener);\n    };\n    EventEmitter.prototype.off = function (type, listener) {\n        if (!this._events[type]) {\n            return;\n        }\n        var obj = this._events[type];\n        var i = obj.length;\n        while (i--) {\n            if (obj[i] === listener || obj[i].listener === listener) {\n                obj.splice(i, 1);\n                return;\n            }\n        }\n    };\n    EventEmitter.prototype.removeAllListeners = function (type) {\n        if (this._events[type]) {\n            delete this._events[type];\n        }\n    };\n    EventEmitter.prototype.once = function (type, listener) {\n        function on() {\n            var args = Array.prototype.slice.call(arguments);\n            this.off(type, on);\n            listener.apply(this, args);\n        }\n        on.listener = listener;\n        this.on(type, on);\n    };\n    EventEmitter.prototype.emit = function (type) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!this._events[type]) {\n            return;\n        }\n        var obj = this._events[type];\n        for (var i = 0; i < obj.length; i++) {\n            obj[i].apply(this, args);\n        }\n    };\n    EventEmitter.prototype.listeners = function (type) {\n        return this._events[type] || [];\n    };\n    EventEmitter.prototype.destroy = function () {\n        this._events = {};\n    };\n    return EventEmitter;\n}());\nexports.EventEmitter = EventEmitter;\n\n\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EscapeSequences_1 = require(\"./EscapeSequences\");\nvar Charsets_1 = require(\"./Charsets\");\nvar Buffer_1 = require(\"./Buffer\");\nvar Types_1 = require(\"./renderer/Types\");\nvar CharWidth_1 = require(\"./CharWidth\");\nvar InputHandler = (function () {\n    function InputHandler(_terminal) {\n        this._terminal = _terminal;\n    }\n    InputHandler.prototype.addChar = function (char, code) {\n        if (char >= ' ') {\n            var ch_width = CharWidth_1.wcwidth(code);\n            if (this._terminal.charset && this._terminal.charset[char]) {\n                char = this._terminal.charset[char];\n            }\n            var row = this._terminal.buffer.y + this._terminal.buffer.ybase;\n            if (!ch_width && this._terminal.buffer.x) {\n                if (this._terminal.buffer.lines.get(row)[this._terminal.buffer.x - 1]) {\n                    if (!this._terminal.buffer.lines.get(row)[this._terminal.buffer.x - 1][Buffer_1.CHAR_DATA_WIDTH_INDEX]) {\n                        if (this._terminal.buffer.lines.get(row)[this._terminal.buffer.x - 2]) {\n                            this._terminal.buffer.lines.get(row)[this._terminal.buffer.x - 2][Buffer_1.CHAR_DATA_CHAR_INDEX] += char;\n                            this._terminal.buffer.lines.get(row)[this._terminal.buffer.x - 2][3] = char.charCodeAt(0);\n                        }\n                    }\n                    else {\n                        this._terminal.buffer.lines.get(row)[this._terminal.buffer.x - 1][Buffer_1.CHAR_DATA_CHAR_INDEX] += char;\n                        this._terminal.buffer.lines.get(row)[this._terminal.buffer.x - 1][3] = char.charCodeAt(0);\n                    }\n                    this._terminal.updateRange(this._terminal.buffer.y);\n                }\n                return;\n            }\n            if (this._terminal.buffer.x + ch_width - 1 >= this._terminal.cols) {\n                if (this._terminal.wraparoundMode) {\n                    this._terminal.buffer.x = 0;\n                    this._terminal.buffer.y++;\n                    if (this._terminal.buffer.y > this._terminal.buffer.scrollBottom) {\n                        this._terminal.buffer.y--;\n                        this._terminal.scroll(true);\n                    }\n                    else {\n                        this._terminal.buffer.lines.get(this._terminal.buffer.y).isWrapped = true;\n                    }\n                }\n                else {\n                    if (ch_width === 2)\n                        return;\n                }\n            }\n            row = this._terminal.buffer.y + this._terminal.buffer.ybase;\n            if (this._terminal.insertMode) {\n                for (var moves = 0; moves < ch_width; ++moves) {\n                    var removed = this._terminal.buffer.lines.get(this._terminal.buffer.y + this._terminal.buffer.ybase).pop();\n                    if (removed[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 0\n                        && this._terminal.buffer.lines.get(row)[this._terminal.cols - 2]\n                        && this._terminal.buffer.lines.get(row)[this._terminal.cols - 2][Buffer_1.CHAR_DATA_WIDTH_INDEX] === 2) {\n                        this._terminal.buffer.lines.get(row)[this._terminal.cols - 2] = [this._terminal.curAttr, ' ', 1, ' '.charCodeAt(0)];\n                    }\n                    this._terminal.buffer.lines.get(row).splice(this._terminal.buffer.x, 0, [this._terminal.curAttr, ' ', 1, ' '.charCodeAt(0)]);\n                }\n            }\n            this._terminal.buffer.lines.get(row)[this._terminal.buffer.x] = [this._terminal.curAttr, char, ch_width, char.charCodeAt(0)];\n            this._terminal.buffer.x++;\n            this._terminal.updateRange(this._terminal.buffer.y);\n            if (ch_width === 2) {\n                this._terminal.buffer.lines.get(row)[this._terminal.buffer.x] = [this._terminal.curAttr, '', 0, undefined];\n                this._terminal.buffer.x++;\n            }\n        }\n    };\n    InputHandler.prototype.bell = function () {\n        this._terminal.bell();\n    };\n    InputHandler.prototype.lineFeed = function () {\n        if (this._terminal.convertEol) {\n            this._terminal.buffer.x = 0;\n        }\n        this._terminal.buffer.y++;\n        if (this._terminal.buffer.y > this._terminal.buffer.scrollBottom) {\n            this._terminal.buffer.y--;\n            this._terminal.scroll();\n        }\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x--;\n        }\n        this._terminal.emit('linefeed');\n    };\n    InputHandler.prototype.carriageReturn = function () {\n        this._terminal.buffer.x = 0;\n    };\n    InputHandler.prototype.backspace = function () {\n        if (this._terminal.buffer.x > 0) {\n            this._terminal.buffer.x--;\n        }\n    };\n    InputHandler.prototype.tab = function () {\n        this._terminal.buffer.x = this._terminal.buffer.nextStop();\n    };\n    InputHandler.prototype.shiftOut = function () {\n        this._terminal.setgLevel(1);\n    };\n    InputHandler.prototype.shiftIn = function () {\n        this._terminal.setgLevel(0);\n    };\n    InputHandler.prototype.insertChars = function (params) {\n        var param = params[0];\n        if (param < 1)\n            param = 1;\n        var row = this._terminal.buffer.y + this._terminal.buffer.ybase;\n        var j = this._terminal.buffer.x;\n        var ch = [this._terminal.eraseAttr(), ' ', 1, 32];\n        while (param-- && j < this._terminal.cols) {\n            this._terminal.buffer.lines.get(row).splice(j++, 0, ch);\n            this._terminal.buffer.lines.get(row).pop();\n        }\n    };\n    InputHandler.prototype.cursorUp = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y -= param;\n        if (this._terminal.buffer.y < 0) {\n            this._terminal.buffer.y = 0;\n        }\n    };\n    InputHandler.prototype.cursorDown = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y += param;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x--;\n        }\n    };\n    InputHandler.prototype.cursorForward = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x += param;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.cursorBackward = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x--;\n        }\n        this._terminal.buffer.x -= param;\n        if (this._terminal.buffer.x < 0) {\n            this._terminal.buffer.x = 0;\n        }\n    };\n    InputHandler.prototype.cursorNextLine = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y += param;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        this._terminal.buffer.x = 0;\n    };\n    InputHandler.prototype.cursorPrecedingLine = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y -= param;\n        if (this._terminal.buffer.y < 0) {\n            this._terminal.buffer.y = 0;\n        }\n        this._terminal.buffer.x = 0;\n    };\n    InputHandler.prototype.cursorCharAbsolute = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x = param - 1;\n    };\n    InputHandler.prototype.cursorPosition = function (params) {\n        var col;\n        var row = params[0] - 1;\n        if (params.length >= 2) {\n            col = params[1] - 1;\n        }\n        else {\n            col = 0;\n        }\n        if (row < 0) {\n            row = 0;\n        }\n        else if (row >= this._terminal.rows) {\n            row = this._terminal.rows - 1;\n        }\n        if (col < 0) {\n            col = 0;\n        }\n        else if (col >= this._terminal.cols) {\n            col = this._terminal.cols - 1;\n        }\n        this._terminal.buffer.x = col;\n        this._terminal.buffer.y = row;\n    };\n    InputHandler.prototype.cursorForwardTab = function (params) {\n        var param = params[0] || 1;\n        while (param--) {\n            this._terminal.buffer.x = this._terminal.buffer.nextStop();\n        }\n    };\n    InputHandler.prototype.eraseInDisplay = function (params) {\n        var j;\n        switch (params[0]) {\n            case 0:\n                this._terminal.eraseRight(this._terminal.buffer.x, this._terminal.buffer.y);\n                j = this._terminal.buffer.y + 1;\n                for (; j < this._terminal.rows; j++) {\n                    this._terminal.eraseLine(j);\n                }\n                break;\n            case 1:\n                this._terminal.eraseLeft(this._terminal.buffer.x, this._terminal.buffer.y);\n                j = this._terminal.buffer.y;\n                while (j--) {\n                    this._terminal.eraseLine(j);\n                }\n                break;\n            case 2:\n                j = this._terminal.rows;\n                while (j--)\n                    this._terminal.eraseLine(j);\n                break;\n            case 3:\n                var scrollBackSize = this._terminal.buffer.lines.length - this._terminal.rows;\n                if (scrollBackSize > 0) {\n                    this._terminal.buffer.lines.trimStart(scrollBackSize);\n                    this._terminal.buffer.ybase = Math.max(this._terminal.buffer.ybase - scrollBackSize, 0);\n                    this._terminal.buffer.ydisp = Math.max(this._terminal.buffer.ydisp - scrollBackSize, 0);\n                    this._terminal.emit('scroll', 0);\n                }\n                break;\n        }\n    };\n    InputHandler.prototype.eraseInLine = function (params) {\n        switch (params[0]) {\n            case 0:\n                this._terminal.eraseRight(this._terminal.buffer.x, this._terminal.buffer.y);\n                break;\n            case 1:\n                this._terminal.eraseLeft(this._terminal.buffer.x, this._terminal.buffer.y);\n                break;\n            case 2:\n                this._terminal.eraseLine(this._terminal.buffer.y);\n                break;\n        }\n    };\n    InputHandler.prototype.insertLines = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        var row = this._terminal.buffer.y + this._terminal.buffer.ybase;\n        var scrollBottomRowsOffset = this._terminal.rows - 1 - this._terminal.buffer.scrollBottom;\n        var scrollBottomAbsolute = this._terminal.rows - 1 + this._terminal.buffer.ybase - scrollBottomRowsOffset + 1;\n        while (param--) {\n            this._terminal.buffer.lines.splice(scrollBottomAbsolute - 1, 1);\n            this._terminal.buffer.lines.splice(row, 0, this._terminal.blankLine(true));\n        }\n        this._terminal.updateRange(this._terminal.buffer.y);\n        this._terminal.updateRange(this._terminal.buffer.scrollBottom);\n    };\n    InputHandler.prototype.deleteLines = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        var row = this._terminal.buffer.y + this._terminal.buffer.ybase;\n        var j;\n        j = this._terminal.rows - 1 - this._terminal.buffer.scrollBottom;\n        j = this._terminal.rows - 1 + this._terminal.buffer.ybase - j;\n        while (param--) {\n            this._terminal.buffer.lines.splice(row, 1);\n            this._terminal.buffer.lines.splice(j, 0, this._terminal.blankLine(true));\n        }\n        this._terminal.updateRange(this._terminal.buffer.y);\n        this._terminal.updateRange(this._terminal.buffer.scrollBottom);\n    };\n    InputHandler.prototype.deleteChars = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        var row = this._terminal.buffer.y + this._terminal.buffer.ybase;\n        var ch = [this._terminal.eraseAttr(), ' ', 1, 32];\n        while (param--) {\n            this._terminal.buffer.lines.get(row).splice(this._terminal.buffer.x, 1);\n            this._terminal.buffer.lines.get(row).push(ch);\n        }\n        this._terminal.updateRange(this._terminal.buffer.y);\n    };\n    InputHandler.prototype.scrollUp = function (params) {\n        var param = params[0] || 1;\n        while (param--) {\n            this._terminal.buffer.lines.splice(this._terminal.buffer.ybase + this._terminal.buffer.scrollTop, 1);\n            this._terminal.buffer.lines.splice(this._terminal.buffer.ybase + this._terminal.buffer.scrollBottom, 0, this._terminal.blankLine());\n        }\n        this._terminal.updateRange(this._terminal.buffer.scrollTop);\n        this._terminal.updateRange(this._terminal.buffer.scrollBottom);\n    };\n    InputHandler.prototype.scrollDown = function (params) {\n        var param = params[0] || 1;\n        while (param--) {\n            this._terminal.buffer.lines.splice(this._terminal.buffer.ybase + this._terminal.buffer.scrollBottom, 1);\n            this._terminal.buffer.lines.splice(this._terminal.buffer.ybase + this._terminal.buffer.scrollTop, 0, this._terminal.blankLine());\n        }\n        this._terminal.updateRange(this._terminal.buffer.scrollTop);\n        this._terminal.updateRange(this._terminal.buffer.scrollBottom);\n    };\n    InputHandler.prototype.eraseChars = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        var row = this._terminal.buffer.y + this._terminal.buffer.ybase;\n        var j = this._terminal.buffer.x;\n        var ch = [this._terminal.eraseAttr(), ' ', 1, 32];\n        while (param-- && j < this._terminal.cols) {\n            this._terminal.buffer.lines.get(row)[j++] = ch;\n        }\n    };\n    InputHandler.prototype.cursorBackwardTab = function (params) {\n        var param = params[0] || 1;\n        while (param--) {\n            this._terminal.buffer.x = this._terminal.buffer.prevStop();\n        }\n    };\n    InputHandler.prototype.charPosAbsolute = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x = param - 1;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.HPositionRelative = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x += param;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.repeatPrecedingCharacter = function (params) {\n        var param = params[0] || 1;\n        var line = this._terminal.buffer.lines.get(this._terminal.buffer.ybase + this._terminal.buffer.y);\n        var ch = line[this._terminal.buffer.x - 1] || [this._terminal.defAttr, ' ', 1, 32];\n        while (param--) {\n            line[this._terminal.buffer.x++] = ch;\n        }\n    };\n    InputHandler.prototype.sendDeviceAttributes = function (params) {\n        if (params[0] > 0) {\n            return;\n        }\n        if (!this._terminal.prefix) {\n            if (this._terminal.is('xterm') || this._terminal.is('rxvt-unicode') || this._terminal.is('screen')) {\n                this._terminal.send(EscapeSequences_1.C0.ESC + '[?1;2c');\n            }\n            else if (this._terminal.is('linux')) {\n                this._terminal.send(EscapeSequences_1.C0.ESC + '[?6c');\n            }\n        }\n        else if (this._terminal.prefix === '>') {\n            if (this._terminal.is('xterm')) {\n                this._terminal.send(EscapeSequences_1.C0.ESC + '[>0;276;0c');\n            }\n            else if (this._terminal.is('rxvt-unicode')) {\n                this._terminal.send(EscapeSequences_1.C0.ESC + '[>85;95;0c');\n            }\n            else if (this._terminal.is('linux')) {\n                this._terminal.send(params[0] + 'c');\n            }\n            else if (this._terminal.is('screen')) {\n                this._terminal.send(EscapeSequences_1.C0.ESC + '[>83;40003;0c');\n            }\n        }\n    };\n    InputHandler.prototype.linePosAbsolute = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y = param - 1;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n    };\n    InputHandler.prototype.VPositionRelative = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y += param;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x--;\n        }\n    };\n    InputHandler.prototype.HVPosition = function (params) {\n        if (params[0] < 1)\n            params[0] = 1;\n        if (params[1] < 1)\n            params[1] = 1;\n        this._terminal.buffer.y = params[0] - 1;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        this._terminal.buffer.x = params[1] - 1;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.tabClear = function (params) {\n        var param = params[0];\n        if (param <= 0) {\n            delete this._terminal.buffer.tabs[this._terminal.buffer.x];\n        }\n        else if (param === 3) {\n            this._terminal.buffer.tabs = {};\n        }\n    };\n    InputHandler.prototype.setMode = function (params) {\n        if (params.length > 1) {\n            for (var i = 0; i < params.length; i++) {\n                this.setMode([params[i]]);\n            }\n            return;\n        }\n        if (!this._terminal.prefix) {\n            switch (params[0]) {\n                case 4:\n                    this._terminal.insertMode = true;\n                    break;\n                case 20:\n                    break;\n            }\n        }\n        else if (this._terminal.prefix === '?') {\n            switch (params[0]) {\n                case 1:\n                    this._terminal.applicationCursor = true;\n                    break;\n                case 2:\n                    this._terminal.setgCharset(0, Charsets_1.DEFAULT_CHARSET);\n                    this._terminal.setgCharset(1, Charsets_1.DEFAULT_CHARSET);\n                    this._terminal.setgCharset(2, Charsets_1.DEFAULT_CHARSET);\n                    this._terminal.setgCharset(3, Charsets_1.DEFAULT_CHARSET);\n                    break;\n                case 3:\n                    this._terminal.savedCols = this._terminal.cols;\n                    this._terminal.resize(132, this._terminal.rows);\n                    break;\n                case 6:\n                    this._terminal.originMode = true;\n                    break;\n                case 7:\n                    this._terminal.wraparoundMode = true;\n                    break;\n                case 12:\n                    break;\n                case 66:\n                    this._terminal.log('Serial port requested application keypad.');\n                    this._terminal.applicationKeypad = true;\n                    this._terminal.viewport.syncScrollArea();\n                    break;\n                case 9:\n                case 1000:\n                case 1002:\n                case 1003:\n                    this._terminal.x10Mouse = params[0] === 9;\n                    this._terminal.vt200Mouse = params[0] === 1000;\n                    this._terminal.normalMouse = params[0] > 1000;\n                    this._terminal.mouseEvents = true;\n                    this._terminal.element.classList.add('enable-mouse-events');\n                    this._terminal.selectionManager.disable();\n                    this._terminal.log('Binding to mouse events.');\n                    break;\n                case 1004:\n                    this._terminal.sendFocus = true;\n                    break;\n                case 1005:\n                    this._terminal.utfMouse = true;\n                    break;\n                case 1006:\n                    this._terminal.sgrMouse = true;\n                    break;\n                case 1015:\n                    this._terminal.urxvtMouse = true;\n                    break;\n                case 25:\n                    this._terminal.cursorHidden = false;\n                    break;\n                case 1049:\n                case 47:\n                case 1047:\n                    this._terminal.buffers.activateAltBuffer();\n                    this._terminal.selectionManager.setBuffer(this._terminal.buffer);\n                    this._terminal.viewport.syncScrollArea();\n                    this._terminal.showCursor();\n                    break;\n                case 2004:\n                    this._terminal.bracketedPasteMode = true;\n                    break;\n            }\n        }\n    };\n    InputHandler.prototype.resetMode = function (params) {\n        if (params.length > 1) {\n            for (var i = 0; i < params.length; i++) {\n                this.resetMode([params[i]]);\n            }\n            return;\n        }\n        if (!this._terminal.prefix) {\n            switch (params[0]) {\n                case 4:\n                    this._terminal.insertMode = false;\n                    break;\n                case 20:\n                    break;\n            }\n        }\n        else if (this._terminal.prefix === '?') {\n            switch (params[0]) {\n                case 1:\n                    this._terminal.applicationCursor = false;\n                    break;\n                case 3:\n                    if (this._terminal.cols === 132 && this._terminal.savedCols) {\n                        this._terminal.resize(this._terminal.savedCols, this._terminal.rows);\n                    }\n                    delete this._terminal.savedCols;\n                    break;\n                case 6:\n                    this._terminal.originMode = false;\n                    break;\n                case 7:\n                    this._terminal.wraparoundMode = false;\n                    break;\n                case 12:\n                    break;\n                case 66:\n                    this._terminal.log('Switching back to normal keypad.');\n                    this._terminal.applicationKeypad = false;\n                    this._terminal.viewport.syncScrollArea();\n                    break;\n                case 9:\n                case 1000:\n                case 1002:\n                case 1003:\n                    this._terminal.x10Mouse = false;\n                    this._terminal.vt200Mouse = false;\n                    this._terminal.normalMouse = false;\n                    this._terminal.mouseEvents = false;\n                    this._terminal.element.classList.remove('enable-mouse-events');\n                    this._terminal.selectionManager.enable();\n                    break;\n                case 1004:\n                    this._terminal.sendFocus = false;\n                    break;\n                case 1005:\n                    this._terminal.utfMouse = false;\n                    break;\n                case 1006:\n                    this._terminal.sgrMouse = false;\n                    break;\n                case 1015:\n                    this._terminal.urxvtMouse = false;\n                    break;\n                case 25:\n                    this._terminal.cursorHidden = true;\n                    break;\n                case 1049:\n                case 47:\n                case 1047:\n                    this._terminal.buffers.activateNormalBuffer();\n                    this._terminal.selectionManager.setBuffer(this._terminal.buffer);\n                    this._terminal.refresh(0, this._terminal.rows - 1);\n                    this._terminal.viewport.syncScrollArea();\n                    this._terminal.showCursor();\n                    break;\n                case 2004:\n                    this._terminal.bracketedPasteMode = false;\n                    break;\n            }\n        }\n    };\n    InputHandler.prototype.charAttributes = function (params) {\n        if (params.length === 1 && params[0] === 0) {\n            this._terminal.curAttr = this._terminal.defAttr;\n            return;\n        }\n        var l = params.length;\n        var flags = this._terminal.curAttr >> 18;\n        var fg = (this._terminal.curAttr >> 9) & 0x1ff;\n        var bg = this._terminal.curAttr & 0x1ff;\n        var p;\n        for (var i = 0; i < l; i++) {\n            p = params[i];\n            if (p >= 30 && p <= 37) {\n                fg = p - 30;\n            }\n            else if (p >= 40 && p <= 47) {\n                bg = p - 40;\n            }\n            else if (p >= 90 && p <= 97) {\n                p += 8;\n                fg = p - 90;\n            }\n            else if (p >= 100 && p <= 107) {\n                p += 8;\n                bg = p - 100;\n            }\n            else if (p === 0) {\n                flags = this._terminal.defAttr >> 18;\n                fg = (this._terminal.defAttr >> 9) & 0x1ff;\n                bg = this._terminal.defAttr & 0x1ff;\n            }\n            else if (p === 1) {\n                flags |= Types_1.FLAGS.BOLD;\n            }\n            else if (p === 4) {\n                flags |= Types_1.FLAGS.UNDERLINE;\n            }\n            else if (p === 5) {\n                flags |= Types_1.FLAGS.BLINK;\n            }\n            else if (p === 7) {\n                flags |= Types_1.FLAGS.INVERSE;\n            }\n            else if (p === 8) {\n                flags |= Types_1.FLAGS.INVISIBLE;\n            }\n            else if (p === 2) {\n                flags |= Types_1.FLAGS.DIM;\n            }\n            else if (p === 22) {\n                flags &= ~Types_1.FLAGS.BOLD;\n                flags &= ~Types_1.FLAGS.DIM;\n            }\n            else if (p === 24) {\n                flags &= ~Types_1.FLAGS.UNDERLINE;\n            }\n            else if (p === 25) {\n                flags &= ~Types_1.FLAGS.BLINK;\n            }\n            else if (p === 27) {\n                flags &= ~Types_1.FLAGS.INVERSE;\n            }\n            else if (p === 28) {\n                flags &= ~Types_1.FLAGS.INVISIBLE;\n            }\n            else if (p === 39) {\n                fg = (this._terminal.defAttr >> 9) & 0x1ff;\n            }\n            else if (p === 49) {\n                bg = this._terminal.defAttr & 0x1ff;\n            }\n            else if (p === 38) {\n                if (params[i + 1] === 2) {\n                    i += 2;\n                    fg = this._terminal.matchColor(params[i] & 0xff, params[i + 1] & 0xff, params[i + 2] & 0xff);\n                    if (fg === -1)\n                        fg = 0x1ff;\n                    i += 2;\n                }\n                else if (params[i + 1] === 5) {\n                    i += 2;\n                    p = params[i] & 0xff;\n                    fg = p;\n                }\n            }\n            else if (p === 48) {\n                if (params[i + 1] === 2) {\n                    i += 2;\n                    bg = this._terminal.matchColor(params[i] & 0xff, params[i + 1] & 0xff, params[i + 2] & 0xff);\n                    if (bg === -1)\n                        bg = 0x1ff;\n                    i += 2;\n                }\n                else if (params[i + 1] === 5) {\n                    i += 2;\n                    p = params[i] & 0xff;\n                    bg = p;\n                }\n            }\n            else if (p === 100) {\n                fg = (this._terminal.defAttr >> 9) & 0x1ff;\n                bg = this._terminal.defAttr & 0x1ff;\n            }\n            else {\n                this._terminal.error('Unknown SGR attribute: %d.', p);\n            }\n        }\n        this._terminal.curAttr = (flags << 18) | (fg << 9) | bg;\n    };\n    InputHandler.prototype.deviceStatus = function (params) {\n        if (!this._terminal.prefix) {\n            switch (params[0]) {\n                case 5:\n                    this._terminal.send(EscapeSequences_1.C0.ESC + '[0n');\n                    break;\n                case 6:\n                    this._terminal.send(EscapeSequences_1.C0.ESC + '['\n                        + (this._terminal.buffer.y + 1)\n                        + ';'\n                        + (this._terminal.buffer.x + 1)\n                        + 'R');\n                    break;\n            }\n        }\n        else if (this._terminal.prefix === '?') {\n            switch (params[0]) {\n                case 6:\n                    this._terminal.send(EscapeSequences_1.C0.ESC + '[?'\n                        + (this._terminal.buffer.y + 1)\n                        + ';'\n                        + (this._terminal.buffer.x + 1)\n                        + 'R');\n                    break;\n                case 15:\n                    break;\n                case 25:\n                    break;\n                case 26:\n                    break;\n                case 53:\n                    break;\n            }\n        }\n    };\n    InputHandler.prototype.softReset = function (params) {\n        this._terminal.cursorHidden = false;\n        this._terminal.insertMode = false;\n        this._terminal.originMode = false;\n        this._terminal.wraparoundMode = true;\n        this._terminal.applicationKeypad = false;\n        this._terminal.viewport.syncScrollArea();\n        this._terminal.applicationCursor = false;\n        this._terminal.buffer.scrollTop = 0;\n        this._terminal.buffer.scrollBottom = this._terminal.rows - 1;\n        this._terminal.curAttr = this._terminal.defAttr;\n        this._terminal.buffer.x = this._terminal.buffer.y = 0;\n        this._terminal.charset = null;\n        this._terminal.glevel = 0;\n        this._terminal.charsets = [null];\n    };\n    InputHandler.prototype.setCursorStyle = function (params) {\n        var param = params[0] < 1 ? 1 : params[0];\n        switch (param) {\n            case 1:\n            case 2:\n                this._terminal.setOption('cursorStyle', 'block');\n                break;\n            case 3:\n            case 4:\n                this._terminal.setOption('cursorStyle', 'underline');\n                break;\n            case 5:\n            case 6:\n                this._terminal.setOption('cursorStyle', 'bar');\n                break;\n        }\n        var isBlinking = param % 2 === 1;\n        this._terminal.setOption('cursorBlink', isBlinking);\n    };\n    InputHandler.prototype.setScrollRegion = function (params) {\n        if (this._terminal.prefix)\n            return;\n        this._terminal.buffer.scrollTop = (params[0] || 1) - 1;\n        this._terminal.buffer.scrollBottom = (params[1] && params[1] <= this._terminal.rows ? params[1] : this._terminal.rows) - 1;\n        this._terminal.buffer.x = 0;\n        this._terminal.buffer.y = 0;\n    };\n    InputHandler.prototype.saveCursor = function (params) {\n        this._terminal.buffer.savedX = this._terminal.buffer.x;\n        this._terminal.buffer.savedY = this._terminal.buffer.y;\n    };\n    InputHandler.prototype.restoreCursor = function (params) {\n        this._terminal.buffer.x = this._terminal.buffer.savedX || 0;\n        this._terminal.buffer.y = this._terminal.buffer.savedY || 0;\n    };\n    return InputHandler;\n}());\nexports.InputHandler = InputHandler;\n\n\n\n},{\"./Buffer\":1,\"./CharWidth\":3,\"./Charsets\":4,\"./EscapeSequences\":6,\"./renderer/Types\":27}],9:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Types_1 = require(\"./Types\");\nvar MouseZoneManager_1 = require(\"./input/MouseZoneManager\");\nvar EventEmitter_1 = require(\"./EventEmitter\");\nvar protocolClause = '(https?:\\\\/\\\\/)';\nvar domainCharacterSet = '[\\\\da-z\\\\.-]+';\nvar negatedDomainCharacterSet = '[^\\\\da-z\\\\.-]+';\nvar domainBodyClause = '(' + domainCharacterSet + ')';\nvar tldClause = '([a-z\\\\.]{2,6})';\nvar ipClause = '((\\\\d{1,3}\\\\.){3}\\\\d{1,3})';\nvar localHostClause = '(localhost)';\nvar portClause = '(:\\\\d{1,5})';\nvar hostClause = '((' + domainBodyClause + '\\\\.' + tldClause + ')|' + ipClause + '|' + localHostClause + ')' + portClause + '?';\nvar pathClause = '(\\\\/[\\\\/\\\\w\\\\.\\\\-%~]*)*';\nvar queryStringHashFragmentCharacterSet = '[0-9\\\\w\\\\[\\\\]\\\\(\\\\)\\\\/\\\\?\\\\!#@$%&\\'*+,:;~\\\\=\\\\.\\\\-]*';\nvar queryStringClause = '(\\\\?' + queryStringHashFragmentCharacterSet + ')?';\nvar hashFragmentClause = '(#' + queryStringHashFragmentCharacterSet + ')?';\nvar negatedPathCharacterSet = '[^\\\\/\\\\w\\\\.\\\\-%]+';\nvar bodyClause = hostClause + pathClause + queryStringClause + hashFragmentClause;\nvar start = '(?:^|' + negatedDomainCharacterSet + ')(';\nvar end = ')($|' + negatedPathCharacterSet + ')';\nvar strictUrlRegex = new RegExp(start + protocolClause + bodyClause + end);\nvar HYPERTEXT_LINK_MATCHER_ID = 0;\nvar Linkifier = (function (_super) {\n    __extends(Linkifier, _super);\n    function Linkifier(_terminal) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._linkMatchers = [];\n        _this._nextLinkMatcherId = HYPERTEXT_LINK_MATCHER_ID;\n        _this._rowsToLinkify = {\n            start: null,\n            end: null\n        };\n        _this.registerLinkMatcher(strictUrlRegex, null, { matchIndex: 1 });\n        return _this;\n    }\n    Linkifier.prototype.attachToDom = function (mouseZoneManager) {\n        this._mouseZoneManager = mouseZoneManager;\n    };\n    Linkifier.prototype.linkifyRows = function (start, end) {\n        var _this = this;\n        if (!this._mouseZoneManager) {\n            return;\n        }\n        if (!this._rowsToLinkify.start) {\n            this._rowsToLinkify.start = start;\n            this._rowsToLinkify.end = end;\n        }\n        else {\n            this._rowsToLinkify.start = this._rowsToLinkify.start < start ? this._rowsToLinkify.start : start;\n            this._rowsToLinkify.end = this._rowsToLinkify.end > end ? this._rowsToLinkify.end : end;\n        }\n        this._mouseZoneManager.clearAll(start, end);\n        if (this._rowsTimeoutId) {\n            clearTimeout(this._rowsTimeoutId);\n        }\n        this._rowsTimeoutId = setTimeout(function () { return _this._linkifyRows(); }, Linkifier.TIME_BEFORE_LINKIFY);\n    };\n    Linkifier.prototype._linkifyRows = function () {\n        this._rowsTimeoutId = null;\n        for (var i = this._rowsToLinkify.start; i <= this._rowsToLinkify.end; i++) {\n            this._linkifyRow(i);\n        }\n        this._rowsToLinkify.start = null;\n        this._rowsToLinkify.end = null;\n    };\n    Linkifier.prototype.setHypertextLinkHandler = function (handler) {\n        this._linkMatchers[HYPERTEXT_LINK_MATCHER_ID].handler = handler;\n    };\n    Linkifier.prototype.setHypertextValidationCallback = function (callback) {\n        this._linkMatchers[HYPERTEXT_LINK_MATCHER_ID].validationCallback = callback;\n    };\n    Linkifier.prototype.registerLinkMatcher = function (regex, handler, options) {\n        if (options === void 0) { options = {}; }\n        if (this._nextLinkMatcherId !== HYPERTEXT_LINK_MATCHER_ID && !handler) {\n            throw new Error('handler must be defined');\n        }\n        var matcher = {\n            id: this._nextLinkMatcherId++,\n            regex: regex,\n            handler: handler,\n            matchIndex: options.matchIndex,\n            validationCallback: options.validationCallback,\n            hoverTooltipCallback: options.tooltipCallback,\n            hoverLeaveCallback: options.leaveCallback,\n            priority: options.priority || 0\n        };\n        this._addLinkMatcherToList(matcher);\n        return matcher.id;\n    };\n    Linkifier.prototype._addLinkMatcherToList = function (matcher) {\n        if (this._linkMatchers.length === 0) {\n            this._linkMatchers.push(matcher);\n            return;\n        }\n        for (var i = this._linkMatchers.length - 1; i >= 0; i--) {\n            if (matcher.priority <= this._linkMatchers[i].priority) {\n                this._linkMatchers.splice(i + 1, 0, matcher);\n                return;\n            }\n        }\n        this._linkMatchers.splice(0, 0, matcher);\n    };\n    Linkifier.prototype.deregisterLinkMatcher = function (matcherId) {\n        for (var i = 1; i < this._linkMatchers.length; i++) {\n            if (this._linkMatchers[i].id === matcherId) {\n                this._linkMatchers.splice(i, 1);\n                return true;\n            }\n        }\n        return false;\n    };\n    Linkifier.prototype._linkifyRow = function (rowIndex) {\n        var absoluteRowIndex = this._terminal.buffer.ydisp + rowIndex;\n        if (absoluteRowIndex >= this._terminal.buffer.lines.length) {\n            return;\n        }\n        var text = this._terminal.buffer.translateBufferLineToString(absoluteRowIndex, false);\n        for (var i = 0; i < this._linkMatchers.length; i++) {\n            this._doLinkifyRow(rowIndex, text, this._linkMatchers[i]);\n        }\n    };\n    Linkifier.prototype._doLinkifyRow = function (rowIndex, text, matcher, offset) {\n        var _this = this;\n        if (offset === void 0) { offset = 0; }\n        var result = [];\n        var isHttpLinkMatcher = matcher.id === HYPERTEXT_LINK_MATCHER_ID;\n        var match = text.match(matcher.regex);\n        if (!match || match.length === 0) {\n            return;\n        }\n        var uri = match[typeof matcher.matchIndex !== 'number' ? 0 : matcher.matchIndex];\n        var index = text.indexOf(uri);\n        if (matcher.validationCallback) {\n            matcher.validationCallback(uri, function (isValid) {\n                if (_this._rowsTimeoutId) {\n                    return;\n                }\n                if (isValid) {\n                    _this._addLink(offset + index, rowIndex, uri, matcher);\n                }\n            });\n        }\n        else {\n            this._addLink(offset + index, rowIndex, uri, matcher);\n        }\n        var remainingStartIndex = index + uri.length;\n        var remainingText = text.substr(remainingStartIndex);\n        if (remainingText.length > 0) {\n            this._doLinkifyRow(rowIndex, remainingText, matcher, offset + remainingStartIndex);\n        }\n    };\n    Linkifier.prototype._addLink = function (x, y, uri, matcher) {\n        var _this = this;\n        this._mouseZoneManager.add(new MouseZoneManager_1.MouseZone(x + 1, x + 1 + uri.length, y + 1, function (e) {\n            if (matcher.handler) {\n                return matcher.handler(e, uri);\n            }\n            window.open(uri, '_blank');\n        }, function (e) {\n            _this.emit(Types_1.LinkHoverEventTypes.HOVER, { x: x, y: y, length: uri.length });\n            _this._terminal.element.style.cursor = 'pointer';\n        }, function (e) {\n            _this.emit(Types_1.LinkHoverEventTypes.TOOLTIP, { x: x, y: y, length: uri.length });\n            if (matcher.hoverTooltipCallback) {\n                matcher.hoverTooltipCallback(e, uri);\n            }\n        }, function () {\n            _this.emit(Types_1.LinkHoverEventTypes.LEAVE, { x: x, y: y, length: uri.length });\n            _this._terminal.element.style.cursor = '';\n            if (matcher.hoverLeaveCallback) {\n                matcher.hoverLeaveCallback();\n            }\n        }));\n    };\n    Linkifier.TIME_BEFORE_LINKIFY = 200;\n    return Linkifier;\n}(EventEmitter_1.EventEmitter));\nexports.Linkifier = Linkifier;\n\n\n\n},{\"./EventEmitter\":7,\"./Types\":14,\"./input/MouseZoneManager\":17}],10:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EscapeSequences_1 = require(\"./EscapeSequences\");\nvar Charsets_1 = require(\"./Charsets\");\nvar normalStateHandler = {};\nnormalStateHandler[EscapeSequences_1.C0.BEL] = function (parser, handler) { return handler.bell(); };\nnormalStateHandler[EscapeSequences_1.C0.LF] = function (parser, handler) { return handler.lineFeed(); };\nnormalStateHandler[EscapeSequences_1.C0.VT] = normalStateHandler[EscapeSequences_1.C0.LF];\nnormalStateHandler[EscapeSequences_1.C0.FF] = normalStateHandler[EscapeSequences_1.C0.LF];\nnormalStateHandler[EscapeSequences_1.C0.CR] = function (parser, handler) { return handler.carriageReturn(); };\nnormalStateHandler[EscapeSequences_1.C0.BS] = function (parser, handler) { return handler.backspace(); };\nnormalStateHandler[EscapeSequences_1.C0.HT] = function (parser, handler) { return handler.tab(); };\nnormalStateHandler[EscapeSequences_1.C0.SO] = function (parser, handler) { return handler.shiftOut(); };\nnormalStateHandler[EscapeSequences_1.C0.SI] = function (parser, handler) { return handler.shiftIn(); };\nnormalStateHandler[EscapeSequences_1.C0.ESC] = function (parser, handler) { return parser.setState(ParserState.ESCAPED); };\nvar escapedStateHandler = {};\nescapedStateHandler['['] = function (parser, terminal) {\n    terminal.params = [];\n    terminal.currentParam = 0;\n    parser.setState(ParserState.CSI_PARAM);\n};\nescapedStateHandler[']'] = function (parser, terminal) {\n    terminal.params = [];\n    terminal.currentParam = 0;\n    parser.setState(ParserState.OSC);\n};\nescapedStateHandler['P'] = function (parser, terminal) {\n    terminal.params = [];\n    terminal.currentParam = 0;\n    parser.setState(ParserState.DCS);\n};\nescapedStateHandler['_'] = function (parser, terminal) {\n    parser.setState(ParserState.IGNORE);\n};\nescapedStateHandler['^'] = function (parser, terminal) {\n    parser.setState(ParserState.IGNORE);\n};\nescapedStateHandler['c'] = function (parser, terminal) {\n    terminal.reset();\n};\nescapedStateHandler['E'] = function (parser, terminal) {\n    terminal.buffer.x = 0;\n    terminal.index();\n    parser.setState(ParserState.NORMAL);\n};\nescapedStateHandler['D'] = function (parser, terminal) {\n    terminal.index();\n    parser.setState(ParserState.NORMAL);\n};\nescapedStateHandler['M'] = function (parser, terminal) {\n    terminal.reverseIndex();\n    parser.setState(ParserState.NORMAL);\n};\nescapedStateHandler['%'] = function (parser, terminal) {\n    terminal.setgLevel(0);\n    terminal.setgCharset(0, Charsets_1.DEFAULT_CHARSET);\n    parser.setState(ParserState.NORMAL);\n    parser.skipNextChar();\n};\nescapedStateHandler[EscapeSequences_1.C0.CAN] = function (parser) { return parser.setState(ParserState.NORMAL); };\nvar csiParamStateHandler = {};\ncsiParamStateHandler['?'] = function (parser) { return parser.setPrefix('?'); };\ncsiParamStateHandler['>'] = function (parser) { return parser.setPrefix('>'); };\ncsiParamStateHandler['!'] = function (parser) { return parser.setPrefix('!'); };\ncsiParamStateHandler['0'] = function (parser) { return parser.setParam(parser.getParam() * 10); };\ncsiParamStateHandler['1'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 1); };\ncsiParamStateHandler['2'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 2); };\ncsiParamStateHandler['3'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 3); };\ncsiParamStateHandler['4'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 4); };\ncsiParamStateHandler['5'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 5); };\ncsiParamStateHandler['6'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 6); };\ncsiParamStateHandler['7'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 7); };\ncsiParamStateHandler['8'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 8); };\ncsiParamStateHandler['9'] = function (parser) { return parser.setParam(parser.getParam() * 10 + 9); };\ncsiParamStateHandler['$'] = function (parser) { return parser.setPostfix('$'); };\ncsiParamStateHandler['\"'] = function (parser) { return parser.setPostfix('\"'); };\ncsiParamStateHandler[' '] = function (parser) { return parser.setPostfix(' '); };\ncsiParamStateHandler['\\''] = function (parser) { return parser.setPostfix('\\''); };\ncsiParamStateHandler[';'] = function (parser) { return parser.finalizeParam(); };\ncsiParamStateHandler[EscapeSequences_1.C0.CAN] = function (parser) { return parser.setState(ParserState.NORMAL); };\nvar csiStateHandler = {};\ncsiStateHandler['@'] = function (handler, params, prefix) { return handler.insertChars(params); };\ncsiStateHandler['A'] = function (handler, params, prefix) { return handler.cursorUp(params); };\ncsiStateHandler['B'] = function (handler, params, prefix) { return handler.cursorDown(params); };\ncsiStateHandler['C'] = function (handler, params, prefix) { return handler.cursorForward(params); };\ncsiStateHandler['D'] = function (handler, params, prefix) { return handler.cursorBackward(params); };\ncsiStateHandler['E'] = function (handler, params, prefix) { return handler.cursorNextLine(params); };\ncsiStateHandler['F'] = function (handler, params, prefix) { return handler.cursorPrecedingLine(params); };\ncsiStateHandler['G'] = function (handler, params, prefix) { return handler.cursorCharAbsolute(params); };\ncsiStateHandler['H'] = function (handler, params, prefix) { return handler.cursorPosition(params); };\ncsiStateHandler['I'] = function (handler, params, prefix) { return handler.cursorForwardTab(params); };\ncsiStateHandler['J'] = function (handler, params, prefix) { return handler.eraseInDisplay(params); };\ncsiStateHandler['K'] = function (handler, params, prefix) { return handler.eraseInLine(params); };\ncsiStateHandler['L'] = function (handler, params, prefix) { return handler.insertLines(params); };\ncsiStateHandler['M'] = function (handler, params, prefix) { return handler.deleteLines(params); };\ncsiStateHandler['P'] = function (handler, params, prefix) { return handler.deleteChars(params); };\ncsiStateHandler['S'] = function (handler, params, prefix) { return handler.scrollUp(params); };\ncsiStateHandler['T'] = function (handler, params, prefix) {\n    if (params.length < 2 && !prefix) {\n        handler.scrollDown(params);\n    }\n};\ncsiStateHandler['X'] = function (handler, params, prefix) { return handler.eraseChars(params); };\ncsiStateHandler['Z'] = function (handler, params, prefix) { return handler.cursorBackwardTab(params); };\ncsiStateHandler['`'] = function (handler, params, prefix) { return handler.charPosAbsolute(params); };\ncsiStateHandler['a'] = function (handler, params, prefix) { return handler.HPositionRelative(params); };\ncsiStateHandler['b'] = function (handler, params, prefix) { return handler.repeatPrecedingCharacter(params); };\ncsiStateHandler['c'] = function (handler, params, prefix) { return handler.sendDeviceAttributes(params); };\ncsiStateHandler['d'] = function (handler, params, prefix) { return handler.linePosAbsolute(params); };\ncsiStateHandler['e'] = function (handler, params, prefix) { return handler.VPositionRelative(params); };\ncsiStateHandler['f'] = function (handler, params, prefix) { return handler.HVPosition(params); };\ncsiStateHandler['g'] = function (handler, params, prefix) { return handler.tabClear(params); };\ncsiStateHandler['h'] = function (handler, params, prefix) { return handler.setMode(params); };\ncsiStateHandler['l'] = function (handler, params, prefix) { return handler.resetMode(params); };\ncsiStateHandler['m'] = function (handler, params, prefix) { return handler.charAttributes(params); };\ncsiStateHandler['n'] = function (handler, params, prefix) { return handler.deviceStatus(params); };\ncsiStateHandler['p'] = function (handler, params, prefix) {\n    switch (prefix) {\n        case '!':\n            handler.softReset(params);\n            break;\n    }\n};\ncsiStateHandler['q'] = function (handler, params, prefix, postfix) {\n    if (postfix === ' ') {\n        handler.setCursorStyle(params);\n    }\n};\ncsiStateHandler['r'] = function (handler, params) { return handler.setScrollRegion(params); };\ncsiStateHandler['s'] = function (handler, params) { return handler.saveCursor(params); };\ncsiStateHandler['u'] = function (handler, params) { return handler.restoreCursor(params); };\ncsiStateHandler[EscapeSequences_1.C0.CAN] = function (handler, params, prefix, postfix, parser) { return parser.setState(ParserState.NORMAL); };\nvar ParserState;\n(function (ParserState) {\n    ParserState[ParserState[\"NORMAL\"] = 0] = \"NORMAL\";\n    ParserState[ParserState[\"ESCAPED\"] = 1] = \"ESCAPED\";\n    ParserState[ParserState[\"CSI_PARAM\"] = 2] = \"CSI_PARAM\";\n    ParserState[ParserState[\"CSI\"] = 3] = \"CSI\";\n    ParserState[ParserState[\"OSC\"] = 4] = \"OSC\";\n    ParserState[ParserState[\"CHARSET\"] = 5] = \"CHARSET\";\n    ParserState[ParserState[\"DCS\"] = 6] = \"DCS\";\n    ParserState[ParserState[\"IGNORE\"] = 7] = \"IGNORE\";\n})(ParserState = exports.ParserState || (exports.ParserState = {}));\nvar Parser = (function () {\n    function Parser(_inputHandler, _terminal) {\n        this._inputHandler = _inputHandler;\n        this._terminal = _terminal;\n        this._state = ParserState.NORMAL;\n    }\n    Parser.prototype.parse = function (data) {\n        var l = data.length;\n        var j;\n        var cs;\n        var ch;\n        var code;\n        var low;\n        var cursorStartX = this._terminal.buffer.x;\n        var cursorStartY = this._terminal.buffer.y;\n        if (this._terminal.debug) {\n            this._terminal.log('data: ' + data);\n        }\n        this._position = 0;\n        if (this._terminal.surrogate_high) {\n            data = this._terminal.surrogate_high + data;\n            this._terminal.surrogate_high = '';\n        }\n        for (; this._position < l; this._position++) {\n            ch = data[this._position];\n            code = data.charCodeAt(this._position);\n            if (0xD800 <= code && code <= 0xDBFF) {\n                low = data.charCodeAt(this._position + 1);\n                if (isNaN(low)) {\n                    this._terminal.surrogate_high = ch;\n                    continue;\n                }\n                code = ((code - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000;\n                ch += data.charAt(this._position + 1);\n            }\n            if (0xDC00 <= code && code <= 0xDFFF)\n                continue;\n            switch (this._state) {\n                case ParserState.NORMAL:\n                    if (ch in normalStateHandler) {\n                        normalStateHandler[ch](this, this._inputHandler);\n                    }\n                    else {\n                        this._inputHandler.addChar(ch, code);\n                    }\n                    break;\n                case ParserState.ESCAPED:\n                    if (ch in escapedStateHandler) {\n                        escapedStateHandler[ch](this, this._terminal);\n                        break;\n                    }\n                    switch (ch) {\n                        case '(':\n                        case ')':\n                        case '*':\n                        case '+':\n                        case '-':\n                        case '.':\n                            switch (ch) {\n                                case '(':\n                                    this._terminal.gcharset = 0;\n                                    break;\n                                case ')':\n                                    this._terminal.gcharset = 1;\n                                    break;\n                                case '*':\n                                    this._terminal.gcharset = 2;\n                                    break;\n                                case '+':\n                                    this._terminal.gcharset = 3;\n                                    break;\n                                case '-':\n                                    this._terminal.gcharset = 1;\n                                    break;\n                                case '.':\n                                    this._terminal.gcharset = 2;\n                                    break;\n                            }\n                            this._state = ParserState.CHARSET;\n                            break;\n                        case '/':\n                            this._terminal.gcharset = 3;\n                            this._state = ParserState.CHARSET;\n                            this._position--;\n                            break;\n                        case 'N':\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case 'O':\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case 'n':\n                            this._terminal.setgLevel(2);\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case 'o':\n                            this._terminal.setgLevel(3);\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '|':\n                            this._terminal.setgLevel(3);\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '}':\n                            this._terminal.setgLevel(2);\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '~':\n                            this._terminal.setgLevel(1);\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '7':\n                            this._inputHandler.saveCursor();\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '8':\n                            this._inputHandler.restoreCursor();\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '#':\n                            this._state = ParserState.NORMAL;\n                            this._position++;\n                            break;\n                        case 'H':\n                            this._terminal.tabSet();\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '=':\n                            this._terminal.log('Serial port requested application keypad.');\n                            this._terminal.applicationKeypad = true;\n                            if (this._terminal.viewport) {\n                                this._terminal.viewport.syncScrollArea();\n                            }\n                            this._state = ParserState.NORMAL;\n                            break;\n                        case '>':\n                            this._terminal.log('Switching back to normal keypad.');\n                            this._terminal.applicationKeypad = false;\n                            if (this._terminal.viewport) {\n                                this._terminal.viewport.syncScrollArea();\n                            }\n                            this._state = ParserState.NORMAL;\n                            break;\n                        default:\n                            this._state = ParserState.NORMAL;\n                            this._terminal.error('Unknown ESC control: %s.', ch);\n                            break;\n                    }\n                    break;\n                case ParserState.CHARSET:\n                    if (ch in Charsets_1.CHARSETS) {\n                        cs = Charsets_1.CHARSETS[ch];\n                        if (ch === '/') {\n                            this.skipNextChar();\n                        }\n                    }\n                    else {\n                        cs = Charsets_1.DEFAULT_CHARSET;\n                    }\n                    this._terminal.setgCharset(this._terminal.gcharset, cs);\n                    this._terminal.gcharset = null;\n                    this._state = ParserState.NORMAL;\n                    break;\n                case ParserState.OSC:\n                    if (ch === EscapeSequences_1.C0.ESC || ch === EscapeSequences_1.C0.BEL) {\n                        if (ch === EscapeSequences_1.C0.ESC)\n                            this._position++;\n                        this._terminal.params.push(this._terminal.currentParam);\n                        switch (this._terminal.params[0]) {\n                            case 0:\n                            case 1:\n                            case 2:\n                                if (this._terminal.params[1]) {\n                                    this._terminal.title = this._terminal.params[1];\n                                    this._terminal.handleTitle(this._terminal.title);\n                                }\n                                break;\n                            case 3:\n                                break;\n                            case 4:\n                            case 5:\n                                break;\n                            case 10:\n                            case 11:\n                            case 12:\n                            case 13:\n                            case 14:\n                            case 15:\n                            case 16:\n                            case 17:\n                            case 18:\n                            case 19:\n                                break;\n                            case 46:\n                                break;\n                            case 50:\n                                break;\n                            case 51:\n                                break;\n                            case 52:\n                                break;\n                            case 104:\n                            case 105:\n                            case 110:\n                            case 111:\n                            case 112:\n                            case 113:\n                            case 114:\n                            case 115:\n                            case 116:\n                            case 117:\n                            case 118:\n                                break;\n                        }\n                        this._terminal.params = [];\n                        this._terminal.currentParam = 0;\n                        this._state = ParserState.NORMAL;\n                    }\n                    else {\n                        if (!this._terminal.params.length) {\n                            if (ch >= '0' && ch <= '9') {\n                                this._terminal.currentParam =\n                                    this._terminal.currentParam * 10 + ch.charCodeAt(0) - 48;\n                            }\n                            else if (ch === ';') {\n                                this._terminal.params.push(this._terminal.currentParam);\n                                this._terminal.currentParam = '';\n                            }\n                        }\n                        else {\n                            this._terminal.currentParam += ch;\n                        }\n                    }\n                    break;\n                case ParserState.CSI_PARAM:\n                    if (ch in csiParamStateHandler) {\n                        csiParamStateHandler[ch](this);\n                        break;\n                    }\n                    this.finalizeParam();\n                    this._state = ParserState.CSI;\n                case ParserState.CSI:\n                    if (ch in csiStateHandler) {\n                        if (this._terminal.debug) {\n                            this._terminal.log(\"CSI \" + (this._terminal.prefix ? this._terminal.prefix : '') + \" \" + (this._terminal.params ? this._terminal.params.join(';') : '') + \" \" + (this._terminal.postfix ? this._terminal.postfix : '') + \" \" + ch);\n                        }\n                        csiStateHandler[ch](this._inputHandler, this._terminal.params, this._terminal.prefix, this._terminal.postfix, this);\n                    }\n                    else {\n                        this._terminal.error('Unknown CSI code: %s.', ch);\n                    }\n                    this._state = ParserState.NORMAL;\n                    this._terminal.prefix = '';\n                    this._terminal.postfix = '';\n                    break;\n                case ParserState.DCS:\n                    if (ch === EscapeSequences_1.C0.ESC || ch === EscapeSequences_1.C0.BEL) {\n                        if (ch === EscapeSequences_1.C0.ESC)\n                            this._position++;\n                        var pt = void 0;\n                        var valid = void 0;\n                        switch (this._terminal.prefix) {\n                            case '':\n                                break;\n                            case '$q':\n                                pt = this._terminal.currentParam;\n                                valid = false;\n                                switch (pt) {\n                                    case '\"q':\n                                        pt = '0\"q';\n                                        break;\n                                    case '\"p':\n                                        pt = '61\"p';\n                                        break;\n                                    case 'r':\n                                        pt = ''\n                                            + (this._terminal.buffer.scrollTop + 1)\n                                            + ';'\n                                            + (this._terminal.buffer.scrollBottom + 1)\n                                            + 'r';\n                                        break;\n                                    case 'm':\n                                        pt = '0m';\n                                        break;\n                                    default:\n                                        this._terminal.error('Unknown DCS Pt: %s.', pt);\n                                        pt = '';\n                                        break;\n                                }\n                                this._terminal.send(EscapeSequences_1.C0.ESC + 'P' + +valid + '$r' + pt + EscapeSequences_1.C0.ESC + '\\\\');\n                                break;\n                            case '+p':\n                                break;\n                            case '+q':\n                                pt = this._terminal.currentParam;\n                                valid = false;\n                                this._terminal.send(EscapeSequences_1.C0.ESC + 'P' + +valid + '+r' + pt + EscapeSequences_1.C0.ESC + '\\\\');\n                                break;\n                            default:\n                                this._terminal.error('Unknown DCS prefix: %s.', this._terminal.prefix);\n                                break;\n                        }\n                        this._terminal.currentParam = 0;\n                        this._terminal.prefix = '';\n                        this._state = ParserState.NORMAL;\n                    }\n                    else if (!this._terminal.currentParam) {\n                        if (!this._terminal.prefix && ch !== '$' && ch !== '+') {\n                            this._terminal.currentParam = ch;\n                        }\n                        else if (this._terminal.prefix.length === 2) {\n                            this._terminal.currentParam = ch;\n                        }\n                        else {\n                            this._terminal.prefix += ch;\n                        }\n                    }\n                    else {\n                        this._terminal.currentParam += ch;\n                    }\n                    break;\n                case ParserState.IGNORE:\n                    if (ch === EscapeSequences_1.C0.ESC || ch === EscapeSequences_1.C0.BEL) {\n                        if (ch === EscapeSequences_1.C0.ESC)\n                            this._position++;\n                        this._state = ParserState.NORMAL;\n                    }\n                    break;\n            }\n        }\n        if (this._terminal.buffer.x !== cursorStartX || this._terminal.buffer.y !== cursorStartY) {\n            this._terminal.emit('cursormove');\n        }\n        return this._state;\n    };\n    Parser.prototype.setState = function (state) {\n        this._state = state;\n    };\n    Parser.prototype.setPrefix = function (prefix) {\n        this._terminal.prefix = prefix;\n    };\n    Parser.prototype.setPostfix = function (postfix) {\n        this._terminal.postfix = postfix;\n    };\n    Parser.prototype.setParam = function (param) {\n        this._terminal.currentParam = param;\n    };\n    Parser.prototype.getParam = function () {\n        return this._terminal.currentParam;\n    };\n    Parser.prototype.finalizeParam = function () {\n        this._terminal.params.push(this._terminal.currentParam);\n        this._terminal.currentParam = 0;\n    };\n    Parser.prototype.skipNextChar = function () {\n        this._position++;\n    };\n    return Parser;\n}());\nexports.Parser = Parser;\n\n\n\n},{\"./Charsets\":4,\"./EscapeSequences\":6}],11:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MouseHelper_1 = require(\"./utils/MouseHelper\");\nvar Browser = require(\"./utils/Browser\");\nvar EventEmitter_1 = require(\"./EventEmitter\");\nvar SelectionModel_1 = require(\"./SelectionModel\");\nvar Buffer_1 = require(\"./Buffer\");\nvar DRAG_SCROLL_MAX_THRESHOLD = 50;\nvar DRAG_SCROLL_MAX_SPEED = 15;\nvar DRAG_SCROLL_INTERVAL = 50;\nvar WORD_SEPARATORS = ' ()[]{}\\'\"';\nvar NON_BREAKING_SPACE_CHAR = String.fromCharCode(160);\nvar ALL_NON_BREAKING_SPACE_REGEX = new RegExp(NON_BREAKING_SPACE_CHAR, 'g');\nvar SelectionMode;\n(function (SelectionMode) {\n    SelectionMode[SelectionMode[\"NORMAL\"] = 0] = \"NORMAL\";\n    SelectionMode[SelectionMode[\"WORD\"] = 1] = \"WORD\";\n    SelectionMode[SelectionMode[\"LINE\"] = 2] = \"LINE\";\n})(SelectionMode || (SelectionMode = {}));\nvar SelectionManager = (function (_super) {\n    __extends(SelectionManager, _super);\n    function SelectionManager(_terminal, _buffer, _charMeasure) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._buffer = _buffer;\n        _this._charMeasure = _charMeasure;\n        _this._enabled = true;\n        _this._initListeners();\n        _this.enable();\n        _this._model = new SelectionModel_1.SelectionModel(_terminal);\n        _this._activeSelectionMode = SelectionMode.NORMAL;\n        return _this;\n    }\n    SelectionManager.prototype._initListeners = function () {\n        var _this = this;\n        this._mouseMoveListener = function (event) { return _this._onMouseMove(event); };\n        this._mouseUpListener = function (event) { return _this._onMouseUp(event); };\n        this._buffer.lines.on('trim', function (amount) { return _this._onTrim(amount); });\n    };\n    SelectionManager.prototype.disable = function () {\n        this.clearSelection();\n        this._enabled = false;\n    };\n    SelectionManager.prototype.enable = function () {\n        this._enabled = true;\n    };\n    SelectionManager.prototype.setBuffer = function (buffer) {\n        this._buffer = buffer;\n        this.clearSelection();\n    };\n    Object.defineProperty(SelectionManager.prototype, \"selectionStart\", {\n        get: function () { return this._model.finalSelectionStart; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"selectionEnd\", {\n        get: function () { return this._model.finalSelectionEnd; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"hasSelection\", {\n        get: function () {\n            var start = this._model.finalSelectionStart;\n            var end = this._model.finalSelectionEnd;\n            if (!start || !end) {\n                return false;\n            }\n            return start[0] !== end[0] || start[1] !== end[1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"selectionText\", {\n        get: function () {\n            var start = this._model.finalSelectionStart;\n            var end = this._model.finalSelectionEnd;\n            if (!start || !end) {\n                return '';\n            }\n            var startRowEndCol = start[1] === end[1] ? end[0] : null;\n            var result = [];\n            result.push(this._buffer.translateBufferLineToString(start[1], true, start[0], startRowEndCol));\n            for (var i = start[1] + 1; i <= end[1] - 1; i++) {\n                var bufferLine = this._buffer.lines.get(i);\n                var lineText = this._buffer.translateBufferLineToString(i, true);\n                if (bufferLine.isWrapped) {\n                    result[result.length - 1] += lineText;\n                }\n                else {\n                    result.push(lineText);\n                }\n            }\n            if (start[1] !== end[1]) {\n                var bufferLine = this._buffer.lines.get(end[1]);\n                var lineText = this._buffer.translateBufferLineToString(end[1], true, 0, end[0]);\n                if (bufferLine.isWrapped) {\n                    result[result.length - 1] += lineText;\n                }\n                else {\n                    result.push(lineText);\n                }\n            }\n            var formattedResult = result.map(function (line) {\n                return line.replace(ALL_NON_BREAKING_SPACE_REGEX, ' ');\n            }).join(Browser.isMSWindows ? '\\r\\n' : '\\n');\n            return formattedResult;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionManager.prototype.clearSelection = function () {\n        this._model.clearSelection();\n        this._removeMouseDownListeners();\n        this.refresh();\n    };\n    SelectionManager.prototype.refresh = function (isNewSelection) {\n        var _this = this;\n        if (!this._refreshAnimationFrame) {\n            this._refreshAnimationFrame = window.requestAnimationFrame(function () { return _this._refresh(); });\n        }\n        if (Browser.isLinux && isNewSelection) {\n            var selectionText = this.selectionText;\n            if (selectionText.length) {\n                this.emit('newselection', this.selectionText);\n            }\n        }\n    };\n    SelectionManager.prototype._refresh = function () {\n        this._refreshAnimationFrame = null;\n        this.emit('refresh', { start: this._model.finalSelectionStart, end: this._model.finalSelectionEnd });\n    };\n    SelectionManager.prototype.selectAll = function () {\n        this._model.isSelectAllActive = true;\n        this.refresh();\n        this._terminal.emit('selection');\n    };\n    SelectionManager.prototype._onTrim = function (amount) {\n        var needsRefresh = this._model.onTrim(amount);\n        if (needsRefresh) {\n            this.refresh();\n        }\n    };\n    SelectionManager.prototype._getMouseBufferCoords = function (event) {\n        var coords = this._terminal.mouseHelper.getCoords(event, this._terminal.element, this._charMeasure, this._terminal.options.lineHeight, this._terminal.cols, this._terminal.rows, true);\n        if (!coords) {\n            return null;\n        }\n        coords[0]--;\n        coords[1]--;\n        coords[1] += this._terminal.buffer.ydisp;\n        return coords;\n    };\n    SelectionManager.prototype._getMouseEventScrollAmount = function (event) {\n        var offset = MouseHelper_1.MouseHelper.getCoordsRelativeToElement(event, this._terminal.element)[1];\n        var terminalHeight = this._terminal.rows * Math.ceil(this._charMeasure.height * this._terminal.options.lineHeight);\n        if (offset >= 0 && offset <= terminalHeight) {\n            return 0;\n        }\n        if (offset > terminalHeight) {\n            offset -= terminalHeight;\n        }\n        offset = Math.min(Math.max(offset, -DRAG_SCROLL_MAX_THRESHOLD), DRAG_SCROLL_MAX_THRESHOLD);\n        offset /= DRAG_SCROLL_MAX_THRESHOLD;\n        return (offset / Math.abs(offset)) + Math.round(offset * (DRAG_SCROLL_MAX_SPEED - 1));\n    };\n    SelectionManager.prototype.shouldForceSelection = function (event) {\n        return Browser.isMac ? event.altKey : event.shiftKey;\n    };\n    SelectionManager.prototype.onMouseDown = function (event) {\n        if (event.button === 2 && this.hasSelection) {\n            return;\n        }\n        if (event.button !== 0) {\n            return;\n        }\n        if (!this._enabled) {\n            if (!this.shouldForceSelection(event)) {\n                return;\n            }\n            event.stopPropagation();\n        }\n        event.preventDefault();\n        this._dragScrollAmount = 0;\n        if (this._enabled && event.shiftKey) {\n            this._onIncrementalClick(event);\n        }\n        else {\n            if (event.detail === 1) {\n                this._onSingleClick(event);\n            }\n            else if (event.detail === 2) {\n                this._onDoubleClick(event);\n            }\n            else if (event.detail === 3) {\n                this._onTripleClick(event);\n            }\n        }\n        this._addMouseDownListeners();\n        this.refresh(true);\n    };\n    SelectionManager.prototype._addMouseDownListeners = function () {\n        var _this = this;\n        this._terminal.element.ownerDocument.addEventListener('mousemove', this._mouseMoveListener);\n        this._terminal.element.ownerDocument.addEventListener('mouseup', this._mouseUpListener);\n        this._dragScrollIntervalTimer = setInterval(function () { return _this._dragScroll(); }, DRAG_SCROLL_INTERVAL);\n    };\n    SelectionManager.prototype._removeMouseDownListeners = function () {\n        this._terminal.element.ownerDocument.removeEventListener('mousemove', this._mouseMoveListener);\n        this._terminal.element.ownerDocument.removeEventListener('mouseup', this._mouseUpListener);\n        clearInterval(this._dragScrollIntervalTimer);\n        this._dragScrollIntervalTimer = null;\n    };\n    SelectionManager.prototype._onIncrementalClick = function (event) {\n        if (this._model.selectionStart) {\n            this._model.selectionEnd = this._getMouseBufferCoords(event);\n        }\n    };\n    SelectionManager.prototype._onSingleClick = function (event) {\n        this._model.selectionStartLength = 0;\n        this._model.isSelectAllActive = false;\n        this._activeSelectionMode = SelectionMode.NORMAL;\n        this._model.selectionStart = this._getMouseBufferCoords(event);\n        if (!this._model.selectionStart) {\n            return;\n        }\n        this._model.selectionEnd = null;\n        var line = this._buffer.lines.get(this._model.selectionStart[1]);\n        if (!line) {\n            return;\n        }\n        if (line.length >= this._model.selectionStart[0]) {\n            return;\n        }\n        var char = line[this._model.selectionStart[0]];\n        if (char[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 0) {\n            this._model.selectionStart[0]++;\n        }\n    };\n    SelectionManager.prototype._onDoubleClick = function (event) {\n        var coords = this._getMouseBufferCoords(event);\n        if (coords) {\n            this._activeSelectionMode = SelectionMode.WORD;\n            this._selectWordAt(coords);\n        }\n    };\n    SelectionManager.prototype._onTripleClick = function (event) {\n        var coords = this._getMouseBufferCoords(event);\n        if (coords) {\n            this._activeSelectionMode = SelectionMode.LINE;\n            this._selectLineAt(coords[1]);\n        }\n    };\n    SelectionManager.prototype._onMouseMove = function (event) {\n        event.stopImmediatePropagation();\n        var previousSelectionEnd = this._model.selectionEnd ? [this._model.selectionEnd[0], this._model.selectionEnd[1]] : null;\n        this._model.selectionEnd = this._getMouseBufferCoords(event);\n        if (!this._model.selectionEnd) {\n            this.refresh(true);\n            return;\n        }\n        if (this._activeSelectionMode === SelectionMode.LINE) {\n            if (this._model.selectionEnd[1] < this._model.selectionStart[1]) {\n                this._model.selectionEnd[0] = 0;\n            }\n            else {\n                this._model.selectionEnd[0] = this._terminal.cols;\n            }\n        }\n        else if (this._activeSelectionMode === SelectionMode.WORD) {\n            this._selectToWordAt(this._model.selectionEnd);\n        }\n        this._dragScrollAmount = this._getMouseEventScrollAmount(event);\n        if (this._dragScrollAmount > 0) {\n            this._model.selectionEnd[0] = this._terminal.cols;\n        }\n        else if (this._dragScrollAmount < 0) {\n            this._model.selectionEnd[0] = 0;\n        }\n        if (this._model.selectionEnd[1] < this._buffer.lines.length) {\n            var char = this._buffer.lines.get(this._model.selectionEnd[1])[this._model.selectionEnd[0]];\n            if (char && char[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 0) {\n                this._model.selectionEnd[0]++;\n            }\n        }\n        if (!previousSelectionEnd ||\n            previousSelectionEnd[0] !== this._model.selectionEnd[0] ||\n            previousSelectionEnd[1] !== this._model.selectionEnd[1]) {\n            this.refresh(true);\n        }\n    };\n    SelectionManager.prototype._dragScroll = function () {\n        if (this._dragScrollAmount) {\n            this._terminal.scrollLines(this._dragScrollAmount, false);\n            if (this._dragScrollAmount > 0) {\n                this._model.selectionEnd = [this._terminal.cols - 1, Math.min(this._terminal.buffer.ydisp + this._terminal.rows, this._terminal.buffer.lines.length - 1)];\n            }\n            else {\n                this._model.selectionEnd = [0, this._terminal.buffer.ydisp];\n            }\n            this.refresh();\n        }\n    };\n    SelectionManager.prototype._onMouseUp = function (event) {\n        this._removeMouseDownListeners();\n        if (this.hasSelection)\n            this._terminal.emit('selection');\n    };\n    SelectionManager.prototype._convertViewportColToCharacterIndex = function (bufferLine, coords) {\n        var charIndex = coords[0];\n        for (var i = 0; coords[0] >= i; i++) {\n            var char = bufferLine[i];\n            if (char[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 0) {\n                charIndex--;\n            }\n            else if (char[Buffer_1.CHAR_DATA_CHAR_INDEX].length > 1 && coords[0] !== i) {\n                charIndex += char[Buffer_1.CHAR_DATA_CHAR_INDEX].length - 1;\n            }\n        }\n        return charIndex;\n    };\n    SelectionManager.prototype.setSelection = function (col, row, length) {\n        this._model.clearSelection();\n        this._removeMouseDownListeners();\n        this._model.selectionStart = [col, row];\n        this._model.selectionStartLength = length;\n        this.refresh();\n    };\n    SelectionManager.prototype._getWordAt = function (coords) {\n        var bufferLine = this._buffer.lines.get(coords[1]);\n        if (!bufferLine) {\n            return null;\n        }\n        var line = this._buffer.translateBufferLineToString(coords[1], false);\n        var startIndex = this._convertViewportColToCharacterIndex(bufferLine, coords);\n        var endIndex = startIndex;\n        var charOffset = coords[0] - startIndex;\n        var leftWideCharCount = 0;\n        var rightWideCharCount = 0;\n        var leftLongCharOffset = 0;\n        var rightLongCharOffset = 0;\n        if (line.charAt(startIndex) === ' ') {\n            while (startIndex > 0 && line.charAt(startIndex - 1) === ' ') {\n                startIndex--;\n            }\n            while (endIndex < line.length && line.charAt(endIndex + 1) === ' ') {\n                endIndex++;\n            }\n        }\n        else {\n            var startCol = coords[0];\n            var endCol = coords[0];\n            if (bufferLine[startCol][Buffer_1.CHAR_DATA_WIDTH_INDEX] === 0) {\n                leftWideCharCount++;\n                startCol--;\n            }\n            if (bufferLine[endCol][Buffer_1.CHAR_DATA_WIDTH_INDEX] === 2) {\n                rightWideCharCount++;\n                endCol++;\n            }\n            if (bufferLine[endCol][Buffer_1.CHAR_DATA_CHAR_INDEX].length > 1) {\n                rightLongCharOffset += bufferLine[endCol][Buffer_1.CHAR_DATA_CHAR_INDEX].length - 1;\n                endIndex += bufferLine[endCol][Buffer_1.CHAR_DATA_CHAR_INDEX].length - 1;\n            }\n            while (startCol > 0 && startIndex > 0 && !this._isCharWordSeparator(bufferLine[startCol - 1])) {\n                var char = bufferLine[startCol - 1];\n                if (char[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 0) {\n                    leftWideCharCount++;\n                    startCol--;\n                }\n                else if (char[Buffer_1.CHAR_DATA_CHAR_INDEX].length > 1) {\n                    leftLongCharOffset += char[Buffer_1.CHAR_DATA_CHAR_INDEX].length - 1;\n                    startIndex -= char[Buffer_1.CHAR_DATA_CHAR_INDEX].length - 1;\n                }\n                startIndex--;\n                startCol--;\n            }\n            while (endCol < bufferLine.length && endIndex + 1 < line.length && !this._isCharWordSeparator(bufferLine[endCol + 1])) {\n                var char = bufferLine[endCol + 1];\n                if (char[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 2) {\n                    rightWideCharCount++;\n                    endCol++;\n                }\n                else if (char[Buffer_1.CHAR_DATA_CHAR_INDEX].length > 1) {\n                    rightLongCharOffset += char[Buffer_1.CHAR_DATA_CHAR_INDEX].length - 1;\n                    endIndex += char[Buffer_1.CHAR_DATA_CHAR_INDEX].length - 1;\n                }\n                endIndex++;\n                endCol++;\n            }\n        }\n        endIndex++;\n        var start = startIndex\n            + charOffset\n            - leftWideCharCount\n            + leftLongCharOffset;\n        var length = Math.min(this._terminal.cols, endIndex\n            - startIndex\n            + leftWideCharCount\n            + rightWideCharCount\n            - leftLongCharOffset\n            - rightLongCharOffset);\n        return { start: start, length: length };\n    };\n    SelectionManager.prototype._selectWordAt = function (coords) {\n        var wordPosition = this._getWordAt(coords);\n        if (wordPosition) {\n            this._model.selectionStart = [wordPosition.start, coords[1]];\n            this._model.selectionStartLength = wordPosition.length;\n        }\n    };\n    SelectionManager.prototype._selectToWordAt = function (coords) {\n        var wordPosition = this._getWordAt(coords);\n        if (wordPosition) {\n            this._model.selectionEnd = [this._model.areSelectionValuesReversed() ? wordPosition.start : (wordPosition.start + wordPosition.length), coords[1]];\n        }\n    };\n    SelectionManager.prototype._isCharWordSeparator = function (charData) {\n        if (charData[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 0) {\n            return false;\n        }\n        return WORD_SEPARATORS.indexOf(charData[Buffer_1.CHAR_DATA_CHAR_INDEX]) >= 0;\n    };\n    SelectionManager.prototype._selectLineAt = function (line) {\n        this._model.selectionStart = [0, line];\n        this._model.selectionStartLength = this._terminal.cols;\n    };\n    return SelectionManager;\n}(EventEmitter_1.EventEmitter));\nexports.SelectionManager = SelectionManager;\n\n\n\n},{\"./Buffer\":1,\"./EventEmitter\":7,\"./SelectionModel\":12,\"./utils/Browser\":28,\"./utils/MouseHelper\":32}],12:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SelectionModel = (function () {\n    function SelectionModel(_terminal) {\n        this._terminal = _terminal;\n        this.clearSelection();\n    }\n    SelectionModel.prototype.clearSelection = function () {\n        this.selectionStart = null;\n        this.selectionEnd = null;\n        this.isSelectAllActive = false;\n        this.selectionStartLength = 0;\n    };\n    Object.defineProperty(SelectionModel.prototype, \"finalSelectionStart\", {\n        get: function () {\n            if (this.isSelectAllActive) {\n                return [0, 0];\n            }\n            if (!this.selectionEnd || !this.selectionStart) {\n                return this.selectionStart;\n            }\n            return this.areSelectionValuesReversed() ? this.selectionEnd : this.selectionStart;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionModel.prototype, \"finalSelectionEnd\", {\n        get: function () {\n            if (this.isSelectAllActive) {\n                return [this._terminal.cols, this._terminal.buffer.ybase + this._terminal.rows - 1];\n            }\n            if (!this.selectionStart) {\n                return null;\n            }\n            if (!this.selectionEnd || this.areSelectionValuesReversed()) {\n                return [this.selectionStart[0] + this.selectionStartLength, this.selectionStart[1]];\n            }\n            if (this.selectionStartLength) {\n                if (this.selectionEnd[1] === this.selectionStart[1]) {\n                    return [Math.max(this.selectionStart[0] + this.selectionStartLength, this.selectionEnd[0]), this.selectionEnd[1]];\n                }\n            }\n            return this.selectionEnd;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionModel.prototype.areSelectionValuesReversed = function () {\n        var start = this.selectionStart;\n        var end = this.selectionEnd;\n        if (!start || !end) {\n            return false;\n        }\n        return start[1] > end[1] || (start[1] === end[1] && start[0] > end[0]);\n    };\n    SelectionModel.prototype.onTrim = function (amount) {\n        if (this.selectionStart) {\n            this.selectionStart[1] -= amount;\n        }\n        if (this.selectionEnd) {\n            this.selectionEnd[1] -= amount;\n        }\n        if (this.selectionEnd && this.selectionEnd[1] < 0) {\n            this.clearSelection();\n            return true;\n        }\n        if (this.selectionStart && this.selectionStart[1] < 0) {\n            this.selectionStart[1] = 0;\n        }\n        return false;\n    };\n    return SelectionModel;\n}());\nexports.SelectionModel = SelectionModel;\n\n\n\n},{}],13:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BufferSet_1 = require(\"./BufferSet\");\nvar Buffer_1 = require(\"./Buffer\");\nvar CompositionHelper_1 = require(\"./CompositionHelper\");\nvar EventEmitter_1 = require(\"./EventEmitter\");\nvar Viewport_1 = require(\"./Viewport\");\nvar Clipboard_1 = require(\"./handlers/Clipboard\");\nvar EscapeSequences_1 = require(\"./EscapeSequences\");\nvar InputHandler_1 = require(\"./InputHandler\");\nvar Parser_1 = require(\"./Parser\");\nvar Renderer_1 = require(\"./renderer/Renderer\");\nvar Linkifier_1 = require(\"./Linkifier\");\nvar SelectionManager_1 = require(\"./SelectionManager\");\nvar CharMeasure_1 = require(\"./utils/CharMeasure\");\nvar Browser = require(\"./utils/Browser\");\nvar MouseHelper_1 = require(\"./utils/MouseHelper\");\nvar Sounds_1 = require(\"./utils/Sounds\");\nvar ColorManager_1 = require(\"./renderer/ColorManager\");\nvar MouseZoneManager_1 = require(\"./input/MouseZoneManager\");\nvar CharAtlas_1 = require(\"./renderer/CharAtlas\");\nvar document = (typeof window !== 'undefined') ? window.document : null;\nvar WRITE_BUFFER_PAUSE_THRESHOLD = 5;\nvar WRITE_BATCH_SIZE = 300;\nvar DEFAULT_OPTIONS = {\n    cols: 80,\n    rows: 24,\n    convertEol: false,\n    termName: 'xterm',\n    cursorBlink: false,\n    cursorStyle: 'block',\n    bellSound: Sounds_1.BellSound,\n    bellStyle: 'none',\n    enableBold: true,\n    fontFamily: 'courier-new, courier, monospace',\n    fontSize: 15,\n    lineHeight: 1.0,\n    letterSpacing: 0,\n    scrollback: 1000,\n    screenKeys: false,\n    debug: false,\n    cancelEvents: false,\n    disableStdin: false,\n    useFlowControl: false,\n    tabStopWidth: 8,\n    theme: null\n};\nvar Terminal = (function (_super) {\n    __extends(Terminal, _super);\n    function Terminal(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.browser = Browser;\n        _this.options = options;\n        _this.setup();\n        return _this;\n    }\n    Terminal.prototype.setup = function () {\n        var _this = this;\n        Object.keys(DEFAULT_OPTIONS).forEach(function (key) {\n            if (_this.options[key] == null) {\n                _this.options[key] = DEFAULT_OPTIONS[key];\n            }\n            _this[key] = _this.options[key];\n        });\n        this.parent = document ? document.body : null;\n        this.cols = this.options.cols;\n        this.rows = this.options.rows;\n        if (this.options.handler) {\n            this.on('data', this.options.handler);\n        }\n        this.cursorState = 0;\n        this.cursorHidden = false;\n        this.sendDataQueue = '';\n        this.customKeyEventHandler = null;\n        this.applicationKeypad = false;\n        this.applicationCursor = false;\n        this.originMode = false;\n        this.insertMode = false;\n        this.wraparoundMode = true;\n        this.bracketedPasteMode = false;\n        this.charset = null;\n        this.gcharset = null;\n        this.glevel = 0;\n        this.charsets = [null];\n        this.readable = true;\n        this.writable = true;\n        this.defAttr = (0 << 18) | (257 << 9) | (256 << 0);\n        this.curAttr = (0 << 18) | (257 << 9) | (256 << 0);\n        this.params = [];\n        this.currentParam = 0;\n        this.prefix = '';\n        this.postfix = '';\n        this.writeBuffer = [];\n        this.writeInProgress = false;\n        this.xoffSentToCatchUp = false;\n        this.writeStopped = false;\n        this.surrogate_high = '';\n        this.userScrolling = false;\n        this.inputHandler = new InputHandler_1.InputHandler(this);\n        this.parser = new Parser_1.Parser(this.inputHandler, this);\n        this.renderer = this.renderer || null;\n        this.selectionManager = this.selectionManager || null;\n        this.linkifier = this.linkifier || new Linkifier_1.Linkifier(this);\n        this._mouseZoneManager = this._mouseZoneManager || null;\n        this.buffers = new BufferSet_1.BufferSet(this);\n        this.buffer = this.buffers.active;\n        this.buffers.on('activate', function (buffer) {\n            _this.buffer = buffer;\n        });\n        if (this.selectionManager) {\n            this.selectionManager.setBuffer(this.buffer);\n        }\n    };\n    Terminal.prototype.eraseAttr = function () {\n        return (this.defAttr & ~0x1ff) | (this.curAttr & 0x1ff);\n    };\n    Terminal.prototype.focus = function () {\n        if (this.textarea) {\n            this.textarea.focus();\n        }\n    };\n    Object.defineProperty(Terminal.prototype, \"isFocused\", {\n        get: function () {\n            return document.activeElement === this.textarea;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Terminal.prototype.getOption = function (key) {\n        if (!(key in DEFAULT_OPTIONS)) {\n            throw new Error('No option with key \"' + key + '\"');\n        }\n        if (typeof this.options[key] !== 'undefined') {\n            return this.options[key];\n        }\n        return this[key];\n    };\n    Terminal.prototype.setOption = function (key, value) {\n        if (!(key in DEFAULT_OPTIONS)) {\n            throw new Error('No option with key \"' + key + '\"');\n        }\n        switch (key) {\n            case 'bellStyle':\n                if (!value) {\n                    value = 'none';\n                }\n                break;\n            case 'cursorStyle':\n                if (!value) {\n                    value = 'block';\n                }\n                break;\n            case 'lineHeight':\n                if (value < 1) {\n                    console.warn(key + \" cannot be less than 1, value: \" + value);\n                    return;\n                }\n            case 'tabStopWidth':\n                if (value < 1) {\n                    console.warn(key + \" cannot be less than 1, value: \" + value);\n                    return;\n                }\n                break;\n            case 'theme':\n                if (this.renderer) {\n                    this._setTheme(value);\n                    return;\n                }\n                break;\n            case 'scrollback':\n                value = Math.min(value, Buffer_1.MAX_BUFFER_SIZE);\n                if (value < 0) {\n                    console.warn(key + \" cannot be less than 0, value: \" + value);\n                    return;\n                }\n                if (this.options[key] !== value) {\n                    var newBufferLength = this.rows + value;\n                    if (this.buffer.lines.length > newBufferLength) {\n                        var amountToTrim = this.buffer.lines.length - newBufferLength;\n                        var needsRefresh = (this.buffer.ydisp - amountToTrim < 0);\n                        this.buffer.lines.trimStart(amountToTrim);\n                        this.buffer.ybase = Math.max(this.buffer.ybase - amountToTrim, 0);\n                        this.buffer.ydisp = Math.max(this.buffer.ydisp - amountToTrim, 0);\n                        if (needsRefresh) {\n                            this.refresh(0, this.rows - 1);\n                        }\n                    }\n                }\n                break;\n        }\n        this[key] = value;\n        this.options[key] = value;\n        switch (key) {\n            case 'fontFamily':\n            case 'fontSize':\n                this.renderer.clear();\n                this.charMeasure.measure(this.options);\n                break;\n            case 'enableBold':\n            case 'letterSpacing':\n            case 'lineHeight':\n                this.renderer.clear();\n                this.renderer.onResize(this.cols, this.rows, false);\n                this.refresh(0, this.rows - 1);\n            case 'scrollback':\n                this.buffers.resize(this.cols, this.rows);\n                this.viewport.syncScrollArea();\n                break;\n            case 'tabStopWidth':\n                this.buffers.setupTabStops();\n                break;\n            case 'bellSound':\n            case 'bellStyle':\n                this.syncBellSound();\n                break;\n        }\n        if (this.renderer) {\n            this.renderer.onOptionsChanged();\n        }\n    };\n    Terminal.prototype._onTextAreaFocus = function () {\n        if (this.sendFocus) {\n            this.send(EscapeSequences_1.C0.ESC + '[I');\n        }\n        this.element.classList.add('focus');\n        this.showCursor();\n        this.emit('focus');\n    };\n    ;\n    Terminal.prototype.blur = function () {\n        return this.textarea.blur();\n    };\n    Terminal.prototype._onTextAreaBlur = function () {\n        this.refresh(this.buffer.y, this.buffer.y);\n        if (this.sendFocus) {\n            this.send(EscapeSequences_1.C0.ESC + '[O');\n        }\n        this.element.classList.remove('focus');\n        this.emit('blur');\n    };\n    Terminal.prototype.initGlobal = function () {\n        var _this = this;\n        this.bindKeys();\n        on(this.element, 'copy', function (event) {\n            if (!_this.hasSelection()) {\n                return;\n            }\n            Clipboard_1.copyHandler(event, _this, _this.selectionManager);\n        });\n        var pasteHandlerWrapper = function (event) { return Clipboard_1.pasteHandler(event, _this); };\n        on(this.textarea, 'paste', pasteHandlerWrapper);\n        on(this.element, 'paste', pasteHandlerWrapper);\n        if (Browser.isFirefox) {\n            on(this.element, 'mousedown', function (event) {\n                if (event.button === 2) {\n                    Clipboard_1.rightClickHandler(event, _this.textarea, _this.selectionManager);\n                }\n            });\n        }\n        else {\n            on(this.element, 'contextmenu', function (event) {\n                Clipboard_1.rightClickHandler(event, _this.textarea, _this.selectionManager);\n            });\n        }\n        if (Browser.isLinux) {\n            on(this.element, 'auxclick', function (event) {\n                if (event.button === 1) {\n                    Clipboard_1.moveTextAreaUnderMouseCursor(event, _this.textarea);\n                }\n            });\n        }\n    };\n    Terminal.prototype.bindKeys = function () {\n        var _this = this;\n        var self = this;\n        on(this.element, 'keydown', function (ev) {\n            if (document.activeElement !== this) {\n                return;\n            }\n            self._keyDown(ev);\n        }, true);\n        on(this.element, 'keypress', function (ev) {\n            if (document.activeElement !== this) {\n                return;\n            }\n            self._keyPress(ev);\n        }, true);\n        on(this.element, 'keyup', function (ev) {\n            if (!wasMondifierKeyOnlyEvent(ev)) {\n                _this.focus();\n            }\n        }, true);\n        on(this.textarea, 'keydown', function (ev) {\n            _this._keyDown(ev);\n        }, true);\n        on(this.textarea, 'keypress', function (ev) {\n            _this._keyPress(ev);\n            _this.textarea.value = '';\n        }, true);\n        on(this.textarea, 'compositionstart', function () { return _this.compositionHelper.compositionstart(); });\n        on(this.textarea, 'compositionupdate', function (e) { return _this.compositionHelper.compositionupdate(e); });\n        on(this.textarea, 'compositionend', function () { return _this.compositionHelper.compositionend(); });\n        this.on('refresh', function () { return _this.compositionHelper.updateCompositionElements(); });\n        this.on('refresh', function (data) { return _this.queueLinkification(data.start, data.end); });\n    };\n    Terminal.prototype.open = function (parent) {\n        var _this = this;\n        var i = 0;\n        var div;\n        this.parent = parent || this.parent;\n        if (!this.parent) {\n            throw new Error('Terminal requires a parent element.');\n        }\n        this.context = this.parent.ownerDocument.defaultView;\n        this.document = this.parent.ownerDocument;\n        this.body = this.document.body;\n        CharAtlas_1.initialize(this.document);\n        this.element = this.document.createElement('div');\n        this.element.classList.add('terminal');\n        this.element.classList.add('xterm');\n        this.element.setAttribute('tabindex', '0');\n        this.parent.appendChild(this.element);\n        var fragment = document.createDocumentFragment();\n        this.viewportElement = document.createElement('div');\n        this.viewportElement.classList.add('xterm-viewport');\n        fragment.appendChild(this.viewportElement);\n        this.viewportScrollArea = document.createElement('div');\n        this.viewportScrollArea.classList.add('xterm-scroll-area');\n        this.viewportElement.appendChild(this.viewportScrollArea);\n        this._mouseZoneManager = new MouseZoneManager_1.MouseZoneManager(this);\n        this.on('scroll', function () { return _this._mouseZoneManager.clearAll(); });\n        this.linkifier.attachToDom(this._mouseZoneManager);\n        this.helperContainer = document.createElement('div');\n        this.helperContainer.classList.add('xterm-helpers');\n        fragment.appendChild(this.helperContainer);\n        this.textarea = document.createElement('textarea');\n        this.textarea.classList.add('xterm-helper-textarea');\n        this.textarea.setAttribute('autocorrect', 'off');\n        this.textarea.setAttribute('autocapitalize', 'off');\n        this.textarea.setAttribute('spellcheck', 'false');\n        this.textarea.tabIndex = 0;\n        this.textarea.addEventListener('focus', function () { return _this._onTextAreaFocus(); });\n        this.textarea.addEventListener('blur', function () { return _this._onTextAreaBlur(); });\n        this.helperContainer.appendChild(this.textarea);\n        this.compositionView = document.createElement('div');\n        this.compositionView.classList.add('composition-view');\n        this.compositionHelper = new CompositionHelper_1.CompositionHelper(this.textarea, this.compositionView, this);\n        this.helperContainer.appendChild(this.compositionView);\n        this.charSizeStyleElement = document.createElement('style');\n        this.helperContainer.appendChild(this.charSizeStyleElement);\n        this.charMeasure = new CharMeasure_1.CharMeasure(document, this.helperContainer);\n        this.syncBellSound();\n        this.element.appendChild(fragment);\n        this.renderer = new Renderer_1.Renderer(this, this.options.theme);\n        this.options.theme = null;\n        this.viewport = new Viewport_1.Viewport(this, this.viewportElement, this.viewportScrollArea, this.charMeasure);\n        this.viewport.onThemeChanged(this.renderer.colorManager.colors);\n        this.on('cursormove', function () { return _this.renderer.onCursorMove(); });\n        this.on('resize', function () { return _this.renderer.onResize(_this.cols, _this.rows, false); });\n        this.on('blur', function () { return _this.renderer.onBlur(); });\n        this.on('focus', function () { return _this.renderer.onFocus(); });\n        this.charMeasure.on('charsizechanged', function () { return _this.renderer.onResize(_this.cols, _this.rows, true); });\n        this.renderer.on('resize', function (dimensions) { return _this.viewport.syncScrollArea(); });\n        this.selectionManager = new SelectionManager_1.SelectionManager(this, this.buffer, this.charMeasure);\n        this.element.addEventListener('mousedown', function (e) { return _this.selectionManager.onMouseDown(e); });\n        this.selectionManager.on('refresh', function (data) { return _this.renderer.onSelectionChanged(data.start, data.end); });\n        this.selectionManager.on('newselection', function (text) {\n            _this.textarea.value = text;\n            _this.textarea.focus();\n            _this.textarea.select();\n        });\n        this.on('scroll', function () {\n            _this.viewport.syncScrollArea();\n            _this.selectionManager.refresh();\n        });\n        this.viewportElement.addEventListener('scroll', function () { return _this.selectionManager.refresh(); });\n        this.mouseHelper = new MouseHelper_1.MouseHelper(this.renderer);\n        this.charMeasure.measure(this.options);\n        this.refresh(0, this.rows - 1);\n        this.initGlobal();\n        this.bindMouse();\n    };\n    Terminal.prototype._setTheme = function (theme) {\n        var colors = this.renderer.setTheme(theme);\n        if (this.viewport) {\n            this.viewport.onThemeChanged(colors);\n        }\n    };\n    Terminal.applyAddon = function (addon) {\n        addon.apply(Terminal);\n    };\n    Terminal.prototype.bindMouse = function () {\n        var _this = this;\n        var el = this.element;\n        var self = this;\n        var pressed = 32;\n        function sendButton(ev) {\n            var button;\n            var pos;\n            button = getButton(ev);\n            pos = self.mouseHelper.getRawByteCoords(ev, self.element, self.charMeasure, self.options.lineHeight, self.cols, self.rows);\n            if (!pos)\n                return;\n            sendEvent(button, pos);\n            switch (ev.overrideType || ev.type) {\n                case 'mousedown':\n                    pressed = button;\n                    break;\n                case 'mouseup':\n                    pressed = 32;\n                    break;\n                case 'wheel':\n                    break;\n            }\n        }\n        function sendMove(ev) {\n            var button = pressed;\n            var pos = self.mouseHelper.getRawByteCoords(ev, self.element, self.charMeasure, self.options.lineHeight, self.cols, self.rows);\n            if (!pos)\n                return;\n            button += 32;\n            sendEvent(button, pos);\n        }\n        function encode(data, ch) {\n            if (!self.utfMouse) {\n                if (ch === 255) {\n                    data.push(0);\n                    return;\n                }\n                if (ch > 127)\n                    ch = 127;\n                data.push(ch);\n            }\n            else {\n                if (ch === 2047) {\n                    data.push(0);\n                    return;\n                }\n                if (ch < 127) {\n                    data.push(ch);\n                }\n                else {\n                    if (ch > 2047)\n                        ch = 2047;\n                    data.push(0xC0 | (ch >> 6));\n                    data.push(0x80 | (ch & 0x3F));\n                }\n            }\n        }\n        function sendEvent(button, pos) {\n            if (self.vt300Mouse) {\n                button &= 3;\n                pos.x -= 32;\n                pos.y -= 32;\n                var data_1 = EscapeSequences_1.C0.ESC + '[24';\n                if (button === 0)\n                    data_1 += '1';\n                else if (button === 1)\n                    data_1 += '3';\n                else if (button === 2)\n                    data_1 += '5';\n                else if (button === 3)\n                    return;\n                else\n                    data_1 += '0';\n                data_1 += '~[' + pos.x + ',' + pos.y + ']\\r';\n                self.send(data_1);\n                return;\n            }\n            if (self.decLocator) {\n                button &= 3;\n                pos.x -= 32;\n                pos.y -= 32;\n                if (button === 0)\n                    button = 2;\n                else if (button === 1)\n                    button = 4;\n                else if (button === 2)\n                    button = 6;\n                else if (button === 3)\n                    button = 3;\n                self.send(EscapeSequences_1.C0.ESC + '['\n                    + button\n                    + ';'\n                    + (button === 3 ? 4 : 0)\n                    + ';'\n                    + pos.y\n                    + ';'\n                    + pos.x\n                    + ';'\n                    + pos.page || 0\n                    + '&w');\n                return;\n            }\n            if (self.urxvtMouse) {\n                pos.x -= 32;\n                pos.y -= 32;\n                pos.x++;\n                pos.y++;\n                self.send(EscapeSequences_1.C0.ESC + '[' + button + ';' + pos.x + ';' + pos.y + 'M');\n                return;\n            }\n            if (self.sgrMouse) {\n                pos.x -= 32;\n                pos.y -= 32;\n                self.send(EscapeSequences_1.C0.ESC + '[<'\n                    + (((button & 3) === 3 ? button & ~3 : button) - 32)\n                    + ';'\n                    + pos.x\n                    + ';'\n                    + pos.y\n                    + ((button & 3) === 3 ? 'm' : 'M'));\n                return;\n            }\n            var data = [];\n            encode(data, button);\n            encode(data, pos.x);\n            encode(data, pos.y);\n            self.send(EscapeSequences_1.C0.ESC + '[M' + String.fromCharCode.apply(String, data));\n        }\n        function getButton(ev) {\n            var button;\n            var shift;\n            var meta;\n            var ctrl;\n            var mod;\n            switch (ev.overrideType || ev.type) {\n                case 'mousedown':\n                    button = ev.button != null\n                        ? +ev.button\n                        : ev.which != null\n                            ? ev.which - 1\n                            : null;\n                    if (Browser.isMSIE) {\n                        button = button === 1 ? 0 : button === 4 ? 1 : button;\n                    }\n                    break;\n                case 'mouseup':\n                    button = 3;\n                    break;\n                case 'DOMMouseScroll':\n                    button = ev.detail < 0\n                        ? 64\n                        : 65;\n                    break;\n                case 'wheel':\n                    button = ev.wheelDeltaY > 0\n                        ? 64\n                        : 65;\n                    break;\n            }\n            shift = ev.shiftKey ? 4 : 0;\n            meta = ev.metaKey ? 8 : 0;\n            ctrl = ev.ctrlKey ? 16 : 0;\n            mod = shift | meta | ctrl;\n            if (self.vt200Mouse) {\n                mod &= ctrl;\n            }\n            else if (!self.normalMouse) {\n                mod = 0;\n            }\n            button = (32 + (mod << 2)) + button;\n            return button;\n        }\n        on(el, 'mousedown', function (ev) {\n            ev.preventDefault();\n            _this.focus();\n            if (!_this.mouseEvents || _this.selectionManager.shouldForceSelection(ev)) {\n                return;\n            }\n            sendButton(ev);\n            if (_this.vt200Mouse) {\n                ev.overrideType = 'mouseup';\n                sendButton(ev);\n                return _this.cancel(ev);\n            }\n            if (_this.normalMouse)\n                on(_this.document, 'mousemove', sendMove);\n            if (!_this.x10Mouse) {\n                var handler_1 = function (ev) {\n                    sendButton(ev);\n                    if (_this.normalMouse)\n                        off(_this.document, 'mousemove', sendMove);\n                    off(_this.document, 'mouseup', handler_1);\n                    return _this.cancel(ev);\n                };\n                on(_this.document, 'mouseup', handler_1);\n            }\n            return _this.cancel(ev);\n        });\n        on(el, 'wheel', function (ev) {\n            if (!_this.mouseEvents)\n                return;\n            if (_this.x10Mouse || _this.vt300Mouse || _this.decLocator)\n                return;\n            sendButton(ev);\n            ev.preventDefault();\n        });\n        on(el, 'wheel', function (ev) {\n            if (_this.mouseEvents)\n                return;\n            _this.viewport.onWheel(ev);\n            return _this.cancel(ev);\n        });\n        on(el, 'touchstart', function (ev) {\n            if (_this.mouseEvents)\n                return;\n            _this.viewport.onTouchStart(ev);\n            return _this.cancel(ev);\n        });\n        on(el, 'touchmove', function (ev) {\n            if (_this.mouseEvents)\n                return;\n            _this.viewport.onTouchMove(ev);\n            return _this.cancel(ev);\n        });\n    };\n    Terminal.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.readable = false;\n        this.writable = false;\n        this.handler = function () { };\n        this.write = function () { };\n        if (this.element && this.element.parentNode) {\n            this.element.parentNode.removeChild(this.element);\n        }\n    };\n    Terminal.prototype.refresh = function (start, end) {\n        if (this.renderer) {\n            this.renderer.queueRefresh(start, end);\n        }\n    };\n    Terminal.prototype.queueLinkification = function (start, end) {\n        if (this.linkifier) {\n            this.linkifier.linkifyRows(start, end);\n        }\n    };\n    Terminal.prototype.showCursor = function () {\n        if (!this.cursorState) {\n            this.cursorState = 1;\n            this.refresh(this.buffer.y, this.buffer.y);\n        }\n    };\n    Terminal.prototype.scroll = function (isWrapped) {\n        var newLine = this.blankLine(undefined, isWrapped);\n        var topRow = this.buffer.ybase + this.buffer.scrollTop;\n        var bottomRow = this.buffer.ybase + this.buffer.scrollBottom;\n        if (this.buffer.scrollTop === 0) {\n            var willBufferBeTrimmed = this.buffer.lines.length === this.buffer.lines.maxLength;\n            if (bottomRow === this.buffer.lines.length - 1) {\n                this.buffer.lines.push(newLine);\n            }\n            else {\n                this.buffer.lines.splice(bottomRow + 1, 0, newLine);\n            }\n            if (!willBufferBeTrimmed) {\n                this.buffer.ybase++;\n                if (!this.userScrolling) {\n                    this.buffer.ydisp++;\n                }\n            }\n            else {\n                if (this.userScrolling) {\n                    this.buffer.ydisp = Math.max(this.buffer.ydisp - 1, 0);\n                }\n            }\n        }\n        else {\n            var scrollRegionHeight = bottomRow - topRow + 1;\n            this.buffer.lines.shiftElements(topRow + 1, scrollRegionHeight - 1, -1);\n            this.buffer.lines.set(bottomRow, newLine);\n        }\n        if (!this.userScrolling) {\n            this.buffer.ydisp = this.buffer.ybase;\n        }\n        this.updateRange(this.buffer.scrollTop);\n        this.updateRange(this.buffer.scrollBottom);\n        this.emit('scroll', this.buffer.ydisp);\n    };\n    Terminal.prototype.scrollLines = function (disp, suppressScrollEvent) {\n        if (disp < 0) {\n            if (this.buffer.ydisp === 0) {\n                return;\n            }\n            this.userScrolling = true;\n        }\n        else if (disp + this.buffer.ydisp >= this.buffer.ybase) {\n            this.userScrolling = false;\n        }\n        var oldYdisp = this.buffer.ydisp;\n        this.buffer.ydisp = Math.max(Math.min(this.buffer.ydisp + disp, this.buffer.ybase), 0);\n        if (oldYdisp === this.buffer.ydisp) {\n            return;\n        }\n        if (!suppressScrollEvent) {\n            this.emit('scroll', this.buffer.ydisp);\n        }\n        this.refresh(0, this.rows - 1);\n    };\n    Terminal.prototype.scrollPages = function (pageCount) {\n        this.scrollLines(pageCount * (this.rows - 1));\n    };\n    Terminal.prototype.scrollToTop = function () {\n        this.scrollLines(-this.buffer.ydisp);\n    };\n    Terminal.prototype.scrollToBottom = function () {\n        this.scrollLines(this.buffer.ybase - this.buffer.ydisp);\n    };\n    Terminal.prototype.write = function (data) {\n        var _this = this;\n        this.writeBuffer.push(data);\n        if (this.options.useFlowControl && !this.xoffSentToCatchUp && this.writeBuffer.length >= WRITE_BUFFER_PAUSE_THRESHOLD) {\n            this.send(EscapeSequences_1.C0.DC3);\n            this.xoffSentToCatchUp = true;\n        }\n        if (!this.writeInProgress && this.writeBuffer.length > 0) {\n            this.writeInProgress = true;\n            setTimeout(function () {\n                _this.innerWrite();\n            });\n        }\n    };\n    Terminal.prototype.innerWrite = function () {\n        var _this = this;\n        var writeBatch = this.writeBuffer.splice(0, WRITE_BATCH_SIZE);\n        while (writeBatch.length > 0) {\n            var data = writeBatch.shift();\n            if (this.xoffSentToCatchUp && writeBatch.length === 0 && this.writeBuffer.length === 0) {\n                this.send(EscapeSequences_1.C0.DC1);\n                this.xoffSentToCatchUp = false;\n            }\n            this.refreshStart = this.buffer.y;\n            this.refreshEnd = this.buffer.y;\n            var state = this.parser.parse(data);\n            this.parser.setState(state);\n            this.updateRange(this.buffer.y);\n            this.refresh(this.refreshStart, this.refreshEnd);\n        }\n        if (this.writeBuffer.length > 0) {\n            setTimeout(function () { return _this.innerWrite(); }, 0);\n        }\n        else {\n            this.writeInProgress = false;\n        }\n    };\n    Terminal.prototype.writeln = function (data) {\n        this.write(data + '\\r\\n');\n    };\n    Terminal.prototype.attachCustomKeyEventHandler = function (customKeyEventHandler) {\n        this.customKeyEventHandler = customKeyEventHandler;\n    };\n    Terminal.prototype.setHypertextLinkHandler = function (handler) {\n        if (!this.linkifier) {\n            throw new Error('Cannot attach a hypertext link handler before Terminal.open is called');\n        }\n        this.linkifier.setHypertextLinkHandler(handler);\n        this.refresh(0, this.rows - 1);\n    };\n    Terminal.prototype.setHypertextValidationCallback = function (callback) {\n        if (!this.linkifier) {\n            throw new Error('Cannot attach a hypertext validation callback before Terminal.open is called');\n        }\n        this.linkifier.setHypertextValidationCallback(callback);\n        this.refresh(0, this.rows - 1);\n    };\n    Terminal.prototype.registerLinkMatcher = function (regex, handler, options) {\n        if (this.linkifier) {\n            var matcherId = this.linkifier.registerLinkMatcher(regex, handler, options);\n            this.refresh(0, this.rows - 1);\n            return matcherId;\n        }\n        return 0;\n    };\n    Terminal.prototype.deregisterLinkMatcher = function (matcherId) {\n        if (this.linkifier) {\n            if (this.linkifier.deregisterLinkMatcher(matcherId)) {\n                this.refresh(0, this.rows - 1);\n            }\n        }\n    };\n    Terminal.prototype.hasSelection = function () {\n        return this.selectionManager ? this.selectionManager.hasSelection : false;\n    };\n    Terminal.prototype.getSelection = function () {\n        return this.selectionManager ? this.selectionManager.selectionText : '';\n    };\n    Terminal.prototype.clearSelection = function () {\n        if (this.selectionManager) {\n            this.selectionManager.clearSelection();\n        }\n    };\n    Terminal.prototype.selectAll = function () {\n        if (this.selectionManager) {\n            this.selectionManager.selectAll();\n        }\n    };\n    Terminal.prototype._keyDown = function (ev) {\n        if (this.customKeyEventHandler && this.customKeyEventHandler(ev) === false) {\n            return false;\n        }\n        if (!this.compositionHelper.keydown(ev)) {\n            if (this.buffer.ybase !== this.buffer.ydisp) {\n                this.scrollToBottom();\n            }\n            return false;\n        }\n        var result = this._evaluateKeyEscapeSequence(ev);\n        if (result.key === EscapeSequences_1.C0.DC3) {\n            this.writeStopped = true;\n        }\n        else if (result.key === EscapeSequences_1.C0.DC1) {\n            this.writeStopped = false;\n        }\n        if (result.scrollLines) {\n            this.scrollLines(result.scrollLines);\n            return this.cancel(ev, true);\n        }\n        if (isThirdLevelShift(this.browser, ev)) {\n            return true;\n        }\n        if (result.cancel) {\n            this.cancel(ev, true);\n        }\n        if (!result.key) {\n            return true;\n        }\n        this.emit('keydown', ev);\n        this.emit('key', result.key, ev);\n        this.showCursor();\n        this.handler(result.key);\n        return this.cancel(ev, true);\n    };\n    Terminal.prototype._evaluateKeyEscapeSequence = function (ev) {\n        var result = {\n            cancel: false,\n            key: undefined,\n            scrollLines: undefined\n        };\n        var modifiers = (ev.shiftKey ? 1 : 0) | (ev.altKey ? 2 : 0) | (ev.ctrlKey ? 4 : 0) | (ev.metaKey ? 8 : 0);\n        switch (ev.keyCode) {\n            case 0:\n                if (ev.key === 'UIKeyInputUpArrow') {\n                    if (this.applicationCursor) {\n                        result.key = EscapeSequences_1.C0.ESC + 'OA';\n                    }\n                    else {\n                        result.key = EscapeSequences_1.C0.ESC + '[A';\n                    }\n                }\n                else if (ev.key === 'UIKeyInputLeftArrow') {\n                    if (this.applicationCursor) {\n                        result.key = EscapeSequences_1.C0.ESC + 'OD';\n                    }\n                    else {\n                        result.key = EscapeSequences_1.C0.ESC + '[D';\n                    }\n                }\n                else if (ev.key === 'UIKeyInputRightArrow') {\n                    if (this.applicationCursor) {\n                        result.key = EscapeSequences_1.C0.ESC + 'OC';\n                    }\n                    else {\n                        result.key = EscapeSequences_1.C0.ESC + '[C';\n                    }\n                }\n                else if (ev.key === 'UIKeyInputDownArrow') {\n                    if (this.applicationCursor) {\n                        result.key = EscapeSequences_1.C0.ESC + 'OB';\n                    }\n                    else {\n                        result.key = EscapeSequences_1.C0.ESC + '[B';\n                    }\n                }\n                break;\n            case 8:\n                if (ev.shiftKey) {\n                    result.key = EscapeSequences_1.C0.BS;\n                    break;\n                }\n                else if (ev.altKey) {\n                    result.key = EscapeSequences_1.C0.ESC + EscapeSequences_1.C0.DEL;\n                    break;\n                }\n                result.key = EscapeSequences_1.C0.DEL;\n                break;\n            case 9:\n                if (ev.shiftKey) {\n                    result.key = EscapeSequences_1.C0.ESC + '[Z';\n                    break;\n                }\n                result.key = EscapeSequences_1.C0.HT;\n                result.cancel = true;\n                break;\n            case 13:\n                result.key = EscapeSequences_1.C0.CR;\n                result.cancel = true;\n                break;\n            case 27:\n                result.key = EscapeSequences_1.C0.ESC;\n                result.cancel = true;\n                break;\n            case 37:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'D';\n                    if (result.key === EscapeSequences_1.C0.ESC + '[1;3D') {\n                        result.key = (this.browser.isMac) ? EscapeSequences_1.C0.ESC + 'b' : EscapeSequences_1.C0.ESC + '[1;5D';\n                    }\n                }\n                else if (this.applicationCursor) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OD';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[D';\n                }\n                break;\n            case 39:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'C';\n                    if (result.key === EscapeSequences_1.C0.ESC + '[1;3C') {\n                        result.key = (this.browser.isMac) ? EscapeSequences_1.C0.ESC + 'f' : EscapeSequences_1.C0.ESC + '[1;5C';\n                    }\n                }\n                else if (this.applicationCursor) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OC';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[C';\n                }\n                break;\n            case 38:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'A';\n                    if (result.key === EscapeSequences_1.C0.ESC + '[1;3A') {\n                        result.key = EscapeSequences_1.C0.ESC + '[1;5A';\n                    }\n                }\n                else if (this.applicationCursor) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OA';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[A';\n                }\n                break;\n            case 40:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'B';\n                    if (result.key === EscapeSequences_1.C0.ESC + '[1;3B') {\n                        result.key = EscapeSequences_1.C0.ESC + '[1;5B';\n                    }\n                }\n                else if (this.applicationCursor) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OB';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[B';\n                }\n                break;\n            case 45:\n                if (!ev.shiftKey && !ev.ctrlKey) {\n                    result.key = EscapeSequences_1.C0.ESC + '[2~';\n                }\n                break;\n            case 46:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[3;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[3~';\n                }\n                break;\n            case 36:\n                if (modifiers)\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'H';\n                else if (this.applicationCursor)\n                    result.key = EscapeSequences_1.C0.ESC + 'OH';\n                else\n                    result.key = EscapeSequences_1.C0.ESC + '[H';\n                break;\n            case 35:\n                if (modifiers)\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'F';\n                else if (this.applicationCursor)\n                    result.key = EscapeSequences_1.C0.ESC + 'OF';\n                else\n                    result.key = EscapeSequences_1.C0.ESC + '[F';\n                break;\n            case 33:\n                if (ev.shiftKey) {\n                    result.scrollLines = -(this.rows - 1);\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[5~';\n                }\n                break;\n            case 34:\n                if (ev.shiftKey) {\n                    result.scrollLines = this.rows - 1;\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[6~';\n                }\n                break;\n            case 112:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'P';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + 'OP';\n                }\n                break;\n            case 113:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'Q';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + 'OQ';\n                }\n                break;\n            case 114:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'R';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + 'OR';\n                }\n                break;\n            case 115:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'S';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + 'OS';\n                }\n                break;\n            case 116:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[15;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[15~';\n                }\n                break;\n            case 117:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[17;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[17~';\n                }\n                break;\n            case 118:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[18;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[18~';\n                }\n                break;\n            case 119:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[19;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[19~';\n                }\n                break;\n            case 120:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[20;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[20~';\n                }\n                break;\n            case 121:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[21;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[21~';\n                }\n                break;\n            case 122:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[23;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[23~';\n                }\n                break;\n            case 123:\n                if (modifiers) {\n                    result.key = EscapeSequences_1.C0.ESC + '[24;' + (modifiers + 1) + '~';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[24~';\n                }\n                break;\n            default:\n                if (ev.ctrlKey && !ev.shiftKey && !ev.altKey && !ev.metaKey) {\n                    if (ev.keyCode >= 65 && ev.keyCode <= 90) {\n                        result.key = String.fromCharCode(ev.keyCode - 64);\n                    }\n                    else if (ev.keyCode === 32) {\n                        result.key = String.fromCharCode(0);\n                    }\n                    else if (ev.keyCode >= 51 && ev.keyCode <= 55) {\n                        result.key = String.fromCharCode(ev.keyCode - 51 + 27);\n                    }\n                    else if (ev.keyCode === 56) {\n                        result.key = String.fromCharCode(127);\n                    }\n                    else if (ev.keyCode === 219) {\n                        result.key = String.fromCharCode(27);\n                    }\n                    else if (ev.keyCode === 220) {\n                        result.key = String.fromCharCode(28);\n                    }\n                    else if (ev.keyCode === 221) {\n                        result.key = String.fromCharCode(29);\n                    }\n                }\n                else if (!this.browser.isMac && ev.altKey && !ev.ctrlKey && !ev.metaKey) {\n                    if (ev.keyCode >= 65 && ev.keyCode <= 90) {\n                        result.key = EscapeSequences_1.C0.ESC + String.fromCharCode(ev.keyCode + 32);\n                    }\n                    else if (ev.keyCode === 192) {\n                        result.key = EscapeSequences_1.C0.ESC + '`';\n                    }\n                    else if (ev.keyCode >= 48 && ev.keyCode <= 57) {\n                        result.key = EscapeSequences_1.C0.ESC + (ev.keyCode - 48);\n                    }\n                }\n                else if (this.browser.isMac && !ev.altKey && !ev.ctrlKey && ev.metaKey) {\n                    if (ev.keyCode === 65) {\n                        this.selectAll();\n                    }\n                }\n                break;\n        }\n        return result;\n    };\n    Terminal.prototype.setgLevel = function (g) {\n        this.glevel = g;\n        this.charset = this.charsets[g];\n    };\n    Terminal.prototype.setgCharset = function (g, charset) {\n        this.charsets[g] = charset;\n        if (this.glevel === g) {\n            this.charset = charset;\n        }\n    };\n    Terminal.prototype._keyPress = function (ev) {\n        var key;\n        if (this.customKeyEventHandler && this.customKeyEventHandler(ev) === false) {\n            return false;\n        }\n        this.cancel(ev);\n        if (ev.charCode) {\n            key = ev.charCode;\n        }\n        else if (ev.which == null) {\n            key = ev.keyCode;\n        }\n        else if (ev.which !== 0 && ev.charCode !== 0) {\n            key = ev.which;\n        }\n        else {\n            return false;\n        }\n        if (!key || ((ev.altKey || ev.ctrlKey || ev.metaKey) && !isThirdLevelShift(this.browser, ev))) {\n            return false;\n        }\n        key = String.fromCharCode(key);\n        this.emit('keypress', key, ev);\n        this.emit('key', key, ev);\n        this.showCursor();\n        this.handler(key);\n        return true;\n    };\n    Terminal.prototype.send = function (data) {\n        var _this = this;\n        if (!this.sendDataQueue) {\n            setTimeout(function () {\n                _this.handler(_this.sendDataQueue);\n                _this.sendDataQueue = '';\n            }, 1);\n        }\n        this.sendDataQueue += data;\n    };\n    Terminal.prototype.bell = function () {\n        var _this = this;\n        this.emit('bell');\n        if (this.soundBell())\n            this.bellAudioElement.play();\n        if (this.visualBell()) {\n            this.element.classList.add('visual-bell-active');\n            clearTimeout(this.visualBellTimer);\n            this.visualBellTimer = window.setTimeout(function () {\n                _this.element.classList.remove('visual-bell-active');\n            }, 200);\n        }\n    };\n    Terminal.prototype.log = function (text, data) {\n        if (!this.options.debug)\n            return;\n        if (!this.context.console || !this.context.console.log)\n            return;\n        this.context.console.log(text, data);\n    };\n    Terminal.prototype.error = function (text, data) {\n        if (!this.options.debug)\n            return;\n        if (!this.context.console || !this.context.console.error)\n            return;\n        this.context.console.error(text, data);\n    };\n    Terminal.prototype.resize = function (x, y) {\n        if (isNaN(x) || isNaN(y)) {\n            return;\n        }\n        if (x === this.cols && y === this.rows) {\n            if (!this.charMeasure.width || !this.charMeasure.height) {\n                this.charMeasure.measure(this.options);\n            }\n            return;\n        }\n        if (x < 1)\n            x = 1;\n        if (y < 1)\n            y = 1;\n        this.buffers.resize(x, y);\n        this.cols = x;\n        this.rows = y;\n        this.buffers.setupTabStops(this.cols);\n        this.charMeasure.measure(this.options);\n        this.refresh(0, this.rows - 1);\n        this.emit('resize', { cols: x, rows: y });\n    };\n    Terminal.prototype.updateRange = function (y) {\n        if (y < this.refreshStart)\n            this.refreshStart = y;\n        if (y > this.refreshEnd)\n            this.refreshEnd = y;\n    };\n    Terminal.prototype.maxRange = function () {\n        this.refreshStart = 0;\n        this.refreshEnd = this.rows - 1;\n    };\n    Terminal.prototype.eraseRight = function (x, y) {\n        var line = this.buffer.lines.get(this.buffer.ybase + y);\n        if (!line) {\n            return;\n        }\n        var ch = [this.eraseAttr(), ' ', 1, 32];\n        for (; x < this.cols; x++) {\n            line[x] = ch;\n        }\n        this.updateRange(y);\n    };\n    Terminal.prototype.eraseLeft = function (x, y) {\n        var line = this.buffer.lines.get(this.buffer.ybase + y);\n        if (!line) {\n            return;\n        }\n        var ch = [this.eraseAttr(), ' ', 1, 32];\n        x++;\n        while (x--) {\n            line[x] = ch;\n        }\n        this.updateRange(y);\n    };\n    Terminal.prototype.clear = function () {\n        if (this.buffer.ybase === 0 && this.buffer.y === 0) {\n            return;\n        }\n        this.buffer.lines.set(0, this.buffer.lines.get(this.buffer.ybase + this.buffer.y));\n        this.buffer.lines.length = 1;\n        this.buffer.ydisp = 0;\n        this.buffer.ybase = 0;\n        this.buffer.y = 0;\n        for (var i = 1; i < this.rows; i++) {\n            this.buffer.lines.push(this.blankLine());\n        }\n        this.refresh(0, this.rows - 1);\n        this.emit('scroll', this.buffer.ydisp);\n    };\n    Terminal.prototype.eraseLine = function (y) {\n        this.eraseRight(0, y);\n    };\n    Terminal.prototype.blankLine = function (cur, isWrapped, cols) {\n        var attr = cur ? this.eraseAttr() : this.defAttr;\n        var ch = [attr, ' ', 1, 32];\n        var line = [];\n        if (isWrapped) {\n            line.isWrapped = isWrapped;\n        }\n        cols = cols || this.cols;\n        for (var i = 0; i < cols; i++) {\n            line[i] = ch;\n        }\n        return line;\n    };\n    Terminal.prototype.ch = function (cur) {\n        if (cur) {\n            return [this.eraseAttr(), ' ', 1, 32];\n        }\n        return [this.defAttr, ' ', 1, 32];\n    };\n    Terminal.prototype.is = function (term) {\n        return (this.options.termName + '').indexOf(term) === 0;\n    };\n    Terminal.prototype.handler = function (data) {\n        if (this.options.disableStdin) {\n            return;\n        }\n        if (this.selectionManager && this.selectionManager.hasSelection) {\n            this.selectionManager.clearSelection();\n        }\n        if (this.buffer.ybase !== this.buffer.ydisp) {\n            this.scrollToBottom();\n        }\n        this.emit('data', data);\n    };\n    Terminal.prototype.handleTitle = function (title) {\n        this.emit('title', title);\n    };\n    Terminal.prototype.index = function () {\n        this.buffer.y++;\n        if (this.buffer.y > this.buffer.scrollBottom) {\n            this.buffer.y--;\n            this.scroll();\n        }\n        if (this.buffer.x >= this.cols) {\n            this.buffer.x--;\n        }\n    };\n    Terminal.prototype.reverseIndex = function () {\n        if (this.buffer.y === this.buffer.scrollTop) {\n            var scrollRegionHeight = this.buffer.scrollBottom - this.buffer.scrollTop;\n            this.buffer.lines.shiftElements(this.buffer.y + this.buffer.ybase, scrollRegionHeight, 1);\n            this.buffer.lines.set(this.buffer.y + this.buffer.ybase, this.blankLine(true));\n            this.updateRange(this.buffer.scrollTop);\n            this.updateRange(this.buffer.scrollBottom);\n        }\n        else {\n            this.buffer.y--;\n        }\n    };\n    Terminal.prototype.reset = function () {\n        this.options.rows = this.rows;\n        this.options.cols = this.cols;\n        var customKeyEventHandler = this.customKeyEventHandler;\n        var inputHandler = this.inputHandler;\n        var buffers = this.buffers;\n        this.setup();\n        this.customKeyEventHandler = customKeyEventHandler;\n        this.inputHandler = inputHandler;\n        this.buffers = buffers;\n        this.refresh(0, this.rows - 1);\n        this.viewport.syncScrollArea();\n    };\n    Terminal.prototype.tabSet = function () {\n        this.buffer.tabs[this.buffer.x] = true;\n    };\n    Terminal.prototype.cancel = function (ev, force) {\n        if (!this.options.cancelEvents && !force) {\n            return;\n        }\n        ev.preventDefault();\n        ev.stopPropagation();\n        return false;\n    };\n    Terminal.prototype.matchColor = function (r1, g1, b1) {\n        return matchColor_(r1, g1, b1);\n    };\n    Terminal.prototype.visualBell = function () {\n        return this.options.bellStyle === 'visual' ||\n            this.options.bellStyle === 'both';\n    };\n    Terminal.prototype.soundBell = function () {\n        return this.options.bellStyle === 'sound' ||\n            this.options.bellStyle === 'both';\n    };\n    Terminal.prototype.syncBellSound = function () {\n        if (!this.element) {\n            return;\n        }\n        if (this.soundBell() && this.bellAudioElement) {\n            this.bellAudioElement.setAttribute('src', this.options.bellSound);\n        }\n        else if (this.soundBell()) {\n            this.bellAudioElement = document.createElement('audio');\n            this.bellAudioElement.setAttribute('preload', 'auto');\n            this.bellAudioElement.setAttribute('src', this.options.bellSound);\n            this.helperContainer.appendChild(this.bellAudioElement);\n        }\n        else if (this.bellAudioElement) {\n            this.helperContainer.removeChild(this.bellAudioElement);\n        }\n    };\n    return Terminal;\n}(EventEmitter_1.EventEmitter));\nexports.Terminal = Terminal;\nfunction globalOn(el, type, handler, capture) {\n    if (!Array.isArray(el)) {\n        el = [el];\n    }\n    el.forEach(function (element) {\n        element.addEventListener(type, handler, capture || false);\n    });\n}\nvar on = globalOn;\nfunction off(el, type, handler, capture) {\n    if (capture === void 0) { capture = false; }\n    el.removeEventListener(type, handler, capture);\n}\nfunction isThirdLevelShift(browser, ev) {\n    var thirdLevelKey = (browser.isMac && ev.altKey && !ev.ctrlKey && !ev.metaKey) ||\n        (browser.isMSWindows && ev.altKey && ev.ctrlKey && !ev.metaKey);\n    if (ev.type === 'keypress') {\n        return thirdLevelKey;\n    }\n    return thirdLevelKey && (!ev.keyCode || ev.keyCode > 47);\n}\nfunction wasMondifierKeyOnlyEvent(ev) {\n    return ev.keyCode === 16 ||\n        ev.keyCode === 17 ||\n        ev.keyCode === 18;\n}\nvar vcolors = (function () {\n    var result = ColorManager_1.DEFAULT_ANSI_COLORS.map(function (c) {\n        c = c.substring(1);\n        return [\n            parseInt(c.substring(0, 2), 16),\n            parseInt(c.substring(2, 4), 16),\n            parseInt(c.substring(4, 6), 16)\n        ];\n    });\n    var r = [0x00, 0x5f, 0x87, 0xaf, 0xd7, 0xff];\n    for (var i = 0; i < 216; i++) {\n        result.push([\n            r[(i / 36) % 6 | 0],\n            r[(i / 6) % 6 | 0],\n            r[i % 6]\n        ]);\n    }\n    var c;\n    for (var i = 0; i < 24; i++) {\n        c = 8 + i * 10;\n        result.push([c, c, c]);\n    }\n    return result;\n})();\nvar matchColorCache = {};\nfunction matchColorDistance(r1, g1, b1, r2, g2, b2) {\n    return Math.pow(30 * (r1 - r2), 2)\n        + Math.pow(59 * (g1 - g2), 2)\n        + Math.pow(11 * (b1 - b2), 2);\n}\n;\nfunction matchColor_(r1, g1, b1) {\n    var hash = (r1 << 16) | (g1 << 8) | b1;\n    if (matchColorCache[hash] != null) {\n        return matchColorCache[hash];\n    }\n    var ldiff = Infinity;\n    var li = -1;\n    var i = 0;\n    var c;\n    var r2;\n    var g2;\n    var b2;\n    var diff;\n    for (; i < vcolors.length; i++) {\n        c = vcolors[i];\n        r2 = c[0];\n        g2 = c[1];\n        b2 = c[2];\n        diff = matchColorDistance(r1, g1, b1, r2, g2, b2);\n        if (diff === 0) {\n            li = i;\n            break;\n        }\n        if (diff < ldiff) {\n            ldiff = diff;\n            li = i;\n        }\n    }\n    return matchColorCache[hash] = li;\n}\n\n\n\n},{\"./Buffer\":1,\"./BufferSet\":2,\"./CompositionHelper\":5,\"./EscapeSequences\":6,\"./EventEmitter\":7,\"./InputHandler\":8,\"./Linkifier\":9,\"./Parser\":10,\"./SelectionManager\":11,\"./Viewport\":15,\"./handlers/Clipboard\":16,\"./input/MouseZoneManager\":17,\"./renderer/CharAtlas\":19,\"./renderer/ColorManager\":20,\"./renderer/Renderer\":24,\"./utils/Browser\":28,\"./utils/CharMeasure\":29,\"./utils/MouseHelper\":32,\"./utils/Sounds\":34}],14:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LinkHoverEventTypes;\n(function (LinkHoverEventTypes) {\n    LinkHoverEventTypes[\"HOVER\"] = \"linkhover\";\n    LinkHoverEventTypes[\"TOOLTIP\"] = \"linktooltip\";\n    LinkHoverEventTypes[\"LEAVE\"] = \"linkleave\";\n})(LinkHoverEventTypes = exports.LinkHoverEventTypes || (exports.LinkHoverEventTypes = {}));\n;\n\n\n\n},{}],15:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Viewport = (function () {\n    function Viewport(terminal, viewportElement, scrollArea, charMeasure) {\n        var _this = this;\n        this.terminal = terminal;\n        this.viewportElement = viewportElement;\n        this.scrollArea = scrollArea;\n        this.charMeasure = charMeasure;\n        this.currentRowHeight = 0;\n        this.lastRecordedBufferLength = 0;\n        this.lastRecordedViewportHeight = 0;\n        this.lastRecordedBufferHeight = 0;\n        this.viewportElement.addEventListener('scroll', this.onScroll.bind(this));\n        setTimeout(function () { return _this.syncScrollArea(); }, 0);\n    }\n    Viewport.prototype.onThemeChanged = function (colors) {\n        this.viewportElement.style.backgroundColor = colors.background;\n    };\n    Viewport.prototype.refresh = function () {\n        if (this.charMeasure.height > 0) {\n            this.currentRowHeight = this.terminal.renderer.dimensions.scaledCellHeight / window.devicePixelRatio;\n            if (this.lastRecordedViewportHeight !== this.terminal.renderer.dimensions.canvasHeight) {\n                this.lastRecordedViewportHeight = this.terminal.renderer.dimensions.canvasHeight;\n                this.viewportElement.style.height = this.lastRecordedViewportHeight + 'px';\n            }\n            var newBufferHeight = Math.round(this.currentRowHeight * this.lastRecordedBufferLength);\n            if (this.lastRecordedBufferHeight !== newBufferHeight) {\n                this.lastRecordedBufferHeight = newBufferHeight;\n                this.scrollArea.style.height = this.lastRecordedBufferHeight + 'px';\n            }\n        }\n    };\n    Viewport.prototype.syncScrollArea = function () {\n        if (this.lastRecordedBufferLength !== this.terminal.buffer.lines.length) {\n            this.lastRecordedBufferLength = this.terminal.buffer.lines.length;\n            this.refresh();\n        }\n        else if (this.lastRecordedViewportHeight !== this.terminal.renderer.dimensions.canvasHeight) {\n            this.refresh();\n        }\n        else {\n            if (this.terminal.renderer.dimensions.scaledCellHeight / window.devicePixelRatio !== this.currentRowHeight) {\n                this.refresh();\n            }\n        }\n        var scrollTop = this.terminal.buffer.ydisp * this.currentRowHeight;\n        if (this.viewportElement.scrollTop !== scrollTop) {\n            this.viewportElement.scrollTop = scrollTop;\n        }\n    };\n    Viewport.prototype.onScroll = function (ev) {\n        var newRow = Math.round(this.viewportElement.scrollTop / this.currentRowHeight);\n        var diff = newRow - this.terminal.buffer.ydisp;\n        this.terminal.scrollLines(diff, true);\n    };\n    Viewport.prototype.onWheel = function (ev) {\n        if (ev.deltaY === 0) {\n            return;\n        }\n        var multiplier = 1;\n        if (ev.deltaMode === WheelEvent.DOM_DELTA_LINE) {\n            multiplier = this.currentRowHeight;\n        }\n        else if (ev.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\n            multiplier = this.currentRowHeight * this.terminal.rows;\n        }\n        this.viewportElement.scrollTop += ev.deltaY * multiplier;\n        ev.preventDefault();\n    };\n    ;\n    Viewport.prototype.onTouchStart = function (ev) {\n        this.lastTouchY = ev.touches[0].pageY;\n    };\n    ;\n    Viewport.prototype.onTouchMove = function (ev) {\n        var deltaY = this.lastTouchY - ev.touches[0].pageY;\n        this.lastTouchY = ev.touches[0].pageY;\n        if (deltaY === 0) {\n            return;\n        }\n        this.viewportElement.scrollTop += deltaY;\n        ev.preventDefault();\n    };\n    ;\n    return Viewport;\n}());\nexports.Viewport = Viewport;\n\n\n\n},{}],16:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction prepareTextForTerminal(text, isMSWindows) {\n    if (isMSWindows) {\n        return text.replace(/\\r?\\n/g, '\\r');\n    }\n    return text;\n}\nexports.prepareTextForTerminal = prepareTextForTerminal;\nfunction bracketTextForPaste(text, bracketedPasteMode) {\n    if (bracketedPasteMode) {\n        return '\\x1b[200~' + text + '\\x1b[201~';\n    }\n    return text;\n}\nexports.bracketTextForPaste = bracketTextForPaste;\nfunction copyHandler(ev, term, selectionManager) {\n    if (term.browser.isMSIE) {\n        window.clipboardData.setData('Text', selectionManager.selectionText);\n    }\n    else {\n        ev.clipboardData.setData('text/plain', selectionManager.selectionText);\n    }\n    ev.preventDefault();\n}\nexports.copyHandler = copyHandler;\nfunction pasteHandler(ev, term) {\n    ev.stopPropagation();\n    var text;\n    var dispatchPaste = function (text) {\n        text = prepareTextForTerminal(text, term.browser.isMSWindows);\n        text = bracketTextForPaste(text, term.bracketedPasteMode);\n        term.handler(text);\n        term.textarea.value = '';\n        term.emit('paste', text);\n        term.cancel(ev);\n    };\n    if (term.browser.isMSIE) {\n        if (window.clipboardData) {\n            text = window.clipboardData.getData('Text');\n            dispatchPaste(text);\n        }\n    }\n    else {\n        if (ev.clipboardData) {\n            text = ev.clipboardData.getData('text/plain');\n            dispatchPaste(text);\n        }\n    }\n}\nexports.pasteHandler = pasteHandler;\nfunction moveTextAreaUnderMouseCursor(ev, textarea) {\n    textarea.style.position = 'fixed';\n    textarea.style.width = '20px';\n    textarea.style.height = '20px';\n    textarea.style.left = (ev.clientX - 10) + 'px';\n    textarea.style.top = (ev.clientY - 10) + 'px';\n    textarea.style.zIndex = '1000';\n    textarea.focus();\n    setTimeout(function () {\n        textarea.style.position = null;\n        textarea.style.width = null;\n        textarea.style.height = null;\n        textarea.style.left = null;\n        textarea.style.top = null;\n        textarea.style.zIndex = null;\n    }, 4);\n}\nexports.moveTextAreaUnderMouseCursor = moveTextAreaUnderMouseCursor;\nfunction rightClickHandler(ev, textarea, selectionManager) {\n    moveTextAreaUnderMouseCursor(ev, textarea);\n    textarea.value = selectionManager.selectionText;\n    textarea.select();\n}\nexports.rightClickHandler = rightClickHandler;\n\n\n\n},{}],17:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar HOVER_DURATION = 500;\nvar MouseZoneManager = (function () {\n    function MouseZoneManager(_terminal) {\n        var _this = this;\n        this._terminal = _terminal;\n        this._zones = [];\n        this._areZonesActive = false;\n        this._tooltipTimeout = null;\n        this._currentZone = null;\n        this._lastHoverCoords = [null, null];\n        this._terminal.element.addEventListener('mousedown', function (e) { return _this._onMouseDown(e); });\n        this._mouseMoveListener = function (e) { return _this._onMouseMove(e); };\n        this._clickListener = function (e) { return _this._onClick(e); };\n    }\n    MouseZoneManager.prototype.add = function (zone) {\n        this._zones.push(zone);\n        if (this._zones.length === 1) {\n            this._activate();\n        }\n    };\n    MouseZoneManager.prototype.clearAll = function (start, end) {\n        if (this._zones.length === 0) {\n            return;\n        }\n        if (!end) {\n            start = 0;\n            end = this._terminal.rows - 1;\n        }\n        for (var i = 0; i < this._zones.length; i++) {\n            var zone = this._zones[i];\n            if (zone.y > start && zone.y <= end + 1) {\n                if (this._currentZone && this._currentZone === zone) {\n                    this._currentZone.leaveCallback();\n                    this._currentZone = null;\n                }\n                this._zones.splice(i--, 1);\n            }\n        }\n        if (this._zones.length === 0) {\n            this._deactivate();\n        }\n    };\n    MouseZoneManager.prototype._activate = function () {\n        if (!this._areZonesActive) {\n            this._areZonesActive = true;\n            this._terminal.element.addEventListener('mousemove', this._mouseMoveListener);\n            this._terminal.element.addEventListener('click', this._clickListener);\n        }\n    };\n    MouseZoneManager.prototype._deactivate = function () {\n        if (this._areZonesActive) {\n            this._areZonesActive = false;\n            this._terminal.element.removeEventListener('mousemove', this._mouseMoveListener);\n            this._terminal.element.removeEventListener('click', this._clickListener);\n        }\n    };\n    MouseZoneManager.prototype._onMouseMove = function (e) {\n        if (this._lastHoverCoords[0] !== e.pageX || this._lastHoverCoords[1] !== e.pageY) {\n            this._onHover(e);\n            this._lastHoverCoords = [e.pageX, e.pageY];\n        }\n    };\n    MouseZoneManager.prototype._onHover = function (e) {\n        var _this = this;\n        var zone = this._findZoneEventAt(e);\n        if (zone === this._currentZone) {\n            return;\n        }\n        if (this._currentZone) {\n            this._currentZone.leaveCallback();\n            this._currentZone = null;\n            if (this._tooltipTimeout) {\n                clearTimeout(this._tooltipTimeout);\n            }\n        }\n        if (!zone) {\n            return;\n        }\n        this._currentZone = zone;\n        if (zone.hoverCallback) {\n            zone.hoverCallback(e);\n        }\n        this._tooltipTimeout = setTimeout(function () { return _this._onTooltip(e); }, HOVER_DURATION);\n    };\n    MouseZoneManager.prototype._onTooltip = function (e) {\n        this._tooltipTimeout = null;\n        var zone = this._findZoneEventAt(e);\n        if (zone && zone.tooltipCallback) {\n            zone.tooltipCallback(e);\n        }\n    };\n    MouseZoneManager.prototype._onMouseDown = function (e) {\n        if (!this._areZonesActive) {\n            return;\n        }\n        var zone = this._findZoneEventAt(e);\n        if (zone) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n        }\n    };\n    MouseZoneManager.prototype._onClick = function (e) {\n        var zone = this._findZoneEventAt(e);\n        if (zone) {\n            zone.clickCallback(e);\n            e.preventDefault();\n            e.stopImmediatePropagation();\n        }\n    };\n    MouseZoneManager.prototype._findZoneEventAt = function (e) {\n        var coords = this._terminal.mouseHelper.getCoords(e, this._terminal.element, this._terminal.charMeasure, this._terminal.options.lineHeight, this._terminal.cols, this._terminal.rows);\n        if (!coords) {\n            return null;\n        }\n        for (var i = 0; i < this._zones.length; i++) {\n            var zone = this._zones[i];\n            if (zone.y === coords[1] && zone.x1 <= coords[0] && zone.x2 > coords[0]) {\n                return zone;\n            }\n        }\n        ;\n        return null;\n    };\n    return MouseZoneManager;\n}());\nexports.MouseZoneManager = MouseZoneManager;\nvar MouseZone = (function () {\n    function MouseZone(x1, x2, y, clickCallback, hoverCallback, tooltipCallback, leaveCallback) {\n        this.x1 = x1;\n        this.x2 = x2;\n        this.y = y;\n        this.clickCallback = clickCallback;\n        this.hoverCallback = hoverCallback;\n        this.tooltipCallback = tooltipCallback;\n        this.leaveCallback = leaveCallback;\n    }\n    return MouseZone;\n}());\nexports.MouseZone = MouseZone;\n\n\n\n},{}],18:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CharAtlas_1 = require(\"./CharAtlas\");\nvar Buffer_1 = require(\"../Buffer\");\nexports.INVERTED_DEFAULT_COLOR = -1;\nvar DIM_OPACITY = 0.5;\nvar BaseRenderLayer = (function () {\n    function BaseRenderLayer(container, id, zIndex, _alpha, _colors) {\n        this._alpha = _alpha;\n        this._colors = _colors;\n        this._scaledCharWidth = 0;\n        this._scaledCharHeight = 0;\n        this._scaledCellWidth = 0;\n        this._scaledCellHeight = 0;\n        this._scaledCharLeft = 0;\n        this._scaledCharTop = 0;\n        this._canvas = document.createElement('canvas');\n        this._canvas.id = \"xterm-\" + id + \"-layer\";\n        this._canvas.style.zIndex = zIndex.toString();\n        this._ctx = this._canvas.getContext('2d', { alpha: _alpha });\n        this._ctx.scale(window.devicePixelRatio, window.devicePixelRatio);\n        if (!_alpha) {\n            this.clearAll();\n        }\n        container.appendChild(this._canvas);\n    }\n    BaseRenderLayer.prototype.onOptionsChanged = function (terminal) { };\n    BaseRenderLayer.prototype.onBlur = function (terminal) { };\n    BaseRenderLayer.prototype.onFocus = function (terminal) { };\n    BaseRenderLayer.prototype.onCursorMove = function (terminal) { };\n    BaseRenderLayer.prototype.onGridChanged = function (terminal, startRow, endRow) { };\n    BaseRenderLayer.prototype.onSelectionChanged = function (terminal, start, end) { };\n    BaseRenderLayer.prototype.onThemeChanged = function (terminal, colorSet) {\n        this._refreshCharAtlas(terminal, colorSet);\n    };\n    BaseRenderLayer.prototype._refreshCharAtlas = function (terminal, colorSet) {\n        var _this = this;\n        if (this._scaledCharWidth <= 0 && this._scaledCharHeight <= 0) {\n            return;\n        }\n        this._charAtlas = null;\n        var result = CharAtlas_1.acquireCharAtlas(terminal, this._colors, this._scaledCharWidth, this._scaledCharHeight);\n        if (result instanceof HTMLCanvasElement) {\n            this._charAtlas = result;\n        }\n        else {\n            result.then(function (bitmap) { return _this._charAtlas = bitmap; });\n        }\n    };\n    BaseRenderLayer.prototype.resize = function (terminal, dim, charSizeChanged) {\n        this._scaledCellWidth = dim.scaledCellWidth;\n        this._scaledCellHeight = dim.scaledCellHeight;\n        this._scaledCharWidth = dim.scaledCharWidth;\n        this._scaledCharHeight = dim.scaledCharHeight;\n        this._scaledCharLeft = dim.scaledCharLeft;\n        this._scaledCharTop = dim.scaledCharTop;\n        this._canvas.width = dim.scaledCanvasWidth;\n        this._canvas.height = dim.scaledCanvasHeight;\n        this._canvas.style.width = dim.canvasWidth + \"px\";\n        this._canvas.style.height = dim.canvasHeight + \"px\";\n        if (!this._alpha) {\n            this.clearAll();\n        }\n        if (charSizeChanged) {\n            this._refreshCharAtlas(terminal, this._colors);\n        }\n    };\n    BaseRenderLayer.prototype.fillCells = function (x, y, width, height) {\n        this._ctx.fillRect(x * this._scaledCellWidth, y * this._scaledCellHeight, width * this._scaledCellWidth, height * this._scaledCellHeight);\n    };\n    BaseRenderLayer.prototype.fillBottomLineAtCells = function (x, y, width) {\n        if (width === void 0) { width = 1; }\n        this._ctx.fillRect(x * this._scaledCellWidth, (y + 1) * this._scaledCellHeight - window.devicePixelRatio - 1, width * this._scaledCellWidth, window.devicePixelRatio);\n    };\n    BaseRenderLayer.prototype.fillLeftLineAtCell = function (x, y) {\n        this._ctx.fillRect(x * this._scaledCellWidth, y * this._scaledCellHeight, window.devicePixelRatio, this._scaledCellHeight);\n    };\n    BaseRenderLayer.prototype.strokeRectAtCell = function (x, y, width, height) {\n        this._ctx.lineWidth = window.devicePixelRatio;\n        this._ctx.strokeRect(x * this._scaledCellWidth + window.devicePixelRatio / 2, y * this._scaledCellHeight + (window.devicePixelRatio / 2), width * this._scaledCellWidth - window.devicePixelRatio, (height * this._scaledCellHeight) - window.devicePixelRatio);\n    };\n    BaseRenderLayer.prototype.clearAll = function () {\n        if (this._alpha) {\n            this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n        }\n        else {\n            this._ctx.fillStyle = this._colors.background;\n            this._ctx.fillRect(0, 0, this._canvas.width, this._canvas.height);\n        }\n    };\n    BaseRenderLayer.prototype.clearCells = function (x, y, width, height) {\n        if (this._alpha) {\n            this._ctx.clearRect(x * this._scaledCellWidth, y * this._scaledCellHeight, width * this._scaledCellWidth, height * this._scaledCellHeight);\n        }\n        else {\n            this._ctx.fillStyle = this._colors.background;\n            this._ctx.fillRect(x * this._scaledCellWidth, y * this._scaledCellHeight, width * this._scaledCellWidth, height * this._scaledCellHeight);\n        }\n    };\n    BaseRenderLayer.prototype.fillCharTrueColor = function (terminal, charData, x, y) {\n        this._ctx.font = terminal.options.fontSize * window.devicePixelRatio + \"px \" + terminal.options.fontFamily;\n        this._ctx.textBaseline = 'top';\n        this._clipRow(terminal, y);\n        this._ctx.fillText(charData[Buffer_1.CHAR_DATA_CHAR_INDEX], x * this._scaledCellWidth + this._scaledCharLeft, y * this._scaledCellHeight + this._scaledCharTop);\n    };\n    BaseRenderLayer.prototype.drawChar = function (terminal, char, code, width, x, y, fg, bg, bold, dim) {\n        var colorIndex = 0;\n        if (fg < 256) {\n            colorIndex = fg + 2;\n        }\n        else {\n            if (bold && terminal.options.enableBold) {\n                colorIndex = 1;\n            }\n        }\n        var isAscii = code < 256;\n        var isBasicColor = (colorIndex > 1 && fg < 16) && (fg < 8 || bold);\n        var isDefaultColor = fg >= 256;\n        var isDefaultBackground = bg >= 256;\n        if (this._charAtlas && isAscii && (isBasicColor || isDefaultColor) && isDefaultBackground) {\n            var charAtlasCellWidth = this._scaledCharWidth + CharAtlas_1.CHAR_ATLAS_CELL_SPACING;\n            var charAtlasCellHeight = this._scaledCharHeight + CharAtlas_1.CHAR_ATLAS_CELL_SPACING;\n            if (dim) {\n                this._ctx.globalAlpha = DIM_OPACITY;\n            }\n            if (bold && !terminal.options.enableBold) {\n                if (colorIndex > 1) {\n                    colorIndex -= 8;\n                }\n            }\n            this._ctx.drawImage(this._charAtlas, code * charAtlasCellWidth, colorIndex * charAtlasCellHeight, charAtlasCellWidth, this._scaledCharHeight, x * this._scaledCellWidth + this._scaledCharLeft, y * this._scaledCellHeight + this._scaledCharTop, charAtlasCellWidth, this._scaledCharHeight);\n        }\n        else {\n            this._drawUncachedChar(terminal, char, width, fg, x, y, bold, dim);\n        }\n    };\n    BaseRenderLayer.prototype._drawUncachedChar = function (terminal, char, width, fg, x, y, bold, dim) {\n        this._ctx.save();\n        this._ctx.font = terminal.options.fontSize * window.devicePixelRatio + \"px \" + terminal.options.fontFamily;\n        if (bold && terminal.options.enableBold) {\n            this._ctx.font = \"bold \" + this._ctx.font;\n        }\n        this._ctx.textBaseline = 'top';\n        if (fg === exports.INVERTED_DEFAULT_COLOR) {\n            this._ctx.fillStyle = this._colors.background;\n        }\n        else if (fg < 256) {\n            this._ctx.fillStyle = this._colors.ansi[fg];\n        }\n        else {\n            this._ctx.fillStyle = this._colors.foreground;\n        }\n        this._clipRow(terminal, y);\n        if (dim) {\n            this._ctx.globalAlpha = DIM_OPACITY;\n        }\n        this._ctx.fillText(char, x * this._scaledCellWidth + this._scaledCharLeft, y * this._scaledCellHeight + this._scaledCharTop);\n        this._ctx.restore();\n    };\n    BaseRenderLayer.prototype._clipRow = function (terminal, y) {\n        this._ctx.beginPath();\n        this._ctx.rect(0, y * this._scaledCellHeight, terminal.cols * this._scaledCellWidth, this._scaledCellHeight);\n        this._ctx.clip();\n    };\n    return BaseRenderLayer;\n}());\nexports.BaseRenderLayer = BaseRenderLayer;\n\n\n\n},{\"../Buffer\":1,\"./CharAtlas\":19}],19:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Browser_1 = require(\"../utils/Browser\");\nexports.CHAR_ATLAS_CELL_SPACING = 1;\nvar charAtlasCache = [];\nfunction acquireCharAtlas(terminal, colors, scaledCharWidth, scaledCharHeight) {\n    var newConfig = generateConfig(scaledCharWidth, scaledCharHeight, terminal, colors);\n    for (var i = 0; i < charAtlasCache.length; i++) {\n        var entry = charAtlasCache[i];\n        var ownedByIndex = entry.ownedBy.indexOf(terminal);\n        if (ownedByIndex >= 0) {\n            if (configEquals(entry.config, newConfig)) {\n                return entry.bitmap;\n            }\n            else {\n                if (entry.ownedBy.length === 1) {\n                    charAtlasCache.splice(i, 1);\n                }\n                else {\n                    entry.ownedBy.splice(ownedByIndex, 1);\n                }\n                break;\n            }\n        }\n    }\n    for (var i = 0; i < charAtlasCache.length; i++) {\n        var entry = charAtlasCache[i];\n        if (configEquals(entry.config, newConfig)) {\n            entry.ownedBy.push(terminal);\n            return entry.bitmap;\n        }\n    }\n    var newEntry = {\n        bitmap: generator.generate(scaledCharWidth, scaledCharHeight, terminal.options.fontSize, terminal.options.fontFamily, colors.background, colors.foreground, colors.ansi),\n        config: newConfig,\n        ownedBy: [terminal]\n    };\n    charAtlasCache.push(newEntry);\n    return newEntry.bitmap;\n}\nexports.acquireCharAtlas = acquireCharAtlas;\nfunction generateConfig(scaledCharWidth, scaledCharHeight, terminal, colors) {\n    var clonedColors = {\n        foreground: colors.foreground,\n        background: colors.background,\n        cursor: null,\n        cursorAccent: null,\n        selection: null,\n        ansi: colors.ansi.slice(0, 16)\n    };\n    return {\n        scaledCharWidth: scaledCharWidth,\n        scaledCharHeight: scaledCharHeight,\n        fontFamily: terminal.options.fontFamily,\n        fontSize: terminal.options.fontSize,\n        colors: clonedColors\n    };\n}\nfunction configEquals(a, b) {\n    for (var i = 0; i < a.colors.ansi.length; i++) {\n        if (a.colors.ansi[i] !== b.colors.ansi[i]) {\n            return false;\n        }\n    }\n    return a.fontFamily === b.fontFamily &&\n        a.fontSize === b.fontSize &&\n        a.scaledCharWidth === b.scaledCharWidth &&\n        a.scaledCharHeight === b.scaledCharHeight &&\n        a.colors.foreground === b.colors.foreground &&\n        a.colors.background === b.colors.background;\n}\nvar generator;\nfunction initialize(document) {\n    if (!generator) {\n        generator = new CharAtlasGenerator(document);\n    }\n}\nexports.initialize = initialize;\nvar CharAtlasGenerator = (function () {\n    function CharAtlasGenerator(_document) {\n        this._document = _document;\n        this._canvas = this._document.createElement('canvas');\n        this._ctx = this._canvas.getContext('2d', { alpha: false });\n        this._ctx.scale(window.devicePixelRatio, window.devicePixelRatio);\n    }\n    CharAtlasGenerator.prototype.generate = function (scaledCharWidth, scaledCharHeight, fontSize, fontFamily, background, foreground, ansiColors) {\n        var cellWidth = scaledCharWidth + exports.CHAR_ATLAS_CELL_SPACING;\n        var cellHeight = scaledCharHeight + exports.CHAR_ATLAS_CELL_SPACING;\n        this._canvas.width = 255 * cellWidth;\n        this._canvas.height = (2 + 16) * cellHeight;\n        this._ctx.fillStyle = background;\n        this._ctx.fillRect(0, 0, this._canvas.width, this._canvas.height);\n        this._ctx.save();\n        this._ctx.fillStyle = foreground;\n        this._ctx.font = fontSize * window.devicePixelRatio + \"px \" + fontFamily;\n        this._ctx.textBaseline = 'top';\n        for (var i = 0; i < 256; i++) {\n            this._ctx.save();\n            this._ctx.beginPath();\n            this._ctx.rect(i * cellWidth, 0, cellWidth, cellHeight);\n            this._ctx.clip();\n            this._ctx.fillText(String.fromCharCode(i), i * cellWidth, 0);\n            this._ctx.restore();\n        }\n        this._ctx.save();\n        this._ctx.font = \"bold \" + this._ctx.font;\n        for (var i = 0; i < 256; i++) {\n            this._ctx.save();\n            this._ctx.beginPath();\n            this._ctx.rect(i * cellWidth, cellHeight, cellWidth, cellHeight);\n            this._ctx.clip();\n            this._ctx.fillText(String.fromCharCode(i), i * cellWidth, cellHeight);\n            this._ctx.restore();\n        }\n        this._ctx.restore();\n        this._ctx.font = fontSize * window.devicePixelRatio + \"px \" + fontFamily;\n        for (var colorIndex = 0; colorIndex < 16; colorIndex++) {\n            if (colorIndex === 8) {\n                this._ctx.font = \"bold \" + this._ctx.font;\n            }\n            var y = (colorIndex + 2) * cellHeight;\n            for (var i = 0; i < 256; i++) {\n                this._ctx.save();\n                this._ctx.beginPath();\n                this._ctx.rect(i * cellWidth, y, cellWidth, cellHeight);\n                this._ctx.clip();\n                this._ctx.fillStyle = ansiColors[colorIndex];\n                this._ctx.fillText(String.fromCharCode(i), i * cellWidth, y);\n                this._ctx.restore();\n            }\n        }\n        this._ctx.restore();\n        if (!('createImageBitmap' in window) || Browser_1.isFirefox) {\n            var result = this._canvas;\n            this._canvas = this._document.createElement('canvas');\n            this._ctx = this._canvas.getContext('2d');\n            this._ctx.scale(window.devicePixelRatio, window.devicePixelRatio);\n            return result;\n        }\n        var charAtlasImageData = this._ctx.getImageData(0, 0, this._canvas.width, this._canvas.height);\n        var r = parseInt(background.substr(1, 2), 16);\n        var g = parseInt(background.substr(3, 2), 16);\n        var b = parseInt(background.substr(5, 2), 16);\n        this._clearColor(charAtlasImageData, r, g, b);\n        var promise = window.createImageBitmap(charAtlasImageData);\n        this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n        return promise;\n    };\n    CharAtlasGenerator.prototype._clearColor = function (imageData, r, g, b) {\n        for (var offset = 0; offset < imageData.data.length; offset += 4) {\n            if (imageData.data[offset] === r &&\n                imageData.data[offset + 1] === g &&\n                imageData.data[offset + 2] === b) {\n                imageData.data[offset + 3] = 0;\n            }\n        }\n    };\n    return CharAtlasGenerator;\n}());\n\n\n\n},{\"../utils/Browser\":28}],20:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar DEFAULT_FOREGROUND = '#ffffff';\nvar DEFAULT_BACKGROUND = '#000000';\nvar DEFAULT_CURSOR = '#ffffff';\nvar DEFAULT_CURSOR_ACCENT = '#000000';\nvar DEFAULT_SELECTION = 'rgba(255, 255, 255, 0.3)';\nexports.DEFAULT_ANSI_COLORS = [\n    '#2e3436',\n    '#cc0000',\n    '#4e9a06',\n    '#c4a000',\n    '#3465a4',\n    '#75507b',\n    '#06989a',\n    '#d3d7cf',\n    '#555753',\n    '#ef2929',\n    '#8ae234',\n    '#fce94f',\n    '#729fcf',\n    '#ad7fa8',\n    '#34e2e2',\n    '#eeeeec'\n];\nfunction generate256Colors(first16Colors) {\n    var colors = first16Colors.slice();\n    var v = [0x00, 0x5f, 0x87, 0xaf, 0xd7, 0xff];\n    for (var i = 0; i < 216; i++) {\n        var r = toPaddedHex(v[(i / 36) % 6 | 0]);\n        var g = toPaddedHex(v[(i / 6) % 6 | 0]);\n        var b = toPaddedHex(v[i % 6]);\n        colors.push(\"#\" + r + g + b);\n    }\n    for (var i = 0; i < 24; i++) {\n        var c = toPaddedHex(8 + i * 10);\n        colors.push(\"#\" + c + c + c);\n    }\n    return colors;\n}\nfunction toPaddedHex(c) {\n    var s = c.toString(16);\n    return s.length < 2 ? '0' + s : s;\n}\nvar ColorManager = (function () {\n    function ColorManager() {\n        this.colors = {\n            foreground: DEFAULT_FOREGROUND,\n            background: DEFAULT_BACKGROUND,\n            cursor: DEFAULT_CURSOR,\n            cursorAccent: DEFAULT_CURSOR_ACCENT,\n            selection: DEFAULT_SELECTION,\n            ansi: generate256Colors(exports.DEFAULT_ANSI_COLORS)\n        };\n    }\n    ColorManager.prototype.setTheme = function (theme) {\n        this.colors.foreground = theme.foreground || DEFAULT_FOREGROUND;\n        this.colors.background = this._validateColor(theme.background, DEFAULT_BACKGROUND);\n        this.colors.cursor = theme.cursor || DEFAULT_CURSOR;\n        this.colors.cursorAccent = theme.cursorAccent || DEFAULT_CURSOR_ACCENT;\n        this.colors.selection = theme.selection || DEFAULT_SELECTION;\n        this.colors.ansi[0] = theme.black || exports.DEFAULT_ANSI_COLORS[0];\n        this.colors.ansi[1] = theme.red || exports.DEFAULT_ANSI_COLORS[1];\n        this.colors.ansi[2] = theme.green || exports.DEFAULT_ANSI_COLORS[2];\n        this.colors.ansi[3] = theme.yellow || exports.DEFAULT_ANSI_COLORS[3];\n        this.colors.ansi[4] = theme.blue || exports.DEFAULT_ANSI_COLORS[4];\n        this.colors.ansi[5] = theme.magenta || exports.DEFAULT_ANSI_COLORS[5];\n        this.colors.ansi[6] = theme.cyan || exports.DEFAULT_ANSI_COLORS[6];\n        this.colors.ansi[7] = theme.white || exports.DEFAULT_ANSI_COLORS[7];\n        this.colors.ansi[8] = theme.brightBlack || exports.DEFAULT_ANSI_COLORS[8];\n        this.colors.ansi[9] = theme.brightRed || exports.DEFAULT_ANSI_COLORS[9];\n        this.colors.ansi[10] = theme.brightGreen || exports.DEFAULT_ANSI_COLORS[10];\n        this.colors.ansi[11] = theme.brightYellow || exports.DEFAULT_ANSI_COLORS[11];\n        this.colors.ansi[12] = theme.brightBlue || exports.DEFAULT_ANSI_COLORS[12];\n        this.colors.ansi[13] = theme.brightMagenta || exports.DEFAULT_ANSI_COLORS[13];\n        this.colors.ansi[14] = theme.brightCyan || exports.DEFAULT_ANSI_COLORS[14];\n        this.colors.ansi[15] = theme.brightWhite || exports.DEFAULT_ANSI_COLORS[15];\n    };\n    ColorManager.prototype._validateColor = function (color, fallback) {\n        if (!color) {\n            return fallback;\n        }\n        if (color.length === 7 && color.charAt(0) === '#') {\n            return color;\n        }\n        if (color.length === 4 && color.charAt(0) === '#') {\n            var r = color.charAt(1);\n            var g = color.charAt(2);\n            var b = color.charAt(3);\n            return \"#\" + r + r + g + g + b + b;\n        }\n        return fallback;\n    };\n    return ColorManager;\n}());\nexports.ColorManager = ColorManager;\n\n\n\n},{}],21:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"../Buffer\");\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar BLINK_INTERVAL = 600;\nvar CursorRenderLayer = (function (_super) {\n    __extends(CursorRenderLayer, _super);\n    function CursorRenderLayer(container, zIndex, colors) {\n        var _this = _super.call(this, container, 'cursor', zIndex, true, colors) || this;\n        _this._state = {\n            x: null,\n            y: null,\n            isFocused: null,\n            style: null,\n            width: null,\n        };\n        _this._cursorRenderers = {\n            'bar': _this._renderBarCursor.bind(_this),\n            'block': _this._renderBlockCursor.bind(_this),\n            'underline': _this._renderUnderlineCursor.bind(_this)\n        };\n        return _this;\n    }\n    CursorRenderLayer.prototype.resize = function (terminal, dim, charSizeChanged) {\n        _super.prototype.resize.call(this, terminal, dim, charSizeChanged);\n        this._state = {\n            x: null,\n            y: null,\n            isFocused: null,\n            style: null,\n            width: null,\n        };\n    };\n    CursorRenderLayer.prototype.reset = function (terminal) {\n        this._clearCursor();\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.dispose();\n            this._cursorBlinkStateManager = null;\n            this.onOptionsChanged(terminal);\n        }\n    };\n    CursorRenderLayer.prototype.onBlur = function (terminal) {\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.pause();\n        }\n        terminal.refresh(terminal.buffer.y, terminal.buffer.y);\n    };\n    CursorRenderLayer.prototype.onFocus = function (terminal) {\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.resume(terminal);\n        }\n        else {\n            terminal.refresh(terminal.buffer.y, terminal.buffer.y);\n        }\n    };\n    CursorRenderLayer.prototype.onOptionsChanged = function (terminal) {\n        var _this = this;\n        if (terminal.options.cursorBlink) {\n            if (!this._cursorBlinkStateManager) {\n                this._cursorBlinkStateManager = new CursorBlinkStateManager(terminal, function () {\n                    _this._render(terminal, true);\n                });\n            }\n        }\n        else {\n            if (this._cursorBlinkStateManager) {\n                this._cursorBlinkStateManager.dispose();\n                this._cursorBlinkStateManager = null;\n            }\n            terminal.refresh(terminal.buffer.y, terminal.buffer.y);\n        }\n    };\n    CursorRenderLayer.prototype.onCursorMove = function (terminal) {\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.restartBlinkAnimation(terminal);\n        }\n    };\n    CursorRenderLayer.prototype.onGridChanged = function (terminal, startRow, endRow) {\n        if (!this._cursorBlinkStateManager || this._cursorBlinkStateManager.isPaused) {\n            this._render(terminal, false);\n        }\n    };\n    CursorRenderLayer.prototype._render = function (terminal, triggeredByAnimationFrame) {\n        if (!terminal.cursorState || terminal.cursorHidden) {\n            this._clearCursor();\n            return;\n        }\n        var cursorY = terminal.buffer.ybase + terminal.buffer.y;\n        var viewportRelativeCursorY = cursorY - terminal.buffer.ydisp;\n        if (viewportRelativeCursorY < 0 || viewportRelativeCursorY >= terminal.rows) {\n            this._clearCursor();\n            return;\n        }\n        var charData = terminal.buffer.lines.get(cursorY)[terminal.buffer.x];\n        if (!charData) {\n            return;\n        }\n        if (!terminal.isFocused) {\n            this._clearCursor();\n            this._ctx.save();\n            this._ctx.fillStyle = this._colors.cursor;\n            this._renderBlurCursor(terminal, terminal.buffer.x, viewportRelativeCursorY, charData);\n            this._ctx.restore();\n            this._state.x = terminal.buffer.x;\n            this._state.y = viewportRelativeCursorY;\n            this._state.isFocused = false;\n            this._state.style = terminal.options.cursorStyle;\n            this._state.width = charData[Buffer_1.CHAR_DATA_WIDTH_INDEX];\n            return;\n        }\n        if (this._cursorBlinkStateManager && !this._cursorBlinkStateManager.isCursorVisible) {\n            this._clearCursor();\n            return;\n        }\n        if (this._state) {\n            if (this._state.x === terminal.buffer.x &&\n                this._state.y === viewportRelativeCursorY &&\n                this._state.isFocused === terminal.isFocused &&\n                this._state.style === terminal.options.cursorStyle &&\n                this._state.width === charData[Buffer_1.CHAR_DATA_WIDTH_INDEX]) {\n                return;\n            }\n            this._clearCursor();\n        }\n        this._ctx.save();\n        this._cursorRenderers[terminal.options.cursorStyle || 'block'](terminal, terminal.buffer.x, viewportRelativeCursorY, charData);\n        this._ctx.restore();\n        this._state.x = terminal.buffer.x;\n        this._state.y = viewportRelativeCursorY;\n        this._state.isFocused = false;\n        this._state.style = terminal.options.cursorStyle;\n        this._state.width = charData[Buffer_1.CHAR_DATA_WIDTH_INDEX];\n    };\n    CursorRenderLayer.prototype._clearCursor = function () {\n        if (this._state) {\n            this.clearCells(this._state.x, this._state.y, this._state.width, 1);\n            this._state = {\n                x: null,\n                y: null,\n                isFocused: null,\n                style: null,\n                width: null,\n            };\n        }\n    };\n    CursorRenderLayer.prototype._renderBarCursor = function (terminal, x, y, charData) {\n        this._ctx.save();\n        this._ctx.fillStyle = this._colors.cursor;\n        this.fillLeftLineAtCell(x, y);\n        this._ctx.restore();\n    };\n    CursorRenderLayer.prototype._renderBlockCursor = function (terminal, x, y, charData) {\n        this._ctx.save();\n        this._ctx.fillStyle = this._colors.cursor;\n        this.fillCells(x, y, charData[Buffer_1.CHAR_DATA_WIDTH_INDEX], 1);\n        this._ctx.fillStyle = this._colors.cursorAccent;\n        this.fillCharTrueColor(terminal, charData, x, y);\n        this._ctx.restore();\n    };\n    CursorRenderLayer.prototype._renderUnderlineCursor = function (terminal, x, y, charData) {\n        this._ctx.save();\n        this._ctx.fillStyle = this._colors.cursor;\n        this.fillBottomLineAtCells(x, y);\n        this._ctx.restore();\n    };\n    CursorRenderLayer.prototype._renderBlurCursor = function (terminal, x, y, charData) {\n        this._ctx.save();\n        this._ctx.strokeStyle = this._colors.cursor;\n        this.strokeRectAtCell(x, y, charData[Buffer_1.CHAR_DATA_WIDTH_INDEX], 1);\n        this._ctx.restore();\n    };\n    return CursorRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.CursorRenderLayer = CursorRenderLayer;\nvar CursorBlinkStateManager = (function () {\n    function CursorBlinkStateManager(terminal, renderCallback) {\n        this.renderCallback = renderCallback;\n        this.isCursorVisible = true;\n        if (terminal.isFocused) {\n            this._restartInterval();\n        }\n    }\n    Object.defineProperty(CursorBlinkStateManager.prototype, \"isPaused\", {\n        get: function () { return !(this._blinkStartTimeout || this._blinkInterval); },\n        enumerable: true,\n        configurable: true\n    });\n    CursorBlinkStateManager.prototype.dispose = function () {\n        if (this._blinkInterval) {\n            window.clearInterval(this._blinkInterval);\n            this._blinkInterval = null;\n        }\n        if (this._blinkStartTimeout) {\n            window.clearTimeout(this._blinkStartTimeout);\n            this._blinkStartTimeout = null;\n        }\n        if (this._animationFrame) {\n            window.cancelAnimationFrame(this._animationFrame);\n            this._animationFrame = null;\n        }\n    };\n    CursorBlinkStateManager.prototype.restartBlinkAnimation = function (terminal) {\n        var _this = this;\n        if (this.isPaused) {\n            return;\n        }\n        this._animationTimeRestarted = Date.now();\n        this.isCursorVisible = true;\n        if (!this._animationFrame) {\n            this._animationFrame = window.requestAnimationFrame(function () {\n                _this.renderCallback();\n                _this._animationFrame = null;\n            });\n        }\n    };\n    CursorBlinkStateManager.prototype._restartInterval = function (timeToStart) {\n        var _this = this;\n        if (timeToStart === void 0) { timeToStart = BLINK_INTERVAL; }\n        if (this._blinkInterval) {\n            window.clearInterval(this._blinkInterval);\n        }\n        this._blinkStartTimeout = setTimeout(function () {\n            if (_this._animationTimeRestarted) {\n                var time = BLINK_INTERVAL - (Date.now() - _this._animationTimeRestarted);\n                _this._animationTimeRestarted = null;\n                if (time > 0) {\n                    _this._restartInterval(time);\n                    return;\n                }\n            }\n            _this.isCursorVisible = false;\n            _this._animationFrame = window.requestAnimationFrame(function () {\n                _this.renderCallback();\n                _this._animationFrame = null;\n            });\n            _this._blinkInterval = setInterval(function () {\n                if (_this._animationTimeRestarted) {\n                    var time = BLINK_INTERVAL - (Date.now() - _this._animationTimeRestarted);\n                    _this._animationTimeRestarted = null;\n                    _this._restartInterval(time);\n                    return;\n                }\n                _this.isCursorVisible = !_this.isCursorVisible;\n                _this._animationFrame = window.requestAnimationFrame(function () {\n                    _this.renderCallback();\n                    _this._animationFrame = null;\n                });\n            }, BLINK_INTERVAL);\n        }, timeToStart);\n    };\n    CursorBlinkStateManager.prototype.pause = function () {\n        this.isCursorVisible = true;\n        if (this._blinkInterval) {\n            window.clearInterval(this._blinkInterval);\n            this._blinkInterval = null;\n        }\n        if (this._blinkStartTimeout) {\n            window.clearTimeout(this._blinkStartTimeout);\n            this._blinkStartTimeout = null;\n        }\n        if (this._animationFrame) {\n            window.cancelAnimationFrame(this._animationFrame);\n            this._animationFrame = null;\n        }\n    };\n    CursorBlinkStateManager.prototype.resume = function (terminal) {\n        this._animationTimeRestarted = null;\n        this._restartInterval();\n        this.restartBlinkAnimation(terminal);\n    };\n    return CursorBlinkStateManager;\n}());\n\n\n\n},{\"../Buffer\":1,\"./BaseRenderLayer\":18}],22:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar GridCache = (function () {\n    function GridCache() {\n        this.cache = [];\n    }\n    GridCache.prototype.resize = function (width, height) {\n        for (var x = 0; x < width; x++) {\n            if (this.cache.length <= x) {\n                this.cache.push([]);\n            }\n            for (var y = this.cache[x].length; y < height; y++) {\n                this.cache[x].push(null);\n            }\n            this.cache[x].length = height;\n        }\n        this.cache.length = width;\n    };\n    GridCache.prototype.clear = function () {\n        for (var x = 0; x < this.cache.length; x++) {\n            for (var y = 0; y < this.cache[x].length; y++) {\n                this.cache[x][y] = null;\n            }\n        }\n    };\n    return GridCache;\n}());\nexports.GridCache = GridCache;\n\n\n\n},{}],23:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar Types_1 = require(\"../Types\");\nvar LinkRenderLayer = (function (_super) {\n    __extends(LinkRenderLayer, _super);\n    function LinkRenderLayer(container, zIndex, colors, terminal) {\n        var _this = _super.call(this, container, 'link', zIndex, true, colors) || this;\n        _this._state = null;\n        terminal.linkifier.on(Types_1.LinkHoverEventTypes.HOVER, function (e) { return _this._onLinkHover(e); });\n        terminal.linkifier.on(Types_1.LinkHoverEventTypes.LEAVE, function (e) { return _this._onLinkLeave(e); });\n        return _this;\n    }\n    LinkRenderLayer.prototype.resize = function (terminal, dim, charSizeChanged) {\n        _super.prototype.resize.call(this, terminal, dim, charSizeChanged);\n        this._state = null;\n    };\n    LinkRenderLayer.prototype.reset = function (terminal) {\n        this._clearCurrentLink();\n    };\n    LinkRenderLayer.prototype._clearCurrentLink = function () {\n        if (this._state) {\n            this.clearCells(this._state.x, this._state.y, this._state.length, 1);\n            this._state = null;\n        }\n    };\n    LinkRenderLayer.prototype._onLinkHover = function (e) {\n        this._ctx.fillStyle = this._colors.foreground;\n        this.fillBottomLineAtCells(e.x, e.y, e.length);\n        this._state = e;\n    };\n    LinkRenderLayer.prototype._onLinkLeave = function (e) {\n        this._clearCurrentLink();\n    };\n    return LinkRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.LinkRenderLayer = LinkRenderLayer;\n\n\n\n},{\"../Types\":14,\"./BaseRenderLayer\":18}],24:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TextRenderLayer_1 = require(\"./TextRenderLayer\");\nvar SelectionRenderLayer_1 = require(\"./SelectionRenderLayer\");\nvar CursorRenderLayer_1 = require(\"./CursorRenderLayer\");\nvar ColorManager_1 = require(\"./ColorManager\");\nvar LinkRenderLayer_1 = require(\"./LinkRenderLayer\");\nvar EventEmitter_1 = require(\"../EventEmitter\");\nvar ScreenDprMonitor_1 = require(\"../utils/ScreenDprMonitor\");\nvar Renderer = (function (_super) {\n    __extends(Renderer, _super);\n    function Renderer(_terminal, theme) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._refreshRowsQueue = [];\n        _this._refreshAnimationFrame = null;\n        _this._isPaused = false;\n        _this._needsFullRefresh = false;\n        _this.colorManager = new ColorManager_1.ColorManager();\n        if (theme) {\n            _this.colorManager.setTheme(theme);\n        }\n        _this._renderLayers = [\n            new TextRenderLayer_1.TextRenderLayer(_this._terminal.element, 0, _this.colorManager.colors),\n            new SelectionRenderLayer_1.SelectionRenderLayer(_this._terminal.element, 1, _this.colorManager.colors),\n            new LinkRenderLayer_1.LinkRenderLayer(_this._terminal.element, 2, _this.colorManager.colors, _this._terminal),\n            new CursorRenderLayer_1.CursorRenderLayer(_this._terminal.element, 3, _this.colorManager.colors)\n        ];\n        _this.dimensions = {\n            scaledCharWidth: null,\n            scaledCharHeight: null,\n            scaledCellWidth: null,\n            scaledCellHeight: null,\n            scaledCharLeft: null,\n            scaledCharTop: null,\n            scaledCanvasWidth: null,\n            scaledCanvasHeight: null,\n            canvasWidth: null,\n            canvasHeight: null,\n            actualCellWidth: null,\n            actualCellHeight: null\n        };\n        _this._devicePixelRatio = window.devicePixelRatio;\n        _this._updateDimensions();\n        _this._screenDprMonitor = new ScreenDprMonitor_1.ScreenDprMonitor();\n        _this._screenDprMonitor.setListener(function () { return _this.onWindowResize(window.devicePixelRatio); });\n        if ('IntersectionObserver' in window) {\n            var observer = new IntersectionObserver(function (e) { return _this.onIntersectionChange(e[0]); }, { threshold: 0 });\n            observer.observe(_this._terminal.element);\n        }\n        return _this;\n    }\n    Renderer.prototype.onIntersectionChange = function (entry) {\n        this._isPaused = entry.intersectionRatio === 0;\n        if (!this._isPaused && this._needsFullRefresh) {\n            this._terminal.refresh(0, this._terminal.rows - 1);\n        }\n    };\n    Renderer.prototype.onWindowResize = function (devicePixelRatio) {\n        if (this._devicePixelRatio !== devicePixelRatio) {\n            this._devicePixelRatio = devicePixelRatio;\n            this.onResize(this._terminal.cols, this._terminal.rows, true);\n        }\n    };\n    Renderer.prototype.setTheme = function (theme) {\n        var _this = this;\n        this.colorManager.setTheme(theme);\n        this._renderLayers.forEach(function (l) {\n            l.onThemeChanged(_this._terminal, _this.colorManager.colors);\n            l.reset(_this._terminal);\n        });\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n        }\n        else {\n            this._terminal.refresh(0, this._terminal.rows - 1);\n        }\n        return this.colorManager.colors;\n    };\n    Renderer.prototype.onResize = function (cols, rows, didCharSizeChange) {\n        var _this = this;\n        this._updateDimensions();\n        this._renderLayers.forEach(function (l) { return l.resize(_this._terminal, _this.dimensions, didCharSizeChange); });\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n        }\n        else {\n            this._terminal.refresh(0, this._terminal.rows - 1);\n        }\n        this.emit('resize', {\n            width: this.dimensions.canvasWidth,\n            height: this.dimensions.canvasHeight\n        });\n    };\n    Renderer.prototype.onCharSizeChanged = function () {\n        this.onResize(this._terminal.cols, this._terminal.rows, true);\n    };\n    Renderer.prototype.onBlur = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.onBlur(_this._terminal); });\n    };\n    Renderer.prototype.onFocus = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.onFocus(_this._terminal); });\n    };\n    Renderer.prototype.onSelectionChanged = function (start, end) {\n        var _this = this;\n        this._runOperation(function (l) { return l.onSelectionChanged(_this._terminal, start, end); });\n    };\n    Renderer.prototype.onCursorMove = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.onCursorMove(_this._terminal); });\n    };\n    Renderer.prototype.onOptionsChanged = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.onOptionsChanged(_this._terminal); });\n    };\n    Renderer.prototype.clear = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.reset(_this._terminal); });\n    };\n    Renderer.prototype._runOperation = function (operation) {\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n        }\n        else {\n            this._renderLayers.forEach(function (l) { return operation(l); });\n        }\n    };\n    Renderer.prototype.queueRefresh = function (start, end) {\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n            return;\n        }\n        this._refreshRowsQueue.push({ start: start, end: end });\n        if (!this._refreshAnimationFrame) {\n            this._refreshAnimationFrame = window.requestAnimationFrame(this._refreshLoop.bind(this));\n        }\n    };\n    Renderer.prototype._refreshLoop = function () {\n        var _this = this;\n        var start;\n        var end;\n        if (this._refreshRowsQueue.length > 4) {\n            start = 0;\n            end = this._terminal.rows - 1;\n        }\n        else {\n            start = this._refreshRowsQueue[0].start;\n            end = this._refreshRowsQueue[0].end;\n            for (var i = 1; i < this._refreshRowsQueue.length; i++) {\n                if (this._refreshRowsQueue[i].start < start) {\n                    start = this._refreshRowsQueue[i].start;\n                }\n                if (this._refreshRowsQueue[i].end > end) {\n                    end = this._refreshRowsQueue[i].end;\n                }\n            }\n        }\n        this._refreshRowsQueue = [];\n        this._refreshAnimationFrame = null;\n        start = Math.max(start, 0);\n        end = Math.min(end, this._terminal.rows - 1);\n        this._renderLayers.forEach(function (l) { return l.onGridChanged(_this._terminal, start, end); });\n        this._terminal.emit('refresh', { start: start, end: end });\n    };\n    Renderer.prototype._updateDimensions = function () {\n        if (!this._terminal.charMeasure.width || !this._terminal.charMeasure.height) {\n            return;\n        }\n        this.dimensions.scaledCharWidth = Math.floor(this._terminal.charMeasure.width * window.devicePixelRatio);\n        this.dimensions.scaledCharHeight = Math.ceil(this._terminal.charMeasure.height * window.devicePixelRatio);\n        this.dimensions.scaledCellHeight = Math.floor(this.dimensions.scaledCharHeight * this._terminal.options.lineHeight);\n        this.dimensions.scaledCharTop = this._terminal.options.lineHeight === 1 ? 0 : Math.round((this.dimensions.scaledCellHeight - this.dimensions.scaledCharHeight) / 2);\n        this.dimensions.scaledCellWidth = this.dimensions.scaledCharWidth + Math.round(this._terminal.options.letterSpacing);\n        this.dimensions.scaledCharLeft = Math.floor(this._terminal.options.letterSpacing / 2);\n        this.dimensions.scaledCanvasHeight = this._terminal.rows * this.dimensions.scaledCellHeight;\n        this.dimensions.scaledCanvasWidth = this._terminal.cols * this.dimensions.scaledCellWidth;\n        this.dimensions.canvasHeight = Math.round(this.dimensions.scaledCanvasHeight / window.devicePixelRatio);\n        this.dimensions.canvasWidth = Math.round(this.dimensions.scaledCanvasWidth / window.devicePixelRatio);\n        this.dimensions.actualCellHeight = this.dimensions.canvasHeight / this._terminal.rows;\n        this.dimensions.actualCellWidth = this.dimensions.canvasWidth / this._terminal.cols;\n    };\n    return Renderer;\n}(EventEmitter_1.EventEmitter));\nexports.Renderer = Renderer;\n\n\n\n},{\"../EventEmitter\":7,\"../utils/ScreenDprMonitor\":33,\"./ColorManager\":20,\"./CursorRenderLayer\":21,\"./LinkRenderLayer\":23,\"./SelectionRenderLayer\":25,\"./TextRenderLayer\":26}],25:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar SelectionRenderLayer = (function (_super) {\n    __extends(SelectionRenderLayer, _super);\n    function SelectionRenderLayer(container, zIndex, colors) {\n        var _this = _super.call(this, container, 'selection', zIndex, true, colors) || this;\n        _this._state = {\n            start: null,\n            end: null\n        };\n        return _this;\n    }\n    SelectionRenderLayer.prototype.resize = function (terminal, dim, charSizeChanged) {\n        _super.prototype.resize.call(this, terminal, dim, charSizeChanged);\n        this._state = {\n            start: null,\n            end: null\n        };\n    };\n    SelectionRenderLayer.prototype.reset = function (terminal) {\n        if (this._state.start && this._state.end) {\n            this._state = {\n                start: null,\n                end: null\n            };\n            this.clearAll();\n        }\n    };\n    SelectionRenderLayer.prototype.onSelectionChanged = function (terminal, start, end) {\n        if (this._state.start === start || this._state.end === end) {\n            return;\n        }\n        this.clearAll();\n        if (!start || !end) {\n            return;\n        }\n        var viewportStartRow = start[1] - terminal.buffer.ydisp;\n        var viewportEndRow = end[1] - terminal.buffer.ydisp;\n        var viewportCappedStartRow = Math.max(viewportStartRow, 0);\n        var viewportCappedEndRow = Math.min(viewportEndRow, terminal.rows - 1);\n        if (viewportCappedStartRow >= terminal.rows || viewportCappedEndRow < 0) {\n            return;\n        }\n        var startCol = viewportStartRow === viewportCappedStartRow ? start[0] : 0;\n        var startRowEndCol = viewportCappedStartRow === viewportCappedEndRow ? end[0] : terminal.cols;\n        this._ctx.fillStyle = this._colors.selection;\n        this.fillCells(startCol, viewportCappedStartRow, startRowEndCol - startCol, 1);\n        var middleRowsCount = Math.max(viewportCappedEndRow - viewportCappedStartRow - 1, 0);\n        this.fillCells(0, viewportCappedStartRow + 1, terminal.cols, middleRowsCount);\n        if (viewportCappedStartRow !== viewportCappedEndRow) {\n            var endCol = viewportEndRow === viewportCappedEndRow ? end[0] : terminal.cols;\n            this.fillCells(0, viewportCappedEndRow, endCol, 1);\n        }\n        this._state.start = [start[0], start[1]];\n        this._state.end = [end[0], end[1]];\n    };\n    return SelectionRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.SelectionRenderLayer = SelectionRenderLayer;\n\n\n\n},{\"./BaseRenderLayer\":18}],26:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"../Buffer\");\nvar Types_1 = require(\"./Types\");\nvar GridCache_1 = require(\"./GridCache\");\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar OVERLAP_OWNED_CHAR_DATA = [null, '', 0, -1];\nvar TextRenderLayer = (function (_super) {\n    __extends(TextRenderLayer, _super);\n    function TextRenderLayer(container, zIndex, colors) {\n        var _this = _super.call(this, container, 'text', zIndex, false, colors) || this;\n        _this._characterOverlapCache = {};\n        _this._state = new GridCache_1.GridCache();\n        return _this;\n    }\n    TextRenderLayer.prototype.resize = function (terminal, dim, charSizeChanged) {\n        _super.prototype.resize.call(this, terminal, dim, charSizeChanged);\n        var terminalFont = terminal.options.fontSize * window.devicePixelRatio + \"px \" + terminal.options.fontFamily;\n        if (this._characterWidth !== dim.scaledCharWidth || this._characterFont !== terminalFont) {\n            this._characterWidth = dim.scaledCharWidth;\n            this._characterFont = terminalFont;\n            this._characterOverlapCache = {};\n        }\n        this._state.clear();\n        this._state.resize(terminal.cols, terminal.rows);\n    };\n    TextRenderLayer.prototype.reset = function (terminal) {\n        this._state.clear();\n        this.clearAll();\n    };\n    TextRenderLayer.prototype.onGridChanged = function (terminal, startRow, endRow) {\n        if (this._state.cache.length === 0) {\n            return;\n        }\n        for (var y = startRow; y <= endRow; y++) {\n            var row = y + terminal.buffer.ydisp;\n            var line = terminal.buffer.lines.get(row);\n            this.clearCells(0, y, terminal.cols, 1);\n            for (var x = 0; x < terminal.cols; x++) {\n                var charData = line[x];\n                var code = charData[Buffer_1.CHAR_DATA_CODE_INDEX];\n                var char = charData[Buffer_1.CHAR_DATA_CHAR_INDEX];\n                var attr = charData[Buffer_1.CHAR_DATA_ATTR_INDEX];\n                var width = charData[Buffer_1.CHAR_DATA_WIDTH_INDEX];\n                if (width === 0) {\n                    continue;\n                }\n                if (code === 32) {\n                    if (x > 0) {\n                        var previousChar = line[x - 1];\n                        if (this._isOverlapping(previousChar)) {\n                            continue;\n                        }\n                    }\n                }\n                var flags = attr >> 18;\n                var bg = attr & 0x1ff;\n                var isDefaultBackground = bg >= 256;\n                var isInvisible = flags & Types_1.FLAGS.INVISIBLE;\n                var isInverted = flags & Types_1.FLAGS.INVERSE;\n                if (!code || (code === 32 && isDefaultBackground && !isInverted) || isInvisible) {\n                    continue;\n                }\n                if (width !== 0 && this._isOverlapping(charData)) {\n                    if (x < line.length - 1 && line[x + 1][Buffer_1.CHAR_DATA_CODE_INDEX] === 32) {\n                        width = 2;\n                    }\n                }\n                var fg = (attr >> 9) & 0x1ff;\n                if (isInverted) {\n                    var temp = bg;\n                    bg = fg;\n                    fg = temp;\n                    if (fg === 256) {\n                        fg = BaseRenderLayer_1.INVERTED_DEFAULT_COLOR;\n                    }\n                    if (bg === 257) {\n                        bg = BaseRenderLayer_1.INVERTED_DEFAULT_COLOR;\n                    }\n                }\n                if (width === 2) {\n                }\n                if (bg < 256) {\n                    this._ctx.save();\n                    this._ctx.fillStyle = (bg === BaseRenderLayer_1.INVERTED_DEFAULT_COLOR ? this._colors.foreground : this._colors.ansi[bg]);\n                    this.fillCells(x, y, width, 1);\n                    this._ctx.restore();\n                }\n                this._ctx.save();\n                if (flags & Types_1.FLAGS.BOLD) {\n                    this._ctx.font = \"bold \" + this._ctx.font;\n                    if (fg < 8) {\n                        fg += 8;\n                    }\n                }\n                if (flags & Types_1.FLAGS.UNDERLINE) {\n                    if (fg === BaseRenderLayer_1.INVERTED_DEFAULT_COLOR) {\n                        this._ctx.fillStyle = this._colors.background;\n                    }\n                    else if (fg < 256) {\n                        this._ctx.fillStyle = this._colors.ansi[fg];\n                    }\n                    else {\n                        this._ctx.fillStyle = this._colors.foreground;\n                    }\n                    this.fillBottomLineAtCells(x, y);\n                }\n                this.drawChar(terminal, char, code, width, x, y, fg, bg, !!(flags & Types_1.FLAGS.BOLD), !!(flags & Types_1.FLAGS.DIM));\n                this._ctx.restore();\n            }\n        }\n    };\n    TextRenderLayer.prototype._isOverlapping = function (charData) {\n        if (charData[Buffer_1.CHAR_DATA_WIDTH_INDEX] !== 1) {\n            return false;\n        }\n        var code = charData[Buffer_1.CHAR_DATA_CODE_INDEX];\n        if (code < 256) {\n            return false;\n        }\n        var char = charData[Buffer_1.CHAR_DATA_CHAR_INDEX];\n        if (this._characterOverlapCache.hasOwnProperty(char)) {\n            return this._characterOverlapCache[char];\n        }\n        this._ctx.save();\n        this._ctx.font = this._characterFont;\n        var overlaps = Math.floor(this._ctx.measureText(char).width) > this._characterWidth;\n        this._ctx.restore();\n        this._characterOverlapCache[char] = overlaps;\n        return overlaps;\n    };\n    TextRenderLayer.prototype._clearChar = function (x, y) {\n        var colsToClear = 1;\n        var state = this._state.cache[x][y];\n        if (state && state[Buffer_1.CHAR_DATA_WIDTH_INDEX] === 2) {\n            colsToClear = 2;\n        }\n        this.clearCells(x, y, colsToClear, 1);\n    };\n    return TextRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.TextRenderLayer = TextRenderLayer;\n\n\n\n},{\"../Buffer\":1,\"./BaseRenderLayer\":18,\"./GridCache\":22,\"./Types\":27}],27:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar FLAGS;\n(function (FLAGS) {\n    FLAGS[FLAGS[\"BOLD\"] = 1] = \"BOLD\";\n    FLAGS[FLAGS[\"UNDERLINE\"] = 2] = \"UNDERLINE\";\n    FLAGS[FLAGS[\"BLINK\"] = 4] = \"BLINK\";\n    FLAGS[FLAGS[\"INVERSE\"] = 8] = \"INVERSE\";\n    FLAGS[FLAGS[\"INVISIBLE\"] = 16] = \"INVISIBLE\";\n    FLAGS[FLAGS[\"DIM\"] = 32] = \"DIM\";\n})(FLAGS = exports.FLAGS || (exports.FLAGS = {}));\n;\n\n\n\n},{}],28:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Generic_1 = require(\"./Generic\");\nvar isNode = (typeof navigator === 'undefined') ? true : false;\nvar userAgent = (isNode) ? 'node' : navigator.userAgent;\nvar platform = (isNode) ? 'node' : navigator.platform;\nexports.isFirefox = !!~userAgent.indexOf('Firefox');\nexports.isMSIE = !!~userAgent.indexOf('MSIE') || !!~userAgent.indexOf('Trident');\nexports.isMac = Generic_1.contains(['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'], platform);\nexports.isIpad = platform === 'iPad';\nexports.isIphone = platform === 'iPhone';\nexports.isMSWindows = Generic_1.contains(['Windows', 'Win16', 'Win32', 'WinCE'], platform);\nexports.isLinux = platform.indexOf('Linux') >= 0;\n\n\n\n},{\"./Generic\":31}],29:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter_1 = require(\"../EventEmitter\");\nvar CharMeasure = (function (_super) {\n    __extends(CharMeasure, _super);\n    function CharMeasure(document, parentElement) {\n        var _this = _super.call(this) || this;\n        _this._document = document;\n        _this._parentElement = parentElement;\n        _this._measureElement = _this._document.createElement('span');\n        _this._measureElement.style.position = 'absolute';\n        _this._measureElement.style.top = '0';\n        _this._measureElement.style.left = '-9999em';\n        _this._measureElement.style.lineHeight = 'normal';\n        _this._measureElement.textContent = 'W';\n        _this._measureElement.setAttribute('aria-hidden', 'true');\n        _this._parentElement.appendChild(_this._measureElement);\n        return _this;\n    }\n    Object.defineProperty(CharMeasure.prototype, \"width\", {\n        get: function () {\n            return this._width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CharMeasure.prototype, \"height\", {\n        get: function () {\n            return this._height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CharMeasure.prototype.measure = function (options) {\n        this._measureElement.style.fontFamily = options.fontFamily;\n        this._measureElement.style.fontSize = options.fontSize + \"px\";\n        var geometry = this._measureElement.getBoundingClientRect();\n        if (geometry.width === 0 || geometry.height === 0) {\n            return;\n        }\n        if (this._width !== geometry.width || this._height !== geometry.height) {\n            this._width = geometry.width;\n            this._height = Math.ceil(geometry.height);\n            this.emit('charsizechanged');\n        }\n    };\n    return CharMeasure;\n}(EventEmitter_1.EventEmitter));\nexports.CharMeasure = CharMeasure;\n\n\n\n},{\"../EventEmitter\":7}],30:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter_1 = require(\"../EventEmitter\");\nvar CircularList = (function (_super) {\n    __extends(CircularList, _super);\n    function CircularList(_maxLength) {\n        var _this = _super.call(this) || this;\n        _this._maxLength = _maxLength;\n        _this._array = new Array(_this._maxLength);\n        _this._startIndex = 0;\n        _this._length = 0;\n        return _this;\n    }\n    Object.defineProperty(CircularList.prototype, \"maxLength\", {\n        get: function () {\n            return this._maxLength;\n        },\n        set: function (newMaxLength) {\n            if (this._maxLength === newMaxLength) {\n                return;\n            }\n            var newArray = new Array(newMaxLength);\n            for (var i = 0; i < Math.min(newMaxLength, this.length); i++) {\n                newArray[i] = this._array[this._getCyclicIndex(i)];\n            }\n            this._array = newArray;\n            this._maxLength = newMaxLength;\n            this._startIndex = 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CircularList.prototype, \"length\", {\n        get: function () {\n            return this._length;\n        },\n        set: function (newLength) {\n            if (newLength > this._length) {\n                for (var i = this._length; i < newLength; i++) {\n                    this._array[i] = undefined;\n                }\n            }\n            this._length = newLength;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CircularList.prototype, \"forEach\", {\n        get: function () {\n            var _this = this;\n            return function (callbackfn) {\n                var i = 0;\n                var length = _this.length;\n                for (var i_1 = 0; i_1 < length; i_1++) {\n                    callbackfn(_this.get(i_1), i_1);\n                }\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CircularList.prototype.get = function (index) {\n        return this._array[this._getCyclicIndex(index)];\n    };\n    CircularList.prototype.set = function (index, value) {\n        this._array[this._getCyclicIndex(index)] = value;\n    };\n    CircularList.prototype.push = function (value) {\n        this._array[this._getCyclicIndex(this._length)] = value;\n        if (this._length === this._maxLength) {\n            this._startIndex++;\n            if (this._startIndex === this._maxLength) {\n                this._startIndex = 0;\n            }\n            this.emit('trim', 1);\n        }\n        else {\n            this._length++;\n        }\n    };\n    CircularList.prototype.pop = function () {\n        return this._array[this._getCyclicIndex(this._length-- - 1)];\n    };\n    CircularList.prototype.splice = function (start, deleteCount) {\n        var items = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            items[_i - 2] = arguments[_i];\n        }\n        if (deleteCount) {\n            for (var i = start; i < this._length - deleteCount; i++) {\n                this._array[this._getCyclicIndex(i)] = this._array[this._getCyclicIndex(i + deleteCount)];\n            }\n            this._length -= deleteCount;\n        }\n        if (items && items.length) {\n            for (var i = this._length - 1; i >= start; i--) {\n                this._array[this._getCyclicIndex(i + items.length)] = this._array[this._getCyclicIndex(i)];\n            }\n            for (var i = 0; i < items.length; i++) {\n                this._array[this._getCyclicIndex(start + i)] = items[i];\n            }\n            if (this._length + items.length > this.maxLength) {\n                var countToTrim = (this._length + items.length) - this.maxLength;\n                this._startIndex += countToTrim;\n                this._length = this.maxLength;\n                this.emit('trim', countToTrim);\n            }\n            else {\n                this._length += items.length;\n            }\n        }\n    };\n    CircularList.prototype.trimStart = function (count) {\n        if (count > this._length) {\n            count = this._length;\n        }\n        this._startIndex += count;\n        this._length -= count;\n        this.emit('trim', count);\n    };\n    CircularList.prototype.shiftElements = function (start, count, offset) {\n        if (count <= 0) {\n            return;\n        }\n        if (start < 0 || start >= this._length) {\n            throw new Error('start argument out of range');\n        }\n        if (start + offset < 0) {\n            throw new Error('Cannot shift elements in list beyond index 0');\n        }\n        if (offset > 0) {\n            for (var i = count - 1; i >= 0; i--) {\n                this.set(start + i + offset, this.get(start + i));\n            }\n            var expandListBy = (start + count + offset) - this._length;\n            if (expandListBy > 0) {\n                this._length += expandListBy;\n                while (this._length > this.maxLength) {\n                    this._length--;\n                    this._startIndex++;\n                    this.emit('trim', 1);\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < count; i++) {\n                this.set(start + i + offset, this.get(start + i));\n            }\n        }\n    };\n    CircularList.prototype._getCyclicIndex = function (index) {\n        return (this._startIndex + index) % this.maxLength;\n    };\n    return CircularList;\n}(EventEmitter_1.EventEmitter));\nexports.CircularList = CircularList;\n\n\n\n},{\"../EventEmitter\":7}],31:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction contains(arr, el) {\n    return arr.indexOf(el) >= 0;\n}\nexports.contains = contains;\n;\n\n\n\n},{}],32:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MouseHelper = (function () {\n    function MouseHelper(_renderer) {\n        this._renderer = _renderer;\n    }\n    MouseHelper.getCoordsRelativeToElement = function (event, element) {\n        if (event.pageX == null) {\n            return null;\n        }\n        var originalElement = element;\n        var x = event.pageX;\n        var y = event.pageY;\n        while (element) {\n            x -= element.offsetLeft;\n            y -= element.offsetTop;\n            element = 'offsetParent' in element ? element.offsetParent : element.parentElement;\n        }\n        element = originalElement;\n        while (element && element !== element.ownerDocument.body) {\n            x += element.scrollLeft;\n            y += element.scrollTop;\n            element = element.parentElement;\n        }\n        return [x, y];\n    };\n    MouseHelper.prototype.getCoords = function (event, element, charMeasure, lineHeight, colCount, rowCount, isSelection) {\n        if (!charMeasure.width || !charMeasure.height) {\n            return null;\n        }\n        var coords = MouseHelper.getCoordsRelativeToElement(event, element);\n        if (!coords) {\n            return null;\n        }\n        coords[0] = Math.ceil((coords[0] + (isSelection ? this._renderer.dimensions.actualCellWidth / 2 : 0)) / this._renderer.dimensions.actualCellWidth);\n        coords[1] = Math.ceil(coords[1] / this._renderer.dimensions.actualCellHeight);\n        coords[0] = Math.min(Math.max(coords[0], 1), colCount + (isSelection ? 1 : 0));\n        coords[1] = Math.min(Math.max(coords[1], 1), rowCount);\n        return coords;\n    };\n    MouseHelper.prototype.getRawByteCoords = function (event, element, charMeasure, lineHeight, colCount, rowCount) {\n        var coords = this.getCoords(event, element, charMeasure, lineHeight, colCount, rowCount);\n        var x = coords[0];\n        var y = coords[1];\n        x += 32;\n        y += 32;\n        return { x: x, y: y };\n    };\n    return MouseHelper;\n}());\nexports.MouseHelper = MouseHelper;\n\n\n\n},{}],33:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ScreenDprMonitor = (function () {\n    function ScreenDprMonitor() {\n    }\n    ScreenDprMonitor.prototype.setListener = function (listener) {\n        var _this = this;\n        if (this._listener) {\n            this.clearListener();\n        }\n        this._listener = listener;\n        this._outerListener = function () {\n            _this._listener(window.devicePixelRatio, _this._currentDevicePixelRatio);\n            _this._updateDpr();\n        };\n        this._updateDpr();\n    };\n    ScreenDprMonitor.prototype._updateDpr = function () {\n        if (this._resolutionMediaMatchList) {\n            this._resolutionMediaMatchList.removeListener(this._outerListener);\n        }\n        this._currentDevicePixelRatio = window.devicePixelRatio;\n        this._resolutionMediaMatchList = window.matchMedia(\"screen and (resolution: \" + window.devicePixelRatio + \"dppx)\");\n        this._resolutionMediaMatchList.addListener(this._outerListener);\n    };\n    ScreenDprMonitor.prototype.clearListener = function () {\n        if (!this._listener) {\n            return;\n        }\n        this._resolutionMediaMatchList.removeListener(this._outerListener);\n        this._listener = null;\n        this._outerListener = null;\n    };\n    return ScreenDprMonitor;\n}());\nexports.ScreenDprMonitor = ScreenDprMonitor;\n\n\n\n},{}],34:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BellSound = 'data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCwAMlBZoG/wdmCcoKRAypDQ8PbRDBEQQTOxRtFYcWlBePGIUZXhoiG88bcBz7HHIdzh0WHlMeZx51HmkeUx4WHs8dah0AHXwc3hs9G4saxRnyGBIYGBcQFv8U4RPAEoYRQBACD70NWwwHC6gJOwjWBloF7gOBAhABkf8b/qv8R/ve+Xf4Ife79W/0JfPZ8Z/wde9N7ijtE+wU6xvqM+lb6H7nw+YX5mrlxuQz5Mzje+Ma49fioeKD4nXiYeJy4pHitOL04j/jn+MN5IPkFOWs5U3mDefM55/ogOl36m7rdOyE7abuyu8D8Unyj/Pg9D/2qfcb+Yn6/vuK/Qj/lAAlAg==';\n\n\n\n},{}],35:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Terminal_1 = require(\"./Terminal\");\nmodule.exports = Terminal_1.Terminal;\n\n\n\n},{\"./Terminal\":13}]},{},[35])(35)\n});\n//# sourceMappingURL=xterm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi94dGVybS5qcy94dGVybS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3h0ZXJtLmpzL3h0ZXJtLmpzPzc3MjMiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09XCJvYmplY3RcIiYmdHlwZW9mIG1vZHVsZSE9PVwidW5kZWZpbmVkXCIpe21vZHVsZS5leHBvcnRzPWYoKX1lbHNlIGlmKHR5cGVvZiBkZWZpbmU9PT1cImZ1bmN0aW9uXCImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT1cInVuZGVmaW5lZFwiKXtnPXdpbmRvd31lbHNlIGlmKHR5cGVvZiBnbG9iYWwhPT1cInVuZGVmaW5lZFwiKXtnPWdsb2JhbH1lbHNlIGlmKHR5cGVvZiBzZWxmIT09XCJ1bmRlZmluZWRcIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuVGVybWluYWwgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBDaXJjdWxhckxpc3RfMSA9IHJlcXVpcmUoXCIuL3V0aWxzL0NpcmN1bGFyTGlzdFwiKTtcbmV4cG9ydHMuQ0hBUl9EQVRBX0FUVFJfSU5ERVggPSAwO1xuZXhwb3J0cy5DSEFSX0RBVEFfQ0hBUl9JTkRFWCA9IDE7XG5leHBvcnRzLkNIQVJfREFUQV9XSURUSF9JTkRFWCA9IDI7XG5leHBvcnRzLkNIQVJfREFUQV9DT0RFX0lOREVYID0gMztcbmV4cG9ydHMuTUFYX0JVRkZFUl9TSVpFID0gNDI5NDk2NzI5NTtcbnZhciBCdWZmZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJ1ZmZlcihfdGVybWluYWwsIF9oYXNTY3JvbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsID0gX3Rlcm1pbmFsO1xuICAgICAgICB0aGlzLl9oYXNTY3JvbGxiYWNrID0gX2hhc1Njcm9sbGJhY2s7XG4gICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlci5wcm90b3R5cGUsIFwibGluZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saW5lcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlci5wcm90b3R5cGUsIFwiaGFzU2Nyb2xsYmFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hhc1Njcm9sbGJhY2sgJiYgdGhpcy5saW5lcy5tYXhMZW5ndGggPiB0aGlzLl90ZXJtaW5hbC5yb3dzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLnByb3RvdHlwZSwgXCJpc0N1cnNvckluVmlld3BvcnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhYnNvbHV0ZVkgPSB0aGlzLnliYXNlICsgdGhpcy55O1xuICAgICAgICAgICAgdmFyIHJlbGF0aXZlWSA9IGFic29sdXRlWSAtIHRoaXMueWRpc3A7XG4gICAgICAgICAgICByZXR1cm4gKHJlbGF0aXZlWSA+PSAwICYmIHJlbGF0aXZlWSA8IHRoaXMuX3Rlcm1pbmFsLnJvd3MpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCdWZmZXIucHJvdG90eXBlLl9nZXRDb3JyZWN0QnVmZmVyTGVuZ3RoID0gZnVuY3Rpb24gKHJvd3MpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9oYXNTY3JvbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gcm93cztcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29ycmVjdEJ1ZmZlckxlbmd0aCA9IHJvd3MgKyB0aGlzLl90ZXJtaW5hbC5vcHRpb25zLnNjcm9sbGJhY2s7XG4gICAgICAgIHJldHVybiBjb3JyZWN0QnVmZmVyTGVuZ3RoID4gZXhwb3J0cy5NQVhfQlVGRkVSX1NJWkUgPyBleHBvcnRzLk1BWF9CVUZGRVJfU0laRSA6IGNvcnJlY3RCdWZmZXJMZW5ndGg7XG4gICAgfTtcbiAgICBCdWZmZXIucHJvdG90eXBlLmZpbGxWaWV3cG9ydFJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9saW5lcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBpID0gdGhpcy5fdGVybWluYWwucm93cztcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVzLnB1c2godGhpcy5fdGVybWluYWwuYmxhbmtMaW5lKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBCdWZmZXIucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnlkaXNwID0gMDtcbiAgICAgICAgdGhpcy55YmFzZSA9IDA7XG4gICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgIHRoaXMuX2xpbmVzID0gbmV3IENpcmN1bGFyTGlzdF8xLkNpcmN1bGFyTGlzdCh0aGlzLl9nZXRDb3JyZWN0QnVmZmVyTGVuZ3RoKHRoaXMuX3Rlcm1pbmFsLnJvd3MpKTtcbiAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAwO1xuICAgICAgICB0aGlzLnNjcm9sbEJvdHRvbSA9IHRoaXMuX3Rlcm1pbmFsLnJvd3MgLSAxO1xuICAgICAgICB0aGlzLnNldHVwVGFiU3RvcHMoKTtcbiAgICB9O1xuICAgIEJ1ZmZlci5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKG5ld0NvbHMsIG5ld1Jvd3MpIHtcbiAgICAgICAgdmFyIG5ld01heExlbmd0aCA9IHRoaXMuX2dldENvcnJlY3RCdWZmZXJMZW5ndGgobmV3Um93cyk7XG4gICAgICAgIGlmIChuZXdNYXhMZW5ndGggPiB0aGlzLl9saW5lcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuX2xpbmVzLm1heExlbmd0aCA9IG5ld01heExlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbGluZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmNvbHMgPCBuZXdDb2xzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoID0gW3RoaXMuX3Rlcm1pbmFsLmRlZkF0dHIsICcgJywgMSwgMzJdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2xpbmVzLmdldChpKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9saW5lcy5zZXQoaSwgdGhpcy5fdGVybWluYWwuYmxhbmtMaW5lKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBuZXdDb2xzKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMuX2xpbmVzLmdldChpKS5sZW5ndGggPCBuZXdDb2xzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9saW5lcy5nZXQoaSkucHVzaChjaCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYWRkVG9ZID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5yb3dzIDwgbmV3Um93cykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHkgPSB0aGlzLl90ZXJtaW5hbC5yb3dzOyB5IDwgbmV3Um93czsgeSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9saW5lcy5sZW5ndGggPCBuZXdSb3dzICsgdGhpcy55YmFzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMueWJhc2UgPiAwICYmIHRoaXMuX2xpbmVzLmxlbmd0aCA8PSB0aGlzLnliYXNlICsgdGhpcy55ICsgYWRkVG9ZICsgMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueWJhc2UtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRUb1krKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy55ZGlzcCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55ZGlzcC0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2xpbmVzLnB1c2godGhpcy5fdGVybWluYWwuYmxhbmtMaW5lKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBuZXdDb2xzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB5ID0gdGhpcy5fdGVybWluYWwucm93czsgeSA+IG5ld1Jvd3M7IHktLSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fbGluZXMubGVuZ3RoID4gbmV3Um93cyArIHRoaXMueWJhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9saW5lcy5sZW5ndGggPiB0aGlzLnliYXNlICsgdGhpcy55ICsgMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2xpbmVzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55YmFzZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueWRpc3ArKztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZXdNYXhMZW5ndGggPCB0aGlzLl9saW5lcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYW1vdW50VG9UcmltID0gdGhpcy5fbGluZXMubGVuZ3RoIC0gbmV3TWF4TGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChhbW91bnRUb1RyaW0gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xpbmVzLnRyaW1TdGFydChhbW91bnRUb1RyaW0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnliYXNlID0gTWF0aC5tYXgodGhpcy55YmFzZSAtIGFtb3VudFRvVHJpbSwgMCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueWRpc3AgPSBNYXRoLm1heCh0aGlzLnlkaXNwIC0gYW1vdW50VG9UcmltLCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fbGluZXMubWF4TGVuZ3RoID0gbmV3TWF4TGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMueSA+PSBuZXdSb3dzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy55ID0gbmV3Um93cyAtIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWRkVG9ZKSB7XG4gICAgICAgICAgICAgICAgdGhpcy55ICs9IGFkZFRvWTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnggPj0gbmV3Q29scykge1xuICAgICAgICAgICAgICAgIHRoaXMueCA9IG5ld0NvbHMgLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2Nyb2xsQm90dG9tID0gbmV3Um93cyAtIDE7XG4gICAgfTtcbiAgICBCdWZmZXIucHJvdG90eXBlLnRyYW5zbGF0ZUJ1ZmZlckxpbmVUb1N0cmluZyA9IGZ1bmN0aW9uIChsaW5lSW5kZXgsIHRyaW1SaWdodCwgc3RhcnRDb2wsIGVuZENvbCkge1xuICAgICAgICBpZiAoc3RhcnRDb2wgPT09IHZvaWQgMCkgeyBzdGFydENvbCA9IDA7IH1cbiAgICAgICAgaWYgKGVuZENvbCA9PT0gdm9pZCAwKSB7IGVuZENvbCA9IG51bGw7IH1cbiAgICAgICAgdmFyIGxpbmVTdHJpbmcgPSAnJztcbiAgICAgICAgdmFyIGxpbmUgPSB0aGlzLmxpbmVzLmdldChsaW5lSW5kZXgpO1xuICAgICAgICBpZiAoIWxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhcnRJbmRleCA9IHN0YXJ0Q29sO1xuICAgICAgICBlbmRDb2wgPSBlbmRDb2wgfHwgbGluZS5sZW5ndGg7XG4gICAgICAgIHZhciBlbmRJbmRleCA9IGVuZENvbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY2hhciA9IGxpbmVbaV07XG4gICAgICAgICAgICBsaW5lU3RyaW5nICs9IGNoYXJbZXhwb3J0cy5DSEFSX0RBVEFfQ0hBUl9JTkRFWF07XG4gICAgICAgICAgICBpZiAoY2hhcltleHBvcnRzLkNIQVJfREFUQV9XSURUSF9JTkRFWF0gPT09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRDb2wgPj0gaSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFydEluZGV4LS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbmRDb2wgPj0gaSkge1xuICAgICAgICAgICAgICAgICAgICBlbmRJbmRleC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjaGFyW2V4cG9ydHMuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0Q29sID4gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRJbmRleCArPSBjaGFyW2V4cG9ydHMuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZENvbCA+IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZEluZGV4ICs9IGNoYXJbZXhwb3J0cy5DSEFSX0RBVEFfQ0hBUl9JTkRFWF0ubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHJpbVJpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgcmlnaHRXaGl0ZXNwYWNlSW5kZXggPSBsaW5lU3RyaW5nLnNlYXJjaCgvXFxzKyQvKTtcbiAgICAgICAgICAgIGlmIChyaWdodFdoaXRlc3BhY2VJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBlbmRJbmRleCA9IE1hdGgubWluKGVuZEluZGV4LCByaWdodFdoaXRlc3BhY2VJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW5kSW5kZXggPD0gc3RhcnRJbmRleCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGluZVN0cmluZy5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kSW5kZXgpO1xuICAgIH07XG4gICAgQnVmZmVyLnByb3RvdHlwZS5zZXR1cFRhYlN0b3BzID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgaWYgKGkgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRhYnNbaV0pIHtcbiAgICAgICAgICAgICAgICBpID0gdGhpcy5wcmV2U3RvcChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGFicyA9IHt9O1xuICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGkgPCB0aGlzLl90ZXJtaW5hbC5jb2xzOyBpICs9IHRoaXMuX3Rlcm1pbmFsLm9wdGlvbnMudGFiU3RvcFdpZHRoKSB7XG4gICAgICAgICAgICB0aGlzLnRhYnNbaV0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCdWZmZXIucHJvdG90eXBlLnByZXZTdG9wID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKHggPT0gbnVsbCkge1xuICAgICAgICAgICAgeCA9IHRoaXMueDtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoIXRoaXMudGFic1stLXhdICYmIHggPiAwKVxuICAgICAgICAgICAgO1xuICAgICAgICByZXR1cm4geCA+PSB0aGlzLl90ZXJtaW5hbC5jb2xzID8gdGhpcy5fdGVybWluYWwuY29scyAtIDEgOiB4IDwgMCA/IDAgOiB4O1xuICAgIH07XG4gICAgQnVmZmVyLnByb3RvdHlwZS5uZXh0U3RvcCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICh4ID09IG51bGwpIHtcbiAgICAgICAgICAgIHggPSB0aGlzLng7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKCF0aGlzLnRhYnNbKyt4XSAmJiB4IDwgdGhpcy5fdGVybWluYWwuY29scylcbiAgICAgICAgICAgIDtcbiAgICAgICAgcmV0dXJuIHggPj0gdGhpcy5fdGVybWluYWwuY29scyA/IHRoaXMuX3Rlcm1pbmFsLmNvbHMgLSAxIDogeCA8IDAgPyAwIDogeDtcbiAgICB9O1xuICAgIHJldHVybiBCdWZmZXI7XG59KCkpO1xuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXI7XG5cblxuXG59LHtcIi4vdXRpbHMvQ2lyY3VsYXJMaXN0XCI6MzB9XSwyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQnVmZmVyXzEgPSByZXF1aXJlKFwiLi9CdWZmZXJcIik7XG52YXIgRXZlbnRFbWl0dGVyXzEgPSByZXF1aXJlKFwiLi9FdmVudEVtaXR0ZXJcIik7XG52YXIgQnVmZmVyU2V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQnVmZmVyU2V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEJ1ZmZlclNldChfdGVybWluYWwpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3Rlcm1pbmFsID0gX3Rlcm1pbmFsO1xuICAgICAgICBfdGhpcy5fbm9ybWFsID0gbmV3IEJ1ZmZlcl8xLkJ1ZmZlcihfdGhpcy5fdGVybWluYWwsIHRydWUpO1xuICAgICAgICBfdGhpcy5fbm9ybWFsLmZpbGxWaWV3cG9ydFJvd3MoKTtcbiAgICAgICAgX3RoaXMuX2FsdCA9IG5ldyBCdWZmZXJfMS5CdWZmZXIoX3RoaXMuX3Rlcm1pbmFsLCBmYWxzZSk7XG4gICAgICAgIF90aGlzLl9hY3RpdmVCdWZmZXIgPSBfdGhpcy5fbm9ybWFsO1xuICAgICAgICBfdGhpcy5zZXR1cFRhYlN0b3BzKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlclNldC5wcm90b3R5cGUsIFwiYWx0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWx0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyU2V0LnByb3RvdHlwZSwgXCJhY3RpdmVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hY3RpdmVCdWZmZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWZmZXJTZXQucHJvdG90eXBlLCBcIm5vcm1hbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25vcm1hbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQnVmZmVyU2V0LnByb3RvdHlwZS5hY3RpdmF0ZU5vcm1hbEJ1ZmZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYWx0LmNsZWFyKCk7XG4gICAgICAgIHRoaXMuX2FjdGl2ZUJ1ZmZlciA9IHRoaXMuX25vcm1hbDtcbiAgICAgICAgdGhpcy5lbWl0KCdhY3RpdmF0ZScsIHRoaXMuX25vcm1hbCk7XG4gICAgfTtcbiAgICBCdWZmZXJTZXQucHJvdG90eXBlLmFjdGl2YXRlQWx0QnVmZmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9hbHQuZmlsbFZpZXdwb3J0Um93cygpO1xuICAgICAgICB0aGlzLl9hY3RpdmVCdWZmZXIgPSB0aGlzLl9hbHQ7XG4gICAgICAgIHRoaXMuZW1pdCgnYWN0aXZhdGUnLCB0aGlzLl9hbHQpO1xuICAgIH07XG4gICAgQnVmZmVyU2V0LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbiAobmV3Q29scywgbmV3Um93cykge1xuICAgICAgICB0aGlzLl9ub3JtYWwucmVzaXplKG5ld0NvbHMsIG5ld1Jvd3MpO1xuICAgICAgICB0aGlzLl9hbHQucmVzaXplKG5ld0NvbHMsIG5ld1Jvd3MpO1xuICAgIH07XG4gICAgQnVmZmVyU2V0LnByb3RvdHlwZS5zZXR1cFRhYlN0b3BzID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgdGhpcy5fbm9ybWFsLnNldHVwVGFiU3RvcHMoaSk7XG4gICAgICAgIHRoaXMuX2FsdC5zZXR1cFRhYlN0b3BzKGkpO1xuICAgIH07XG4gICAgcmV0dXJuIEJ1ZmZlclNldDtcbn0oRXZlbnRFbWl0dGVyXzEuRXZlbnRFbWl0dGVyKSk7XG5leHBvcnRzLkJ1ZmZlclNldCA9IEJ1ZmZlclNldDtcblxuXG5cbn0se1wiLi9CdWZmZXJcIjoxLFwiLi9FdmVudEVtaXR0ZXJcIjo3fV0sMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMud2N3aWR0aCA9IChmdW5jdGlvbiAob3B0cykge1xuICAgIHZhciBDT01CSU5JTkdfQk1QID0gW1xuICAgICAgICBbMHgwMzAwLCAweDAzNkZdLCBbMHgwNDgzLCAweDA0ODZdLCBbMHgwNDg4LCAweDA0ODldLFxuICAgICAgICBbMHgwNTkxLCAweDA1QkRdLCBbMHgwNUJGLCAweDA1QkZdLCBbMHgwNUMxLCAweDA1QzJdLFxuICAgICAgICBbMHgwNUM0LCAweDA1QzVdLCBbMHgwNUM3LCAweDA1QzddLCBbMHgwNjAwLCAweDA2MDNdLFxuICAgICAgICBbMHgwNjEwLCAweDA2MTVdLCBbMHgwNjRCLCAweDA2NUVdLCBbMHgwNjcwLCAweDA2NzBdLFxuICAgICAgICBbMHgwNkQ2LCAweDA2RTRdLCBbMHgwNkU3LCAweDA2RThdLCBbMHgwNkVBLCAweDA2RURdLFxuICAgICAgICBbMHgwNzBGLCAweDA3MEZdLCBbMHgwNzExLCAweDA3MTFdLCBbMHgwNzMwLCAweDA3NEFdLFxuICAgICAgICBbMHgwN0E2LCAweDA3QjBdLCBbMHgwN0VCLCAweDA3RjNdLCBbMHgwOTAxLCAweDA5MDJdLFxuICAgICAgICBbMHgwOTNDLCAweDA5M0NdLCBbMHgwOTQxLCAweDA5NDhdLCBbMHgwOTRELCAweDA5NERdLFxuICAgICAgICBbMHgwOTUxLCAweDA5NTRdLCBbMHgwOTYyLCAweDA5NjNdLCBbMHgwOTgxLCAweDA5ODFdLFxuICAgICAgICBbMHgwOUJDLCAweDA5QkNdLCBbMHgwOUMxLCAweDA5QzRdLCBbMHgwOUNELCAweDA5Q0RdLFxuICAgICAgICBbMHgwOUUyLCAweDA5RTNdLCBbMHgwQTAxLCAweDBBMDJdLCBbMHgwQTNDLCAweDBBM0NdLFxuICAgICAgICBbMHgwQTQxLCAweDBBNDJdLCBbMHgwQTQ3LCAweDBBNDhdLCBbMHgwQTRCLCAweDBBNERdLFxuICAgICAgICBbMHgwQTcwLCAweDBBNzFdLCBbMHgwQTgxLCAweDBBODJdLCBbMHgwQUJDLCAweDBBQkNdLFxuICAgICAgICBbMHgwQUMxLCAweDBBQzVdLCBbMHgwQUM3LCAweDBBQzhdLCBbMHgwQUNELCAweDBBQ0RdLFxuICAgICAgICBbMHgwQUUyLCAweDBBRTNdLCBbMHgwQjAxLCAweDBCMDFdLCBbMHgwQjNDLCAweDBCM0NdLFxuICAgICAgICBbMHgwQjNGLCAweDBCM0ZdLCBbMHgwQjQxLCAweDBCNDNdLCBbMHgwQjRELCAweDBCNERdLFxuICAgICAgICBbMHgwQjU2LCAweDBCNTZdLCBbMHgwQjgyLCAweDBCODJdLCBbMHgwQkMwLCAweDBCQzBdLFxuICAgICAgICBbMHgwQkNELCAweDBCQ0RdLCBbMHgwQzNFLCAweDBDNDBdLCBbMHgwQzQ2LCAweDBDNDhdLFxuICAgICAgICBbMHgwQzRBLCAweDBDNERdLCBbMHgwQzU1LCAweDBDNTZdLCBbMHgwQ0JDLCAweDBDQkNdLFxuICAgICAgICBbMHgwQ0JGLCAweDBDQkZdLCBbMHgwQ0M2LCAweDBDQzZdLCBbMHgwQ0NDLCAweDBDQ0RdLFxuICAgICAgICBbMHgwQ0UyLCAweDBDRTNdLCBbMHgwRDQxLCAweDBENDNdLCBbMHgwRDRELCAweDBENERdLFxuICAgICAgICBbMHgwRENBLCAweDBEQ0FdLCBbMHgwREQyLCAweDBERDRdLCBbMHgwREQ2LCAweDBERDZdLFxuICAgICAgICBbMHgwRTMxLCAweDBFMzFdLCBbMHgwRTM0LCAweDBFM0FdLCBbMHgwRTQ3LCAweDBFNEVdLFxuICAgICAgICBbMHgwRUIxLCAweDBFQjFdLCBbMHgwRUI0LCAweDBFQjldLCBbMHgwRUJCLCAweDBFQkNdLFxuICAgICAgICBbMHgwRUM4LCAweDBFQ0RdLCBbMHgwRjE4LCAweDBGMTldLCBbMHgwRjM1LCAweDBGMzVdLFxuICAgICAgICBbMHgwRjM3LCAweDBGMzddLCBbMHgwRjM5LCAweDBGMzldLCBbMHgwRjcxLCAweDBGN0VdLFxuICAgICAgICBbMHgwRjgwLCAweDBGODRdLCBbMHgwRjg2LCAweDBGODddLCBbMHgwRjkwLCAweDBGOTddLFxuICAgICAgICBbMHgwRjk5LCAweDBGQkNdLCBbMHgwRkM2LCAweDBGQzZdLCBbMHgxMDJELCAweDEwMzBdLFxuICAgICAgICBbMHgxMDMyLCAweDEwMzJdLCBbMHgxMDM2LCAweDEwMzddLCBbMHgxMDM5LCAweDEwMzldLFxuICAgICAgICBbMHgxMDU4LCAweDEwNTldLCBbMHgxMTYwLCAweDExRkZdLCBbMHgxMzVGLCAweDEzNUZdLFxuICAgICAgICBbMHgxNzEyLCAweDE3MTRdLCBbMHgxNzMyLCAweDE3MzRdLCBbMHgxNzUyLCAweDE3NTNdLFxuICAgICAgICBbMHgxNzcyLCAweDE3NzNdLCBbMHgxN0I0LCAweDE3QjVdLCBbMHgxN0I3LCAweDE3QkRdLFxuICAgICAgICBbMHgxN0M2LCAweDE3QzZdLCBbMHgxN0M5LCAweDE3RDNdLCBbMHgxN0RELCAweDE3RERdLFxuICAgICAgICBbMHgxODBCLCAweDE4MERdLCBbMHgxOEE5LCAweDE4QTldLCBbMHgxOTIwLCAweDE5MjJdLFxuICAgICAgICBbMHgxOTI3LCAweDE5MjhdLCBbMHgxOTMyLCAweDE5MzJdLCBbMHgxOTM5LCAweDE5M0JdLFxuICAgICAgICBbMHgxQTE3LCAweDFBMThdLCBbMHgxQjAwLCAweDFCMDNdLCBbMHgxQjM0LCAweDFCMzRdLFxuICAgICAgICBbMHgxQjM2LCAweDFCM0FdLCBbMHgxQjNDLCAweDFCM0NdLCBbMHgxQjQyLCAweDFCNDJdLFxuICAgICAgICBbMHgxQjZCLCAweDFCNzNdLCBbMHgxREMwLCAweDFEQ0FdLCBbMHgxREZFLCAweDFERkZdLFxuICAgICAgICBbMHgyMDBCLCAweDIwMEZdLCBbMHgyMDJBLCAweDIwMkVdLCBbMHgyMDYwLCAweDIwNjNdLFxuICAgICAgICBbMHgyMDZBLCAweDIwNkZdLCBbMHgyMEQwLCAweDIwRUZdLCBbMHgzMDJBLCAweDMwMkZdLFxuICAgICAgICBbMHgzMDk5LCAweDMwOUFdLCBbMHhBODA2LCAweEE4MDZdLCBbMHhBODBCLCAweEE4MEJdLFxuICAgICAgICBbMHhBODI1LCAweEE4MjZdLCBbMHhGQjFFLCAweEZCMUVdLCBbMHhGRTAwLCAweEZFMEZdLFxuICAgICAgICBbMHhGRTIwLCAweEZFMjNdLCBbMHhGRUZGLCAweEZFRkZdLCBbMHhGRkY5LCAweEZGRkJdLFxuICAgIF07XG4gICAgdmFyIENPTUJJTklOR19ISUdIID0gW1xuICAgICAgICBbMHgxMEEwMSwgMHgxMEEwM10sIFsweDEwQTA1LCAweDEwQTA2XSwgWzB4MTBBMEMsIDB4MTBBMEZdLFxuICAgICAgICBbMHgxMEEzOCwgMHgxMEEzQV0sIFsweDEwQTNGLCAweDEwQTNGXSwgWzB4MUQxNjcsIDB4MUQxNjldLFxuICAgICAgICBbMHgxRDE3MywgMHgxRDE4Ml0sIFsweDFEMTg1LCAweDFEMThCXSwgWzB4MUQxQUEsIDB4MUQxQURdLFxuICAgICAgICBbMHgxRDI0MiwgMHgxRDI0NF0sIFsweEUwMDAxLCAweEUwMDAxXSwgWzB4RTAwMjAsIDB4RTAwN0ZdLFxuICAgICAgICBbMHhFMDEwMCwgMHhFMDFFRl1cbiAgICBdO1xuICAgIGZ1bmN0aW9uIGJpc2VhcmNoKHVjcywgZGF0YSkge1xuICAgICAgICB2YXIgbWluID0gMDtcbiAgICAgICAgdmFyIG1heCA9IGRhdGEubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIG1pZDtcbiAgICAgICAgaWYgKHVjcyA8IGRhdGFbMF1bMF0gfHwgdWNzID4gZGF0YVttYXhdWzFdKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB3aGlsZSAobWF4ID49IG1pbikge1xuICAgICAgICAgICAgbWlkID0gKG1pbiArIG1heCkgPj4gMTtcbiAgICAgICAgICAgIGlmICh1Y3MgPiBkYXRhW21pZF1bMV0pXG4gICAgICAgICAgICAgICAgbWluID0gbWlkICsgMTtcbiAgICAgICAgICAgIGVsc2UgaWYgKHVjcyA8IGRhdGFbbWlkXVswXSlcbiAgICAgICAgICAgICAgICBtYXggPSBtaWQgLSAxO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gd2N3aWR0aEJNUCh1Y3MpIHtcbiAgICAgICAgaWYgKHVjcyA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiBvcHRzLm51bDtcbiAgICAgICAgaWYgKHVjcyA8IDMyIHx8ICh1Y3MgPj0gMHg3ZiAmJiB1Y3MgPCAweGEwKSlcbiAgICAgICAgICAgIHJldHVybiBvcHRzLmNvbnRyb2w7XG4gICAgICAgIGlmIChiaXNlYXJjaCh1Y3MsIENPTUJJTklOR19CTVApKVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIGlmIChpc1dpZGVCTVAodWNzKSkge1xuICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzV2lkZUJNUCh1Y3MpIHtcbiAgICAgICAgcmV0dXJuICh1Y3MgPj0gMHgxMTAwICYmICh1Y3MgPD0gMHgxMTVmIHx8XG4gICAgICAgICAgICB1Y3MgPT09IDB4MjMyOSB8fFxuICAgICAgICAgICAgdWNzID09PSAweDIzMmEgfHxcbiAgICAgICAgICAgICh1Y3MgPj0gMHgyZTgwICYmIHVjcyA8PSAweGE0Y2YgJiYgdWNzICE9PSAweDMwM2YpIHx8XG4gICAgICAgICAgICAodWNzID49IDB4YWMwMCAmJiB1Y3MgPD0gMHhkN2EzKSB8fFxuICAgICAgICAgICAgKHVjcyA+PSAweGY5MDAgJiYgdWNzIDw9IDB4ZmFmZikgfHxcbiAgICAgICAgICAgICh1Y3MgPj0gMHhmZTEwICYmIHVjcyA8PSAweGZlMTkpIHx8XG4gICAgICAgICAgICAodWNzID49IDB4ZmUzMCAmJiB1Y3MgPD0gMHhmZTZmKSB8fFxuICAgICAgICAgICAgKHVjcyA+PSAweGZmMDAgJiYgdWNzIDw9IDB4ZmY2MCkgfHxcbiAgICAgICAgICAgICh1Y3MgPj0gMHhmZmUwICYmIHVjcyA8PSAweGZmZTYpKSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHdjd2lkdGhIaWdoKHVjcykge1xuICAgICAgICBpZiAoYmlzZWFyY2godWNzLCBDT01CSU5JTkdfSElHSCkpXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgaWYgKCh1Y3MgPj0gMHgyMDAwMCAmJiB1Y3MgPD0gMHgyZmZmZCkgfHwgKHVjcyA+PSAweDMwMDAwICYmIHVjcyA8PSAweDNmZmZkKSkge1xuICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIHZhciBjb250cm9sID0gb3B0cy5jb250cm9sIHwgMDtcbiAgICB2YXIgdGFibGUgPSBudWxsO1xuICAgIGZ1bmN0aW9uIGluaXRfdGFibGUoKSB7XG4gICAgICAgIHZhciBDT0RFUE9JTlRTID0gNjU1MzY7XG4gICAgICAgIHZhciBCSVRXSURUSCA9IDI7XG4gICAgICAgIHZhciBJVEVNU0laRSA9IDMyO1xuICAgICAgICB2YXIgQ09OVEFJTkVSU0laRSA9IENPREVQT0lOVFMgKiBCSVRXSURUSCAvIElURU1TSVpFO1xuICAgICAgICB2YXIgQ09ERVBPSU5UU19QRVJfSVRFTSA9IElURU1TSVpFIC8gQklUV0lEVEg7XG4gICAgICAgIHRhYmxlID0gKHR5cGVvZiBVaW50MzJBcnJheSA9PT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICA/IG5ldyBBcnJheShDT05UQUlORVJTSVpFKVxuICAgICAgICAgICAgOiBuZXcgVWludDMyQXJyYXkoQ09OVEFJTkVSU0laRSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgQ09OVEFJTkVSU0laRTsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbnVtID0gMDtcbiAgICAgICAgICAgIHZhciBwb3MgPSBDT0RFUE9JTlRTX1BFUl9JVEVNO1xuICAgICAgICAgICAgd2hpbGUgKHBvcy0tKVxuICAgICAgICAgICAgICAgIG51bSA9IChudW0gPDwgMikgfCB3Y3dpZHRoQk1QKENPREVQT0lOVFNfUEVSX0lURU0gKiBpICsgcG9zKTtcbiAgICAgICAgICAgIHRhYmxlW2ldID0gbnVtO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YWJsZTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChudW0pIHtcbiAgICAgICAgbnVtID0gbnVtIHwgMDtcbiAgICAgICAgaWYgKG51bSA8IDMyKVxuICAgICAgICAgICAgcmV0dXJuIGNvbnRyb2wgfCAwO1xuICAgICAgICBpZiAobnVtIDwgMTI3KVxuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIHZhciB0ID0gdGFibGUgfHwgaW5pdF90YWJsZSgpO1xuICAgICAgICBpZiAobnVtIDwgNjU1MzYpXG4gICAgICAgICAgICByZXR1cm4gdFtudW0gPj4gNF0gPj4gKChudW0gJiAxNSkgPDwgMSkgJiAzO1xuICAgICAgICByZXR1cm4gd2N3aWR0aEhpZ2gobnVtKTtcbiAgICB9O1xufSkoeyBudWw6IDAsIGNvbnRyb2w6IDAgfSk7XG5cblxuXG59LHt9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5DSEFSU0VUUyA9IHt9O1xuZXhwb3J0cy5ERUZBVUxUX0NIQVJTRVQgPSBleHBvcnRzLkNIQVJTRVRTWydCJ107XG5leHBvcnRzLkNIQVJTRVRTWycwJ10gPSB7XG4gICAgJ2AnOiAnXFx1MjVjNicsXG4gICAgJ2EnOiAnXFx1MjU5MicsXG4gICAgJ2InOiAnXFx1MDAwOScsXG4gICAgJ2MnOiAnXFx1MDAwYycsXG4gICAgJ2QnOiAnXFx1MDAwZCcsXG4gICAgJ2UnOiAnXFx1MDAwYScsXG4gICAgJ2YnOiAnXFx1MDBiMCcsXG4gICAgJ2cnOiAnXFx1MDBiMScsXG4gICAgJ2gnOiAnXFx1MjQyNCcsXG4gICAgJ2knOiAnXFx1MDAwYicsXG4gICAgJ2onOiAnXFx1MjUxOCcsXG4gICAgJ2snOiAnXFx1MjUxMCcsXG4gICAgJ2wnOiAnXFx1MjUwYycsXG4gICAgJ20nOiAnXFx1MjUxNCcsXG4gICAgJ24nOiAnXFx1MjUzYycsXG4gICAgJ28nOiAnXFx1MjNiYScsXG4gICAgJ3AnOiAnXFx1MjNiYicsXG4gICAgJ3EnOiAnXFx1MjUwMCcsXG4gICAgJ3InOiAnXFx1MjNiYycsXG4gICAgJ3MnOiAnXFx1MjNiZCcsXG4gICAgJ3QnOiAnXFx1MjUxYycsXG4gICAgJ3UnOiAnXFx1MjUyNCcsXG4gICAgJ3YnOiAnXFx1MjUzNCcsXG4gICAgJ3cnOiAnXFx1MjUyYycsXG4gICAgJ3gnOiAnXFx1MjUwMicsXG4gICAgJ3knOiAnXFx1MjI2NCcsXG4gICAgJ3onOiAnXFx1MjI2NScsXG4gICAgJ3snOiAnXFx1MDNjMCcsXG4gICAgJ3wnOiAnXFx1MjI2MCcsXG4gICAgJ30nOiAnXFx1MDBhMycsXG4gICAgJ34nOiAnXFx1MDBiNydcbn07XG5leHBvcnRzLkNIQVJTRVRTWydBJ10gPSB7XG4gICAgJyMnOiAnwqMnXG59O1xuZXhwb3J0cy5DSEFSU0VUU1snQiddID0gbnVsbDtcbmV4cG9ydHMuQ0hBUlNFVFNbJzQnXSA9IHtcbiAgICAnIyc6ICfCoycsXG4gICAgJ0AnOiAnwr4nLFxuICAgICdbJzogJ2lqJyxcbiAgICAnXFxcXCc6ICfCvScsXG4gICAgJ10nOiAnfCcsXG4gICAgJ3snOiAnwqgnLFxuICAgICd8JzogJ2YnLFxuICAgICd9JzogJ8K8JyxcbiAgICAnfic6ICfCtCdcbn07XG5leHBvcnRzLkNIQVJTRVRTWydDJ10gPVxuICAgIGV4cG9ydHMuQ0hBUlNFVFNbJzUnXSA9IHtcbiAgICAgICAgJ1snOiAnw4QnLFxuICAgICAgICAnXFxcXCc6ICfDlicsXG4gICAgICAgICddJzogJ8OFJyxcbiAgICAgICAgJ14nOiAnw5wnLFxuICAgICAgICAnYCc6ICfDqScsXG4gICAgICAgICd7JzogJ8OkJyxcbiAgICAgICAgJ3wnOiAnw7YnLFxuICAgICAgICAnfSc6ICfDpScsXG4gICAgICAgICd+JzogJ8O8J1xuICAgIH07XG5leHBvcnRzLkNIQVJTRVRTWydSJ10gPSB7XG4gICAgJyMnOiAnwqMnLFxuICAgICdAJzogJ8OgJyxcbiAgICAnWyc6ICfCsCcsXG4gICAgJ1xcXFwnOiAnw6cnLFxuICAgICddJzogJ8KnJyxcbiAgICAneyc6ICfDqScsXG4gICAgJ3wnOiAnw7knLFxuICAgICd9JzogJ8OoJyxcbiAgICAnfic6ICfCqCdcbn07XG5leHBvcnRzLkNIQVJTRVRTWydRJ10gPSB7XG4gICAgJ0AnOiAnw6AnLFxuICAgICdbJzogJ8OiJyxcbiAgICAnXFxcXCc6ICfDpycsXG4gICAgJ10nOiAnw6onLFxuICAgICdeJzogJ8OuJyxcbiAgICAnYCc6ICfDtCcsXG4gICAgJ3snOiAnw6knLFxuICAgICd8JzogJ8O5JyxcbiAgICAnfSc6ICfDqCcsXG4gICAgJ34nOiAnw7snXG59O1xuZXhwb3J0cy5DSEFSU0VUU1snSyddID0ge1xuICAgICdAJzogJ8KnJyxcbiAgICAnWyc6ICfDhCcsXG4gICAgJ1xcXFwnOiAnw5YnLFxuICAgICddJzogJ8OcJyxcbiAgICAneyc6ICfDpCcsXG4gICAgJ3wnOiAnw7YnLFxuICAgICd9JzogJ8O8JyxcbiAgICAnfic6ICfDnydcbn07XG5leHBvcnRzLkNIQVJTRVRTWydZJ10gPSB7XG4gICAgJyMnOiAnwqMnLFxuICAgICdAJzogJ8KnJyxcbiAgICAnWyc6ICfCsCcsXG4gICAgJ1xcXFwnOiAnw6cnLFxuICAgICddJzogJ8OpJyxcbiAgICAnYCc6ICfDuScsXG4gICAgJ3snOiAnw6AnLFxuICAgICd8JzogJ8OyJyxcbiAgICAnfSc6ICfDqCcsXG4gICAgJ34nOiAnw6wnXG59O1xuZXhwb3J0cy5DSEFSU0VUU1snRSddID1cbiAgICBleHBvcnRzLkNIQVJTRVRTWyc2J10gPSB7XG4gICAgICAgICdAJzogJ8OEJyxcbiAgICAgICAgJ1snOiAnw4YnLFxuICAgICAgICAnXFxcXCc6ICfDmCcsXG4gICAgICAgICddJzogJ8OFJyxcbiAgICAgICAgJ14nOiAnw5wnLFxuICAgICAgICAnYCc6ICfDpCcsXG4gICAgICAgICd7JzogJ8OmJyxcbiAgICAgICAgJ3wnOiAnw7gnLFxuICAgICAgICAnfSc6ICfDpScsXG4gICAgICAgICd+JzogJ8O8J1xuICAgIH07XG5leHBvcnRzLkNIQVJTRVRTWydaJ10gPSB7XG4gICAgJyMnOiAnwqMnLFxuICAgICdAJzogJ8KnJyxcbiAgICAnWyc6ICfCoScsXG4gICAgJ1xcXFwnOiAnw5EnLFxuICAgICddJzogJ8K/JyxcbiAgICAneyc6ICfCsCcsXG4gICAgJ3wnOiAnw7EnLFxuICAgICd9JzogJ8OnJ1xufTtcbmV4cG9ydHMuQ0hBUlNFVFNbJ0gnXSA9XG4gICAgZXhwb3J0cy5DSEFSU0VUU1snNyddID0ge1xuICAgICAgICAnQCc6ICfDiScsXG4gICAgICAgICdbJzogJ8OEJyxcbiAgICAgICAgJ1xcXFwnOiAnw5YnLFxuICAgICAgICAnXSc6ICfDhScsXG4gICAgICAgICdeJzogJ8OcJyxcbiAgICAgICAgJ2AnOiAnw6knLFxuICAgICAgICAneyc6ICfDpCcsXG4gICAgICAgICd8JzogJ8O2JyxcbiAgICAgICAgJ30nOiAnw6UnLFxuICAgICAgICAnfic6ICfDvCdcbiAgICB9O1xuZXhwb3J0cy5DSEFSU0VUU1snPSddID0ge1xuICAgICcjJzogJ8O5JyxcbiAgICAnQCc6ICfDoCcsXG4gICAgJ1snOiAnw6knLFxuICAgICdcXFxcJzogJ8OnJyxcbiAgICAnXSc6ICfDqicsXG4gICAgJ14nOiAnw64nLFxuICAgICdfJzogJ8OoJyxcbiAgICAnYCc6ICfDtCcsXG4gICAgJ3snOiAnw6QnLFxuICAgICd8JzogJ8O2JyxcbiAgICAnfSc6ICfDvCcsXG4gICAgJ34nOiAnw7snXG59O1xuXG5cblxufSx7fV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBDb21wb3NpdGlvbkhlbHBlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29tcG9zaXRpb25IZWxwZXIodGV4dGFyZWEsIGNvbXBvc2l0aW9uVmlldywgdGVybWluYWwpIHtcbiAgICAgICAgdGhpcy50ZXh0YXJlYSA9IHRleHRhcmVhO1xuICAgICAgICB0aGlzLmNvbXBvc2l0aW9uVmlldyA9IGNvbXBvc2l0aW9uVmlldztcbiAgICAgICAgdGhpcy50ZXJtaW5hbCA9IHRlcm1pbmFsO1xuICAgICAgICB0aGlzLmlzQ29tcG9zaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNTZW5kaW5nQ29tcG9zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvblBvc2l0aW9uID0geyBzdGFydDogbnVsbCwgZW5kOiBudWxsIH07XG4gICAgfVxuICAgIENvbXBvc2l0aW9uSGVscGVyLnByb3RvdHlwZS5jb21wb3NpdGlvbnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzQ29tcG9zaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvblBvc2l0aW9uLnN0YXJ0ID0gdGhpcy50ZXh0YXJlYS52YWx1ZS5sZW5ndGg7XG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25WaWV3LnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25WaWV3LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgIH07XG4gICAgQ29tcG9zaXRpb25IZWxwZXIucHJvdG90eXBlLmNvbXBvc2l0aW9udXBkYXRlID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25WaWV3LnRleHRDb250ZW50ID0gZXYuZGF0YTtcbiAgICAgICAgdGhpcy51cGRhdGVDb21wb3NpdGlvbkVsZW1lbnRzKCk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMuY29tcG9zaXRpb25Qb3NpdGlvbi5lbmQgPSBfdGhpcy50ZXh0YXJlYS52YWx1ZS5sZW5ndGg7XG4gICAgICAgIH0sIDApO1xuICAgIH07XG4gICAgQ29tcG9zaXRpb25IZWxwZXIucHJvdG90eXBlLmNvbXBvc2l0aW9uZW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmZpbmFsaXplQ29tcG9zaXRpb24odHJ1ZSk7XG4gICAgfTtcbiAgICBDb21wb3NpdGlvbkhlbHBlci5wcm90b3R5cGUua2V5ZG93biA9IGZ1bmN0aW9uIChldikge1xuICAgICAgICBpZiAodGhpcy5pc0NvbXBvc2luZyB8fCB0aGlzLmlzU2VuZGluZ0NvbXBvc2l0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZXYua2V5Q29kZSA9PT0gMjI5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZXYua2V5Q29kZSA9PT0gMTYgfHwgZXYua2V5Q29kZSA9PT0gMTcgfHwgZXYua2V5Q29kZSA9PT0gMTgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmFsaXplQ29tcG9zaXRpb24oZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChldi5rZXlDb2RlID09PSAyMjkpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlQW55VGV4dGFyZWFDaGFuZ2VzKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBDb21wb3NpdGlvbkhlbHBlci5wcm90b3R5cGUuZmluYWxpemVDb21wb3NpdGlvbiA9IGZ1bmN0aW9uICh3YWl0Rm9yUHJvcG9nYXRpb24pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvblZpZXcuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgIHRoaXMuaXNDb21wb3NpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jbGVhclRleHRhcmVhUG9zaXRpb24oKTtcbiAgICAgICAgaWYgKCF3YWl0Rm9yUHJvcG9nYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuaXNTZW5kaW5nQ29tcG9zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IHRoaXMudGV4dGFyZWEudmFsdWUuc3Vic3RyaW5nKHRoaXMuY29tcG9zaXRpb25Qb3NpdGlvbi5zdGFydCwgdGhpcy5jb21wb3NpdGlvblBvc2l0aW9uLmVuZCk7XG4gICAgICAgICAgICB0aGlzLnRlcm1pbmFsLmhhbmRsZXIoaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRDb21wb3NpdGlvblBvc2l0aW9uXzEgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IHRoaXMuY29tcG9zaXRpb25Qb3NpdGlvbi5zdGFydCxcbiAgICAgICAgICAgICAgICBlbmQ6IHRoaXMuY29tcG9zaXRpb25Qb3NpdGlvbi5lbmQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5pc1NlbmRpbmdDb21wb3NpdGlvbiA9IHRydWU7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNTZW5kaW5nQ29tcG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNTZW5kaW5nQ29tcG9zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0ID0gX3RoaXMudGV4dGFyZWEudmFsdWUuc3Vic3RyaW5nKGN1cnJlbnRDb21wb3NpdGlvblBvc2l0aW9uXzEuc3RhcnQsIGN1cnJlbnRDb21wb3NpdGlvblBvc2l0aW9uXzEuZW5kKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0ID0gX3RoaXMudGV4dGFyZWEudmFsdWUuc3Vic3RyaW5nKGN1cnJlbnRDb21wb3NpdGlvblBvc2l0aW9uXzEuc3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnRlcm1pbmFsLmhhbmRsZXIoaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb21wb3NpdGlvbkhlbHBlci5wcm90b3R5cGUuaGFuZGxlQW55VGV4dGFyZWFDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLnRleHRhcmVhLnZhbHVlO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghX3RoaXMuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBfdGhpcy50ZXh0YXJlYS52YWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgZGlmZiA9IG5ld1ZhbHVlLnJlcGxhY2Uob2xkVmFsdWUsICcnKTtcbiAgICAgICAgICAgICAgICBpZiAoZGlmZi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnRlcm1pbmFsLmhhbmRsZXIoZGlmZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCAwKTtcbiAgICB9O1xuICAgIENvbXBvc2l0aW9uSGVscGVyLnByb3RvdHlwZS51cGRhdGVDb21wb3NpdGlvbkVsZW1lbnRzID0gZnVuY3Rpb24gKGRvbnRSZWN1cnNlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRlcm1pbmFsLmJ1ZmZlci5pc0N1cnNvckluVmlld3BvcnQpIHtcbiAgICAgICAgICAgIHZhciBjZWxsSGVpZ2h0ID0gTWF0aC5jZWlsKHRoaXMudGVybWluYWwuY2hhck1lYXN1cmUuaGVpZ2h0ICogdGhpcy50ZXJtaW5hbC5vcHRpb25zLmxpbmVIZWlnaHQpO1xuICAgICAgICAgICAgdmFyIGN1cnNvclRvcCA9IHRoaXMudGVybWluYWwuYnVmZmVyLnkgKiBjZWxsSGVpZ2h0O1xuICAgICAgICAgICAgdmFyIGN1cnNvckxlZnQgPSB0aGlzLnRlcm1pbmFsLmJ1ZmZlci54ICogdGhpcy50ZXJtaW5hbC5jaGFyTWVhc3VyZS53aWR0aDtcbiAgICAgICAgICAgIHRoaXMuY29tcG9zaXRpb25WaWV3LnN0eWxlLmxlZnQgPSBjdXJzb3JMZWZ0ICsgJ3B4JztcbiAgICAgICAgICAgIHRoaXMuY29tcG9zaXRpb25WaWV3LnN0eWxlLnRvcCA9IGN1cnNvclRvcCArICdweCc7XG4gICAgICAgICAgICB0aGlzLmNvbXBvc2l0aW9uVmlldy5zdHlsZS5oZWlnaHQgPSBjZWxsSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIHRoaXMuY29tcG9zaXRpb25WaWV3LnN0eWxlLmxpbmVIZWlnaHQgPSBjZWxsSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIHZhciBjb21wb3NpdGlvblZpZXdCb3VuZHMgPSB0aGlzLmNvbXBvc2l0aW9uVmlldy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIHRoaXMudGV4dGFyZWEuc3R5bGUubGVmdCA9IGN1cnNvckxlZnQgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy50ZXh0YXJlYS5zdHlsZS50b3AgPSBjdXJzb3JUb3AgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy50ZXh0YXJlYS5zdHlsZS53aWR0aCA9IGNvbXBvc2l0aW9uVmlld0JvdW5kcy53aWR0aCArICdweCc7XG4gICAgICAgICAgICB0aGlzLnRleHRhcmVhLnN0eWxlLmhlaWdodCA9IGNvbXBvc2l0aW9uVmlld0JvdW5kcy5oZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy50ZXh0YXJlYS5zdHlsZS5saW5lSGVpZ2h0ID0gY29tcG9zaXRpb25WaWV3Qm91bmRzLmhlaWdodCArICdweCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkb250UmVjdXJzZSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy51cGRhdGVDb21wb3NpdGlvbkVsZW1lbnRzKHRydWUpOyB9LCAwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgO1xuICAgIENvbXBvc2l0aW9uSGVscGVyLnByb3RvdHlwZS5jbGVhclRleHRhcmVhUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudGV4dGFyZWEuc3R5bGUubGVmdCA9ICcnO1xuICAgICAgICB0aGlzLnRleHRhcmVhLnN0eWxlLnRvcCA9ICcnO1xuICAgIH07XG4gICAgO1xuICAgIHJldHVybiBDb21wb3NpdGlvbkhlbHBlcjtcbn0oKSk7XG5leHBvcnRzLkNvbXBvc2l0aW9uSGVscGVyID0gQ29tcG9zaXRpb25IZWxwZXI7XG5cblxuXG59LHt9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEMwO1xuKGZ1bmN0aW9uIChDMCkge1xuICAgIEMwLk5VTCA9ICdcXHgwMCc7XG4gICAgQzAuU09IID0gJ1xceDAxJztcbiAgICBDMC5TVFggPSAnXFx4MDInO1xuICAgIEMwLkVUWCA9ICdcXHgwMyc7XG4gICAgQzAuRU9UID0gJ1xceDA0JztcbiAgICBDMC5FTlEgPSAnXFx4MDUnO1xuICAgIEMwLkFDSyA9ICdcXHgwNic7XG4gICAgQzAuQkVMID0gJ1xceDA3JztcbiAgICBDMC5CUyA9ICdcXHgwOCc7XG4gICAgQzAuSFQgPSAnXFx4MDknO1xuICAgIEMwLkxGID0gJ1xceDBhJztcbiAgICBDMC5WVCA9ICdcXHgwYic7XG4gICAgQzAuRkYgPSAnXFx4MGMnO1xuICAgIEMwLkNSID0gJ1xceDBkJztcbiAgICBDMC5TTyA9ICdcXHgwZSc7XG4gICAgQzAuU0kgPSAnXFx4MGYnO1xuICAgIEMwLkRMRSA9ICdcXHgxMCc7XG4gICAgQzAuREMxID0gJ1xceDExJztcbiAgICBDMC5EQzIgPSAnXFx4MTInO1xuICAgIEMwLkRDMyA9ICdcXHgxMyc7XG4gICAgQzAuREM0ID0gJ1xceDE0JztcbiAgICBDMC5OQUsgPSAnXFx4MTUnO1xuICAgIEMwLlNZTiA9ICdcXHgxNic7XG4gICAgQzAuRVRCID0gJ1xceDE3JztcbiAgICBDMC5DQU4gPSAnXFx4MTgnO1xuICAgIEMwLkVNID0gJ1xceDE5JztcbiAgICBDMC5TVUIgPSAnXFx4MWEnO1xuICAgIEMwLkVTQyA9ICdcXHgxYic7XG4gICAgQzAuRlMgPSAnXFx4MWMnO1xuICAgIEMwLkdTID0gJ1xceDFkJztcbiAgICBDMC5SUyA9ICdcXHgxZSc7XG4gICAgQzAuVVMgPSAnXFx4MWYnO1xuICAgIEMwLlNQID0gJ1xceDIwJztcbiAgICBDMC5ERUwgPSAnXFx4N2YnO1xufSkoQzAgPSBleHBvcnRzLkMwIHx8IChleHBvcnRzLkMwID0ge30pKTtcbjtcblxuXG5cbn0se31dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgRXZlbnRFbWl0dGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTtcbiAgICB9XG4gICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uICh0eXBlLCBsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSB0aGlzLl9ldmVudHNbdHlwZV0gfHwgW107XG4gICAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgICB9O1xuICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9iaiA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICAgICAgdmFyIGkgPSBvYmoubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBpZiAob2JqW2ldID09PSBsaXN0ZW5lciB8fCBvYmpbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgb2JqLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGZ1bmN0aW9uIG9uKCkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuICAgICAgICAgICAgdGhpcy5vZmYodHlwZSwgb24pO1xuICAgICAgICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgb24ubGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICAgICAgdGhpcy5vbih0eXBlLCBvbik7XG4gICAgfTtcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvYmogPSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvYmpbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50c1t0eXBlXSB8fCBbXTtcbiAgICB9O1xuICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgfTtcbiAgICByZXR1cm4gRXZlbnRFbWl0dGVyO1xufSgpKTtcbmV4cG9ydHMuRXZlbnRFbWl0dGVyID0gRXZlbnRFbWl0dGVyO1xuXG5cblxufSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBFc2NhcGVTZXF1ZW5jZXNfMSA9IHJlcXVpcmUoXCIuL0VzY2FwZVNlcXVlbmNlc1wiKTtcbnZhciBDaGFyc2V0c18xID0gcmVxdWlyZShcIi4vQ2hhcnNldHNcIik7XG52YXIgQnVmZmVyXzEgPSByZXF1aXJlKFwiLi9CdWZmZXJcIik7XG52YXIgVHlwZXNfMSA9IHJlcXVpcmUoXCIuL3JlbmRlcmVyL1R5cGVzXCIpO1xudmFyIENoYXJXaWR0aF8xID0gcmVxdWlyZShcIi4vQ2hhcldpZHRoXCIpO1xudmFyIElucHV0SGFuZGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSW5wdXRIYW5kbGVyKF90ZXJtaW5hbCkge1xuICAgICAgICB0aGlzLl90ZXJtaW5hbCA9IF90ZXJtaW5hbDtcbiAgICB9XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5hZGRDaGFyID0gZnVuY3Rpb24gKGNoYXIsIGNvZGUpIHtcbiAgICAgICAgaWYgKGNoYXIgPj0gJyAnKSB7XG4gICAgICAgICAgICB2YXIgY2hfd2lkdGggPSBDaGFyV2lkdGhfMS53Y3dpZHRoKGNvZGUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmNoYXJzZXQgJiYgdGhpcy5fdGVybWluYWwuY2hhcnNldFtjaGFyXSkge1xuICAgICAgICAgICAgICAgIGNoYXIgPSB0aGlzLl90ZXJtaW5hbC5jaGFyc2V0W2NoYXJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJvdyA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ICsgdGhpcy5fdGVybWluYWwuYnVmZmVyLnliYXNlO1xuICAgICAgICAgICAgaWYgKCFjaF93aWR0aCAmJiB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuZ2V0KHJvdylbdGhpcy5fdGVybWluYWwuYnVmZmVyLnggLSAxXSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KVt0aGlzLl90ZXJtaW5hbC5idWZmZXIueCAtIDFdW0J1ZmZlcl8xLkNIQVJfREFUQV9XSURUSF9JTkRFWF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuZ2V0KHJvdylbdGhpcy5fdGVybWluYWwuYnVmZmVyLnggLSAyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KVt0aGlzLl90ZXJtaW5hbC5idWZmZXIueCAtIDJdW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXSArPSBjaGFyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KVt0aGlzLl90ZXJtaW5hbC5idWZmZXIueCAtIDJdWzNdID0gY2hhci5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLmdldChyb3cpW3RoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54IC0gMV1bQnVmZmVyXzEuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdICs9IGNoYXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuZ2V0KHJvdylbdGhpcy5fdGVybWluYWwuYnVmZmVyLnggLSAxXVszXSA9IGNoYXIuY2hhckNvZGVBdCgwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC51cGRhdGVSYW5nZSh0aGlzLl90ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCArIGNoX3dpZHRoIC0gMSA+PSB0aGlzLl90ZXJtaW5hbC5jb2xzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLndyYXBhcm91bmRNb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkrKztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID4gdGhpcy5fdGVybWluYWwuYnVmZmVyLnNjcm9sbEJvdHRvbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnktLTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNjcm9sbCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQodGhpcy5fdGVybWluYWwuYnVmZmVyLnkpLmlzV3JhcHBlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaF93aWR0aCA9PT0gMilcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb3cgPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSArIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5pbnNlcnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbW92ZXMgPSAwOyBtb3ZlcyA8IGNoX3dpZHRoOyArK21vdmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdmVkID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLmdldCh0aGlzLl90ZXJtaW5hbC5idWZmZXIueSArIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZSkucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdmVkW0J1ZmZlcl8xLkNIQVJfREFUQV9XSURUSF9JTkRFWF0gPT09IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KVt0aGlzLl90ZXJtaW5hbC5jb2xzIC0gMl1cbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KVt0aGlzLl90ZXJtaW5hbC5jb2xzIC0gMl1bQnVmZmVyXzEuQ0hBUl9EQVRBX1dJRFRIX0lOREVYXSA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLmdldChyb3cpW3RoaXMuX3Rlcm1pbmFsLmNvbHMgLSAyXSA9IFt0aGlzLl90ZXJtaW5hbC5jdXJBdHRyLCAnICcsIDEsICcgJy5jaGFyQ29kZUF0KDApXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuZ2V0KHJvdykuc3BsaWNlKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54LCAwLCBbdGhpcy5fdGVybWluYWwuY3VyQXR0ciwgJyAnLCAxLCAnICcuY2hhckNvZGVBdCgwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KVt0aGlzLl90ZXJtaW5hbC5idWZmZXIueF0gPSBbdGhpcy5fdGVybWluYWwuY3VyQXR0ciwgY2hhciwgY2hfd2lkdGgsIGNoYXIuY2hhckNvZGVBdCgwKV07XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCsrO1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwudXBkYXRlUmFuZ2UodGhpcy5fdGVybWluYWwuYnVmZmVyLnkpO1xuICAgICAgICAgICAgaWYgKGNoX3dpZHRoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLmdldChyb3cpW3RoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54XSA9IFt0aGlzLl90ZXJtaW5hbC5jdXJBdHRyLCAnJywgMCwgdW5kZWZpbmVkXTtcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLmJlbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJlbGwoKTtcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUubGluZUZlZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5jb252ZXJ0RW9sKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkrKztcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID4gdGhpcy5fdGVybWluYWwuYnVmZmVyLnNjcm9sbEJvdHRvbSkge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnktLTtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNjcm9sbCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA+PSB0aGlzLl90ZXJtaW5hbC5jb2xzKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueC0tO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVtaXQoJ2xpbmVmZWVkJyk7XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLmNhcnJpYWdlUmV0dXJuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IDA7XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLmJhY2tzcGFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLngtLTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS50YWIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLm5leHRTdG9wKCk7XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLnNoaWZ0T3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRnTGV2ZWwoMSk7XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLnNoaWZ0SW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNldGdMZXZlbCgwKTtcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuaW5zZXJ0Q2hhcnMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1swXTtcbiAgICAgICAgaWYgKHBhcmFtIDwgMSlcbiAgICAgICAgICAgIHBhcmFtID0gMTtcbiAgICAgICAgdmFyIHJvdyA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ICsgdGhpcy5fdGVybWluYWwuYnVmZmVyLnliYXNlO1xuICAgICAgICB2YXIgaiA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54O1xuICAgICAgICB2YXIgY2ggPSBbdGhpcy5fdGVybWluYWwuZXJhc2VBdHRyKCksICcgJywgMSwgMzJdO1xuICAgICAgICB3aGlsZSAocGFyYW0tLSAmJiBqIDwgdGhpcy5fdGVybWluYWwuY29scykge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLmdldChyb3cpLnNwbGljZShqKyssIDAsIGNoKTtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KS5wb3AoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5jdXJzb3JVcCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdO1xuICAgICAgICBpZiAocGFyYW0gPCAxKSB7XG4gICAgICAgICAgICBwYXJhbSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkgLT0gcGFyYW07XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID0gMDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5jdXJzb3JEb3duID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF07XG4gICAgICAgIGlmIChwYXJhbSA8IDEpIHtcbiAgICAgICAgICAgIHBhcmFtID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSArPSBwYXJhbTtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID49IHRoaXMuX3Rlcm1pbmFsLnJvd3MpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID0gdGhpcy5fdGVybWluYWwucm93cyAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID49IHRoaXMuX3Rlcm1pbmFsLmNvbHMpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54LS07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuY3Vyc29yRm9yd2FyZCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdO1xuICAgICAgICBpZiAocGFyYW0gPCAxKSB7XG4gICAgICAgICAgICBwYXJhbSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnggKz0gcGFyYW07XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA+PSB0aGlzLl90ZXJtaW5hbC5jb2xzKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IHRoaXMuX3Rlcm1pbmFsLmNvbHMgLSAxO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLmN1cnNvckJhY2t3YXJkID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF07XG4gICAgICAgIGlmIChwYXJhbSA8IDEpIHtcbiAgICAgICAgICAgIHBhcmFtID0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwuYnVmZmVyLnggPj0gdGhpcy5fdGVybWluYWwuY29scykge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLngtLTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCAtPSBwYXJhbTtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54IDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnggPSAwO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLmN1cnNvck5leHRMaW5lID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF07XG4gICAgICAgIGlmIChwYXJhbSA8IDEpIHtcbiAgICAgICAgICAgIHBhcmFtID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSArPSBwYXJhbTtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID49IHRoaXMuX3Rlcm1pbmFsLnJvd3MpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID0gdGhpcy5fdGVybWluYWwucm93cyAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnggPSAwO1xuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5jdXJzb3JQcmVjZWRpbmdMaW5lID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF07XG4gICAgICAgIGlmIChwYXJhbSA8IDEpIHtcbiAgICAgICAgICAgIHBhcmFtID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSAtPSBwYXJhbTtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55IDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID0gMDtcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuY3Vyc29yQ2hhckFic29sdXRlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF07XG4gICAgICAgIGlmIChwYXJhbSA8IDEpIHtcbiAgICAgICAgICAgIHBhcmFtID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IHBhcmFtIC0gMTtcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuY3Vyc29yUG9zaXRpb24gPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBjb2w7XG4gICAgICAgIHZhciByb3cgPSBwYXJhbXNbMF0gLSAxO1xuICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgICAgICBjb2wgPSBwYXJhbXNbMV0gLSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29sID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93IDwgMCkge1xuICAgICAgICAgICAgcm93ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyb3cgPj0gdGhpcy5fdGVybWluYWwucm93cykge1xuICAgICAgICAgICAgcm93ID0gdGhpcy5fdGVybWluYWwucm93cyAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbCA8IDApIHtcbiAgICAgICAgICAgIGNvbCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29sID49IHRoaXMuX3Rlcm1pbmFsLmNvbHMpIHtcbiAgICAgICAgICAgIGNvbCA9IHRoaXMuX3Rlcm1pbmFsLmNvbHMgLSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID0gY29sO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSA9IHJvdztcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuY3Vyc29yRm9yd2FyZFRhYiA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdIHx8IDE7XG4gICAgICAgIHdoaWxlIChwYXJhbS0tKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5uZXh0U3RvcCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLmVyYXNlSW5EaXNwbGF5ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgajtcbiAgICAgICAgc3dpdGNoIChwYXJhbXNbMF0pIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5lcmFzZVJpZ2h0KHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54LCB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgICAgICAgICAgICAgaiA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ICsgMTtcbiAgICAgICAgICAgICAgICBmb3IgKDsgaiA8IHRoaXMuX3Rlcm1pbmFsLnJvd3M7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5lcmFzZUxpbmUoaik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVyYXNlTGVmdCh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCwgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkpO1xuICAgICAgICAgICAgICAgIGogPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIueTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoai0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVyYXNlTGluZShqKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgaiA9IHRoaXMuX3Rlcm1pbmFsLnJvd3M7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGotLSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZXJhc2VMaW5lKGopO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxCYWNrU2l6ZSA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5sZW5ndGggLSB0aGlzLl90ZXJtaW5hbC5yb3dzO1xuICAgICAgICAgICAgICAgIGlmIChzY3JvbGxCYWNrU2l6ZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLnRyaW1TdGFydChzY3JvbGxCYWNrU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZSA9IE1hdGgubWF4KHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZSAtIHNjcm9sbEJhY2tTaXplLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnlkaXNwID0gTWF0aC5tYXgodGhpcy5fdGVybWluYWwuYnVmZmVyLnlkaXNwIC0gc2Nyb2xsQmFja1NpemUsIDApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5lbWl0KCdzY3JvbGwnLCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuZXJhc2VJbkxpbmUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHN3aXRjaCAocGFyYW1zWzBdKSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZXJhc2VSaWdodCh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCwgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVyYXNlTGVmdCh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCwgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVyYXNlTGluZSh0aGlzLl90ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuaW5zZXJ0TGluZXMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1swXTtcbiAgICAgICAgaWYgKHBhcmFtIDwgMSkge1xuICAgICAgICAgICAgcGFyYW0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb3cgPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSArIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZTtcbiAgICAgICAgdmFyIHNjcm9sbEJvdHRvbVJvd3NPZmZzZXQgPSB0aGlzLl90ZXJtaW5hbC5yb3dzIC0gMSAtIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxCb3R0b207XG4gICAgICAgIHZhciBzY3JvbGxCb3R0b21BYnNvbHV0ZSA9IHRoaXMuX3Rlcm1pbmFsLnJvd3MgLSAxICsgdGhpcy5fdGVybWluYWwuYnVmZmVyLnliYXNlIC0gc2Nyb2xsQm90dG9tUm93c09mZnNldCArIDE7XG4gICAgICAgIHdoaWxlIChwYXJhbS0tKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuc3BsaWNlKHNjcm9sbEJvdHRvbUFic29sdXRlIC0gMSwgMSk7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuc3BsaWNlKHJvdywgMCwgdGhpcy5fdGVybWluYWwuYmxhbmtMaW5lKHRydWUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC51cGRhdGVSYW5nZSh0aGlzLl90ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLnVwZGF0ZVJhbmdlKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxCb3R0b20pO1xuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5kZWxldGVMaW5lcyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdO1xuICAgICAgICBpZiAocGFyYW0gPCAxKSB7XG4gICAgICAgICAgICBwYXJhbSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvdyA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ICsgdGhpcy5fdGVybWluYWwuYnVmZmVyLnliYXNlO1xuICAgICAgICB2YXIgajtcbiAgICAgICAgaiA9IHRoaXMuX3Rlcm1pbmFsLnJvd3MgLSAxIC0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnNjcm9sbEJvdHRvbTtcbiAgICAgICAgaiA9IHRoaXMuX3Rlcm1pbmFsLnJvd3MgLSAxICsgdGhpcy5fdGVybWluYWwuYnVmZmVyLnliYXNlIC0gajtcbiAgICAgICAgd2hpbGUgKHBhcmFtLS0pIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5zcGxpY2Uocm93LCAxKTtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5zcGxpY2UoaiwgMCwgdGhpcy5fdGVybWluYWwuYmxhbmtMaW5lKHRydWUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC51cGRhdGVSYW5nZSh0aGlzLl90ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLnVwZGF0ZVJhbmdlKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxCb3R0b20pO1xuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5kZWxldGVDaGFycyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdO1xuICAgICAgICBpZiAocGFyYW0gPCAxKSB7XG4gICAgICAgICAgICBwYXJhbSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvdyA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ICsgdGhpcy5fdGVybWluYWwuYnVmZmVyLnliYXNlO1xuICAgICAgICB2YXIgY2ggPSBbdGhpcy5fdGVybWluYWwuZXJhc2VBdHRyKCksICcgJywgMSwgMzJdO1xuICAgICAgICB3aGlsZSAocGFyYW0tLSkge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLmdldChyb3cpLnNwbGljZSh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCwgMSk7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuZ2V0KHJvdykucHVzaChjaCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwudXBkYXRlUmFuZ2UodGhpcy5fdGVybWluYWwuYnVmZmVyLnkpO1xuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5zY3JvbGxVcCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdIHx8IDE7XG4gICAgICAgIHdoaWxlIChwYXJhbS0tKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuc3BsaWNlKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZSArIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxUb3AsIDEpO1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLnNwbGljZSh0aGlzLl90ZXJtaW5hbC5idWZmZXIueWJhc2UgKyB0aGlzLl90ZXJtaW5hbC5idWZmZXIuc2Nyb2xsQm90dG9tLCAwLCB0aGlzLl90ZXJtaW5hbC5ibGFua0xpbmUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwudXBkYXRlUmFuZ2UodGhpcy5fdGVybWluYWwuYnVmZmVyLnNjcm9sbFRvcCk7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLnVwZGF0ZVJhbmdlKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxCb3R0b20pO1xuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5zY3JvbGxEb3duID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF0gfHwgMTtcbiAgICAgICAgd2hpbGUgKHBhcmFtLS0pIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5zcGxpY2UodGhpcy5fdGVybWluYWwuYnVmZmVyLnliYXNlICsgdGhpcy5fdGVybWluYWwuYnVmZmVyLnNjcm9sbEJvdHRvbSwgMSk7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMuc3BsaWNlKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZSArIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxUb3AsIDAsIHRoaXMuX3Rlcm1pbmFsLmJsYW5rTGluZSgpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC51cGRhdGVSYW5nZSh0aGlzLl90ZXJtaW5hbC5idWZmZXIuc2Nyb2xsVG9wKTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwudXBkYXRlUmFuZ2UodGhpcy5fdGVybWluYWwuYnVmZmVyLnNjcm9sbEJvdHRvbSk7XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLmVyYXNlQ2hhcnMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1swXTtcbiAgICAgICAgaWYgKHBhcmFtIDwgMSkge1xuICAgICAgICAgICAgcGFyYW0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb3cgPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSArIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55YmFzZTtcbiAgICAgICAgdmFyIGogPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIueDtcbiAgICAgICAgdmFyIGNoID0gW3RoaXMuX3Rlcm1pbmFsLmVyYXNlQXR0cigpLCAnICcsIDEsIDMyXTtcbiAgICAgICAgd2hpbGUgKHBhcmFtLS0gJiYgaiA8IHRoaXMuX3Rlcm1pbmFsLmNvbHMpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KVtqKytdID0gY2g7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuY3Vyc29yQmFja3dhcmRUYWIgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1swXSB8fCAxO1xuICAgICAgICB3aGlsZSAocGFyYW0tLSkge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnggPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIucHJldlN0b3AoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5jaGFyUG9zQWJzb2x1dGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1swXTtcbiAgICAgICAgaWYgKHBhcmFtIDwgMSkge1xuICAgICAgICAgICAgcGFyYW0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID0gcGFyYW0gLSAxO1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwuYnVmZmVyLnggPj0gdGhpcy5fdGVybWluYWwuY29scykge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnggPSB0aGlzLl90ZXJtaW5hbC5jb2xzIC0gMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5IUG9zaXRpb25SZWxhdGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdO1xuICAgICAgICBpZiAocGFyYW0gPCAxKSB7XG4gICAgICAgICAgICBwYXJhbSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnggKz0gcGFyYW07XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA+PSB0aGlzLl90ZXJtaW5hbC5jb2xzKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IHRoaXMuX3Rlcm1pbmFsLmNvbHMgLSAxO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLnJlcGVhdFByZWNlZGluZ0NoYXJhY3RlciA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zWzBdIHx8IDE7XG4gICAgICAgIHZhciBsaW5lID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLmxpbmVzLmdldCh0aGlzLl90ZXJtaW5hbC5idWZmZXIueWJhc2UgKyB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgICAgIHZhciBjaCA9IGxpbmVbdGhpcy5fdGVybWluYWwuYnVmZmVyLnggLSAxXSB8fCBbdGhpcy5fdGVybWluYWwuZGVmQXR0ciwgJyAnLCAxLCAzMl07XG4gICAgICAgIHdoaWxlIChwYXJhbS0tKSB7XG4gICAgICAgICAgICBsaW5lW3RoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54KytdID0gY2g7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuc2VuZERldmljZUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIGlmIChwYXJhbXNbMF0gPiAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl90ZXJtaW5hbC5wcmVmaXgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5pcygneHRlcm0nKSB8fCB0aGlzLl90ZXJtaW5hbC5pcygncnh2dC11bmljb2RlJykgfHwgdGhpcy5fdGVybWluYWwuaXMoJ3NjcmVlbicpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2VuZChFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWz8xOzJjJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLl90ZXJtaW5hbC5pcygnbGludXgnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbmQoRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1s/NmMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl90ZXJtaW5hbC5wcmVmaXggPT09ICc+Jykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmlzKCd4dGVybScpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2VuZChFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWz4wOzI3NjswYycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5fdGVybWluYWwuaXMoJ3J4dnQtdW5pY29kZScpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2VuZChFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWz44NTs5NTswYycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5fdGVybWluYWwuaXMoJ2xpbnV4JykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZW5kKHBhcmFtc1swXSArICdjJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLl90ZXJtaW5hbC5pcygnc2NyZWVuJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZW5kKEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbPjgzOzQwMDAzOzBjJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUubGluZVBvc0Fic29sdXRlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF07XG4gICAgICAgIGlmIChwYXJhbSA8IDEpIHtcbiAgICAgICAgICAgIHBhcmFtID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSA9IHBhcmFtIC0gMTtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID49IHRoaXMuX3Rlcm1pbmFsLnJvd3MpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID0gdGhpcy5fdGVybWluYWwucm93cyAtIDE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuVlBvc2l0aW9uUmVsYXRpdmUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1swXTtcbiAgICAgICAgaWYgKHBhcmFtIDwgMSkge1xuICAgICAgICAgICAgcGFyYW0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ICs9IHBhcmFtO1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwuYnVmZmVyLnkgPj0gdGhpcy5fdGVybWluYWwucm93cykge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkgPSB0aGlzLl90ZXJtaW5hbC5yb3dzIC0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwuYnVmZmVyLnggPj0gdGhpcy5fdGVybWluYWwuY29scykge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLngtLTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5IVlBvc2l0aW9uID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAocGFyYW1zWzBdIDwgMSlcbiAgICAgICAgICAgIHBhcmFtc1swXSA9IDE7XG4gICAgICAgIGlmIChwYXJhbXNbMV0gPCAxKVxuICAgICAgICAgICAgcGFyYW1zWzFdID0gMTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkgPSBwYXJhbXNbMF0gLSAxO1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwuYnVmZmVyLnkgPj0gdGhpcy5fdGVybWluYWwucm93cykge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnkgPSB0aGlzLl90ZXJtaW5hbC5yb3dzIC0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IHBhcmFtc1sxXSAtIDE7XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA+PSB0aGlzLl90ZXJtaW5hbC5jb2xzKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IHRoaXMuX3Rlcm1pbmFsLmNvbHMgLSAxO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLnRhYkNsZWFyID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF07XG4gICAgICAgIGlmIChwYXJhbSA8PSAwKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fdGVybWluYWwuYnVmZmVyLnRhYnNbdGhpcy5fdGVybWluYWwuYnVmZmVyLnhdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcmFtID09PSAzKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIudGFicyA9IHt9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLnNldE1vZGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIGlmIChwYXJhbXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldE1vZGUoW3BhcmFtc1tpXV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fdGVybWluYWwucHJlZml4KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhcmFtc1swXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuaW5zZXJ0TW9kZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjA6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX3Rlcm1pbmFsLnByZWZpeCA9PT0gJz8nKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhcmFtc1swXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYXBwbGljYXRpb25DdXJzb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNldGdDaGFyc2V0KDAsIENoYXJzZXRzXzEuREVGQVVMVF9DSEFSU0VUKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2V0Z0NoYXJzZXQoMSwgQ2hhcnNldHNfMS5ERUZBVUxUX0NIQVJTRVQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRnQ2hhcnNldCgyLCBDaGFyc2V0c18xLkRFRkFVTFRfQ0hBUlNFVCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNldGdDaGFyc2V0KDMsIENoYXJzZXRzXzEuREVGQVVMVF9DSEFSU0VUKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zYXZlZENvbHMgPSB0aGlzLl90ZXJtaW5hbC5jb2xzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5yZXNpemUoMTMyLCB0aGlzLl90ZXJtaW5hbC5yb3dzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5vcmlnaW5Nb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC53cmFwYXJvdW5kTW9kZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNjY6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmxvZygnU2VyaWFsIHBvcnQgcmVxdWVzdGVkIGFwcGxpY2F0aW9uIGtleXBhZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYXBwbGljYXRpb25LZXlwYWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC52aWV3cG9ydC5zeW5jU2Nyb2xsQXJlYSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgY2FzZSAxMDAwOlxuICAgICAgICAgICAgICAgIGNhc2UgMTAwMjpcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDM6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLngxME1vdXNlID0gcGFyYW1zWzBdID09PSA5O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC52dDIwME1vdXNlID0gcGFyYW1zWzBdID09PSAxMDAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5ub3JtYWxNb3VzZSA9IHBhcmFtc1swXSA+IDEwMDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLm1vdXNlRXZlbnRzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlbmFibGUtbW91c2UtZXZlbnRzJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbGVjdGlvbk1hbmFnZXIuZGlzYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5sb2coJ0JpbmRpbmcgdG8gbW91c2UgZXZlbnRzLicpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbmRGb2N1cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTAwNTpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwudXRmTW91c2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDY6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNnck1vdXNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDE1OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC51cnh2dE1vdXNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyNTpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuY3Vyc29ySGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTA0OTpcbiAgICAgICAgICAgICAgICBjYXNlIDQ3OlxuICAgICAgICAgICAgICAgIGNhc2UgMTA0NzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVycy5hY3RpdmF0ZUFsdEJ1ZmZlcigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZWxlY3Rpb25NYW5hZ2VyLnNldEJ1ZmZlcih0aGlzLl90ZXJtaW5hbC5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC52aWV3cG9ydC5zeW5jU2Nyb2xsQXJlYSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zaG93Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjAwNDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnJhY2tldGVkUGFzdGVNb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUucmVzZXRNb2RlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldE1vZGUoW3BhcmFtc1tpXV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fdGVybWluYWwucHJlZml4KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhcmFtc1swXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuaW5zZXJ0TW9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl90ZXJtaW5hbC5wcmVmaXggPT09ICc/Jykge1xuICAgICAgICAgICAgc3dpdGNoIChwYXJhbXNbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmFwcGxpY2F0aW9uQ3Vyc29yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmNvbHMgPT09IDEzMiAmJiB0aGlzLl90ZXJtaW5hbC5zYXZlZENvbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnJlc2l6ZSh0aGlzLl90ZXJtaW5hbC5zYXZlZENvbHMsIHRoaXMuX3Rlcm1pbmFsLnJvd3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl90ZXJtaW5hbC5zYXZlZENvbHM7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwub3JpZ2luTW9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLndyYXBhcm91bmRNb2RlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNjY6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmxvZygnU3dpdGNoaW5nIGJhY2sgdG8gbm9ybWFsIGtleXBhZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYXBwbGljYXRpb25LZXlwYWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwudmlld3BvcnQuc3luY1Njcm9sbEFyZWEoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIGNhc2UgMTAwMDpcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDI6XG4gICAgICAgICAgICAgICAgY2FzZSAxMDAzOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC54MTBNb3VzZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC52dDIwME1vdXNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLm5vcm1hbE1vdXNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLm1vdXNlRXZlbnRzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZW5hYmxlLW1vdXNlLWV2ZW50cycpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZWxlY3Rpb25NYW5hZ2VyLmVuYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbmRGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDU6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnV0Zk1vdXNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTAwNjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2dyTW91c2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDE1OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC51cnh2dE1vdXNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjU6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmN1cnNvckhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTA0OTpcbiAgICAgICAgICAgICAgICBjYXNlIDQ3OlxuICAgICAgICAgICAgICAgIGNhc2UgMTA0NzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVycy5hY3RpdmF0ZU5vcm1hbEJ1ZmZlcigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZWxlY3Rpb25NYW5hZ2VyLnNldEJ1ZmZlcih0aGlzLl90ZXJtaW5hbC5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5yZWZyZXNoKDAsIHRoaXMuX3Rlcm1pbmFsLnJvd3MgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwudmlld3BvcnQuc3luY1Njcm9sbEFyZWEoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2hvd0N1cnNvcigpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDIwMDQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJyYWNrZXRlZFBhc3RlTW9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgSW5wdXRIYW5kbGVyLnByb3RvdHlwZS5jaGFyQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgaWYgKHBhcmFtcy5sZW5ndGggPT09IDEgJiYgcGFyYW1zWzBdID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5jdXJBdHRyID0gdGhpcy5fdGVybWluYWwuZGVmQXR0cjtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbCA9IHBhcmFtcy5sZW5ndGg7XG4gICAgICAgIHZhciBmbGFncyA9IHRoaXMuX3Rlcm1pbmFsLmN1ckF0dHIgPj4gMTg7XG4gICAgICAgIHZhciBmZyA9ICh0aGlzLl90ZXJtaW5hbC5jdXJBdHRyID4+IDkpICYgMHgxZmY7XG4gICAgICAgIHZhciBiZyA9IHRoaXMuX3Rlcm1pbmFsLmN1ckF0dHIgJiAweDFmZjtcbiAgICAgICAgdmFyIHA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBwID0gcGFyYW1zW2ldO1xuICAgICAgICAgICAgaWYgKHAgPj0gMzAgJiYgcCA8PSAzNykge1xuICAgICAgICAgICAgICAgIGZnID0gcCAtIDMwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocCA+PSA0MCAmJiBwIDw9IDQ3KSB7XG4gICAgICAgICAgICAgICAgYmcgPSBwIC0gNDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID49IDkwICYmIHAgPD0gOTcpIHtcbiAgICAgICAgICAgICAgICBwICs9IDg7XG4gICAgICAgICAgICAgICAgZmcgPSBwIC0gOTA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID49IDEwMCAmJiBwIDw9IDEwNykge1xuICAgICAgICAgICAgICAgIHAgKz0gODtcbiAgICAgICAgICAgICAgICBiZyA9IHAgLSAxMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MgPSB0aGlzLl90ZXJtaW5hbC5kZWZBdHRyID4+IDE4O1xuICAgICAgICAgICAgICAgIGZnID0gKHRoaXMuX3Rlcm1pbmFsLmRlZkF0dHIgPj4gOSkgJiAweDFmZjtcbiAgICAgICAgICAgICAgICBiZyA9IHRoaXMuX3Rlcm1pbmFsLmRlZkF0dHIgJiAweDFmZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHAgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBmbGFncyB8PSBUeXBlc18xLkZMQUdTLkJPTEQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSA0KSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MgfD0gVHlwZXNfMS5GTEFHUy5VTkRFUkxJTkU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSA1KSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MgfD0gVHlwZXNfMS5GTEFHUy5CTElOSztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHAgPT09IDcpIHtcbiAgICAgICAgICAgICAgICBmbGFncyB8PSBUeXBlc18xLkZMQUdTLklOVkVSU0U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSA4KSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MgfD0gVHlwZXNfMS5GTEFHUy5JTlZJU0lCTEU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSAyKSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MgfD0gVHlwZXNfMS5GTEFHUy5ESU07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSAyMikge1xuICAgICAgICAgICAgICAgIGZsYWdzICY9IH5UeXBlc18xLkZMQUdTLkJPTEQ7XG4gICAgICAgICAgICAgICAgZmxhZ3MgJj0gflR5cGVzXzEuRkxBR1MuRElNO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocCA9PT0gMjQpIHtcbiAgICAgICAgICAgICAgICBmbGFncyAmPSB+VHlwZXNfMS5GTEFHUy5VTkRFUkxJTkU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSAyNSkge1xuICAgICAgICAgICAgICAgIGZsYWdzICY9IH5UeXBlc18xLkZMQUdTLkJMSU5LO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocCA9PT0gMjcpIHtcbiAgICAgICAgICAgICAgICBmbGFncyAmPSB+VHlwZXNfMS5GTEFHUy5JTlZFUlNFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocCA9PT0gMjgpIHtcbiAgICAgICAgICAgICAgICBmbGFncyAmPSB+VHlwZXNfMS5GTEFHUy5JTlZJU0lCTEU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSAzOSkge1xuICAgICAgICAgICAgICAgIGZnID0gKHRoaXMuX3Rlcm1pbmFsLmRlZkF0dHIgPj4gOSkgJiAweDFmZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHAgPT09IDQ5KSB7XG4gICAgICAgICAgICAgICAgYmcgPSB0aGlzLl90ZXJtaW5hbC5kZWZBdHRyICYgMHgxZmY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwID09PSAzOCkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbXNbaSArIDFdID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIGkgKz0gMjtcbiAgICAgICAgICAgICAgICAgICAgZmcgPSB0aGlzLl90ZXJtaW5hbC5tYXRjaENvbG9yKHBhcmFtc1tpXSAmIDB4ZmYsIHBhcmFtc1tpICsgMV0gJiAweGZmLCBwYXJhbXNbaSArIDJdICYgMHhmZik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmZyA9PT0gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICBmZyA9IDB4MWZmO1xuICAgICAgICAgICAgICAgICAgICBpICs9IDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtc1tpICsgMV0gPT09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgaSArPSAyO1xuICAgICAgICAgICAgICAgICAgICBwID0gcGFyYW1zW2ldICYgMHhmZjtcbiAgICAgICAgICAgICAgICAgICAgZmcgPSBwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHAgPT09IDQ4KSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtc1tpICsgMV0gPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgaSArPSAyO1xuICAgICAgICAgICAgICAgICAgICBiZyA9IHRoaXMuX3Rlcm1pbmFsLm1hdGNoQ29sb3IocGFyYW1zW2ldICYgMHhmZiwgcGFyYW1zW2kgKyAxXSAmIDB4ZmYsIHBhcmFtc1tpICsgMl0gJiAweGZmKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJnID09PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJnID0gMHgxZmY7XG4gICAgICAgICAgICAgICAgICAgIGkgKz0gMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1zW2kgKyAxXSA9PT0gNSkge1xuICAgICAgICAgICAgICAgICAgICBpICs9IDI7XG4gICAgICAgICAgICAgICAgICAgIHAgPSBwYXJhbXNbaV0gJiAweGZmO1xuICAgICAgICAgICAgICAgICAgICBiZyA9IHA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocCA9PT0gMTAwKSB7XG4gICAgICAgICAgICAgICAgZmcgPSAodGhpcy5fdGVybWluYWwuZGVmQXR0ciA+PiA5KSAmIDB4MWZmO1xuICAgICAgICAgICAgICAgIGJnID0gdGhpcy5fdGVybWluYWwuZGVmQXR0ciAmIDB4MWZmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZXJyb3IoJ1Vua25vd24gU0dSIGF0dHJpYnV0ZTogJWQuJywgcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGVybWluYWwuY3VyQXR0ciA9IChmbGFncyA8PCAxOCkgfCAoZmcgPDwgOSkgfCBiZztcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuZGV2aWNlU3RhdHVzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAoIXRoaXMuX3Rlcm1pbmFsLnByZWZpeCkge1xuICAgICAgICAgICAgc3dpdGNoIChwYXJhbXNbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbmQoRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1swbicpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbmQoRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1snXG4gICAgICAgICAgICAgICAgICAgICAgICArICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueSArIDEpXG4gICAgICAgICAgICAgICAgICAgICAgICArICc7J1xuICAgICAgICAgICAgICAgICAgICAgICAgKyAodGhpcy5fdGVybWluYWwuYnVmZmVyLnggKyAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgKyAnUicpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl90ZXJtaW5hbC5wcmVmaXggPT09ICc/Jykge1xuICAgICAgICAgICAgc3dpdGNoIChwYXJhbXNbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbmQoRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1s/J1xuICAgICAgICAgICAgICAgICAgICAgICAgKyAodGhpcy5fdGVybWluYWwuYnVmZmVyLnkgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgKyAnOydcbiAgICAgICAgICAgICAgICAgICAgICAgICsgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICsgJ1InKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyNTpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyNjpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA1MzpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuc29mdFJlc2V0ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5jdXJzb3JIaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuaW5zZXJ0TW9kZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5vcmlnaW5Nb2RlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLndyYXBhcm91bmRNb2RlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuYXBwbGljYXRpb25LZXlwYWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwudmlld3BvcnQuc3luY1Njcm9sbEFyZWEoKTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuYXBwbGljYXRpb25DdXJzb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnNjcm9sbFRvcCA9IDA7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxCb3R0b20gPSB0aGlzLl90ZXJtaW5hbC5yb3dzIC0gMTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuY3VyQXR0ciA9IHRoaXMuX3Rlcm1pbmFsLmRlZkF0dHI7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnkgPSAwO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5jaGFyc2V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuZ2xldmVsID0gMDtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuY2hhcnNldHMgPSBbbnVsbF07XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLnNldEN1cnNvclN0eWxlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFyYW0gPSBwYXJhbXNbMF0gPCAxID8gMSA6IHBhcmFtc1swXTtcbiAgICAgICAgc3dpdGNoIChwYXJhbSkge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNldE9wdGlvbignY3Vyc29yU3R5bGUnLCAnYmxvY2snKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRPcHRpb24oJ2N1cnNvclN0eWxlJywgJ3VuZGVybGluZScpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNldE9wdGlvbignY3Vyc29yU3R5bGUnLCAnYmFyJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzQmxpbmtpbmcgPSBwYXJhbSAlIDIgPT09IDE7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNldE9wdGlvbignY3Vyc29yQmxpbmsnLCBpc0JsaW5raW5nKTtcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuc2V0U2Nyb2xsUmVnaW9uID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwucHJlZml4KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIuc2Nyb2xsVG9wID0gKHBhcmFtc1swXSB8fCAxKSAtIDE7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxCb3R0b20gPSAocGFyYW1zWzFdICYmIHBhcmFtc1sxXSA8PSB0aGlzLl90ZXJtaW5hbC5yb3dzID8gcGFyYW1zWzFdIDogdGhpcy5fdGVybWluYWwucm93cykgLSAxO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueCA9IDA7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ID0gMDtcbiAgICB9O1xuICAgIElucHV0SGFuZGxlci5wcm90b3R5cGUuc2F2ZUN1cnNvciA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuYnVmZmVyLnNhdmVkWCA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54O1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIuc2F2ZWRZID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnk7XG4gICAgfTtcbiAgICBJbnB1dEhhbmRsZXIucHJvdG90eXBlLnJlc3RvcmVDdXJzb3IgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci54ID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnNhdmVkWCB8fCAwO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5idWZmZXIueSA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zYXZlZFkgfHwgMDtcbiAgICB9O1xuICAgIHJldHVybiBJbnB1dEhhbmRsZXI7XG59KCkpO1xuZXhwb3J0cy5JbnB1dEhhbmRsZXIgPSBJbnB1dEhhbmRsZXI7XG5cblxuXG59LHtcIi4vQnVmZmVyXCI6MSxcIi4vQ2hhcldpZHRoXCI6MyxcIi4vQ2hhcnNldHNcIjo0LFwiLi9Fc2NhcGVTZXF1ZW5jZXNcIjo2LFwiLi9yZW5kZXJlci9UeXBlc1wiOjI3fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFR5cGVzXzEgPSByZXF1aXJlKFwiLi9UeXBlc1wiKTtcbnZhciBNb3VzZVpvbmVNYW5hZ2VyXzEgPSByZXF1aXJlKFwiLi9pbnB1dC9Nb3VzZVpvbmVNYW5hZ2VyXCIpO1xudmFyIEV2ZW50RW1pdHRlcl8xID0gcmVxdWlyZShcIi4vRXZlbnRFbWl0dGVyXCIpO1xudmFyIHByb3RvY29sQ2xhdXNlID0gJyhodHRwcz86XFxcXC9cXFxcLyknO1xudmFyIGRvbWFpbkNoYXJhY3RlclNldCA9ICdbXFxcXGRhLXpcXFxcLi1dKyc7XG52YXIgbmVnYXRlZERvbWFpbkNoYXJhY3RlclNldCA9ICdbXlxcXFxkYS16XFxcXC4tXSsnO1xudmFyIGRvbWFpbkJvZHlDbGF1c2UgPSAnKCcgKyBkb21haW5DaGFyYWN0ZXJTZXQgKyAnKSc7XG52YXIgdGxkQ2xhdXNlID0gJyhbYS16XFxcXC5dezIsNn0pJztcbnZhciBpcENsYXVzZSA9ICcoKFxcXFxkezEsM31cXFxcLil7M31cXFxcZHsxLDN9KSc7XG52YXIgbG9jYWxIb3N0Q2xhdXNlID0gJyhsb2NhbGhvc3QpJztcbnZhciBwb3J0Q2xhdXNlID0gJyg6XFxcXGR7MSw1fSknO1xudmFyIGhvc3RDbGF1c2UgPSAnKCgnICsgZG9tYWluQm9keUNsYXVzZSArICdcXFxcLicgKyB0bGRDbGF1c2UgKyAnKXwnICsgaXBDbGF1c2UgKyAnfCcgKyBsb2NhbEhvc3RDbGF1c2UgKyAnKScgKyBwb3J0Q2xhdXNlICsgJz8nO1xudmFyIHBhdGhDbGF1c2UgPSAnKFxcXFwvW1xcXFwvXFxcXHdcXFxcLlxcXFwtJX5dKikqJztcbnZhciBxdWVyeVN0cmluZ0hhc2hGcmFnbWVudENoYXJhY3RlclNldCA9ICdbMC05XFxcXHdcXFxcW1xcXFxdXFxcXChcXFxcKVxcXFwvXFxcXD9cXFxcISNAJCUmXFwnKissOjt+XFxcXD1cXFxcLlxcXFwtXSonO1xudmFyIHF1ZXJ5U3RyaW5nQ2xhdXNlID0gJyhcXFxcPycgKyBxdWVyeVN0cmluZ0hhc2hGcmFnbWVudENoYXJhY3RlclNldCArICcpPyc7XG52YXIgaGFzaEZyYWdtZW50Q2xhdXNlID0gJygjJyArIHF1ZXJ5U3RyaW5nSGFzaEZyYWdtZW50Q2hhcmFjdGVyU2V0ICsgJyk/JztcbnZhciBuZWdhdGVkUGF0aENoYXJhY3RlclNldCA9ICdbXlxcXFwvXFxcXHdcXFxcLlxcXFwtJV0rJztcbnZhciBib2R5Q2xhdXNlID0gaG9zdENsYXVzZSArIHBhdGhDbGF1c2UgKyBxdWVyeVN0cmluZ0NsYXVzZSArIGhhc2hGcmFnbWVudENsYXVzZTtcbnZhciBzdGFydCA9ICcoPzpefCcgKyBuZWdhdGVkRG9tYWluQ2hhcmFjdGVyU2V0ICsgJykoJztcbnZhciBlbmQgPSAnKSgkfCcgKyBuZWdhdGVkUGF0aENoYXJhY3RlclNldCArICcpJztcbnZhciBzdHJpY3RVcmxSZWdleCA9IG5ldyBSZWdFeHAoc3RhcnQgKyBwcm90b2NvbENsYXVzZSArIGJvZHlDbGF1c2UgKyBlbmQpO1xudmFyIEhZUEVSVEVYVF9MSU5LX01BVENIRVJfSUQgPSAwO1xudmFyIExpbmtpZmllciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExpbmtpZmllciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaW5raWZpZXIoX3Rlcm1pbmFsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl90ZXJtaW5hbCA9IF90ZXJtaW5hbDtcbiAgICAgICAgX3RoaXMuX2xpbmtNYXRjaGVycyA9IFtdO1xuICAgICAgICBfdGhpcy5fbmV4dExpbmtNYXRjaGVySWQgPSBIWVBFUlRFWFRfTElOS19NQVRDSEVSX0lEO1xuICAgICAgICBfdGhpcy5fcm93c1RvTGlua2lmeSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBudWxsLFxuICAgICAgICAgICAgZW5kOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnJlZ2lzdGVyTGlua01hdGNoZXIoc3RyaWN0VXJsUmVnZXgsIG51bGwsIHsgbWF0Y2hJbmRleDogMSB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBMaW5raWZpZXIucHJvdG90eXBlLmF0dGFjaFRvRG9tID0gZnVuY3Rpb24gKG1vdXNlWm9uZU1hbmFnZXIpIHtcbiAgICAgICAgdGhpcy5fbW91c2Vab25lTWFuYWdlciA9IG1vdXNlWm9uZU1hbmFnZXI7XG4gICAgfTtcbiAgICBMaW5raWZpZXIucHJvdG90eXBlLmxpbmtpZnlSb3dzID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLl9tb3VzZVpvbmVNYW5hZ2VyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9yb3dzVG9MaW5raWZ5LnN0YXJ0KSB7XG4gICAgICAgICAgICB0aGlzLl9yb3dzVG9MaW5raWZ5LnN0YXJ0ID0gc3RhcnQ7XG4gICAgICAgICAgICB0aGlzLl9yb3dzVG9MaW5raWZ5LmVuZCA9IGVuZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3Jvd3NUb0xpbmtpZnkuc3RhcnQgPSB0aGlzLl9yb3dzVG9MaW5raWZ5LnN0YXJ0IDwgc3RhcnQgPyB0aGlzLl9yb3dzVG9MaW5raWZ5LnN0YXJ0IDogc3RhcnQ7XG4gICAgICAgICAgICB0aGlzLl9yb3dzVG9MaW5raWZ5LmVuZCA9IHRoaXMuX3Jvd3NUb0xpbmtpZnkuZW5kID4gZW5kID8gdGhpcy5fcm93c1RvTGlua2lmeS5lbmQgOiBlbmQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbW91c2Vab25lTWFuYWdlci5jbGVhckFsbChzdGFydCwgZW5kKTtcbiAgICAgICAgaWYgKHRoaXMuX3Jvd3NUaW1lb3V0SWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9yb3dzVGltZW91dElkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yb3dzVGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fbGlua2lmeVJvd3MoKTsgfSwgTGlua2lmaWVyLlRJTUVfQkVGT1JFX0xJTktJRlkpO1xuICAgIH07XG4gICAgTGlua2lmaWVyLnByb3RvdHlwZS5fbGlua2lmeVJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3Jvd3NUaW1lb3V0SWQgPSBudWxsO1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fcm93c1RvTGlua2lmeS5zdGFydDsgaSA8PSB0aGlzLl9yb3dzVG9MaW5raWZ5LmVuZDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl9saW5raWZ5Um93KGkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jvd3NUb0xpbmtpZnkuc3RhcnQgPSBudWxsO1xuICAgICAgICB0aGlzLl9yb3dzVG9MaW5raWZ5LmVuZCA9IG51bGw7XG4gICAgfTtcbiAgICBMaW5raWZpZXIucHJvdG90eXBlLnNldEh5cGVydGV4dExpbmtIYW5kbGVyID0gZnVuY3Rpb24gKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fbGlua01hdGNoZXJzW0hZUEVSVEVYVF9MSU5LX01BVENIRVJfSURdLmhhbmRsZXIgPSBoYW5kbGVyO1xuICAgIH07XG4gICAgTGlua2lmaWVyLnByb3RvdHlwZS5zZXRIeXBlcnRleHRWYWxpZGF0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fbGlua01hdGNoZXJzW0hZUEVSVEVYVF9MSU5LX01BVENIRVJfSURdLnZhbGlkYXRpb25DYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH07XG4gICAgTGlua2lmaWVyLnByb3RvdHlwZS5yZWdpc3RlckxpbmtNYXRjaGVyID0gZnVuY3Rpb24gKHJlZ2V4LCBoYW5kbGVyLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XG4gICAgICAgIGlmICh0aGlzLl9uZXh0TGlua01hdGNoZXJJZCAhPT0gSFlQRVJURVhUX0xJTktfTUFUQ0hFUl9JRCAmJiAhaGFuZGxlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdoYW5kbGVyIG11c3QgYmUgZGVmaW5lZCcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtYXRjaGVyID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuX25leHRMaW5rTWF0Y2hlcklkKyssXG4gICAgICAgICAgICByZWdleDogcmVnZXgsXG4gICAgICAgICAgICBoYW5kbGVyOiBoYW5kbGVyLFxuICAgICAgICAgICAgbWF0Y2hJbmRleDogb3B0aW9ucy5tYXRjaEluZGV4LFxuICAgICAgICAgICAgdmFsaWRhdGlvbkNhbGxiYWNrOiBvcHRpb25zLnZhbGlkYXRpb25DYWxsYmFjayxcbiAgICAgICAgICAgIGhvdmVyVG9vbHRpcENhbGxiYWNrOiBvcHRpb25zLnRvb2x0aXBDYWxsYmFjayxcbiAgICAgICAgICAgIGhvdmVyTGVhdmVDYWxsYmFjazogb3B0aW9ucy5sZWF2ZUNhbGxiYWNrLFxuICAgICAgICAgICAgcHJpb3JpdHk6IG9wdGlvbnMucHJpb3JpdHkgfHwgMFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9hZGRMaW5rTWF0Y2hlclRvTGlzdChtYXRjaGVyKTtcbiAgICAgICAgcmV0dXJuIG1hdGNoZXIuaWQ7XG4gICAgfTtcbiAgICBMaW5raWZpZXIucHJvdG90eXBlLl9hZGRMaW5rTWF0Y2hlclRvTGlzdCA9IGZ1bmN0aW9uIChtYXRjaGVyKSB7XG4gICAgICAgIGlmICh0aGlzLl9saW5rTWF0Y2hlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9saW5rTWF0Y2hlcnMucHVzaChtYXRjaGVyKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbGlua01hdGNoZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAobWF0Y2hlci5wcmlvcml0eSA8PSB0aGlzLl9saW5rTWF0Y2hlcnNbaV0ucHJpb3JpdHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9saW5rTWF0Y2hlcnMuc3BsaWNlKGkgKyAxLCAwLCBtYXRjaGVyKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGlua01hdGNoZXJzLnNwbGljZSgwLCAwLCBtYXRjaGVyKTtcbiAgICB9O1xuICAgIExpbmtpZmllci5wcm90b3R5cGUuZGVyZWdpc3RlckxpbmtNYXRjaGVyID0gZnVuY3Rpb24gKG1hdGNoZXJJZCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMuX2xpbmtNYXRjaGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xpbmtNYXRjaGVyc1tpXS5pZCA9PT0gbWF0Y2hlcklkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGlua01hdGNoZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBMaW5raWZpZXIucHJvdG90eXBlLl9saW5raWZ5Um93ID0gZnVuY3Rpb24gKHJvd0luZGV4KSB7XG4gICAgICAgIHZhciBhYnNvbHV0ZVJvd0luZGV4ID0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnlkaXNwICsgcm93SW5kZXg7XG4gICAgICAgIGlmIChhYnNvbHV0ZVJvd0luZGV4ID49IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5saW5lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGV4dCA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci50cmFuc2xhdGVCdWZmZXJMaW5lVG9TdHJpbmcoYWJzb2x1dGVSb3dJbmRleCwgZmFsc2UpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2xpbmtNYXRjaGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5fZG9MaW5raWZ5Um93KHJvd0luZGV4LCB0ZXh0LCB0aGlzLl9saW5rTWF0Y2hlcnNbaV0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaW5raWZpZXIucHJvdG90eXBlLl9kb0xpbmtpZnlSb3cgPSBmdW5jdGlvbiAocm93SW5kZXgsIHRleHQsIG1hdGNoZXIsIG9mZnNldCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAob2Zmc2V0ID09PSB2b2lkIDApIHsgb2Zmc2V0ID0gMDsgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHZhciBpc0h0dHBMaW5rTWF0Y2hlciA9IG1hdGNoZXIuaWQgPT09IEhZUEVSVEVYVF9MSU5LX01BVENIRVJfSUQ7XG4gICAgICAgIHZhciBtYXRjaCA9IHRleHQubWF0Y2gobWF0Y2hlci5yZWdleCk7XG4gICAgICAgIGlmICghbWF0Y2ggfHwgbWF0Y2gubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHVyaSA9IG1hdGNoW3R5cGVvZiBtYXRjaGVyLm1hdGNoSW5kZXggIT09ICdudW1iZXInID8gMCA6IG1hdGNoZXIubWF0Y2hJbmRleF07XG4gICAgICAgIHZhciBpbmRleCA9IHRleHQuaW5kZXhPZih1cmkpO1xuICAgICAgICBpZiAobWF0Y2hlci52YWxpZGF0aW9uQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIG1hdGNoZXIudmFsaWRhdGlvbkNhbGxiYWNrKHVyaSwgZnVuY3Rpb24gKGlzVmFsaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX3Jvd3NUaW1lb3V0SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYWRkTGluayhvZmZzZXQgKyBpbmRleCwgcm93SW5kZXgsIHVyaSwgbWF0Y2hlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9hZGRMaW5rKG9mZnNldCArIGluZGV4LCByb3dJbmRleCwgdXJpLCBtYXRjaGVyKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVtYWluaW5nU3RhcnRJbmRleCA9IGluZGV4ICsgdXJpLmxlbmd0aDtcbiAgICAgICAgdmFyIHJlbWFpbmluZ1RleHQgPSB0ZXh0LnN1YnN0cihyZW1haW5pbmdTdGFydEluZGV4KTtcbiAgICAgICAgaWYgKHJlbWFpbmluZ1RleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5fZG9MaW5raWZ5Um93KHJvd0luZGV4LCByZW1haW5pbmdUZXh0LCBtYXRjaGVyLCBvZmZzZXQgKyByZW1haW5pbmdTdGFydEluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGlua2lmaWVyLnByb3RvdHlwZS5fYWRkTGluayA9IGZ1bmN0aW9uICh4LCB5LCB1cmksIG1hdGNoZXIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fbW91c2Vab25lTWFuYWdlci5hZGQobmV3IE1vdXNlWm9uZU1hbmFnZXJfMS5Nb3VzZVpvbmUoeCArIDEsIHggKyAxICsgdXJpLmxlbmd0aCwgeSArIDEsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAobWF0Y2hlci5oYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXIuaGFuZGxlcihlLCB1cmkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2luZG93Lm9wZW4odXJpLCAnX2JsYW5rJyk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfdGhpcy5lbWl0KFR5cGVzXzEuTGlua0hvdmVyRXZlbnRUeXBlcy5IT1ZFUiwgeyB4OiB4LCB5OiB5LCBsZW5ndGg6IHVyaS5sZW5ndGggfSk7XG4gICAgICAgICAgICBfdGhpcy5fdGVybWluYWwuZWxlbWVudC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfdGhpcy5lbWl0KFR5cGVzXzEuTGlua0hvdmVyRXZlbnRUeXBlcy5UT09MVElQLCB7IHg6IHgsIHk6IHksIGxlbmd0aDogdXJpLmxlbmd0aCB9KTtcbiAgICAgICAgICAgIGlmIChtYXRjaGVyLmhvdmVyVG9vbHRpcENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgbWF0Y2hlci5ob3ZlclRvb2x0aXBDYWxsYmFjayhlLCB1cmkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5lbWl0KFR5cGVzXzEuTGlua0hvdmVyRXZlbnRUeXBlcy5MRUFWRSwgeyB4OiB4LCB5OiB5LCBsZW5ndGg6IHVyaS5sZW5ndGggfSk7XG4gICAgICAgICAgICBfdGhpcy5fdGVybWluYWwuZWxlbWVudC5zdHlsZS5jdXJzb3IgPSAnJztcbiAgICAgICAgICAgIGlmIChtYXRjaGVyLmhvdmVyTGVhdmVDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIG1hdGNoZXIuaG92ZXJMZWF2ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIExpbmtpZmllci5USU1FX0JFRk9SRV9MSU5LSUZZID0gMjAwO1xuICAgIHJldHVybiBMaW5raWZpZXI7XG59KEV2ZW50RW1pdHRlcl8xLkV2ZW50RW1pdHRlcikpO1xuZXhwb3J0cy5MaW5raWZpZXIgPSBMaW5raWZpZXI7XG5cblxuXG59LHtcIi4vRXZlbnRFbWl0dGVyXCI6NyxcIi4vVHlwZXNcIjoxNCxcIi4vaW5wdXQvTW91c2Vab25lTWFuYWdlclwiOjE3fV0sMTA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgRXNjYXBlU2VxdWVuY2VzXzEgPSByZXF1aXJlKFwiLi9Fc2NhcGVTZXF1ZW5jZXNcIik7XG52YXIgQ2hhcnNldHNfMSA9IHJlcXVpcmUoXCIuL0NoYXJzZXRzXCIpO1xudmFyIG5vcm1hbFN0YXRlSGFuZGxlciA9IHt9O1xubm9ybWFsU3RhdGVIYW5kbGVyW0VzY2FwZVNlcXVlbmNlc18xLkMwLkJFTF0gPSBmdW5jdGlvbiAocGFyc2VyLCBoYW5kbGVyKSB7IHJldHVybiBoYW5kbGVyLmJlbGwoKTsgfTtcbm5vcm1hbFN0YXRlSGFuZGxlcltFc2NhcGVTZXF1ZW5jZXNfMS5DMC5MRl0gPSBmdW5jdGlvbiAocGFyc2VyLCBoYW5kbGVyKSB7IHJldHVybiBoYW5kbGVyLmxpbmVGZWVkKCk7IH07XG5ub3JtYWxTdGF0ZUhhbmRsZXJbRXNjYXBlU2VxdWVuY2VzXzEuQzAuVlRdID0gbm9ybWFsU3RhdGVIYW5kbGVyW0VzY2FwZVNlcXVlbmNlc18xLkMwLkxGXTtcbm5vcm1hbFN0YXRlSGFuZGxlcltFc2NhcGVTZXF1ZW5jZXNfMS5DMC5GRl0gPSBub3JtYWxTdGF0ZUhhbmRsZXJbRXNjYXBlU2VxdWVuY2VzXzEuQzAuTEZdO1xubm9ybWFsU3RhdGVIYW5kbGVyW0VzY2FwZVNlcXVlbmNlc18xLkMwLkNSXSA9IGZ1bmN0aW9uIChwYXJzZXIsIGhhbmRsZXIpIHsgcmV0dXJuIGhhbmRsZXIuY2FycmlhZ2VSZXR1cm4oKTsgfTtcbm5vcm1hbFN0YXRlSGFuZGxlcltFc2NhcGVTZXF1ZW5jZXNfMS5DMC5CU10gPSBmdW5jdGlvbiAocGFyc2VyLCBoYW5kbGVyKSB7IHJldHVybiBoYW5kbGVyLmJhY2tzcGFjZSgpOyB9O1xubm9ybWFsU3RhdGVIYW5kbGVyW0VzY2FwZVNlcXVlbmNlc18xLkMwLkhUXSA9IGZ1bmN0aW9uIChwYXJzZXIsIGhhbmRsZXIpIHsgcmV0dXJuIGhhbmRsZXIudGFiKCk7IH07XG5ub3JtYWxTdGF0ZUhhbmRsZXJbRXNjYXBlU2VxdWVuY2VzXzEuQzAuU09dID0gZnVuY3Rpb24gKHBhcnNlciwgaGFuZGxlcikgeyByZXR1cm4gaGFuZGxlci5zaGlmdE91dCgpOyB9O1xubm9ybWFsU3RhdGVIYW5kbGVyW0VzY2FwZVNlcXVlbmNlc18xLkMwLlNJXSA9IGZ1bmN0aW9uIChwYXJzZXIsIGhhbmRsZXIpIHsgcmV0dXJuIGhhbmRsZXIuc2hpZnRJbigpOyB9O1xubm9ybWFsU3RhdGVIYW5kbGVyW0VzY2FwZVNlcXVlbmNlc18xLkMwLkVTQ10gPSBmdW5jdGlvbiAocGFyc2VyLCBoYW5kbGVyKSB7IHJldHVybiBwYXJzZXIuc2V0U3RhdGUoUGFyc2VyU3RhdGUuRVNDQVBFRCk7IH07XG52YXIgZXNjYXBlZFN0YXRlSGFuZGxlciA9IHt9O1xuZXNjYXBlZFN0YXRlSGFuZGxlclsnWyddID0gZnVuY3Rpb24gKHBhcnNlciwgdGVybWluYWwpIHtcbiAgICB0ZXJtaW5hbC5wYXJhbXMgPSBbXTtcbiAgICB0ZXJtaW5hbC5jdXJyZW50UGFyYW0gPSAwO1xuICAgIHBhcnNlci5zZXRTdGF0ZShQYXJzZXJTdGF0ZS5DU0lfUEFSQU0pO1xufTtcbmVzY2FwZWRTdGF0ZUhhbmRsZXJbJ10nXSA9IGZ1bmN0aW9uIChwYXJzZXIsIHRlcm1pbmFsKSB7XG4gICAgdGVybWluYWwucGFyYW1zID0gW107XG4gICAgdGVybWluYWwuY3VycmVudFBhcmFtID0gMDtcbiAgICBwYXJzZXIuc2V0U3RhdGUoUGFyc2VyU3RhdGUuT1NDKTtcbn07XG5lc2NhcGVkU3RhdGVIYW5kbGVyWydQJ10gPSBmdW5jdGlvbiAocGFyc2VyLCB0ZXJtaW5hbCkge1xuICAgIHRlcm1pbmFsLnBhcmFtcyA9IFtdO1xuICAgIHRlcm1pbmFsLmN1cnJlbnRQYXJhbSA9IDA7XG4gICAgcGFyc2VyLnNldFN0YXRlKFBhcnNlclN0YXRlLkRDUyk7XG59O1xuZXNjYXBlZFN0YXRlSGFuZGxlclsnXyddID0gZnVuY3Rpb24gKHBhcnNlciwgdGVybWluYWwpIHtcbiAgICBwYXJzZXIuc2V0U3RhdGUoUGFyc2VyU3RhdGUuSUdOT1JFKTtcbn07XG5lc2NhcGVkU3RhdGVIYW5kbGVyWydeJ10gPSBmdW5jdGlvbiAocGFyc2VyLCB0ZXJtaW5hbCkge1xuICAgIHBhcnNlci5zZXRTdGF0ZShQYXJzZXJTdGF0ZS5JR05PUkUpO1xufTtcbmVzY2FwZWRTdGF0ZUhhbmRsZXJbJ2MnXSA9IGZ1bmN0aW9uIChwYXJzZXIsIHRlcm1pbmFsKSB7XG4gICAgdGVybWluYWwucmVzZXQoKTtcbn07XG5lc2NhcGVkU3RhdGVIYW5kbGVyWydFJ10gPSBmdW5jdGlvbiAocGFyc2VyLCB0ZXJtaW5hbCkge1xuICAgIHRlcm1pbmFsLmJ1ZmZlci54ID0gMDtcbiAgICB0ZXJtaW5hbC5pbmRleCgpO1xuICAgIHBhcnNlci5zZXRTdGF0ZShQYXJzZXJTdGF0ZS5OT1JNQUwpO1xufTtcbmVzY2FwZWRTdGF0ZUhhbmRsZXJbJ0QnXSA9IGZ1bmN0aW9uIChwYXJzZXIsIHRlcm1pbmFsKSB7XG4gICAgdGVybWluYWwuaW5kZXgoKTtcbiAgICBwYXJzZXIuc2V0U3RhdGUoUGFyc2VyU3RhdGUuTk9STUFMKTtcbn07XG5lc2NhcGVkU3RhdGVIYW5kbGVyWydNJ10gPSBmdW5jdGlvbiAocGFyc2VyLCB0ZXJtaW5hbCkge1xuICAgIHRlcm1pbmFsLnJldmVyc2VJbmRleCgpO1xuICAgIHBhcnNlci5zZXRTdGF0ZShQYXJzZXJTdGF0ZS5OT1JNQUwpO1xufTtcbmVzY2FwZWRTdGF0ZUhhbmRsZXJbJyUnXSA9IGZ1bmN0aW9uIChwYXJzZXIsIHRlcm1pbmFsKSB7XG4gICAgdGVybWluYWwuc2V0Z0xldmVsKDApO1xuICAgIHRlcm1pbmFsLnNldGdDaGFyc2V0KDAsIENoYXJzZXRzXzEuREVGQVVMVF9DSEFSU0VUKTtcbiAgICBwYXJzZXIuc2V0U3RhdGUoUGFyc2VyU3RhdGUuTk9STUFMKTtcbiAgICBwYXJzZXIuc2tpcE5leHRDaGFyKCk7XG59O1xuZXNjYXBlZFN0YXRlSGFuZGxlcltFc2NhcGVTZXF1ZW5jZXNfMS5DMC5DQU5dID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFN0YXRlKFBhcnNlclN0YXRlLk5PUk1BTCk7IH07XG52YXIgY3NpUGFyYW1TdGF0ZUhhbmRsZXIgPSB7fTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWyc/J10gPSBmdW5jdGlvbiAocGFyc2VyKSB7IHJldHVybiBwYXJzZXIuc2V0UHJlZml4KCc/Jyk7IH07XG5jc2lQYXJhbVN0YXRlSGFuZGxlclsnPiddID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFByZWZpeCgnPicpOyB9O1xuY3NpUGFyYW1TdGF0ZUhhbmRsZXJbJyEnXSA9IGZ1bmN0aW9uIChwYXJzZXIpIHsgcmV0dXJuIHBhcnNlci5zZXRQcmVmaXgoJyEnKTsgfTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWycwJ10gPSBmdW5jdGlvbiAocGFyc2VyKSB7IHJldHVybiBwYXJzZXIuc2V0UGFyYW0ocGFyc2VyLmdldFBhcmFtKCkgKiAxMCk7IH07XG5jc2lQYXJhbVN0YXRlSGFuZGxlclsnMSddID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFBhcmFtKHBhcnNlci5nZXRQYXJhbSgpICogMTAgKyAxKTsgfTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWycyJ10gPSBmdW5jdGlvbiAocGFyc2VyKSB7IHJldHVybiBwYXJzZXIuc2V0UGFyYW0ocGFyc2VyLmdldFBhcmFtKCkgKiAxMCArIDIpOyB9O1xuY3NpUGFyYW1TdGF0ZUhhbmRsZXJbJzMnXSA9IGZ1bmN0aW9uIChwYXJzZXIpIHsgcmV0dXJuIHBhcnNlci5zZXRQYXJhbShwYXJzZXIuZ2V0UGFyYW0oKSAqIDEwICsgMyk7IH07XG5jc2lQYXJhbVN0YXRlSGFuZGxlclsnNCddID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFBhcmFtKHBhcnNlci5nZXRQYXJhbSgpICogMTAgKyA0KTsgfTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWyc1J10gPSBmdW5jdGlvbiAocGFyc2VyKSB7IHJldHVybiBwYXJzZXIuc2V0UGFyYW0ocGFyc2VyLmdldFBhcmFtKCkgKiAxMCArIDUpOyB9O1xuY3NpUGFyYW1TdGF0ZUhhbmRsZXJbJzYnXSA9IGZ1bmN0aW9uIChwYXJzZXIpIHsgcmV0dXJuIHBhcnNlci5zZXRQYXJhbShwYXJzZXIuZ2V0UGFyYW0oKSAqIDEwICsgNik7IH07XG5jc2lQYXJhbVN0YXRlSGFuZGxlclsnNyddID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFBhcmFtKHBhcnNlci5nZXRQYXJhbSgpICogMTAgKyA3KTsgfTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWyc4J10gPSBmdW5jdGlvbiAocGFyc2VyKSB7IHJldHVybiBwYXJzZXIuc2V0UGFyYW0ocGFyc2VyLmdldFBhcmFtKCkgKiAxMCArIDgpOyB9O1xuY3NpUGFyYW1TdGF0ZUhhbmRsZXJbJzknXSA9IGZ1bmN0aW9uIChwYXJzZXIpIHsgcmV0dXJuIHBhcnNlci5zZXRQYXJhbShwYXJzZXIuZ2V0UGFyYW0oKSAqIDEwICsgOSk7IH07XG5jc2lQYXJhbVN0YXRlSGFuZGxlclsnJCddID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFBvc3RmaXgoJyQnKTsgfTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWydcIiddID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFBvc3RmaXgoJ1wiJyk7IH07XG5jc2lQYXJhbVN0YXRlSGFuZGxlclsnICddID0gZnVuY3Rpb24gKHBhcnNlcikgeyByZXR1cm4gcGFyc2VyLnNldFBvc3RmaXgoJyAnKTsgfTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWydcXCcnXSA9IGZ1bmN0aW9uIChwYXJzZXIpIHsgcmV0dXJuIHBhcnNlci5zZXRQb3N0Zml4KCdcXCcnKTsgfTtcbmNzaVBhcmFtU3RhdGVIYW5kbGVyWyc7J10gPSBmdW5jdGlvbiAocGFyc2VyKSB7IHJldHVybiBwYXJzZXIuZmluYWxpemVQYXJhbSgpOyB9O1xuY3NpUGFyYW1TdGF0ZUhhbmRsZXJbRXNjYXBlU2VxdWVuY2VzXzEuQzAuQ0FOXSA9IGZ1bmN0aW9uIChwYXJzZXIpIHsgcmV0dXJuIHBhcnNlci5zZXRTdGF0ZShQYXJzZXJTdGF0ZS5OT1JNQUwpOyB9O1xudmFyIGNzaVN0YXRlSGFuZGxlciA9IHt9O1xuY3NpU3RhdGVIYW5kbGVyWydAJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIuaW5zZXJ0Q2hhcnMocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnQSddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmN1cnNvclVwKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ0InXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5jdXJzb3JEb3duKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ0MnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5jdXJzb3JGb3J3YXJkKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ0QnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5jdXJzb3JCYWNrd2FyZChwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWydFJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIuY3Vyc29yTmV4dExpbmUocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnRiddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmN1cnNvclByZWNlZGluZ0xpbmUocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnRyddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmN1cnNvckNoYXJBYnNvbHV0ZShwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWydIJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIuY3Vyc29yUG9zaXRpb24ocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnSSddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmN1cnNvckZvcndhcmRUYWIocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnSiddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmVyYXNlSW5EaXNwbGF5KHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ0snXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5lcmFzZUluTGluZShwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWydMJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIuaW5zZXJ0TGluZXMocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnTSddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmRlbGV0ZUxpbmVzKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ1AnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5kZWxldGVDaGFycyhwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWydTJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIuc2Nyb2xsVXAocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnVCddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7XG4gICAgaWYgKHBhcmFtcy5sZW5ndGggPCAyICYmICFwcmVmaXgpIHtcbiAgICAgICAgaGFuZGxlci5zY3JvbGxEb3duKHBhcmFtcyk7XG4gICAgfVxufTtcbmNzaVN0YXRlSGFuZGxlclsnWCddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmVyYXNlQ2hhcnMocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnWiddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLmN1cnNvckJhY2t3YXJkVGFiKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ2AnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5jaGFyUG9zQWJzb2x1dGUocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnYSddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLkhQb3NpdGlvblJlbGF0aXZlKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ2InXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5yZXBlYXRQcmVjZWRpbmdDaGFyYWN0ZXIocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnYyddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLnNlbmREZXZpY2VBdHRyaWJ1dGVzKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ2QnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5saW5lUG9zQWJzb2x1dGUocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlclsnZSddID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4KSB7IHJldHVybiBoYW5kbGVyLlZQb3NpdGlvblJlbGF0aXZlKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ2YnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5IVlBvc2l0aW9uKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ2cnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci50YWJDbGVhcihwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWydoJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIuc2V0TW9kZShwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWydsJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIucmVzZXRNb2RlKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ20nXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkgeyByZXR1cm4gaGFuZGxlci5jaGFyQXR0cmlidXRlcyhwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWyduJ10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zLCBwcmVmaXgpIHsgcmV0dXJuIGhhbmRsZXIuZGV2aWNlU3RhdHVzKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ3AnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCkge1xuICAgIHN3aXRjaCAocHJlZml4KSB7XG4gICAgICAgIGNhc2UgJyEnOlxuICAgICAgICAgICAgaGFuZGxlci5zb2Z0UmVzZXQocGFyYW1zKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn07XG5jc2lTdGF0ZUhhbmRsZXJbJ3EnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMsIHByZWZpeCwgcG9zdGZpeCkge1xuICAgIGlmIChwb3N0Zml4ID09PSAnICcpIHtcbiAgICAgICAgaGFuZGxlci5zZXRDdXJzb3JTdHlsZShwYXJhbXMpO1xuICAgIH1cbn07XG5jc2lTdGF0ZUhhbmRsZXJbJ3InXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMpIHsgcmV0dXJuIGhhbmRsZXIuc2V0U2Nyb2xsUmVnaW9uKHBhcmFtcyk7IH07XG5jc2lTdGF0ZUhhbmRsZXJbJ3MnXSA9IGZ1bmN0aW9uIChoYW5kbGVyLCBwYXJhbXMpIHsgcmV0dXJuIGhhbmRsZXIuc2F2ZUN1cnNvcihwYXJhbXMpOyB9O1xuY3NpU3RhdGVIYW5kbGVyWyd1J10gPSBmdW5jdGlvbiAoaGFuZGxlciwgcGFyYW1zKSB7IHJldHVybiBoYW5kbGVyLnJlc3RvcmVDdXJzb3IocGFyYW1zKTsgfTtcbmNzaVN0YXRlSGFuZGxlcltFc2NhcGVTZXF1ZW5jZXNfMS5DMC5DQU5dID0gZnVuY3Rpb24gKGhhbmRsZXIsIHBhcmFtcywgcHJlZml4LCBwb3N0Zml4LCBwYXJzZXIpIHsgcmV0dXJuIHBhcnNlci5zZXRTdGF0ZShQYXJzZXJTdGF0ZS5OT1JNQUwpOyB9O1xudmFyIFBhcnNlclN0YXRlO1xuKGZ1bmN0aW9uIChQYXJzZXJTdGF0ZSkge1xuICAgIFBhcnNlclN0YXRlW1BhcnNlclN0YXRlW1wiTk9STUFMXCJdID0gMF0gPSBcIk5PUk1BTFwiO1xuICAgIFBhcnNlclN0YXRlW1BhcnNlclN0YXRlW1wiRVNDQVBFRFwiXSA9IDFdID0gXCJFU0NBUEVEXCI7XG4gICAgUGFyc2VyU3RhdGVbUGFyc2VyU3RhdGVbXCJDU0lfUEFSQU1cIl0gPSAyXSA9IFwiQ1NJX1BBUkFNXCI7XG4gICAgUGFyc2VyU3RhdGVbUGFyc2VyU3RhdGVbXCJDU0lcIl0gPSAzXSA9IFwiQ1NJXCI7XG4gICAgUGFyc2VyU3RhdGVbUGFyc2VyU3RhdGVbXCJPU0NcIl0gPSA0XSA9IFwiT1NDXCI7XG4gICAgUGFyc2VyU3RhdGVbUGFyc2VyU3RhdGVbXCJDSEFSU0VUXCJdID0gNV0gPSBcIkNIQVJTRVRcIjtcbiAgICBQYXJzZXJTdGF0ZVtQYXJzZXJTdGF0ZVtcIkRDU1wiXSA9IDZdID0gXCJEQ1NcIjtcbiAgICBQYXJzZXJTdGF0ZVtQYXJzZXJTdGF0ZVtcIklHTk9SRVwiXSA9IDddID0gXCJJR05PUkVcIjtcbn0pKFBhcnNlclN0YXRlID0gZXhwb3J0cy5QYXJzZXJTdGF0ZSB8fCAoZXhwb3J0cy5QYXJzZXJTdGF0ZSA9IHt9KSk7XG52YXIgUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYXJzZXIoX2lucHV0SGFuZGxlciwgX3Rlcm1pbmFsKSB7XG4gICAgICAgIHRoaXMuX2lucHV0SGFuZGxlciA9IF9pbnB1dEhhbmRsZXI7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsID0gX3Rlcm1pbmFsO1xuICAgICAgICB0aGlzLl9zdGF0ZSA9IFBhcnNlclN0YXRlLk5PUk1BTDtcbiAgICB9XG4gICAgUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBsID0gZGF0YS5sZW5ndGg7XG4gICAgICAgIHZhciBqO1xuICAgICAgICB2YXIgY3M7XG4gICAgICAgIHZhciBjaDtcbiAgICAgICAgdmFyIGNvZGU7XG4gICAgICAgIHZhciBsb3c7XG4gICAgICAgIHZhciBjdXJzb3JTdGFydFggPSB0aGlzLl90ZXJtaW5hbC5idWZmZXIueDtcbiAgICAgICAgdmFyIGN1cnNvclN0YXJ0WSA9IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55O1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYWwuZGVidWcpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmxvZygnZGF0YTogJyArIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uID0gMDtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLnN1cnJvZ2F0ZV9oaWdoKSB7XG4gICAgICAgICAgICBkYXRhID0gdGhpcy5fdGVybWluYWwuc3Vycm9nYXRlX2hpZ2ggKyBkYXRhO1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc3Vycm9nYXRlX2hpZ2ggPSAnJztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgdGhpcy5fcG9zaXRpb24gPCBsOyB0aGlzLl9wb3NpdGlvbisrKSB7XG4gICAgICAgICAgICBjaCA9IGRhdGFbdGhpcy5fcG9zaXRpb25dO1xuICAgICAgICAgICAgY29kZSA9IGRhdGEuY2hhckNvZGVBdCh0aGlzLl9wb3NpdGlvbik7XG4gICAgICAgICAgICBpZiAoMHhEODAwIDw9IGNvZGUgJiYgY29kZSA8PSAweERCRkYpIHtcbiAgICAgICAgICAgICAgICBsb3cgPSBkYXRhLmNoYXJDb2RlQXQodGhpcy5fcG9zaXRpb24gKyAxKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4obG93KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zdXJyb2dhdGVfaGlnaCA9IGNoO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29kZSA9ICgoY29kZSAtIDB4RDgwMCkgKiAweDQwMCkgKyAobG93IC0gMHhEQzAwKSArIDB4MTAwMDA7XG4gICAgICAgICAgICAgICAgY2ggKz0gZGF0YS5jaGFyQXQodGhpcy5fcG9zaXRpb24gKyAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgweERDMDAgPD0gY29kZSAmJiBjb2RlIDw9IDB4REZGRilcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5fc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFBhcnNlclN0YXRlLk5PUk1BTDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoIGluIG5vcm1hbFN0YXRlSGFuZGxlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsU3RhdGVIYW5kbGVyW2NoXSh0aGlzLCB0aGlzLl9pbnB1dEhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5wdXRIYW5kbGVyLmFkZENoYXIoY2gsIGNvZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUGFyc2VyU3RhdGUuRVNDQVBFRDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoIGluIGVzY2FwZWRTdGF0ZUhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVzY2FwZWRTdGF0ZUhhbmRsZXJbY2hdKHRoaXMsIHRoaXMuX3Rlcm1pbmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJygnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnKSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcqJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJysnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJygnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZ2NoYXJzZXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJyknOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZ2NoYXJzZXQgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJyonOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZ2NoYXJzZXQgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJysnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZ2NoYXJzZXQgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy0nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZ2NoYXJzZXQgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZ2NoYXJzZXQgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUGFyc2VyU3RhdGUuQ0hBUlNFVDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy8nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmdjaGFyc2V0ID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IFBhcnNlclN0YXRlLkNIQVJTRVQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcG9zaXRpb24tLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ04nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUGFyc2VyU3RhdGUuTk9STUFMO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnTyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICduJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRnTGV2ZWwoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdvJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRnTGV2ZWwoMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd8JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRnTGV2ZWwoMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd9JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRnTGV2ZWwoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd+JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5zZXRnTGV2ZWwoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICc3JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dEhhbmRsZXIuc2F2ZUN1cnNvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUGFyc2VyU3RhdGUuTk9STUFMO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnOCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5wdXRIYW5kbGVyLnJlc3RvcmVDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IFBhcnNlclN0YXRlLk5PUk1BTDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJyMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUGFyc2VyU3RhdGUuTk9STUFMO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Bvc2l0aW9uKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdIJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC50YWJTZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IFBhcnNlclN0YXRlLk5PUk1BTDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJz0nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmxvZygnU2VyaWFsIHBvcnQgcmVxdWVzdGVkIGFwcGxpY2F0aW9uIGtleXBhZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5hcHBsaWNhdGlvbktleXBhZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLnZpZXdwb3J0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnZpZXdwb3J0LnN5bmNTY3JvbGxBcmVhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUGFyc2VyU3RhdGUuTk9STUFMO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnPic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwubG9nKCdTd2l0Y2hpbmcgYmFjayB0byBub3JtYWwga2V5cGFkLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmFwcGxpY2F0aW9uS2V5cGFkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLnZpZXdwb3J0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnZpZXdwb3J0LnN5bmNTY3JvbGxBcmVhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUGFyc2VyU3RhdGUuTk9STUFMO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IFBhcnNlclN0YXRlLk5PUk1BTDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5lcnJvcignVW5rbm93biBFU0MgY29udHJvbDogJXMuJywgY2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUGFyc2VyU3RhdGUuQ0hBUlNFVDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoIGluIENoYXJzZXRzXzEuQ0hBUlNFVFMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzID0gQ2hhcnNldHNfMS5DSEFSU0VUU1tjaF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPT09ICcvJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpcE5leHRDaGFyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcyA9IENoYXJzZXRzXzEuREVGQVVMVF9DSEFSU0VUO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNldGdDaGFyc2V0KHRoaXMuX3Rlcm1pbmFsLmdjaGFyc2V0LCBjcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmdjaGFyc2V0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUGFyc2VyU3RhdGUuT1NDOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyB8fCBjaCA9PT0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuQkVMKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wb3NpdGlvbisrO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwucGFyYW1zLnB1c2godGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodGhpcy5fdGVybWluYWwucGFyYW1zWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5wYXJhbXNbMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnRpdGxlID0gdGhpcy5fdGVybWluYWwucGFyYW1zWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuaGFuZGxlVGl0bGUodGhpcy5fdGVybWluYWwudGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTg6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0NjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTg6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwucGFyYW1zID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5jdXJyZW50UGFyYW0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3Rlcm1pbmFsLnBhcmFtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPj0gJzAnICYmIGNoIDw9ICc5Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5jdXJyZW50UGFyYW0gPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtICogMTAgKyBjaC5jaGFyQ29kZUF0KDApIC0gNDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoID09PSAnOycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwucGFyYW1zLnB1c2godGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtICs9IGNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUGFyc2VyU3RhdGUuQ1NJX1BBUkFNOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY2ggaW4gY3NpUGFyYW1TdGF0ZUhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzaVBhcmFtU3RhdGVIYW5kbGVyW2NoXSh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmluYWxpemVQYXJhbSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IFBhcnNlclN0YXRlLkNTSTtcbiAgICAgICAgICAgICAgICBjYXNlIFBhcnNlclN0YXRlLkNTSTpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoIGluIGNzaVN0YXRlSGFuZGxlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmFsLmRlYnVnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwubG9nKFwiQ1NJIFwiICsgKHRoaXMuX3Rlcm1pbmFsLnByZWZpeCA/IHRoaXMuX3Rlcm1pbmFsLnByZWZpeCA6ICcnKSArIFwiIFwiICsgKHRoaXMuX3Rlcm1pbmFsLnBhcmFtcyA/IHRoaXMuX3Rlcm1pbmFsLnBhcmFtcy5qb2luKCc7JykgOiAnJykgKyBcIiBcIiArICh0aGlzLl90ZXJtaW5hbC5wb3N0Zml4ID8gdGhpcy5fdGVybWluYWwucG9zdGZpeCA6ICcnKSArIFwiIFwiICsgY2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3NpU3RhdGVIYW5kbGVyW2NoXSh0aGlzLl9pbnB1dEhhbmRsZXIsIHRoaXMuX3Rlcm1pbmFsLnBhcmFtcywgdGhpcy5fdGVybWluYWwucHJlZml4LCB0aGlzLl90ZXJtaW5hbC5wb3N0Zml4LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVycm9yKCdVbmtub3duIENTSSBjb2RlOiAlcy4nLCBjaCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBQYXJzZXJTdGF0ZS5OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnByZWZpeCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5wb3N0Zml4ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUGFyc2VyU3RhdGUuRENTOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyB8fCBjaCA9PT0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuQkVMKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wb3NpdGlvbisrO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHB0ID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbGlkID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLl90ZXJtaW5hbC5wcmVmaXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICckcSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB0ID0gdGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdcInEnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB0ID0gJzBcInEnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnXCJwJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdCA9ICc2MVwicCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdCA9ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci5zY3JvbGxUb3AgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICc7J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICh0aGlzLl90ZXJtaW5hbC5idWZmZXIuc2Nyb2xsQm90dG9tICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAncic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdCA9ICcwbSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVycm9yKCdVbmtub3duIERDUyBQdDogJXMuJywgcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB0ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2VuZChFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnUCcgKyArdmFsaWQgKyAnJHInICsgcHQgKyBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnXFxcXCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcrcCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJytxJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHQgPSB0aGlzLl90ZXJtaW5hbC5jdXJyZW50UGFyYW07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnNlbmQoRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1AnICsgK3ZhbGlkICsgJytyJyArIHB0ICsgRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1xcXFwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZXJyb3IoJ1Vua25vd24gRENTIHByZWZpeDogJXMuJywgdGhpcy5fdGVybWluYWwucHJlZml4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5jdXJyZW50UGFyYW0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVybWluYWwucHJlZml4ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IFBhcnNlclN0YXRlLk5PUk1BTDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghdGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3Rlcm1pbmFsLnByZWZpeCAmJiBjaCAhPT0gJyQnICYmIGNoICE9PSAnKycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5jdXJyZW50UGFyYW0gPSBjaDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuX3Rlcm1pbmFsLnByZWZpeC5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5jdXJyZW50UGFyYW0gPSBjaDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnByZWZpeCArPSBjaDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmN1cnJlbnRQYXJhbSArPSBjaDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFBhcnNlclN0YXRlLklHTk9SRTpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoID09PSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgfHwgY2ggPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkJFTCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoID09PSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcG9zaXRpb24rKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUGFyc2VyU3RhdGUuTk9STUFMO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hbC5idWZmZXIueCAhPT0gY3Vyc29yU3RhcnRYIHx8IHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ICE9PSBjdXJzb3JTdGFydFkpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVtaXQoJ2N1cnNvcm1vdmUnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGU7XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLnNldFN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLnNldFByZWZpeCA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcbiAgICAgICAgdGhpcy5fdGVybWluYWwucHJlZml4ID0gcHJlZml4O1xuICAgIH07XG4gICAgUGFyc2VyLnByb3RvdHlwZS5zZXRQb3N0Zml4ID0gZnVuY3Rpb24gKHBvc3RmaXgpIHtcbiAgICAgICAgdGhpcy5fdGVybWluYWwucG9zdGZpeCA9IHBvc3RmaXg7XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLnNldFBhcmFtID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmN1cnJlbnRQYXJhbSA9IHBhcmFtO1xuICAgIH07XG4gICAgUGFyc2VyLnByb3RvdHlwZS5nZXRQYXJhbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rlcm1pbmFsLmN1cnJlbnRQYXJhbTtcbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUuZmluYWxpemVQYXJhbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdGVybWluYWwucGFyYW1zLnB1c2godGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtKTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuY3VycmVudFBhcmFtID0gMDtcbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUuc2tpcE5leHRDaGFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wb3NpdGlvbisrO1xuICAgIH07XG4gICAgcmV0dXJuIFBhcnNlcjtcbn0oKSk7XG5leHBvcnRzLlBhcnNlciA9IFBhcnNlcjtcblxuXG5cbn0se1wiLi9DaGFyc2V0c1wiOjQsXCIuL0VzY2FwZVNlcXVlbmNlc1wiOjZ9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIE1vdXNlSGVscGVyXzEgPSByZXF1aXJlKFwiLi91dGlscy9Nb3VzZUhlbHBlclwiKTtcbnZhciBCcm93c2VyID0gcmVxdWlyZShcIi4vdXRpbHMvQnJvd3NlclwiKTtcbnZhciBFdmVudEVtaXR0ZXJfMSA9IHJlcXVpcmUoXCIuL0V2ZW50RW1pdHRlclwiKTtcbnZhciBTZWxlY3Rpb25Nb2RlbF8xID0gcmVxdWlyZShcIi4vU2VsZWN0aW9uTW9kZWxcIik7XG52YXIgQnVmZmVyXzEgPSByZXF1aXJlKFwiLi9CdWZmZXJcIik7XG52YXIgRFJBR19TQ1JPTExfTUFYX1RIUkVTSE9MRCA9IDUwO1xudmFyIERSQUdfU0NST0xMX01BWF9TUEVFRCA9IDE1O1xudmFyIERSQUdfU0NST0xMX0lOVEVSVkFMID0gNTA7XG52YXIgV09SRF9TRVBBUkFUT1JTID0gJyAoKVtde31cXCdcIic7XG52YXIgTk9OX0JSRUFLSU5HX1NQQUNFX0NIQVIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDE2MCk7XG52YXIgQUxMX05PTl9CUkVBS0lOR19TUEFDRV9SRUdFWCA9IG5ldyBSZWdFeHAoTk9OX0JSRUFLSU5HX1NQQUNFX0NIQVIsICdnJyk7XG52YXIgU2VsZWN0aW9uTW9kZTtcbihmdW5jdGlvbiAoU2VsZWN0aW9uTW9kZSkge1xuICAgIFNlbGVjdGlvbk1vZGVbU2VsZWN0aW9uTW9kZVtcIk5PUk1BTFwiXSA9IDBdID0gXCJOT1JNQUxcIjtcbiAgICBTZWxlY3Rpb25Nb2RlW1NlbGVjdGlvbk1vZGVbXCJXT1JEXCJdID0gMV0gPSBcIldPUkRcIjtcbiAgICBTZWxlY3Rpb25Nb2RlW1NlbGVjdGlvbk1vZGVbXCJMSU5FXCJdID0gMl0gPSBcIkxJTkVcIjtcbn0pKFNlbGVjdGlvbk1vZGUgfHwgKFNlbGVjdGlvbk1vZGUgPSB7fSkpO1xudmFyIFNlbGVjdGlvbk1hbmFnZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWxlY3Rpb25NYW5hZ2VyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlbGVjdGlvbk1hbmFnZXIoX3Rlcm1pbmFsLCBfYnVmZmVyLCBfY2hhck1lYXN1cmUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3Rlcm1pbmFsID0gX3Rlcm1pbmFsO1xuICAgICAgICBfdGhpcy5fYnVmZmVyID0gX2J1ZmZlcjtcbiAgICAgICAgX3RoaXMuX2NoYXJNZWFzdXJlID0gX2NoYXJNZWFzdXJlO1xuICAgICAgICBfdGhpcy5fZW5hYmxlZCA9IHRydWU7XG4gICAgICAgIF90aGlzLl9pbml0TGlzdGVuZXJzKCk7XG4gICAgICAgIF90aGlzLmVuYWJsZSgpO1xuICAgICAgICBfdGhpcy5fbW9kZWwgPSBuZXcgU2VsZWN0aW9uTW9kZWxfMS5TZWxlY3Rpb25Nb2RlbChfdGVybWluYWwpO1xuICAgICAgICBfdGhpcy5fYWN0aXZlU2VsZWN0aW9uTW9kZSA9IFNlbGVjdGlvbk1vZGUuTk9STUFMO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLl9pbml0TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9tb3VzZU1vdmVMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuX29uTW91c2VNb3ZlKGV2ZW50KTsgfTtcbiAgICAgICAgdGhpcy5fbW91c2VVcExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5fb25Nb3VzZVVwKGV2ZW50KTsgfTtcbiAgICAgICAgdGhpcy5fYnVmZmVyLmxpbmVzLm9uKCd0cmltJywgZnVuY3Rpb24gKGFtb3VudCkgeyByZXR1cm4gX3RoaXMuX29uVHJpbShhbW91bnQpOyB9KTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5fZW5hYmxlZCA9IGZhbHNlO1xuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9lbmFibGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLnNldEJ1ZmZlciA9IGZ1bmN0aW9uIChidWZmZXIpIHtcbiAgICAgICAgdGhpcy5fYnVmZmVyID0gYnVmZmVyO1xuICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUsIFwic2VsZWN0aW9uU3RhcnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21vZGVsLmZpbmFsU2VsZWN0aW9uU3RhcnQ7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZSwgXCJzZWxlY3Rpb25FbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21vZGVsLmZpbmFsU2VsZWN0aW9uRW5kOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUsIFwiaGFzU2VsZWN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLl9tb2RlbC5maW5hbFNlbGVjdGlvblN0YXJ0O1xuICAgICAgICAgICAgdmFyIGVuZCA9IHRoaXMuX21vZGVsLmZpbmFsU2VsZWN0aW9uRW5kO1xuICAgICAgICAgICAgaWYgKCFzdGFydCB8fCAhZW5kKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN0YXJ0WzBdICE9PSBlbmRbMF0gfHwgc3RhcnRbMV0gIT09IGVuZFsxXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLCBcInNlbGVjdGlvblRleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IHRoaXMuX21vZGVsLmZpbmFsU2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgICAgICB2YXIgZW5kID0gdGhpcy5fbW9kZWwuZmluYWxTZWxlY3Rpb25FbmQ7XG4gICAgICAgICAgICBpZiAoIXN0YXJ0IHx8ICFlbmQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3RhcnRSb3dFbmRDb2wgPSBzdGFydFsxXSA9PT0gZW5kWzFdID8gZW5kWzBdIDogbnVsbDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRoaXMuX2J1ZmZlci50cmFuc2xhdGVCdWZmZXJMaW5lVG9TdHJpbmcoc3RhcnRbMV0sIHRydWUsIHN0YXJ0WzBdLCBzdGFydFJvd0VuZENvbCkpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0WzFdICsgMTsgaSA8PSBlbmRbMV0gLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYnVmZmVyTGluZSA9IHRoaXMuX2J1ZmZlci5saW5lcy5nZXQoaSk7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmVUZXh0ID0gdGhpcy5fYnVmZmVyLnRyYW5zbGF0ZUJ1ZmZlckxpbmVUb1N0cmluZyhpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBpZiAoYnVmZmVyTGluZS5pc1dyYXBwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXSArPSBsaW5lVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxpbmVUZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3RhcnRbMV0gIT09IGVuZFsxXSkge1xuICAgICAgICAgICAgICAgIHZhciBidWZmZXJMaW5lID0gdGhpcy5fYnVmZmVyLmxpbmVzLmdldChlbmRbMV0pO1xuICAgICAgICAgICAgICAgIHZhciBsaW5lVGV4dCA9IHRoaXMuX2J1ZmZlci50cmFuc2xhdGVCdWZmZXJMaW5lVG9TdHJpbmcoZW5kWzFdLCB0cnVlLCAwLCBlbmRbMF0pO1xuICAgICAgICAgICAgICAgIGlmIChidWZmZXJMaW5lLmlzV3JhcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aCAtIDFdICs9IGxpbmVUZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobGluZVRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmb3JtYXR0ZWRSZXN1bHQgPSByZXN1bHQubWFwKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmUucmVwbGFjZShBTExfTk9OX0JSRUFLSU5HX1NQQUNFX1JFR0VYLCAnICcpO1xuICAgICAgICAgICAgfSkuam9pbihCcm93c2VyLmlzTVNXaW5kb3dzID8gJ1xcclxcbicgOiAnXFxuJyk7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0dGVkUmVzdWx0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5jbGVhclNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fbW9kZWwuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5fcmVtb3ZlTW91c2VEb3duTGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uIChpc05ld1NlbGVjdGlvbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuX3JlZnJlc2hBbmltYXRpb25GcmFtZSkge1xuICAgICAgICAgICAgdGhpcy5fcmVmcmVzaEFuaW1hdGlvbkZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fcmVmcmVzaCgpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQnJvd3Nlci5pc0xpbnV4ICYmIGlzTmV3U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0aW9uVGV4dCA9IHRoaXMuc2VsZWN0aW9uVGV4dDtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb25UZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbmV3c2VsZWN0aW9uJywgdGhpcy5zZWxlY3Rpb25UZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX3JlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3JlZnJlc2hBbmltYXRpb25GcmFtZSA9IG51bGw7XG4gICAgICAgIHRoaXMuZW1pdCgncmVmcmVzaCcsIHsgc3RhcnQ6IHRoaXMuX21vZGVsLmZpbmFsU2VsZWN0aW9uU3RhcnQsIGVuZDogdGhpcy5fbW9kZWwuZmluYWxTZWxlY3Rpb25FbmQgfSk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5zZWxlY3RBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX21vZGVsLmlzU2VsZWN0QWxsQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVtaXQoJ3NlbGVjdGlvbicpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX29uVHJpbSA9IGZ1bmN0aW9uIChhbW91bnQpIHtcbiAgICAgICAgdmFyIG5lZWRzUmVmcmVzaCA9IHRoaXMuX21vZGVsLm9uVHJpbShhbW91bnQpO1xuICAgICAgICBpZiAobmVlZHNSZWZyZXNoKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX2dldE1vdXNlQnVmZmVyQ29vcmRzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBjb29yZHMgPSB0aGlzLl90ZXJtaW5hbC5tb3VzZUhlbHBlci5nZXRDb29yZHMoZXZlbnQsIHRoaXMuX3Rlcm1pbmFsLmVsZW1lbnQsIHRoaXMuX2NoYXJNZWFzdXJlLCB0aGlzLl90ZXJtaW5hbC5vcHRpb25zLmxpbmVIZWlnaHQsIHRoaXMuX3Rlcm1pbmFsLmNvbHMsIHRoaXMuX3Rlcm1pbmFsLnJvd3MsIHRydWUpO1xuICAgICAgICBpZiAoIWNvb3Jkcykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29vcmRzWzBdLS07XG4gICAgICAgIGNvb3Jkc1sxXS0tO1xuICAgICAgICBjb29yZHNbMV0gKz0gdGhpcy5fdGVybWluYWwuYnVmZmVyLnlkaXNwO1xuICAgICAgICByZXR1cm4gY29vcmRzO1xuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX2dldE1vdXNlRXZlbnRTY3JvbGxBbW91bnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IE1vdXNlSGVscGVyXzEuTW91c2VIZWxwZXIuZ2V0Q29vcmRzUmVsYXRpdmVUb0VsZW1lbnQoZXZlbnQsIHRoaXMuX3Rlcm1pbmFsLmVsZW1lbnQpWzFdO1xuICAgICAgICB2YXIgdGVybWluYWxIZWlnaHQgPSB0aGlzLl90ZXJtaW5hbC5yb3dzICogTWF0aC5jZWlsKHRoaXMuX2NoYXJNZWFzdXJlLmhlaWdodCAqIHRoaXMuX3Rlcm1pbmFsLm9wdGlvbnMubGluZUhlaWdodCk7XG4gICAgICAgIGlmIChvZmZzZXQgPj0gMCAmJiBvZmZzZXQgPD0gdGVybWluYWxIZWlnaHQpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvZmZzZXQgPiB0ZXJtaW5hbEhlaWdodCkge1xuICAgICAgICAgICAgb2Zmc2V0IC09IHRlcm1pbmFsSGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIG9mZnNldCA9IE1hdGgubWluKE1hdGgubWF4KG9mZnNldCwgLURSQUdfU0NST0xMX01BWF9USFJFU0hPTEQpLCBEUkFHX1NDUk9MTF9NQVhfVEhSRVNIT0xEKTtcbiAgICAgICAgb2Zmc2V0IC89IERSQUdfU0NST0xMX01BWF9USFJFU0hPTEQ7XG4gICAgICAgIHJldHVybiAob2Zmc2V0IC8gTWF0aC5hYnMob2Zmc2V0KSkgKyBNYXRoLnJvdW5kKG9mZnNldCAqIChEUkFHX1NDUk9MTF9NQVhfU1BFRUQgLSAxKSk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5zaG91bGRGb3JjZVNlbGVjdGlvbiA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICByZXR1cm4gQnJvd3Nlci5pc01hYyA/IGV2ZW50LmFsdEtleSA6IGV2ZW50LnNoaWZ0S2V5O1xuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUub25Nb3VzZURvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LmJ1dHRvbiA9PT0gMiAmJiB0aGlzLmhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudC5idXR0b24gIT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2VuYWJsZWQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5zaG91bGRGb3JjZVNlbGVjdGlvbihldmVudCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLl9kcmFnU2Nyb2xsQW1vdW50ID0gMDtcbiAgICAgICAgaWYgKHRoaXMuX2VuYWJsZWQgJiYgZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgIHRoaXMuX29uSW5jcmVtZW50YWxDbGljayhldmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuZGV0YWlsID09PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25TaW5nbGVDbGljayhldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChldmVudC5kZXRhaWwgPT09IDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkRvdWJsZUNsaWNrKGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmRldGFpbCA9PT0gMykge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uVHJpcGxlQ2xpY2soZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FkZE1vdXNlRG93bkxpc3RlbmVycygpO1xuICAgICAgICB0aGlzLnJlZnJlc2godHJ1ZSk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5fYWRkTW91c2VEb3duTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5lbGVtZW50Lm93bmVyRG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5fbW91c2VNb3ZlTGlzdGVuZXIpO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5lbGVtZW50Lm93bmVyRG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX21vdXNlVXBMaXN0ZW5lcik7XG4gICAgICAgIHRoaXMuX2RyYWdTY3JvbGxJbnRlcnZhbFRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2RyYWdTY3JvbGwoKTsgfSwgRFJBR19TQ1JPTExfSU5URVJWQUwpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX3JlbW92ZU1vdXNlRG93bkxpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuZWxlbWVudC5vd25lckRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdXNlTW92ZUxpc3RlbmVyKTtcbiAgICAgICAgdGhpcy5fdGVybWluYWwuZWxlbWVudC5vd25lckRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLl9tb3VzZVVwTGlzdGVuZXIpO1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuX2RyYWdTY3JvbGxJbnRlcnZhbFRpbWVyKTtcbiAgICAgICAgdGhpcy5fZHJhZ1Njcm9sbEludGVydmFsVGltZXIgPSBudWxsO1xuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX29uSW5jcmVtZW50YWxDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAodGhpcy5fbW9kZWwuc2VsZWN0aW9uU3RhcnQpIHtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvbkVuZCA9IHRoaXMuX2dldE1vdXNlQnVmZmVyQ29vcmRzKGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX29uU2luZ2xlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5fbW9kZWwuc2VsZWN0aW9uU3RhcnRMZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9tb2RlbC5pc1NlbGVjdEFsbEFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9hY3RpdmVTZWxlY3Rpb25Nb2RlID0gU2VsZWN0aW9uTW9kZS5OT1JNQUw7XG4gICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0ID0gdGhpcy5fZ2V0TW91c2VCdWZmZXJDb29yZHMoZXZlbnQpO1xuICAgICAgICBpZiAoIXRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kID0gbnVsbDtcbiAgICAgICAgdmFyIGxpbmUgPSB0aGlzLl9idWZmZXIubGluZXMuZ2V0KHRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0WzFdKTtcbiAgICAgICAgaWYgKCFsaW5lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpbmUubGVuZ3RoID49IHRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0WzBdKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoYXIgPSBsaW5lW3RoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0WzBdXTtcbiAgICAgICAgaWYgKGNoYXJbQnVmZmVyXzEuQ0hBUl9EQVRBX1dJRFRIX0lOREVYXSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5fbW9kZWwuc2VsZWN0aW9uU3RhcnRbMF0rKztcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX29uRG91YmxlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGNvb3JkcyA9IHRoaXMuX2dldE1vdXNlQnVmZmVyQ29vcmRzKGV2ZW50KTtcbiAgICAgICAgaWYgKGNvb3Jkcykge1xuICAgICAgICAgICAgdGhpcy5fYWN0aXZlU2VsZWN0aW9uTW9kZSA9IFNlbGVjdGlvbk1vZGUuV09SRDtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdFdvcmRBdChjb29yZHMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5fb25UcmlwbGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgY29vcmRzID0gdGhpcy5fZ2V0TW91c2VCdWZmZXJDb29yZHMoZXZlbnQpO1xuICAgICAgICBpZiAoY29vcmRzKSB7XG4gICAgICAgICAgICB0aGlzLl9hY3RpdmVTZWxlY3Rpb25Nb2RlID0gU2VsZWN0aW9uTW9kZS5MSU5FO1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0TGluZUF0KGNvb3Jkc1sxXSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLl9vbk1vdXNlTW92ZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdmFyIHByZXZpb3VzU2VsZWN0aW9uRW5kID0gdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kID8gW3RoaXMuX21vZGVsLnNlbGVjdGlvbkVuZFswXSwgdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kWzFdXSA6IG51bGw7XG4gICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvbkVuZCA9IHRoaXMuX2dldE1vdXNlQnVmZmVyQ29vcmRzKGV2ZW50KTtcbiAgICAgICAgaWYgKCF0aGlzLl9tb2RlbC5zZWxlY3Rpb25FbmQpIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaCh0cnVlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fYWN0aXZlU2VsZWN0aW9uTW9kZSA9PT0gU2VsZWN0aW9uTW9kZS5MSU5FKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kWzFdIDwgdGhpcy5fbW9kZWwuc2VsZWN0aW9uU3RhcnRbMV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RlbC5zZWxlY3Rpb25FbmRbMF0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kWzBdID0gdGhpcy5fdGVybWluYWwuY29scztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9hY3RpdmVTZWxlY3Rpb25Nb2RlID09PSBTZWxlY3Rpb25Nb2RlLldPUkQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdFRvV29yZEF0KHRoaXMuX21vZGVsLnNlbGVjdGlvbkVuZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZHJhZ1Njcm9sbEFtb3VudCA9IHRoaXMuX2dldE1vdXNlRXZlbnRTY3JvbGxBbW91bnQoZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy5fZHJhZ1Njcm9sbEFtb3VudCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvbkVuZFswXSA9IHRoaXMuX3Rlcm1pbmFsLmNvbHM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fZHJhZ1Njcm9sbEFtb3VudCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvbkVuZFswXSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX21vZGVsLnNlbGVjdGlvbkVuZFsxXSA8IHRoaXMuX2J1ZmZlci5saW5lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBjaGFyID0gdGhpcy5fYnVmZmVyLmxpbmVzLmdldCh0aGlzLl9tb2RlbC5zZWxlY3Rpb25FbmRbMV0pW3RoaXMuX21vZGVsLnNlbGVjdGlvbkVuZFswXV07XG4gICAgICAgICAgICBpZiAoY2hhciAmJiBjaGFyW0J1ZmZlcl8xLkNIQVJfREFUQV9XSURUSF9JTkRFWF0gPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RlbC5zZWxlY3Rpb25FbmRbMF0rKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXByZXZpb3VzU2VsZWN0aW9uRW5kIHx8XG4gICAgICAgICAgICBwcmV2aW91c1NlbGVjdGlvbkVuZFswXSAhPT0gdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kWzBdIHx8XG4gICAgICAgICAgICBwcmV2aW91c1NlbGVjdGlvbkVuZFsxXSAhPT0gdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kWzFdKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2godHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLl9kcmFnU2Nyb2xsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fZHJhZ1Njcm9sbEFtb3VudCkge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuc2Nyb2xsTGluZXModGhpcy5fZHJhZ1Njcm9sbEFtb3VudCwgZmFsc2UpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2RyYWdTY3JvbGxBbW91bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kID0gW3RoaXMuX3Rlcm1pbmFsLmNvbHMgLSAxLCBNYXRoLm1pbih0aGlzLl90ZXJtaW5hbC5idWZmZXIueWRpc3AgKyB0aGlzLl90ZXJtaW5hbC5yb3dzLCB0aGlzLl90ZXJtaW5hbC5idWZmZXIubGluZXMubGVuZ3RoIC0gMSldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kZWwuc2VsZWN0aW9uRW5kID0gWzAsIHRoaXMuX3Rlcm1pbmFsLmJ1ZmZlci55ZGlzcF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX29uTW91c2VVcCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9yZW1vdmVNb3VzZURvd25MaXN0ZW5lcnMoKTtcbiAgICAgICAgaWYgKHRoaXMuaGFzU2VsZWN0aW9uKVxuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZW1pdCgnc2VsZWN0aW9uJyk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5fY29udmVydFZpZXdwb3J0Q29sVG9DaGFyYWN0ZXJJbmRleCA9IGZ1bmN0aW9uIChidWZmZXJMaW5lLCBjb29yZHMpIHtcbiAgICAgICAgdmFyIGNoYXJJbmRleCA9IGNvb3Jkc1swXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGNvb3Jkc1swXSA+PSBpOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjaGFyID0gYnVmZmVyTGluZVtpXTtcbiAgICAgICAgICAgIGlmIChjaGFyW0J1ZmZlcl8xLkNIQVJfREFUQV9XSURUSF9JTkRFWF0gPT09IDApIHtcbiAgICAgICAgICAgICAgICBjaGFySW5kZXgtLTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNoYXJbQnVmZmVyXzEuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdLmxlbmd0aCA+IDEgJiYgY29vcmRzWzBdICE9PSBpKSB7XG4gICAgICAgICAgICAgICAgY2hhckluZGV4ICs9IGNoYXJbQnVmZmVyXzEuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoYXJJbmRleDtcbiAgICB9O1xuICAgIFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLnNldFNlbGVjdGlvbiA9IGZ1bmN0aW9uIChjb2wsIHJvdywgbGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuX21vZGVsLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuX3JlbW92ZU1vdXNlRG93bkxpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9tb2RlbC5zZWxlY3Rpb25TdGFydCA9IFtjb2wsIHJvd107XG4gICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0TGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbk1hbmFnZXIucHJvdG90eXBlLl9nZXRXb3JkQXQgPSBmdW5jdGlvbiAoY29vcmRzKSB7XG4gICAgICAgIHZhciBidWZmZXJMaW5lID0gdGhpcy5fYnVmZmVyLmxpbmVzLmdldChjb29yZHNbMV0pO1xuICAgICAgICBpZiAoIWJ1ZmZlckxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaW5lID0gdGhpcy5fYnVmZmVyLnRyYW5zbGF0ZUJ1ZmZlckxpbmVUb1N0cmluZyhjb29yZHNbMV0sIGZhbHNlKTtcbiAgICAgICAgdmFyIHN0YXJ0SW5kZXggPSB0aGlzLl9jb252ZXJ0Vmlld3BvcnRDb2xUb0NoYXJhY3RlckluZGV4KGJ1ZmZlckxpbmUsIGNvb3Jkcyk7XG4gICAgICAgIHZhciBlbmRJbmRleCA9IHN0YXJ0SW5kZXg7XG4gICAgICAgIHZhciBjaGFyT2Zmc2V0ID0gY29vcmRzWzBdIC0gc3RhcnRJbmRleDtcbiAgICAgICAgdmFyIGxlZnRXaWRlQ2hhckNvdW50ID0gMDtcbiAgICAgICAgdmFyIHJpZ2h0V2lkZUNoYXJDb3VudCA9IDA7XG4gICAgICAgIHZhciBsZWZ0TG9uZ0NoYXJPZmZzZXQgPSAwO1xuICAgICAgICB2YXIgcmlnaHRMb25nQ2hhck9mZnNldCA9IDA7XG4gICAgICAgIGlmIChsaW5lLmNoYXJBdChzdGFydEluZGV4KSA9PT0gJyAnKSB7XG4gICAgICAgICAgICB3aGlsZSAoc3RhcnRJbmRleCA+IDAgJiYgbGluZS5jaGFyQXQoc3RhcnRJbmRleCAtIDEpID09PSAnICcpIHtcbiAgICAgICAgICAgICAgICBzdGFydEluZGV4LS07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZSAoZW5kSW5kZXggPCBsaW5lLmxlbmd0aCAmJiBsaW5lLmNoYXJBdChlbmRJbmRleCArIDEpID09PSAnICcpIHtcbiAgICAgICAgICAgICAgICBlbmRJbmRleCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHN0YXJ0Q29sID0gY29vcmRzWzBdO1xuICAgICAgICAgICAgdmFyIGVuZENvbCA9IGNvb3Jkc1swXTtcbiAgICAgICAgICAgIGlmIChidWZmZXJMaW5lW3N0YXJ0Q29sXVtCdWZmZXJfMS5DSEFSX0RBVEFfV0lEVEhfSU5ERVhdID09PSAwKSB7XG4gICAgICAgICAgICAgICAgbGVmdFdpZGVDaGFyQ291bnQrKztcbiAgICAgICAgICAgICAgICBzdGFydENvbC0tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGJ1ZmZlckxpbmVbZW5kQ29sXVtCdWZmZXJfMS5DSEFSX0RBVEFfV0lEVEhfSU5ERVhdID09PSAyKSB7XG4gICAgICAgICAgICAgICAgcmlnaHRXaWRlQ2hhckNvdW50Kys7XG4gICAgICAgICAgICAgICAgZW5kQ29sKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYnVmZmVyTGluZVtlbmRDb2xdW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgcmlnaHRMb25nQ2hhck9mZnNldCArPSBidWZmZXJMaW5lW2VuZENvbF1bQnVmZmVyXzEuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgZW5kSW5kZXggKz0gYnVmZmVyTGluZVtlbmRDb2xdW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXS5sZW5ndGggLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKHN0YXJ0Q29sID4gMCAmJiBzdGFydEluZGV4ID4gMCAmJiAhdGhpcy5faXNDaGFyV29yZFNlcGFyYXRvcihidWZmZXJMaW5lW3N0YXJ0Q29sIC0gMV0pKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoYXIgPSBidWZmZXJMaW5lW3N0YXJ0Q29sIC0gMV07XG4gICAgICAgICAgICAgICAgaWYgKGNoYXJbQnVmZmVyXzEuQ0hBUl9EQVRBX1dJRFRIX0lOREVYXSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsZWZ0V2lkZUNoYXJDb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICBzdGFydENvbC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGxlZnRMb25nQ2hhck9mZnNldCArPSBjaGFyW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXS5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICBzdGFydEluZGV4IC09IGNoYXJbQnVmZmVyXzEuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXgtLTtcbiAgICAgICAgICAgICAgICBzdGFydENvbC0tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKGVuZENvbCA8IGJ1ZmZlckxpbmUubGVuZ3RoICYmIGVuZEluZGV4ICsgMSA8IGxpbmUubGVuZ3RoICYmICF0aGlzLl9pc0NoYXJXb3JkU2VwYXJhdG9yKGJ1ZmZlckxpbmVbZW5kQ29sICsgMV0pKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoYXIgPSBidWZmZXJMaW5lW2VuZENvbCArIDFdO1xuICAgICAgICAgICAgICAgIGlmIChjaGFyW0J1ZmZlcl8xLkNIQVJfREFUQV9XSURUSF9JTkRFWF0gPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRXaWRlQ2hhckNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIGVuZENvbCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0TG9uZ0NoYXJPZmZzZXQgKz0gY2hhcltCdWZmZXJfMS5DSEFSX0RBVEFfQ0hBUl9JTkRFWF0ubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggKz0gY2hhcltCdWZmZXJfMS5DSEFSX0RBVEFfQ0hBUl9JTkRFWF0ubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZW5kSW5kZXgrKztcbiAgICAgICAgICAgICAgICBlbmRDb2wrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbmRJbmRleCsrO1xuICAgICAgICB2YXIgc3RhcnQgPSBzdGFydEluZGV4XG4gICAgICAgICAgICArIGNoYXJPZmZzZXRcbiAgICAgICAgICAgIC0gbGVmdFdpZGVDaGFyQ291bnRcbiAgICAgICAgICAgICsgbGVmdExvbmdDaGFyT2Zmc2V0O1xuICAgICAgICB2YXIgbGVuZ3RoID0gTWF0aC5taW4odGhpcy5fdGVybWluYWwuY29scywgZW5kSW5kZXhcbiAgICAgICAgICAgIC0gc3RhcnRJbmRleFxuICAgICAgICAgICAgKyBsZWZ0V2lkZUNoYXJDb3VudFxuICAgICAgICAgICAgKyByaWdodFdpZGVDaGFyQ291bnRcbiAgICAgICAgICAgIC0gbGVmdExvbmdDaGFyT2Zmc2V0XG4gICAgICAgICAgICAtIHJpZ2h0TG9uZ0NoYXJPZmZzZXQpO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGxlbmd0aDogbGVuZ3RoIH07XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5fc2VsZWN0V29yZEF0ID0gZnVuY3Rpb24gKGNvb3Jkcykge1xuICAgICAgICB2YXIgd29yZFBvc2l0aW9uID0gdGhpcy5fZ2V0V29yZEF0KGNvb3Jkcyk7XG4gICAgICAgIGlmICh3b3JkUG9zaXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0ID0gW3dvcmRQb3NpdGlvbi5zdGFydCwgY29vcmRzWzFdXTtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0TGVuZ3RoID0gd29yZFBvc2l0aW9uLmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uTWFuYWdlci5wcm90b3R5cGUuX3NlbGVjdFRvV29yZEF0ID0gZnVuY3Rpb24gKGNvb3Jkcykge1xuICAgICAgICB2YXIgd29yZFBvc2l0aW9uID0gdGhpcy5fZ2V0V29yZEF0KGNvb3Jkcyk7XG4gICAgICAgIGlmICh3b3JkUG9zaXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvbkVuZCA9IFt0aGlzLl9tb2RlbC5hcmVTZWxlY3Rpb25WYWx1ZXNSZXZlcnNlZCgpID8gd29yZFBvc2l0aW9uLnN0YXJ0IDogKHdvcmRQb3NpdGlvbi5zdGFydCArIHdvcmRQb3NpdGlvbi5sZW5ndGgpLCBjb29yZHNbMV1dO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5faXNDaGFyV29yZFNlcGFyYXRvciA9IGZ1bmN0aW9uIChjaGFyRGF0YSkge1xuICAgICAgICBpZiAoY2hhckRhdGFbQnVmZmVyXzEuQ0hBUl9EQVRBX1dJRFRIX0lOREVYXSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBXT1JEX1NFUEFSQVRPUlMuaW5kZXhPZihjaGFyRGF0YVtCdWZmZXJfMS5DSEFSX0RBVEFfQ0hBUl9JTkRFWF0pID49IDA7XG4gICAgfTtcbiAgICBTZWxlY3Rpb25NYW5hZ2VyLnByb3RvdHlwZS5fc2VsZWN0TGluZUF0ID0gZnVuY3Rpb24gKGxpbmUpIHtcbiAgICAgICAgdGhpcy5fbW9kZWwuc2VsZWN0aW9uU3RhcnQgPSBbMCwgbGluZV07XG4gICAgICAgIHRoaXMuX21vZGVsLnNlbGVjdGlvblN0YXJ0TGVuZ3RoID0gdGhpcy5fdGVybWluYWwuY29scztcbiAgICB9O1xuICAgIHJldHVybiBTZWxlY3Rpb25NYW5hZ2VyO1xufShFdmVudEVtaXR0ZXJfMS5FdmVudEVtaXR0ZXIpKTtcbmV4cG9ydHMuU2VsZWN0aW9uTWFuYWdlciA9IFNlbGVjdGlvbk1hbmFnZXI7XG5cblxuXG59LHtcIi4vQnVmZmVyXCI6MSxcIi4vRXZlbnRFbWl0dGVyXCI6NyxcIi4vU2VsZWN0aW9uTW9kZWxcIjoxMixcIi4vdXRpbHMvQnJvd3NlclwiOjI4LFwiLi91dGlscy9Nb3VzZUhlbHBlclwiOjMyfV0sMTI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU2VsZWN0aW9uTW9kZWwgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlbGVjdGlvbk1vZGVsKF90ZXJtaW5hbCkge1xuICAgICAgICB0aGlzLl90ZXJtaW5hbCA9IF90ZXJtaW5hbDtcbiAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgIH1cbiAgICBTZWxlY3Rpb25Nb2RlbC5wcm90b3R5cGUuY2xlYXJTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU3RhcnQgPSBudWxsO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkVuZCA9IG51bGw7XG4gICAgICAgIHRoaXMuaXNTZWxlY3RBbGxBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TdGFydExlbmd0aCA9IDA7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VsZWN0aW9uTW9kZWwucHJvdG90eXBlLCBcImZpbmFsU2VsZWN0aW9uU3RhcnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0QWxsQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFswLCAwXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3Rpb25FbmQgfHwgIXRoaXMuc2VsZWN0aW9uU3RhcnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFyZVNlbGVjdGlvblZhbHVlc1JldmVyc2VkKCkgPyB0aGlzLnNlbGVjdGlvbkVuZCA6IHRoaXMuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZWxlY3Rpb25Nb2RlbC5wcm90b3R5cGUsIFwiZmluYWxTZWxlY3Rpb25FbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0QWxsQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFt0aGlzLl90ZXJtaW5hbC5jb2xzLCB0aGlzLl90ZXJtaW5hbC5idWZmZXIueWJhc2UgKyB0aGlzLl90ZXJtaW5hbC5yb3dzIC0gMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuc2VsZWN0aW9uU3RhcnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3Rpb25FbmQgfHwgdGhpcy5hcmVTZWxlY3Rpb25WYWx1ZXNSZXZlcnNlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnNlbGVjdGlvblN0YXJ0WzBdICsgdGhpcy5zZWxlY3Rpb25TdGFydExlbmd0aCwgdGhpcy5zZWxlY3Rpb25TdGFydFsxXV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TdGFydExlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbkVuZFsxXSA9PT0gdGhpcy5zZWxlY3Rpb25TdGFydFsxXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW01hdGgubWF4KHRoaXMuc2VsZWN0aW9uU3RhcnRbMF0gKyB0aGlzLnNlbGVjdGlvblN0YXJ0TGVuZ3RoLCB0aGlzLnNlbGVjdGlvbkVuZFswXSksIHRoaXMuc2VsZWN0aW9uRW5kWzFdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25FbmQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNlbGVjdGlvbk1vZGVsLnByb3RvdHlwZS5hcmVTZWxlY3Rpb25WYWx1ZXNSZXZlcnNlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgdmFyIGVuZCA9IHRoaXMuc2VsZWN0aW9uRW5kO1xuICAgICAgICBpZiAoIXN0YXJ0IHx8ICFlbmQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RhcnRbMV0gPiBlbmRbMV0gfHwgKHN0YXJ0WzFdID09PSBlbmRbMV0gJiYgc3RhcnRbMF0gPiBlbmRbMF0pO1xuICAgIH07XG4gICAgU2VsZWN0aW9uTW9kZWwucHJvdG90eXBlLm9uVHJpbSA9IGZ1bmN0aW9uIChhbW91bnQpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uU3RhcnQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU3RhcnRbMV0gLT0gYW1vdW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbkVuZCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25FbmRbMV0gLT0gYW1vdW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbkVuZCAmJiB0aGlzLnNlbGVjdGlvbkVuZFsxXSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblN0YXJ0ICYmIHRoaXMuc2VsZWN0aW9uU3RhcnRbMV0gPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblN0YXJ0WzFdID0gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICByZXR1cm4gU2VsZWN0aW9uTW9kZWw7XG59KCkpO1xuZXhwb3J0cy5TZWxlY3Rpb25Nb2RlbCA9IFNlbGVjdGlvbk1vZGVsO1xuXG5cblxufSx7fV0sMTM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBCdWZmZXJTZXRfMSA9IHJlcXVpcmUoXCIuL0J1ZmZlclNldFwiKTtcbnZhciBCdWZmZXJfMSA9IHJlcXVpcmUoXCIuL0J1ZmZlclwiKTtcbnZhciBDb21wb3NpdGlvbkhlbHBlcl8xID0gcmVxdWlyZShcIi4vQ29tcG9zaXRpb25IZWxwZXJcIik7XG52YXIgRXZlbnRFbWl0dGVyXzEgPSByZXF1aXJlKFwiLi9FdmVudEVtaXR0ZXJcIik7XG52YXIgVmlld3BvcnRfMSA9IHJlcXVpcmUoXCIuL1ZpZXdwb3J0XCIpO1xudmFyIENsaXBib2FyZF8xID0gcmVxdWlyZShcIi4vaGFuZGxlcnMvQ2xpcGJvYXJkXCIpO1xudmFyIEVzY2FwZVNlcXVlbmNlc18xID0gcmVxdWlyZShcIi4vRXNjYXBlU2VxdWVuY2VzXCIpO1xudmFyIElucHV0SGFuZGxlcl8xID0gcmVxdWlyZShcIi4vSW5wdXRIYW5kbGVyXCIpO1xudmFyIFBhcnNlcl8xID0gcmVxdWlyZShcIi4vUGFyc2VyXCIpO1xudmFyIFJlbmRlcmVyXzEgPSByZXF1aXJlKFwiLi9yZW5kZXJlci9SZW5kZXJlclwiKTtcbnZhciBMaW5raWZpZXJfMSA9IHJlcXVpcmUoXCIuL0xpbmtpZmllclwiKTtcbnZhciBTZWxlY3Rpb25NYW5hZ2VyXzEgPSByZXF1aXJlKFwiLi9TZWxlY3Rpb25NYW5hZ2VyXCIpO1xudmFyIENoYXJNZWFzdXJlXzEgPSByZXF1aXJlKFwiLi91dGlscy9DaGFyTWVhc3VyZVwiKTtcbnZhciBCcm93c2VyID0gcmVxdWlyZShcIi4vdXRpbHMvQnJvd3NlclwiKTtcbnZhciBNb3VzZUhlbHBlcl8xID0gcmVxdWlyZShcIi4vdXRpbHMvTW91c2VIZWxwZXJcIik7XG52YXIgU291bmRzXzEgPSByZXF1aXJlKFwiLi91dGlscy9Tb3VuZHNcIik7XG52YXIgQ29sb3JNYW5hZ2VyXzEgPSByZXF1aXJlKFwiLi9yZW5kZXJlci9Db2xvck1hbmFnZXJcIik7XG52YXIgTW91c2Vab25lTWFuYWdlcl8xID0gcmVxdWlyZShcIi4vaW5wdXQvTW91c2Vab25lTWFuYWdlclwiKTtcbnZhciBDaGFyQXRsYXNfMSA9IHJlcXVpcmUoXCIuL3JlbmRlcmVyL0NoYXJBdGxhc1wiKTtcbnZhciBkb2N1bWVudCA9ICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykgPyB3aW5kb3cuZG9jdW1lbnQgOiBudWxsO1xudmFyIFdSSVRFX0JVRkZFUl9QQVVTRV9USFJFU0hPTEQgPSA1O1xudmFyIFdSSVRFX0JBVENIX1NJWkUgPSAzMDA7XG52YXIgREVGQVVMVF9PUFRJT05TID0ge1xuICAgIGNvbHM6IDgwLFxuICAgIHJvd3M6IDI0LFxuICAgIGNvbnZlcnRFb2w6IGZhbHNlLFxuICAgIHRlcm1OYW1lOiAneHRlcm0nLFxuICAgIGN1cnNvckJsaW5rOiBmYWxzZSxcbiAgICBjdXJzb3JTdHlsZTogJ2Jsb2NrJyxcbiAgICBiZWxsU291bmQ6IFNvdW5kc18xLkJlbGxTb3VuZCxcbiAgICBiZWxsU3R5bGU6ICdub25lJyxcbiAgICBlbmFibGVCb2xkOiB0cnVlLFxuICAgIGZvbnRGYW1pbHk6ICdjb3VyaWVyLW5ldywgY291cmllciwgbW9ub3NwYWNlJyxcbiAgICBmb250U2l6ZTogMTUsXG4gICAgbGluZUhlaWdodDogMS4wLFxuICAgIGxldHRlclNwYWNpbmc6IDAsXG4gICAgc2Nyb2xsYmFjazogMTAwMCxcbiAgICBzY3JlZW5LZXlzOiBmYWxzZSxcbiAgICBkZWJ1ZzogZmFsc2UsXG4gICAgY2FuY2VsRXZlbnRzOiBmYWxzZSxcbiAgICBkaXNhYmxlU3RkaW46IGZhbHNlLFxuICAgIHVzZUZsb3dDb250cm9sOiBmYWxzZSxcbiAgICB0YWJTdG9wV2lkdGg6IDgsXG4gICAgdGhlbWU6IG51bGxcbn07XG52YXIgVGVybWluYWwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXJtaW5hbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUZXJtaW5hbChvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmJyb3dzZXIgPSBCcm93c2VyO1xuICAgICAgICBfdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgX3RoaXMuc2V0dXAoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIE9iamVjdC5rZXlzKERFRkFVTFRfT1BUSU9OUykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMub3B0aW9uc1trZXldID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5vcHRpb25zW2tleV0gPSBERUZBVUxUX09QVElPTlNba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzW2tleV0gPSBfdGhpcy5vcHRpb25zW2tleV07XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBhcmVudCA9IGRvY3VtZW50ID8gZG9jdW1lbnQuYm9keSA6IG51bGw7XG4gICAgICAgIHRoaXMuY29scyA9IHRoaXMub3B0aW9ucy5jb2xzO1xuICAgICAgICB0aGlzLnJvd3MgPSB0aGlzLm9wdGlvbnMucm93cztcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5oYW5kbGVyKSB7XG4gICAgICAgICAgICB0aGlzLm9uKCdkYXRhJywgdGhpcy5vcHRpb25zLmhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3Vyc29yU3RhdGUgPSAwO1xuICAgICAgICB0aGlzLmN1cnNvckhpZGRlbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlbmREYXRhUXVldWUgPSAnJztcbiAgICAgICAgdGhpcy5jdXN0b21LZXlFdmVudEhhbmRsZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uS2V5cGFkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb25DdXJzb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vcmlnaW5Nb2RlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5zZXJ0TW9kZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLndyYXBhcm91bmRNb2RlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5icmFja2V0ZWRQYXN0ZU1vZGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jaGFyc2V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5nY2hhcnNldCA9IG51bGw7XG4gICAgICAgIHRoaXMuZ2xldmVsID0gMDtcbiAgICAgICAgdGhpcy5jaGFyc2V0cyA9IFtudWxsXTtcbiAgICAgICAgdGhpcy5yZWFkYWJsZSA9IHRydWU7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICB0aGlzLmRlZkF0dHIgPSAoMCA8PCAxOCkgfCAoMjU3IDw8IDkpIHwgKDI1NiA8PCAwKTtcbiAgICAgICAgdGhpcy5jdXJBdHRyID0gKDAgPDwgMTgpIHwgKDI1NyA8PCA5KSB8ICgyNTYgPDwgMCk7XG4gICAgICAgIHRoaXMucGFyYW1zID0gW107XG4gICAgICAgIHRoaXMuY3VycmVudFBhcmFtID0gMDtcbiAgICAgICAgdGhpcy5wcmVmaXggPSAnJztcbiAgICAgICAgdGhpcy5wb3N0Zml4ID0gJyc7XG4gICAgICAgIHRoaXMud3JpdGVCdWZmZXIgPSBbXTtcbiAgICAgICAgdGhpcy53cml0ZUluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgdGhpcy54b2ZmU2VudFRvQ2F0Y2hVcCA9IGZhbHNlO1xuICAgICAgICB0aGlzLndyaXRlU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN1cnJvZ2F0ZV9oaWdoID0gJyc7XG4gICAgICAgIHRoaXMudXNlclNjcm9sbGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlucHV0SGFuZGxlciA9IG5ldyBJbnB1dEhhbmRsZXJfMS5JbnB1dEhhbmRsZXIodGhpcyk7XG4gICAgICAgIHRoaXMucGFyc2VyID0gbmV3IFBhcnNlcl8xLlBhcnNlcih0aGlzLmlucHV0SGFuZGxlciwgdGhpcyk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyIHx8IG51bGw7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uTWFuYWdlciA9IHRoaXMuc2VsZWN0aW9uTWFuYWdlciB8fCBudWxsO1xuICAgICAgICB0aGlzLmxpbmtpZmllciA9IHRoaXMubGlua2lmaWVyIHx8IG5ldyBMaW5raWZpZXJfMS5MaW5raWZpZXIodGhpcyk7XG4gICAgICAgIHRoaXMuX21vdXNlWm9uZU1hbmFnZXIgPSB0aGlzLl9tb3VzZVpvbmVNYW5hZ2VyIHx8IG51bGw7XG4gICAgICAgIHRoaXMuYnVmZmVycyA9IG5ldyBCdWZmZXJTZXRfMS5CdWZmZXJTZXQodGhpcyk7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXJzLmFjdGl2ZTtcbiAgICAgICAgdGhpcy5idWZmZXJzLm9uKCdhY3RpdmF0ZScsIGZ1bmN0aW9uIChidWZmZXIpIHtcbiAgICAgICAgICAgIF90aGlzLmJ1ZmZlciA9IGJ1ZmZlcjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uTWFuYWdlci5zZXRCdWZmZXIodGhpcy5idWZmZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuZXJhc2VBdHRyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuZGVmQXR0ciAmIH4weDFmZikgfCAodGhpcy5jdXJBdHRyICYgMHgxZmYpO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50ZXh0YXJlYSkge1xuICAgICAgICAgICAgdGhpcy50ZXh0YXJlYS5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGVybWluYWwucHJvdG90eXBlLCBcImlzRm9jdXNlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHRoaXMudGV4dGFyZWE7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5nZXRPcHRpb24gPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGlmICghKGtleSBpbiBERUZBVUxUX09QVElPTlMpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIG9wdGlvbiB3aXRoIGtleSBcIicgKyBrZXkgKyAnXCInKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9uc1trZXldICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzW2tleV07XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuc2V0T3B0aW9uID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKCEoa2V5IGluIERFRkFVTFRfT1BUSU9OUykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gb3B0aW9uIHdpdGgga2V5IFwiJyArIGtleSArICdcIicpO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgICBjYXNlICdiZWxsU3R5bGUnOlxuICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnY3Vyc29yU3R5bGUnOlxuICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnYmxvY2snO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2xpbmVIZWlnaHQnOlxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGtleSArIFwiIGNhbm5vdCBiZSBsZXNzIHRoYW4gMSwgdmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAndGFiU3RvcFdpZHRoJzpcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihrZXkgKyBcIiBjYW5ub3QgYmUgbGVzcyB0aGFuIDEsIHZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RoZW1lJzpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZW5kZXJlcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRUaGVtZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzY3JvbGxiYWNrJzpcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IE1hdGgubWluKHZhbHVlLCBCdWZmZXJfMS5NQVhfQlVGRkVSX1NJWkUpO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGtleSArIFwiIGNhbm5vdCBiZSBsZXNzIHRoYW4gMCwgdmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnNba2V5XSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0J1ZmZlckxlbmd0aCA9IHRoaXMucm93cyArIHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5idWZmZXIubGluZXMubGVuZ3RoID4gbmV3QnVmZmVyTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW1vdW50VG9UcmltID0gdGhpcy5idWZmZXIubGluZXMubGVuZ3RoIC0gbmV3QnVmZmVyTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5lZWRzUmVmcmVzaCA9ICh0aGlzLmJ1ZmZlci55ZGlzcCAtIGFtb3VudFRvVHJpbSA8IDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWZmZXIubGluZXMudHJpbVN0YXJ0KGFtb3VudFRvVHJpbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1ZmZlci55YmFzZSA9IE1hdGgubWF4KHRoaXMuYnVmZmVyLnliYXNlIC0gYW1vdW50VG9UcmltLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyLnlkaXNwID0gTWF0aC5tYXgodGhpcy5idWZmZXIueWRpc3AgLSBhbW91bnRUb1RyaW0sIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWRzUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgwLCB0aGlzLnJvd3MgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5vcHRpb25zW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgICAgIGNhc2UgJ2ZvbnRGYW1pbHknOlxuICAgICAgICAgICAgY2FzZSAnZm9udFNpemUnOlxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJNZWFzdXJlLm1lYXN1cmUodGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VuYWJsZUJvbGQnOlxuICAgICAgICAgICAgY2FzZSAnbGV0dGVyU3BhY2luZyc6XG4gICAgICAgICAgICBjYXNlICdsaW5lSGVpZ2h0JzpcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5vblJlc2l6ZSh0aGlzLmNvbHMsIHRoaXMucm93cywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgwLCB0aGlzLnJvd3MgLSAxKTtcbiAgICAgICAgICAgIGNhc2UgJ3Njcm9sbGJhY2snOlxuICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVycy5yZXNpemUodGhpcy5jb2xzLCB0aGlzLnJvd3MpO1xuICAgICAgICAgICAgICAgIHRoaXMudmlld3BvcnQuc3luY1Njcm9sbEFyZWEoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RhYlN0b3BXaWR0aCc6XG4gICAgICAgICAgICAgICAgdGhpcy5idWZmZXJzLnNldHVwVGFiU3RvcHMoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2JlbGxTb3VuZCc6XG4gICAgICAgICAgICBjYXNlICdiZWxsU3R5bGUnOlxuICAgICAgICAgICAgICAgIHRoaXMuc3luY0JlbGxTb3VuZCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlbmRlcmVyKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLm9uT3B0aW9uc0NoYW5nZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLl9vblRleHRBcmVhRm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbmRGb2N1cykge1xuICAgICAgICAgICAgdGhpcy5zZW5kKEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbSScpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdmb2N1cycpO1xuICAgICAgICB0aGlzLnNob3dDdXJzb3IoKTtcbiAgICAgICAgdGhpcy5lbWl0KCdmb2N1cycpO1xuICAgIH07XG4gICAgO1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5ibHVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0YXJlYS5ibHVyKCk7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuX29uVGV4dEFyZWFCbHVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlZnJlc2godGhpcy5idWZmZXIueSwgdGhpcy5idWZmZXIueSk7XG4gICAgICAgIGlmICh0aGlzLnNlbmRGb2N1cykge1xuICAgICAgICAgICAgdGhpcy5zZW5kKEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbTycpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmb2N1cycpO1xuICAgICAgICB0aGlzLmVtaXQoJ2JsdXInKTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5pbml0R2xvYmFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmJpbmRLZXlzKCk7XG4gICAgICAgIG9uKHRoaXMuZWxlbWVudCwgJ2NvcHknLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICghX3RoaXMuaGFzU2VsZWN0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbGlwYm9hcmRfMS5jb3B5SGFuZGxlcihldmVudCwgX3RoaXMsIF90aGlzLnNlbGVjdGlvbk1hbmFnZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHBhc3RlSGFuZGxlcldyYXBwZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIENsaXBib2FyZF8xLnBhc3RlSGFuZGxlcihldmVudCwgX3RoaXMpOyB9O1xuICAgICAgICBvbih0aGlzLnRleHRhcmVhLCAncGFzdGUnLCBwYXN0ZUhhbmRsZXJXcmFwcGVyKTtcbiAgICAgICAgb24odGhpcy5lbGVtZW50LCAncGFzdGUnLCBwYXN0ZUhhbmRsZXJXcmFwcGVyKTtcbiAgICAgICAgaWYgKEJyb3dzZXIuaXNGaXJlZm94KSB7XG4gICAgICAgICAgICBvbih0aGlzLmVsZW1lbnQsICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuYnV0dG9uID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIENsaXBib2FyZF8xLnJpZ2h0Q2xpY2tIYW5kbGVyKGV2ZW50LCBfdGhpcy50ZXh0YXJlYSwgX3RoaXMuc2VsZWN0aW9uTWFuYWdlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvbih0aGlzLmVsZW1lbnQsICdjb250ZXh0bWVudScsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIENsaXBib2FyZF8xLnJpZ2h0Q2xpY2tIYW5kbGVyKGV2ZW50LCBfdGhpcy50ZXh0YXJlYSwgX3RoaXMuc2VsZWN0aW9uTWFuYWdlcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQnJvd3Nlci5pc0xpbnV4KSB7XG4gICAgICAgICAgICBvbih0aGlzLmVsZW1lbnQsICdhdXhjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5idXR0b24gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgQ2xpcGJvYXJkXzEubW92ZVRleHRBcmVhVW5kZXJNb3VzZUN1cnNvcihldmVudCwgX3RoaXMudGV4dGFyZWEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuYmluZEtleXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgb24odGhpcy5lbGVtZW50LCAna2V5ZG93bicsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLl9rZXlEb3duKGV2KTtcbiAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgIG9uKHRoaXMuZWxlbWVudCwgJ2tleXByZXNzJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gdGhpcykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuX2tleVByZXNzKGV2KTtcbiAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgIG9uKHRoaXMuZWxlbWVudCwgJ2tleXVwJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICBpZiAoIXdhc01vbmRpZmllcktleU9ubHlFdmVudChldikpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgb24odGhpcy50ZXh0YXJlYSwgJ2tleWRvd24nLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIF90aGlzLl9rZXlEb3duKGV2KTtcbiAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgIG9uKHRoaXMudGV4dGFyZWEsICdrZXlwcmVzcycsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgX3RoaXMuX2tleVByZXNzKGV2KTtcbiAgICAgICAgICAgIF90aGlzLnRleHRhcmVhLnZhbHVlID0gJyc7XG4gICAgICAgIH0sIHRydWUpO1xuICAgICAgICBvbih0aGlzLnRleHRhcmVhLCAnY29tcG9zaXRpb25zdGFydCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmNvbXBvc2l0aW9uSGVscGVyLmNvbXBvc2l0aW9uc3RhcnQoKTsgfSk7XG4gICAgICAgIG9uKHRoaXMudGV4dGFyZWEsICdjb21wb3NpdGlvbnVwZGF0ZScsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5jb21wb3NpdGlvbkhlbHBlci5jb21wb3NpdGlvbnVwZGF0ZShlKTsgfSk7XG4gICAgICAgIG9uKHRoaXMudGV4dGFyZWEsICdjb21wb3NpdGlvbmVuZCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmNvbXBvc2l0aW9uSGVscGVyLmNvbXBvc2l0aW9uZW5kKCk7IH0pO1xuICAgICAgICB0aGlzLm9uKCdyZWZyZXNoJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuY29tcG9zaXRpb25IZWxwZXIudXBkYXRlQ29tcG9zaXRpb25FbGVtZW50cygpOyB9KTtcbiAgICAgICAgdGhpcy5vbigncmVmcmVzaCcsIGZ1bmN0aW9uIChkYXRhKSB7IHJldHVybiBfdGhpcy5xdWV1ZUxpbmtpZmljYXRpb24oZGF0YS5zdGFydCwgZGF0YS5lbmQpOyB9KTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKHBhcmVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIHZhciBkaXY7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50IHx8IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rlcm1pbmFsIHJlcXVpcmVzIGEgcGFyZW50IGVsZW1lbnQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250ZXh0ID0gdGhpcy5wYXJlbnQub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztcbiAgICAgICAgdGhpcy5kb2N1bWVudCA9IHRoaXMucGFyZW50Lm93bmVyRG9jdW1lbnQ7XG4gICAgICAgIHRoaXMuYm9keSA9IHRoaXMuZG9jdW1lbnQuYm9keTtcbiAgICAgICAgQ2hhckF0bGFzXzEuaW5pdGlhbGl6ZSh0aGlzLmRvY3VtZW50KTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gdGhpcy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3Rlcm1pbmFsJyk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCd4dGVybScpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XG4gICAgICAgIHRoaXMucGFyZW50LmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgdGhpcy52aWV3cG9ydEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy52aWV3cG9ydEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgneHRlcm0tdmlld3BvcnQnKTtcbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGhpcy52aWV3cG9ydEVsZW1lbnQpO1xuICAgICAgICB0aGlzLnZpZXdwb3J0U2Nyb2xsQXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLnZpZXdwb3J0U2Nyb2xsQXJlYS5jbGFzc0xpc3QuYWRkKCd4dGVybS1zY3JvbGwtYXJlYScpO1xuICAgICAgICB0aGlzLnZpZXdwb3J0RWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLnZpZXdwb3J0U2Nyb2xsQXJlYSk7XG4gICAgICAgIHRoaXMuX21vdXNlWm9uZU1hbmFnZXIgPSBuZXcgTW91c2Vab25lTWFuYWdlcl8xLk1vdXNlWm9uZU1hbmFnZXIodGhpcyk7XG4gICAgICAgIHRoaXMub24oJ3Njcm9sbCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9tb3VzZVpvbmVNYW5hZ2VyLmNsZWFyQWxsKCk7IH0pO1xuICAgICAgICB0aGlzLmxpbmtpZmllci5hdHRhY2hUb0RvbSh0aGlzLl9tb3VzZVpvbmVNYW5hZ2VyKTtcbiAgICAgICAgdGhpcy5oZWxwZXJDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5oZWxwZXJDb250YWluZXIuY2xhc3NMaXN0LmFkZCgneHRlcm0taGVscGVycycpO1xuICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0aGlzLmhlbHBlckNvbnRhaW5lcik7XG4gICAgICAgIHRoaXMudGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgICAgICB0aGlzLnRleHRhcmVhLmNsYXNzTGlzdC5hZGQoJ3h0ZXJtLWhlbHBlci10ZXh0YXJlYScpO1xuICAgICAgICB0aGlzLnRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnLCAnb2ZmJyk7XG4gICAgICAgIHRoaXMudGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhdXRvY2FwaXRhbGl6ZScsICdvZmYnKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ3NwZWxsY2hlY2snLCAnZmFsc2UnKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYS50YWJJbmRleCA9IDA7XG4gICAgICAgIHRoaXMudGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fb25UZXh0QXJlYUZvY3VzKCk7IH0pO1xuICAgICAgICB0aGlzLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fb25UZXh0QXJlYUJsdXIoKTsgfSk7XG4gICAgICAgIHRoaXMuaGVscGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMudGV4dGFyZWEpO1xuICAgICAgICB0aGlzLmNvbXBvc2l0aW9uVmlldyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmNvbXBvc2l0aW9uVmlldy5jbGFzc0xpc3QuYWRkKCdjb21wb3NpdGlvbi12aWV3Jyk7XG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25IZWxwZXIgPSBuZXcgQ29tcG9zaXRpb25IZWxwZXJfMS5Db21wb3NpdGlvbkhlbHBlcih0aGlzLnRleHRhcmVhLCB0aGlzLmNvbXBvc2l0aW9uVmlldywgdGhpcyk7XG4gICAgICAgIHRoaXMuaGVscGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY29tcG9zaXRpb25WaWV3KTtcbiAgICAgICAgdGhpcy5jaGFyU2l6ZVN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgIHRoaXMuaGVscGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY2hhclNpemVTdHlsZUVsZW1lbnQpO1xuICAgICAgICB0aGlzLmNoYXJNZWFzdXJlID0gbmV3IENoYXJNZWFzdXJlXzEuQ2hhck1lYXN1cmUoZG9jdW1lbnQsIHRoaXMuaGVscGVyQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5zeW5jQmVsbFNvdW5kKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgUmVuZGVyZXJfMS5SZW5kZXJlcih0aGlzLCB0aGlzLm9wdGlvbnMudGhlbWUpO1xuICAgICAgICB0aGlzLm9wdGlvbnMudGhlbWUgPSBudWxsO1xuICAgICAgICB0aGlzLnZpZXdwb3J0ID0gbmV3IFZpZXdwb3J0XzEuVmlld3BvcnQodGhpcywgdGhpcy52aWV3cG9ydEVsZW1lbnQsIHRoaXMudmlld3BvcnRTY3JvbGxBcmVhLCB0aGlzLmNoYXJNZWFzdXJlKTtcbiAgICAgICAgdGhpcy52aWV3cG9ydC5vblRoZW1lQ2hhbmdlZCh0aGlzLnJlbmRlcmVyLmNvbG9yTWFuYWdlci5jb2xvcnMpO1xuICAgICAgICB0aGlzLm9uKCdjdXJzb3Jtb3ZlJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucmVuZGVyZXIub25DdXJzb3JNb3ZlKCk7IH0pO1xuICAgICAgICB0aGlzLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5yZW5kZXJlci5vblJlc2l6ZShfdGhpcy5jb2xzLCBfdGhpcy5yb3dzLCBmYWxzZSk7IH0pO1xuICAgICAgICB0aGlzLm9uKCdibHVyJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucmVuZGVyZXIub25CbHVyKCk7IH0pO1xuICAgICAgICB0aGlzLm9uKCdmb2N1cycsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJlbmRlcmVyLm9uRm9jdXMoKTsgfSk7XG4gICAgICAgIHRoaXMuY2hhck1lYXN1cmUub24oJ2NoYXJzaXplY2hhbmdlZCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJlbmRlcmVyLm9uUmVzaXplKF90aGlzLmNvbHMsIF90aGlzLnJvd3MsIHRydWUpOyB9KTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5vbigncmVzaXplJywgZnVuY3Rpb24gKGRpbWVuc2lvbnMpIHsgcmV0dXJuIF90aGlzLnZpZXdwb3J0LnN5bmNTY3JvbGxBcmVhKCk7IH0pO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbk1hbmFnZXIgPSBuZXcgU2VsZWN0aW9uTWFuYWdlcl8xLlNlbGVjdGlvbk1hbmFnZXIodGhpcywgdGhpcy5idWZmZXIsIHRoaXMuY2hhck1lYXN1cmUpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLnNlbGVjdGlvbk1hbmFnZXIub25Nb3VzZURvd24oZSk7IH0pO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbk1hbmFnZXIub24oJ3JlZnJlc2gnLCBmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gX3RoaXMucmVuZGVyZXIub25TZWxlY3Rpb25DaGFuZ2VkKGRhdGEuc3RhcnQsIGRhdGEuZW5kKTsgfSk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uTWFuYWdlci5vbignbmV3c2VsZWN0aW9uJywgZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgICAgICAgIF90aGlzLnRleHRhcmVhLnZhbHVlID0gdGV4dDtcbiAgICAgICAgICAgIF90aGlzLnRleHRhcmVhLmZvY3VzKCk7XG4gICAgICAgICAgICBfdGhpcy50ZXh0YXJlYS5zZWxlY3QoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub24oJ3Njcm9sbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnZpZXdwb3J0LnN5bmNTY3JvbGxBcmVhKCk7XG4gICAgICAgICAgICBfdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLnJlZnJlc2goKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudmlld3BvcnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNlbGVjdGlvbk1hbmFnZXIucmVmcmVzaCgpOyB9KTtcbiAgICAgICAgdGhpcy5tb3VzZUhlbHBlciA9IG5ldyBNb3VzZUhlbHBlcl8xLk1vdXNlSGVscGVyKHRoaXMucmVuZGVyZXIpO1xuICAgICAgICB0aGlzLmNoYXJNZWFzdXJlLm1lYXN1cmUodGhpcy5vcHRpb25zKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoKDAsIHRoaXMucm93cyAtIDEpO1xuICAgICAgICB0aGlzLmluaXRHbG9iYWwoKTtcbiAgICAgICAgdGhpcy5iaW5kTW91c2UoKTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5fc2V0VGhlbWUgPSBmdW5jdGlvbiAodGhlbWUpIHtcbiAgICAgICAgdmFyIGNvbG9ycyA9IHRoaXMucmVuZGVyZXIuc2V0VGhlbWUodGhlbWUpO1xuICAgICAgICBpZiAodGhpcy52aWV3cG9ydCkge1xuICAgICAgICAgICAgdGhpcy52aWV3cG9ydC5vblRoZW1lQ2hhbmdlZChjb2xvcnMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXJtaW5hbC5hcHBseUFkZG9uID0gZnVuY3Rpb24gKGFkZG9uKSB7XG4gICAgICAgIGFkZG9uLmFwcGx5KFRlcm1pbmFsKTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5iaW5kTW91c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBlbCA9IHRoaXMuZWxlbWVudDtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgcHJlc3NlZCA9IDMyO1xuICAgICAgICBmdW5jdGlvbiBzZW5kQnV0dG9uKGV2KSB7XG4gICAgICAgICAgICB2YXIgYnV0dG9uO1xuICAgICAgICAgICAgdmFyIHBvcztcbiAgICAgICAgICAgIGJ1dHRvbiA9IGdldEJ1dHRvbihldik7XG4gICAgICAgICAgICBwb3MgPSBzZWxmLm1vdXNlSGVscGVyLmdldFJhd0J5dGVDb29yZHMoZXYsIHNlbGYuZWxlbWVudCwgc2VsZi5jaGFyTWVhc3VyZSwgc2VsZi5vcHRpb25zLmxpbmVIZWlnaHQsIHNlbGYuY29scywgc2VsZi5yb3dzKTtcbiAgICAgICAgICAgIGlmICghcG9zKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIHNlbmRFdmVudChidXR0b24sIHBvcyk7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2Lm92ZXJyaWRlVHlwZSB8fCBldi50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2Vkb3duJzpcbiAgICAgICAgICAgICAgICAgICAgcHJlc3NlZCA9IGJ1dHRvbjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2V1cCc6XG4gICAgICAgICAgICAgICAgICAgIHByZXNzZWQgPSAzMjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnd2hlZWwnOlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZW5kTW92ZShldikge1xuICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IHByZXNzZWQ7XG4gICAgICAgICAgICB2YXIgcG9zID0gc2VsZi5tb3VzZUhlbHBlci5nZXRSYXdCeXRlQ29vcmRzKGV2LCBzZWxmLmVsZW1lbnQsIHNlbGYuY2hhck1lYXN1cmUsIHNlbGYub3B0aW9ucy5saW5lSGVpZ2h0LCBzZWxmLmNvbHMsIHNlbGYucm93cyk7XG4gICAgICAgICAgICBpZiAoIXBvcylcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBidXR0b24gKz0gMzI7XG4gICAgICAgICAgICBzZW5kRXZlbnQoYnV0dG9uLCBwb3MpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGVuY29kZShkYXRhLCBjaCkge1xuICAgICAgICAgICAgaWYgKCFzZWxmLnV0Zk1vdXNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoID09PSAyNTUpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKDApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjaCA+IDEyNylcbiAgICAgICAgICAgICAgICAgICAgY2ggPSAxMjc7XG4gICAgICAgICAgICAgICAgZGF0YS5wdXNoKGNoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjaCA9PT0gMjA0Nykge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goMCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNoIDwgMTI3KSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaChjaCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPiAyMDQ3KVxuICAgICAgICAgICAgICAgICAgICAgICAgY2ggPSAyMDQ3O1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goMHhDMCB8IChjaCA+PiA2KSk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaCgweDgwIHwgKGNoICYgMHgzRikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZW5kRXZlbnQoYnV0dG9uLCBwb3MpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLnZ0MzAwTW91c2UpIHtcbiAgICAgICAgICAgICAgICBidXR0b24gJj0gMztcbiAgICAgICAgICAgICAgICBwb3MueCAtPSAzMjtcbiAgICAgICAgICAgICAgICBwb3MueSAtPSAzMjtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YV8xID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1syNCc7XG4gICAgICAgICAgICAgICAgaWYgKGJ1dHRvbiA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgZGF0YV8xICs9ICcxJztcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChidXR0b24gPT09IDEpXG4gICAgICAgICAgICAgICAgICAgIGRhdGFfMSArPSAnMyc7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYnV0dG9uID09PSAyKVxuICAgICAgICAgICAgICAgICAgICBkYXRhXzEgKz0gJzUnO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJ1dHRvbiA9PT0gMylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgZGF0YV8xICs9ICcwJztcbiAgICAgICAgICAgICAgICBkYXRhXzEgKz0gJ35bJyArIHBvcy54ICsgJywnICsgcG9zLnkgKyAnXVxccic7XG4gICAgICAgICAgICAgICAgc2VsZi5zZW5kKGRhdGFfMSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuZGVjTG9jYXRvcikge1xuICAgICAgICAgICAgICAgIGJ1dHRvbiAmPSAzO1xuICAgICAgICAgICAgICAgIHBvcy54IC09IDMyO1xuICAgICAgICAgICAgICAgIHBvcy55IC09IDMyO1xuICAgICAgICAgICAgICAgIGlmIChidXR0b24gPT09IDApXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbiA9IDI7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYnV0dG9uID09PSAxKVxuICAgICAgICAgICAgICAgICAgICBidXR0b24gPSA0O1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJ1dHRvbiA9PT0gMilcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uID0gNjtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChidXR0b24gPT09IDMpXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbiA9IDM7XG4gICAgICAgICAgICAgICAgc2VsZi5zZW5kKEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbJ1xuICAgICAgICAgICAgICAgICAgICArIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICArICc7J1xuICAgICAgICAgICAgICAgICAgICArIChidXR0b24gPT09IDMgPyA0IDogMClcbiAgICAgICAgICAgICAgICAgICAgKyAnOydcbiAgICAgICAgICAgICAgICAgICAgKyBwb3MueVxuICAgICAgICAgICAgICAgICAgICArICc7J1xuICAgICAgICAgICAgICAgICAgICArIHBvcy54XG4gICAgICAgICAgICAgICAgICAgICsgJzsnXG4gICAgICAgICAgICAgICAgICAgICsgcG9zLnBhZ2UgfHwgMFxuICAgICAgICAgICAgICAgICAgICArICcmdycpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLnVyeHZ0TW91c2UpIHtcbiAgICAgICAgICAgICAgICBwb3MueCAtPSAzMjtcbiAgICAgICAgICAgICAgICBwb3MueSAtPSAzMjtcbiAgICAgICAgICAgICAgICBwb3MueCsrO1xuICAgICAgICAgICAgICAgIHBvcy55Kys7XG4gICAgICAgICAgICAgICAgc2VsZi5zZW5kKEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbJyArIGJ1dHRvbiArICc7JyArIHBvcy54ICsgJzsnICsgcG9zLnkgKyAnTScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLnNnck1vdXNlKSB7XG4gICAgICAgICAgICAgICAgcG9zLnggLT0gMzI7XG4gICAgICAgICAgICAgICAgcG9zLnkgLT0gMzI7XG4gICAgICAgICAgICAgICAgc2VsZi5zZW5kKEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbPCdcbiAgICAgICAgICAgICAgICAgICAgKyAoKChidXR0b24gJiAzKSA9PT0gMyA/IGJ1dHRvbiAmIH4zIDogYnV0dG9uKSAtIDMyKVxuICAgICAgICAgICAgICAgICAgICArICc7J1xuICAgICAgICAgICAgICAgICAgICArIHBvcy54XG4gICAgICAgICAgICAgICAgICAgICsgJzsnXG4gICAgICAgICAgICAgICAgICAgICsgcG9zLnlcbiAgICAgICAgICAgICAgICAgICAgKyAoKGJ1dHRvbiAmIDMpID09PSAzID8gJ20nIDogJ00nKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRhdGEgPSBbXTtcbiAgICAgICAgICAgIGVuY29kZShkYXRhLCBidXR0b24pO1xuICAgICAgICAgICAgZW5jb2RlKGRhdGEsIHBvcy54KTtcbiAgICAgICAgICAgIGVuY29kZShkYXRhLCBwb3MueSk7XG4gICAgICAgICAgICBzZWxmLnNlbmQoRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1tNJyArIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLCBkYXRhKSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QnV0dG9uKGV2KSB7XG4gICAgICAgICAgICB2YXIgYnV0dG9uO1xuICAgICAgICAgICAgdmFyIHNoaWZ0O1xuICAgICAgICAgICAgdmFyIG1ldGE7XG4gICAgICAgICAgICB2YXIgY3RybDtcbiAgICAgICAgICAgIHZhciBtb2Q7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2Lm92ZXJyaWRlVHlwZSB8fCBldi50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2Vkb3duJzpcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uID0gZXYuYnV0dG9uICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgID8gK2V2LmJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgOiBldi53aGljaCAhPSBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBldi53aGljaCAtIDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChCcm93c2VyLmlzTVNJRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uID0gYnV0dG9uID09PSAxID8gMCA6IGJ1dHRvbiA9PT0gNCA/IDEgOiBidXR0b247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2V1cCc6XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbiA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RPTU1vdXNlU2Nyb2xsJzpcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uID0gZXYuZGV0YWlsIDwgMFxuICAgICAgICAgICAgICAgICAgICAgICAgPyA2NFxuICAgICAgICAgICAgICAgICAgICAgICAgOiA2NTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnd2hlZWwnOlxuICAgICAgICAgICAgICAgICAgICBidXR0b24gPSBldi53aGVlbERlbHRhWSA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gNjRcbiAgICAgICAgICAgICAgICAgICAgICAgIDogNjU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2hpZnQgPSBldi5zaGlmdEtleSA/IDQgOiAwO1xuICAgICAgICAgICAgbWV0YSA9IGV2Lm1ldGFLZXkgPyA4IDogMDtcbiAgICAgICAgICAgIGN0cmwgPSBldi5jdHJsS2V5ID8gMTYgOiAwO1xuICAgICAgICAgICAgbW9kID0gc2hpZnQgfCBtZXRhIHwgY3RybDtcbiAgICAgICAgICAgIGlmIChzZWxmLnZ0MjAwTW91c2UpIHtcbiAgICAgICAgICAgICAgICBtb2QgJj0gY3RybDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFzZWxmLm5vcm1hbE1vdXNlKSB7XG4gICAgICAgICAgICAgICAgbW9kID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJ1dHRvbiA9ICgzMiArIChtb2QgPDwgMikpICsgYnV0dG9uO1xuICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbjtcbiAgICAgICAgfVxuICAgICAgICBvbihlbCwgJ21vdXNlZG93bicsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIF90aGlzLmZvY3VzKCk7XG4gICAgICAgICAgICBpZiAoIV90aGlzLm1vdXNlRXZlbnRzIHx8IF90aGlzLnNlbGVjdGlvbk1hbmFnZXIuc2hvdWxkRm9yY2VTZWxlY3Rpb24oZXYpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VuZEJ1dHRvbihldik7XG4gICAgICAgICAgICBpZiAoX3RoaXMudnQyMDBNb3VzZSkge1xuICAgICAgICAgICAgICAgIGV2Lm92ZXJyaWRlVHlwZSA9ICdtb3VzZXVwJztcbiAgICAgICAgICAgICAgICBzZW5kQnV0dG9uKGV2KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY2FuY2VsKGV2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5ub3JtYWxNb3VzZSlcbiAgICAgICAgICAgICAgICBvbihfdGhpcy5kb2N1bWVudCwgJ21vdXNlbW92ZScsIHNlbmRNb3ZlKTtcbiAgICAgICAgICAgIGlmICghX3RoaXMueDEwTW91c2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlcl8xID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbmRCdXR0b24oZXYpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMubm9ybWFsTW91c2UpXG4gICAgICAgICAgICAgICAgICAgICAgICBvZmYoX3RoaXMuZG9jdW1lbnQsICdtb3VzZW1vdmUnLCBzZW5kTW92ZSk7XG4gICAgICAgICAgICAgICAgICAgIG9mZihfdGhpcy5kb2N1bWVudCwgJ21vdXNldXAnLCBoYW5kbGVyXzEpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY2FuY2VsKGV2KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIG9uKF90aGlzLmRvY3VtZW50LCAnbW91c2V1cCcsIGhhbmRsZXJfMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY2FuY2VsKGV2KTtcbiAgICAgICAgfSk7XG4gICAgICAgIG9uKGVsLCAnd2hlZWwnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIGlmICghX3RoaXMubW91c2VFdmVudHMpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKF90aGlzLngxME1vdXNlIHx8IF90aGlzLnZ0MzAwTW91c2UgfHwgX3RoaXMuZGVjTG9jYXRvcilcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBzZW5kQnV0dG9uKGV2KTtcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICBvbihlbCwgJ3doZWVsJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMubW91c2VFdmVudHMpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgX3RoaXMudmlld3BvcnQub25XaGVlbChldik7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY2FuY2VsKGV2KTtcbiAgICAgICAgfSk7XG4gICAgICAgIG9uKGVsLCAndG91Y2hzdGFydCcsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgaWYgKF90aGlzLm1vdXNlRXZlbnRzKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIF90aGlzLnZpZXdwb3J0Lm9uVG91Y2hTdGFydChldik7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY2FuY2VsKGV2KTtcbiAgICAgICAgfSk7XG4gICAgICAgIG9uKGVsLCAndG91Y2htb3ZlJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMubW91c2VFdmVudHMpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgX3RoaXMudmlld3BvcnQub25Ub3VjaE1vdmUoZXYpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNhbmNlbChldik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnJlYWRhYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICB0aGlzLndyaXRlID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50ICYmIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgICAgIGlmICh0aGlzLnJlbmRlcmVyKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnF1ZXVlUmVmcmVzaChzdGFydCwgZW5kKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnF1ZXVlTGlua2lmaWNhdGlvbiA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgICAgIGlmICh0aGlzLmxpbmtpZmllcikge1xuICAgICAgICAgICAgdGhpcy5saW5raWZpZXIubGlua2lmeVJvd3Moc3RhcnQsIGVuZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5zaG93Q3Vyc29yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuY3Vyc29yU3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yU3RhdGUgPSAxO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKHRoaXMuYnVmZmVyLnksIHRoaXMuYnVmZmVyLnkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuc2Nyb2xsID0gZnVuY3Rpb24gKGlzV3JhcHBlZCkge1xuICAgICAgICB2YXIgbmV3TGluZSA9IHRoaXMuYmxhbmtMaW5lKHVuZGVmaW5lZCwgaXNXcmFwcGVkKTtcbiAgICAgICAgdmFyIHRvcFJvdyA9IHRoaXMuYnVmZmVyLnliYXNlICsgdGhpcy5idWZmZXIuc2Nyb2xsVG9wO1xuICAgICAgICB2YXIgYm90dG9tUm93ID0gdGhpcy5idWZmZXIueWJhc2UgKyB0aGlzLmJ1ZmZlci5zY3JvbGxCb3R0b207XG4gICAgICAgIGlmICh0aGlzLmJ1ZmZlci5zY3JvbGxUb3AgPT09IDApIHtcbiAgICAgICAgICAgIHZhciB3aWxsQnVmZmVyQmVUcmltbWVkID0gdGhpcy5idWZmZXIubGluZXMubGVuZ3RoID09PSB0aGlzLmJ1ZmZlci5saW5lcy5tYXhMZW5ndGg7XG4gICAgICAgICAgICBpZiAoYm90dG9tUm93ID09PSB0aGlzLmJ1ZmZlci5saW5lcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idWZmZXIubGluZXMucHVzaChuZXdMaW5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyLmxpbmVzLnNwbGljZShib3R0b21Sb3cgKyAxLCAwLCBuZXdMaW5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghd2lsbEJ1ZmZlckJlVHJpbW1lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyLnliYXNlKys7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVzZXJTY3JvbGxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idWZmZXIueWRpc3ArKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy51c2VyU2Nyb2xsaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyLnlkaXNwID0gTWF0aC5tYXgodGhpcy5idWZmZXIueWRpc3AgLSAxLCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgc2Nyb2xsUmVnaW9uSGVpZ2h0ID0gYm90dG9tUm93IC0gdG9wUm93ICsgMTtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyLmxpbmVzLnNoaWZ0RWxlbWVudHModG9wUm93ICsgMSwgc2Nyb2xsUmVnaW9uSGVpZ2h0IC0gMSwgLTEpO1xuICAgICAgICAgICAgdGhpcy5idWZmZXIubGluZXMuc2V0KGJvdHRvbVJvdywgbmV3TGluZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnVzZXJTY3JvbGxpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyLnlkaXNwID0gdGhpcy5idWZmZXIueWJhc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVSYW5nZSh0aGlzLmJ1ZmZlci5zY3JvbGxUb3ApO1xuICAgICAgICB0aGlzLnVwZGF0ZVJhbmdlKHRoaXMuYnVmZmVyLnNjcm9sbEJvdHRvbSk7XG4gICAgICAgIHRoaXMuZW1pdCgnc2Nyb2xsJywgdGhpcy5idWZmZXIueWRpc3ApO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnNjcm9sbExpbmVzID0gZnVuY3Rpb24gKGRpc3AsIHN1cHByZXNzU2Nyb2xsRXZlbnQpIHtcbiAgICAgICAgaWYgKGRpc3AgPCAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5idWZmZXIueWRpc3AgPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVzZXJTY3JvbGxpbmcgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRpc3AgKyB0aGlzLmJ1ZmZlci55ZGlzcCA+PSB0aGlzLmJ1ZmZlci55YmFzZSkge1xuICAgICAgICAgICAgdGhpcy51c2VyU2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9sZFlkaXNwID0gdGhpcy5idWZmZXIueWRpc3A7XG4gICAgICAgIHRoaXMuYnVmZmVyLnlkaXNwID0gTWF0aC5tYXgoTWF0aC5taW4odGhpcy5idWZmZXIueWRpc3AgKyBkaXNwLCB0aGlzLmJ1ZmZlci55YmFzZSksIDApO1xuICAgICAgICBpZiAob2xkWWRpc3AgPT09IHRoaXMuYnVmZmVyLnlkaXNwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdXBwcmVzc1Njcm9sbEV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ3Njcm9sbCcsIHRoaXMuYnVmZmVyLnlkaXNwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2goMCwgdGhpcy5yb3dzIC0gMSk7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuc2Nyb2xsUGFnZXMgPSBmdW5jdGlvbiAocGFnZUNvdW50KSB7XG4gICAgICAgIHRoaXMuc2Nyb2xsTGluZXMocGFnZUNvdW50ICogKHRoaXMucm93cyAtIDEpKTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5zY3JvbGxUb1RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxMaW5lcygtdGhpcy5idWZmZXIueWRpc3ApO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnNjcm9sbFRvQm90dG9tID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNjcm9sbExpbmVzKHRoaXMuYnVmZmVyLnliYXNlIC0gdGhpcy5idWZmZXIueWRpc3ApO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5wdXNoKGRhdGEpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnVzZUZsb3dDb250cm9sICYmICF0aGlzLnhvZmZTZW50VG9DYXRjaFVwICYmIHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoID49IFdSSVRFX0JVRkZFUl9QQVVTRV9USFJFU0hPTEQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VuZChFc2NhcGVTZXF1ZW5jZXNfMS5DMC5EQzMpO1xuICAgICAgICAgICAgdGhpcy54b2ZmU2VudFRvQ2F0Y2hVcCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLndyaXRlSW5Qcm9ncmVzcyAmJiB0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMud3JpdGVJblByb2dyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmlubmVyV3JpdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuaW5uZXJXcml0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHdyaXRlQmF0Y2ggPSB0aGlzLndyaXRlQnVmZmVyLnNwbGljZSgwLCBXUklURV9CQVRDSF9TSVpFKTtcbiAgICAgICAgd2hpbGUgKHdyaXRlQmF0Y2gubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB3cml0ZUJhdGNoLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy54b2ZmU2VudFRvQ2F0Y2hVcCAmJiB3cml0ZUJhdGNoLmxlbmd0aCA9PT0gMCAmJiB0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VuZChFc2NhcGVTZXF1ZW5jZXNfMS5DMC5EQzEpO1xuICAgICAgICAgICAgICAgIHRoaXMueG9mZlNlbnRUb0NhdGNoVXAgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFN0YXJ0ID0gdGhpcy5idWZmZXIueTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEVuZCA9IHRoaXMuYnVmZmVyLnk7XG4gICAgICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLnBhcnNlci5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgIHRoaXMucGFyc2VyLnNldFN0YXRlKHN0YXRlKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmFuZ2UodGhpcy5idWZmZXIueSk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2godGhpcy5yZWZyZXNoU3RhcnQsIHRoaXMucmVmcmVzaEVuZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5pbm5lcldyaXRlKCk7IH0sIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy53cml0ZUluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLndyaXRlbG4gPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLndyaXRlKGRhdGEgKyAnXFxyXFxuJyk7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuYXR0YWNoQ3VzdG9tS2V5RXZlbnRIYW5kbGVyID0gZnVuY3Rpb24gKGN1c3RvbUtleUV2ZW50SGFuZGxlcikge1xuICAgICAgICB0aGlzLmN1c3RvbUtleUV2ZW50SGFuZGxlciA9IGN1c3RvbUtleUV2ZW50SGFuZGxlcjtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5zZXRIeXBlcnRleHRMaW5rSGFuZGxlciA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7XG4gICAgICAgIGlmICghdGhpcy5saW5raWZpZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGF0dGFjaCBhIGh5cGVydGV4dCBsaW5rIGhhbmRsZXIgYmVmb3JlIFRlcm1pbmFsLm9wZW4gaXMgY2FsbGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5saW5raWZpZXIuc2V0SHlwZXJ0ZXh0TGlua0hhbmRsZXIoaGFuZGxlcik7XG4gICAgICAgIHRoaXMucmVmcmVzaCgwLCB0aGlzLnJvd3MgLSAxKTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5zZXRIeXBlcnRleHRWYWxpZGF0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKCF0aGlzLmxpbmtpZmllcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgYXR0YWNoIGEgaHlwZXJ0ZXh0IHZhbGlkYXRpb24gY2FsbGJhY2sgYmVmb3JlIFRlcm1pbmFsLm9wZW4gaXMgY2FsbGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5saW5raWZpZXIuc2V0SHlwZXJ0ZXh0VmFsaWRhdGlvbkNhbGxiYWNrKGNhbGxiYWNrKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoKDAsIHRoaXMucm93cyAtIDEpO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnJlZ2lzdGVyTGlua01hdGNoZXIgPSBmdW5jdGlvbiAocmVnZXgsIGhhbmRsZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHRoaXMubGlua2lmaWVyKSB7XG4gICAgICAgICAgICB2YXIgbWF0Y2hlcklkID0gdGhpcy5saW5raWZpZXIucmVnaXN0ZXJMaW5rTWF0Y2hlcihyZWdleCwgaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goMCwgdGhpcy5yb3dzIC0gMSk7XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlcklkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmRlcmVnaXN0ZXJMaW5rTWF0Y2hlciA9IGZ1bmN0aW9uIChtYXRjaGVySWQpIHtcbiAgICAgICAgaWYgKHRoaXMubGlua2lmaWVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saW5raWZpZXIuZGVyZWdpc3RlckxpbmtNYXRjaGVyKG1hdGNoZXJJZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goMCwgdGhpcy5yb3dzIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5oYXNTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbk1hbmFnZXIgPyB0aGlzLnNlbGVjdGlvbk1hbmFnZXIuaGFzU2VsZWN0aW9uIDogZmFsc2U7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuZ2V0U2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25NYW5hZ2VyID8gdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLnNlbGVjdGlvblRleHQgOiAnJztcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5jbGVhclNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uTWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5zZWxlY3RBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uTWFuYWdlci5zZWxlY3RBbGwoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLl9rZXlEb3duID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIGlmICh0aGlzLmN1c3RvbUtleUV2ZW50SGFuZGxlciAmJiB0aGlzLmN1c3RvbUtleUV2ZW50SGFuZGxlcihldikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmNvbXBvc2l0aW9uSGVscGVyLmtleWRvd24oZXYpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5idWZmZXIueWJhc2UgIT09IHRoaXMuYnVmZmVyLnlkaXNwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUb0JvdHRvbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9ldmFsdWF0ZUtleUVzY2FwZVNlcXVlbmNlKGV2KTtcbiAgICAgICAgaWYgKHJlc3VsdC5rZXkgPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkRDMykge1xuICAgICAgICAgICAgdGhpcy53cml0ZVN0b3BwZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlc3VsdC5rZXkgPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkRDMSkge1xuICAgICAgICAgICAgdGhpcy53cml0ZVN0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0LnNjcm9sbExpbmVzKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbExpbmVzKHJlc3VsdC5zY3JvbGxMaW5lcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW5jZWwoZXYsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1RoaXJkTGV2ZWxTaGlmdCh0aGlzLmJyb3dzZXIsIGV2KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdC5jYW5jZWwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FuY2VsKGV2LCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlc3VsdC5rZXkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW1pdCgna2V5ZG93bicsIGV2KTtcbiAgICAgICAgdGhpcy5lbWl0KCdrZXknLCByZXN1bHQua2V5LCBldik7XG4gICAgICAgIHRoaXMuc2hvd0N1cnNvcigpO1xuICAgICAgICB0aGlzLmhhbmRsZXIocmVzdWx0LmtleSk7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbmNlbChldiwgdHJ1ZSk7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuX2V2YWx1YXRlS2V5RXNjYXBlU2VxdWVuY2UgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgICAgICBrZXk6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHNjcm9sbExpbmVzOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG1vZGlmaWVycyA9IChldi5zaGlmdEtleSA/IDEgOiAwKSB8IChldi5hbHRLZXkgPyAyIDogMCkgfCAoZXYuY3RybEtleSA/IDQgOiAwKSB8IChldi5tZXRhS2V5ID8gOCA6IDApO1xuICAgICAgICBzd2l0Y2ggKGV2LmtleUNvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBpZiAoZXYua2V5ID09PSAnVUlLZXlJbnB1dFVwQXJyb3cnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFwcGxpY2F0aW9uQ3Vyc29yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ09BJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnW0EnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2LmtleSA9PT0gJ1VJS2V5SW5wdXRMZWZ0QXJyb3cnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFwcGxpY2F0aW9uQ3Vyc29yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ09EJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnW0QnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2LmtleSA9PT0gJ1VJS2V5SW5wdXRSaWdodEFycm93Jykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hcHBsaWNhdGlvbkN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdPQyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1tDJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChldi5rZXkgPT09ICdVSUtleUlucHV0RG93bkFycm93Jykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hcHBsaWNhdGlvbkN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdPQic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1tCJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICBpZiAoZXYuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkJTO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXYuYWx0S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5ERUw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuREVMO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIGlmIChldi5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1taJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5IVDtcbiAgICAgICAgICAgICAgICByZXN1bHQuY2FuY2VsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkNSO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5jYW5jZWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5jYW5jZWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgICAgICBpZiAobW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE7JyArIChtb2RpZmllcnMgKyAxKSArICdEJztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5rZXkgPT09IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTszRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSAodGhpcy5icm93c2VyLmlzTWFjKSA/IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdiJyA6IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTs1RCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5hcHBsaWNhdGlvbkN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ09EJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnW0QnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxOycgKyAobW9kaWZpZXJzICsgMSkgKyAnQyc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQua2V5ID09PSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE7M0MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gKHRoaXMuYnJvd3Nlci5pc01hYykgPyBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnZicgOiBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE7NUMnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuYXBwbGljYXRpb25DdXJzb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdPQyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1tDJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTsnICsgKG1vZGlmaWVycyArIDEpICsgJ0EnO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmtleSA9PT0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxOzNBJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTs1QSc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5hcHBsaWNhdGlvbkN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ09BJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnW0EnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxOycgKyAobW9kaWZpZXJzICsgMSkgKyAnQic7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQua2V5ID09PSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE7M0InKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxOzVCJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmFwcGxpY2F0aW9uQ3Vyc29yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnT0InO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbQic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0NTpcbiAgICAgICAgICAgICAgICBpZiAoIWV2LnNoaWZ0S2V5ICYmICFldi5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzJ+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDQ2OlxuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMzsnICsgKG1vZGlmaWVycyArIDEpICsgJ34nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbM34nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzY6XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVycylcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTsnICsgKG1vZGlmaWVycyArIDEpICsgJ0gnO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuYXBwbGljYXRpb25DdXJzb3IpXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnT0gnO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbSCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM1OlxuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnMpXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE7JyArIChtb2RpZmllcnMgKyAxKSArICdGJztcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmFwcGxpY2F0aW9uQ3Vyc29yKVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ09GJztcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnW0YnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzMzpcbiAgICAgICAgICAgICAgICBpZiAoZXYuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNjcm9sbExpbmVzID0gLSh0aGlzLnJvd3MgLSAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzV+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM0OlxuICAgICAgICAgICAgICAgIGlmIChldi5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuc2Nyb2xsTGluZXMgPSB0aGlzLnJvd3MgLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbNn4nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTEyOlxuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTsnICsgKG1vZGlmaWVycyArIDEpICsgJ1AnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdPUCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxMTM6XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxOycgKyAobW9kaWZpZXJzICsgMSkgKyAnUSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ09RJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExNDpcbiAgICAgICAgICAgICAgICBpZiAobW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE7JyArIChtb2RpZmllcnMgKyAxKSArICdSJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnT1InO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTE1OlxuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTsnICsgKG1vZGlmaWVycyArIDEpICsgJ1MnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdPUyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxMTY6XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxNTsnICsgKG1vZGlmaWVycyArIDEpICsgJ34nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTV+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExNzpcbiAgICAgICAgICAgICAgICBpZiAobW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE3OycgKyAobW9kaWZpZXJzICsgMSkgKyAnfic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxN34nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTE4OlxuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTg7JyArIChtb2RpZmllcnMgKyAxKSArICd+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzE4fic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxMTk6XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1sxOTsnICsgKG1vZGlmaWVycyArIDEpICsgJ34nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMTl+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDEyMDpcbiAgICAgICAgICAgICAgICBpZiAobW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzIwOycgKyAobW9kaWZpZXJzICsgMSkgKyAnfic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1syMH4nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTIxOlxuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMjE7JyArIChtb2RpZmllcnMgKyAxKSArICd+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzIxfic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxMjI6XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1syMzsnICsgKG1vZGlmaWVycyArIDEpICsgJ34nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArICdbMjN+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDEyMzpcbiAgICAgICAgICAgICAgICBpZiAobW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnWzI0OycgKyAobW9kaWZpZXJzICsgMSkgKyAnfic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgJ1syNH4nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgaWYgKGV2LmN0cmxLZXkgJiYgIWV2LnNoaWZ0S2V5ICYmICFldi5hbHRLZXkgJiYgIWV2Lm1ldGFLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2LmtleUNvZGUgPj0gNjUgJiYgZXYua2V5Q29kZSA8PSA5MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZXYua2V5Q29kZSAtIDY0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldi5rZXlDb2RlID09PSAzMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXYua2V5Q29kZSA+PSA1MSAmJiBldi5rZXlDb2RlIDw9IDU1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gU3RyaW5nLmZyb21DaGFyQ29kZShldi5rZXlDb2RlIC0gNTEgKyAyNyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXYua2V5Q29kZSA9PT0gNTYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXYua2V5Q29kZSA9PT0gMjE5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gU3RyaW5nLmZyb21DaGFyQ29kZSgyNyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXYua2V5Q29kZSA9PT0gMjIwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gU3RyaW5nLmZyb21DaGFyQ29kZSgyOCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXYua2V5Q29kZSA9PT0gMjIxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gU3RyaW5nLmZyb21DaGFyQ29kZSgyOSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXRoaXMuYnJvd3Nlci5pc01hYyAmJiBldi5hbHRLZXkgJiYgIWV2LmN0cmxLZXkgJiYgIWV2Lm1ldGFLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2LmtleUNvZGUgPj0gNjUgJiYgZXYua2V5Q29kZSA8PSA5MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmtleSA9IEVzY2FwZVNlcXVlbmNlc18xLkMwLkVTQyArIFN0cmluZy5mcm9tQ2hhckNvZGUoZXYua2V5Q29kZSArIDMyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldi5rZXlDb2RlID09PSAxOTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5rZXkgPSBFc2NhcGVTZXF1ZW5jZXNfMS5DMC5FU0MgKyAnYCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXYua2V5Q29kZSA+PSA0OCAmJiBldi5rZXlDb2RlIDw9IDU3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQua2V5ID0gRXNjYXBlU2VxdWVuY2VzXzEuQzAuRVNDICsgKGV2LmtleUNvZGUgLSA0OCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5icm93c2VyLmlzTWFjICYmICFldi5hbHRLZXkgJiYgIWV2LmN0cmxLZXkgJiYgZXYubWV0YUtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXYua2V5Q29kZSA9PT0gNjUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0QWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5zZXRnTGV2ZWwgPSBmdW5jdGlvbiAoZykge1xuICAgICAgICB0aGlzLmdsZXZlbCA9IGc7XG4gICAgICAgIHRoaXMuY2hhcnNldCA9IHRoaXMuY2hhcnNldHNbZ107XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuc2V0Z0NoYXJzZXQgPSBmdW5jdGlvbiAoZywgY2hhcnNldCkge1xuICAgICAgICB0aGlzLmNoYXJzZXRzW2ddID0gY2hhcnNldDtcbiAgICAgICAgaWYgKHRoaXMuZ2xldmVsID09PSBnKSB7XG4gICAgICAgICAgICB0aGlzLmNoYXJzZXQgPSBjaGFyc2V0O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuX2tleVByZXNzID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIHZhciBrZXk7XG4gICAgICAgIGlmICh0aGlzLmN1c3RvbUtleUV2ZW50SGFuZGxlciAmJiB0aGlzLmN1c3RvbUtleUV2ZW50SGFuZGxlcihldikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jYW5jZWwoZXYpO1xuICAgICAgICBpZiAoZXYuY2hhckNvZGUpIHtcbiAgICAgICAgICAgIGtleSA9IGV2LmNoYXJDb2RlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2LndoaWNoID09IG51bGwpIHtcbiAgICAgICAgICAgIGtleSA9IGV2LmtleUNvZGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXYud2hpY2ggIT09IDAgJiYgZXYuY2hhckNvZGUgIT09IDApIHtcbiAgICAgICAgICAgIGtleSA9IGV2LndoaWNoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICgha2V5IHx8ICgoZXYuYWx0S2V5IHx8IGV2LmN0cmxLZXkgfHwgZXYubWV0YUtleSkgJiYgIWlzVGhpcmRMZXZlbFNoaWZ0KHRoaXMuYnJvd3NlciwgZXYpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGtleSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoa2V5KTtcbiAgICAgICAgdGhpcy5lbWl0KCdrZXlwcmVzcycsIGtleSwgZXYpO1xuICAgICAgICB0aGlzLmVtaXQoJ2tleScsIGtleSwgZXYpO1xuICAgICAgICB0aGlzLnNob3dDdXJzb3IoKTtcbiAgICAgICAgdGhpcy5oYW5kbGVyKGtleSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuc2VuZERhdGFRdWV1ZSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaGFuZGxlcihfdGhpcy5zZW5kRGF0YVF1ZXVlKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZW5kRGF0YVF1ZXVlID0gJyc7XG4gICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbmREYXRhUXVldWUgKz0gZGF0YTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5iZWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmVtaXQoJ2JlbGwnKTtcbiAgICAgICAgaWYgKHRoaXMuc291bmRCZWxsKCkpXG4gICAgICAgICAgICB0aGlzLmJlbGxBdWRpb0VsZW1lbnQucGxheSgpO1xuICAgICAgICBpZiAodGhpcy52aXN1YWxCZWxsKCkpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCd2aXN1YWwtYmVsbC1hY3RpdmUnKTtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnZpc3VhbEJlbGxUaW1lcik7XG4gICAgICAgICAgICB0aGlzLnZpc3VhbEJlbGxUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc3VhbC1iZWxsLWFjdGl2ZScpO1xuICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uICh0ZXh0LCBkYXRhKSB7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmRlYnVnKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoIXRoaXMuY29udGV4dC5jb25zb2xlIHx8ICF0aGlzLmNvbnRleHQuY29uc29sZS5sb2cpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMuY29udGV4dC5jb25zb2xlLmxvZyh0ZXh0LCBkYXRhKTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uICh0ZXh0LCBkYXRhKSB7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmRlYnVnKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoIXRoaXMuY29udGV4dC5jb25zb2xlIHx8ICF0aGlzLmNvbnRleHQuY29uc29sZS5lcnJvcilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5jb250ZXh0LmNvbnNvbGUuZXJyb3IodGV4dCwgZGF0YSk7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgaWYgKGlzTmFOKHgpIHx8IGlzTmFOKHkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHggPT09IHRoaXMuY29scyAmJiB5ID09PSB0aGlzLnJvd3MpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5jaGFyTWVhc3VyZS53aWR0aCB8fCAhdGhpcy5jaGFyTWVhc3VyZS5oZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJNZWFzdXJlLm1lYXN1cmUodGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoeCA8IDEpXG4gICAgICAgICAgICB4ID0gMTtcbiAgICAgICAgaWYgKHkgPCAxKVxuICAgICAgICAgICAgeSA9IDE7XG4gICAgICAgIHRoaXMuYnVmZmVycy5yZXNpemUoeCwgeSk7XG4gICAgICAgIHRoaXMuY29scyA9IHg7XG4gICAgICAgIHRoaXMucm93cyA9IHk7XG4gICAgICAgIHRoaXMuYnVmZmVycy5zZXR1cFRhYlN0b3BzKHRoaXMuY29scyk7XG4gICAgICAgIHRoaXMuY2hhck1lYXN1cmUubWVhc3VyZSh0aGlzLm9wdGlvbnMpO1xuICAgICAgICB0aGlzLnJlZnJlc2goMCwgdGhpcy5yb3dzIC0gMSk7XG4gICAgICAgIHRoaXMuZW1pdCgncmVzaXplJywgeyBjb2xzOiB4LCByb3dzOiB5IH0pO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnVwZGF0ZVJhbmdlID0gZnVuY3Rpb24gKHkpIHtcbiAgICAgICAgaWYgKHkgPCB0aGlzLnJlZnJlc2hTdGFydClcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFN0YXJ0ID0geTtcbiAgICAgICAgaWYgKHkgPiB0aGlzLnJlZnJlc2hFbmQpXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hFbmQgPSB5O1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLm1heFJhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlZnJlc2hTdGFydCA9IDA7XG4gICAgICAgIHRoaXMucmVmcmVzaEVuZCA9IHRoaXMucm93cyAtIDE7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuZXJhc2VSaWdodCA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgIHZhciBsaW5lID0gdGhpcy5idWZmZXIubGluZXMuZ2V0KHRoaXMuYnVmZmVyLnliYXNlICsgeSk7XG4gICAgICAgIGlmICghbGluZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaCA9IFt0aGlzLmVyYXNlQXR0cigpLCAnICcsIDEsIDMyXTtcbiAgICAgICAgZm9yICg7IHggPCB0aGlzLmNvbHM7IHgrKykge1xuICAgICAgICAgICAgbGluZVt4XSA9IGNoO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlUmFuZ2UoeSk7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuZXJhc2VMZWZ0ID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgdmFyIGxpbmUgPSB0aGlzLmJ1ZmZlci5saW5lcy5nZXQodGhpcy5idWZmZXIueWJhc2UgKyB5KTtcbiAgICAgICAgaWYgKCFsaW5lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoID0gW3RoaXMuZXJhc2VBdHRyKCksICcgJywgMSwgMzJdO1xuICAgICAgICB4Kys7XG4gICAgICAgIHdoaWxlICh4LS0pIHtcbiAgICAgICAgICAgIGxpbmVbeF0gPSBjaDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZVJhbmdlKHkpO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5idWZmZXIueWJhc2UgPT09IDAgJiYgdGhpcy5idWZmZXIueSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYnVmZmVyLmxpbmVzLnNldCgwLCB0aGlzLmJ1ZmZlci5saW5lcy5nZXQodGhpcy5idWZmZXIueWJhc2UgKyB0aGlzLmJ1ZmZlci55KSk7XG4gICAgICAgIHRoaXMuYnVmZmVyLmxpbmVzLmxlbmd0aCA9IDE7XG4gICAgICAgIHRoaXMuYnVmZmVyLnlkaXNwID0gMDtcbiAgICAgICAgdGhpcy5idWZmZXIueWJhc2UgPSAwO1xuICAgICAgICB0aGlzLmJ1ZmZlci55ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLnJvd3M7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5idWZmZXIubGluZXMucHVzaCh0aGlzLmJsYW5rTGluZSgpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2goMCwgdGhpcy5yb3dzIC0gMSk7XG4gICAgICAgIHRoaXMuZW1pdCgnc2Nyb2xsJywgdGhpcy5idWZmZXIueWRpc3ApO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmVyYXNlTGluZSA9IGZ1bmN0aW9uICh5KSB7XG4gICAgICAgIHRoaXMuZXJhc2VSaWdodCgwLCB5KTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5ibGFua0xpbmUgPSBmdW5jdGlvbiAoY3VyLCBpc1dyYXBwZWQsIGNvbHMpIHtcbiAgICAgICAgdmFyIGF0dHIgPSBjdXIgPyB0aGlzLmVyYXNlQXR0cigpIDogdGhpcy5kZWZBdHRyO1xuICAgICAgICB2YXIgY2ggPSBbYXR0ciwgJyAnLCAxLCAzMl07XG4gICAgICAgIHZhciBsaW5lID0gW107XG4gICAgICAgIGlmIChpc1dyYXBwZWQpIHtcbiAgICAgICAgICAgIGxpbmUuaXNXcmFwcGVkID0gaXNXcmFwcGVkO1xuICAgICAgICB9XG4gICAgICAgIGNvbHMgPSBjb2xzIHx8IHRoaXMuY29scztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2xzOyBpKyspIHtcbiAgICAgICAgICAgIGxpbmVbaV0gPSBjaDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGluZTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5jaCA9IGZ1bmN0aW9uIChjdXIpIHtcbiAgICAgICAgaWYgKGN1cikge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLmVyYXNlQXR0cigpLCAnICcsIDEsIDMyXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3RoaXMuZGVmQXR0ciwgJyAnLCAxLCAzMl07XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuaXMgPSBmdW5jdGlvbiAodGVybSkge1xuICAgICAgICByZXR1cm4gKHRoaXMub3B0aW9ucy50ZXJtTmFtZSArICcnKS5pbmRleE9mKHRlcm0pID09PSAwO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmhhbmRsZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRpc2FibGVTdGRpbikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1hbmFnZXIgJiYgdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLmhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyLnliYXNlICE9PSB0aGlzLmJ1ZmZlci55ZGlzcCkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb0JvdHRvbSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW1pdCgnZGF0YScsIGRhdGEpO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLmhhbmRsZVRpdGxlID0gZnVuY3Rpb24gKHRpdGxlKSB7XG4gICAgICAgIHRoaXMuZW1pdCgndGl0bGUnLCB0aXRsZSk7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYnVmZmVyLnkrKztcbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyLnkgPiB0aGlzLmJ1ZmZlci5zY3JvbGxCb3R0b20pIHtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyLnktLTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyLnggPj0gdGhpcy5jb2xzKSB7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlci54LS07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5yZXZlcnNlSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmJ1ZmZlci55ID09PSB0aGlzLmJ1ZmZlci5zY3JvbGxUb3ApIHtcbiAgICAgICAgICAgIHZhciBzY3JvbGxSZWdpb25IZWlnaHQgPSB0aGlzLmJ1ZmZlci5zY3JvbGxCb3R0b20gLSB0aGlzLmJ1ZmZlci5zY3JvbGxUb3A7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlci5saW5lcy5zaGlmdEVsZW1lbnRzKHRoaXMuYnVmZmVyLnkgKyB0aGlzLmJ1ZmZlci55YmFzZSwgc2Nyb2xsUmVnaW9uSGVpZ2h0LCAxKTtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyLmxpbmVzLnNldCh0aGlzLmJ1ZmZlci55ICsgdGhpcy5idWZmZXIueWJhc2UsIHRoaXMuYmxhbmtMaW5lKHRydWUpKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmFuZ2UodGhpcy5idWZmZXIuc2Nyb2xsVG9wKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmFuZ2UodGhpcy5idWZmZXIuc2Nyb2xsQm90dG9tKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyLnktLTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMucm93cyA9IHRoaXMucm93cztcbiAgICAgICAgdGhpcy5vcHRpb25zLmNvbHMgPSB0aGlzLmNvbHM7XG4gICAgICAgIHZhciBjdXN0b21LZXlFdmVudEhhbmRsZXIgPSB0aGlzLmN1c3RvbUtleUV2ZW50SGFuZGxlcjtcbiAgICAgICAgdmFyIGlucHV0SGFuZGxlciA9IHRoaXMuaW5wdXRIYW5kbGVyO1xuICAgICAgICB2YXIgYnVmZmVycyA9IHRoaXMuYnVmZmVycztcbiAgICAgICAgdGhpcy5zZXR1cCgpO1xuICAgICAgICB0aGlzLmN1c3RvbUtleUV2ZW50SGFuZGxlciA9IGN1c3RvbUtleUV2ZW50SGFuZGxlcjtcbiAgICAgICAgdGhpcy5pbnB1dEhhbmRsZXIgPSBpbnB1dEhhbmRsZXI7XG4gICAgICAgIHRoaXMuYnVmZmVycyA9IGJ1ZmZlcnM7XG4gICAgICAgIHRoaXMucmVmcmVzaCgwLCB0aGlzLnJvd3MgLSAxKTtcbiAgICAgICAgdGhpcy52aWV3cG9ydC5zeW5jU2Nyb2xsQXJlYSgpO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnRhYlNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5idWZmZXIudGFic1t0aGlzLmJ1ZmZlci54XSA9IHRydWU7XG4gICAgfTtcbiAgICBUZXJtaW5hbC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKGV2LCBmb3JjZSkge1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5jYW5jZWxFdmVudHMgJiYgIWZvcmNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5tYXRjaENvbG9yID0gZnVuY3Rpb24gKHIxLCBnMSwgYjEpIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoQ29sb3JfKHIxLCBnMSwgYjEpO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnZpc3VhbEJlbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYmVsbFN0eWxlID09PSAndmlzdWFsJyB8fFxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmJlbGxTdHlsZSA9PT0gJ2JvdGgnO1xuICAgIH07XG4gICAgVGVybWluYWwucHJvdG90eXBlLnNvdW5kQmVsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5iZWxsU3R5bGUgPT09ICdzb3VuZCcgfHxcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5iZWxsU3R5bGUgPT09ICdib3RoJztcbiAgICB9O1xuICAgIFRlcm1pbmFsLnByb3RvdHlwZS5zeW5jQmVsbFNvdW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNvdW5kQmVsbCgpICYmIHRoaXMuYmVsbEF1ZGlvRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5iZWxsQXVkaW9FbGVtZW50LnNldEF0dHJpYnV0ZSgnc3JjJywgdGhpcy5vcHRpb25zLmJlbGxTb3VuZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zb3VuZEJlbGwoKSkge1xuICAgICAgICAgICAgdGhpcy5iZWxsQXVkaW9FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTtcbiAgICAgICAgICAgIHRoaXMuYmVsbEF1ZGlvRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3ByZWxvYWQnLCAnYXV0bycpO1xuICAgICAgICAgICAgdGhpcy5iZWxsQXVkaW9FbGVtZW50LnNldEF0dHJpYnV0ZSgnc3JjJywgdGhpcy5vcHRpb25zLmJlbGxTb3VuZCk7XG4gICAgICAgICAgICB0aGlzLmhlbHBlckNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmJlbGxBdWRpb0VsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYmVsbEF1ZGlvRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5oZWxwZXJDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5iZWxsQXVkaW9FbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFRlcm1pbmFsO1xufShFdmVudEVtaXR0ZXJfMS5FdmVudEVtaXR0ZXIpKTtcbmV4cG9ydHMuVGVybWluYWwgPSBUZXJtaW5hbDtcbmZ1bmN0aW9uIGdsb2JhbE9uKGVsLCB0eXBlLCBoYW5kbGVyLCBjYXB0dXJlKSB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGVsKSkge1xuICAgICAgICBlbCA9IFtlbF07XG4gICAgfVxuICAgIGVsLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUgfHwgZmFsc2UpO1xuICAgIH0pO1xufVxudmFyIG9uID0gZ2xvYmFsT247XG5mdW5jdGlvbiBvZmYoZWwsIHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUpIHtcbiAgICBpZiAoY2FwdHVyZSA9PT0gdm9pZCAwKSB7IGNhcHR1cmUgPSBmYWxzZTsgfVxuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgY2FwdHVyZSk7XG59XG5mdW5jdGlvbiBpc1RoaXJkTGV2ZWxTaGlmdChicm93c2VyLCBldikge1xuICAgIHZhciB0aGlyZExldmVsS2V5ID0gKGJyb3dzZXIuaXNNYWMgJiYgZXYuYWx0S2V5ICYmICFldi5jdHJsS2V5ICYmICFldi5tZXRhS2V5KSB8fFxuICAgICAgICAoYnJvd3Nlci5pc01TV2luZG93cyAmJiBldi5hbHRLZXkgJiYgZXYuY3RybEtleSAmJiAhZXYubWV0YUtleSk7XG4gICAgaWYgKGV2LnR5cGUgPT09ICdrZXlwcmVzcycpIHtcbiAgICAgICAgcmV0dXJuIHRoaXJkTGV2ZWxLZXk7XG4gICAgfVxuICAgIHJldHVybiB0aGlyZExldmVsS2V5ICYmICghZXYua2V5Q29kZSB8fCBldi5rZXlDb2RlID4gNDcpO1xufVxuZnVuY3Rpb24gd2FzTW9uZGlmaWVyS2V5T25seUV2ZW50KGV2KSB7XG4gICAgcmV0dXJuIGV2LmtleUNvZGUgPT09IDE2IHx8XG4gICAgICAgIGV2LmtleUNvZGUgPT09IDE3IHx8XG4gICAgICAgIGV2LmtleUNvZGUgPT09IDE4O1xufVxudmFyIHZjb2xvcnMgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciByZXN1bHQgPSBDb2xvck1hbmFnZXJfMS5ERUZBVUxUX0FOU0lfQ09MT1JTLm1hcChmdW5jdGlvbiAoYykge1xuICAgICAgICBjID0gYy5zdWJzdHJpbmcoMSk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBwYXJzZUludChjLnN1YnN0cmluZygwLCAyKSwgMTYpLFxuICAgICAgICAgICAgcGFyc2VJbnQoYy5zdWJzdHJpbmcoMiwgNCksIDE2KSxcbiAgICAgICAgICAgIHBhcnNlSW50KGMuc3Vic3RyaW5nKDQsIDYpLCAxNilcbiAgICAgICAgXTtcbiAgICB9KTtcbiAgICB2YXIgciA9IFsweDAwLCAweDVmLCAweDg3LCAweGFmLCAweGQ3LCAweGZmXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDIxNjsgaSsrKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKFtcbiAgICAgICAgICAgIHJbKGkgLyAzNikgJSA2IHwgMF0sXG4gICAgICAgICAgICByWyhpIC8gNikgJSA2IHwgMF0sXG4gICAgICAgICAgICByW2kgJSA2XVxuICAgICAgICBdKTtcbiAgICB9XG4gICAgdmFyIGM7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNDsgaSsrKSB7XG4gICAgICAgIGMgPSA4ICsgaSAqIDEwO1xuICAgICAgICByZXN1bHQucHVzaChbYywgYywgY10pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufSkoKTtcbnZhciBtYXRjaENvbG9yQ2FjaGUgPSB7fTtcbmZ1bmN0aW9uIG1hdGNoQ29sb3JEaXN0YW5jZShyMSwgZzEsIGIxLCByMiwgZzIsIGIyKSB7XG4gICAgcmV0dXJuIE1hdGgucG93KDMwICogKHIxIC0gcjIpLCAyKVxuICAgICAgICArIE1hdGgucG93KDU5ICogKGcxIC0gZzIpLCAyKVxuICAgICAgICArIE1hdGgucG93KDExICogKGIxIC0gYjIpLCAyKTtcbn1cbjtcbmZ1bmN0aW9uIG1hdGNoQ29sb3JfKHIxLCBnMSwgYjEpIHtcbiAgICB2YXIgaGFzaCA9IChyMSA8PCAxNikgfCAoZzEgPDwgOCkgfCBiMTtcbiAgICBpZiAobWF0Y2hDb2xvckNhY2hlW2hhc2hdICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoQ29sb3JDYWNoZVtoYXNoXTtcbiAgICB9XG4gICAgdmFyIGxkaWZmID0gSW5maW5pdHk7XG4gICAgdmFyIGxpID0gLTE7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBjO1xuICAgIHZhciByMjtcbiAgICB2YXIgZzI7XG4gICAgdmFyIGIyO1xuICAgIHZhciBkaWZmO1xuICAgIGZvciAoOyBpIDwgdmNvbG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjID0gdmNvbG9yc1tpXTtcbiAgICAgICAgcjIgPSBjWzBdO1xuICAgICAgICBnMiA9IGNbMV07XG4gICAgICAgIGIyID0gY1syXTtcbiAgICAgICAgZGlmZiA9IG1hdGNoQ29sb3JEaXN0YW5jZShyMSwgZzEsIGIxLCByMiwgZzIsIGIyKTtcbiAgICAgICAgaWYgKGRpZmYgPT09IDApIHtcbiAgICAgICAgICAgIGxpID0gaTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkaWZmIDwgbGRpZmYpIHtcbiAgICAgICAgICAgIGxkaWZmID0gZGlmZjtcbiAgICAgICAgICAgIGxpID0gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWF0Y2hDb2xvckNhY2hlW2hhc2hdID0gbGk7XG59XG5cblxuXG59LHtcIi4vQnVmZmVyXCI6MSxcIi4vQnVmZmVyU2V0XCI6MixcIi4vQ29tcG9zaXRpb25IZWxwZXJcIjo1LFwiLi9Fc2NhcGVTZXF1ZW5jZXNcIjo2LFwiLi9FdmVudEVtaXR0ZXJcIjo3LFwiLi9JbnB1dEhhbmRsZXJcIjo4LFwiLi9MaW5raWZpZXJcIjo5LFwiLi9QYXJzZXJcIjoxMCxcIi4vU2VsZWN0aW9uTWFuYWdlclwiOjExLFwiLi9WaWV3cG9ydFwiOjE1LFwiLi9oYW5kbGVycy9DbGlwYm9hcmRcIjoxNixcIi4vaW5wdXQvTW91c2Vab25lTWFuYWdlclwiOjE3LFwiLi9yZW5kZXJlci9DaGFyQXRsYXNcIjoxOSxcIi4vcmVuZGVyZXIvQ29sb3JNYW5hZ2VyXCI6MjAsXCIuL3JlbmRlcmVyL1JlbmRlcmVyXCI6MjQsXCIuL3V0aWxzL0Jyb3dzZXJcIjoyOCxcIi4vdXRpbHMvQ2hhck1lYXN1cmVcIjoyOSxcIi4vdXRpbHMvTW91c2VIZWxwZXJcIjozMixcIi4vdXRpbHMvU291bmRzXCI6MzR9XSwxNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBMaW5rSG92ZXJFdmVudFR5cGVzO1xuKGZ1bmN0aW9uIChMaW5rSG92ZXJFdmVudFR5cGVzKSB7XG4gICAgTGlua0hvdmVyRXZlbnRUeXBlc1tcIkhPVkVSXCJdID0gXCJsaW5raG92ZXJcIjtcbiAgICBMaW5rSG92ZXJFdmVudFR5cGVzW1wiVE9PTFRJUFwiXSA9IFwibGlua3Rvb2x0aXBcIjtcbiAgICBMaW5rSG92ZXJFdmVudFR5cGVzW1wiTEVBVkVcIl0gPSBcImxpbmtsZWF2ZVwiO1xufSkoTGlua0hvdmVyRXZlbnRUeXBlcyA9IGV4cG9ydHMuTGlua0hvdmVyRXZlbnRUeXBlcyB8fCAoZXhwb3J0cy5MaW5rSG92ZXJFdmVudFR5cGVzID0ge30pKTtcbjtcblxuXG5cbn0se31dLDE1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFZpZXdwb3J0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBWaWV3cG9ydCh0ZXJtaW5hbCwgdmlld3BvcnRFbGVtZW50LCBzY3JvbGxBcmVhLCBjaGFyTWVhc3VyZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnRlcm1pbmFsID0gdGVybWluYWw7XG4gICAgICAgIHRoaXMudmlld3BvcnRFbGVtZW50ID0gdmlld3BvcnRFbGVtZW50O1xuICAgICAgICB0aGlzLnNjcm9sbEFyZWEgPSBzY3JvbGxBcmVhO1xuICAgICAgICB0aGlzLmNoYXJNZWFzdXJlID0gY2hhck1lYXN1cmU7XG4gICAgICAgIHRoaXMuY3VycmVudFJvd0hlaWdodCA9IDA7XG4gICAgICAgIHRoaXMubGFzdFJlY29yZGVkQnVmZmVyTGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5sYXN0UmVjb3JkZWRWaWV3cG9ydEhlaWdodCA9IDA7XG4gICAgICAgIHRoaXMubGFzdFJlY29yZGVkQnVmZmVySGVpZ2h0ID0gMDtcbiAgICAgICAgdGhpcy52aWV3cG9ydEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5vblNjcm9sbC5iaW5kKHRoaXMpKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zeW5jU2Nyb2xsQXJlYSgpOyB9LCAwKTtcbiAgICB9XG4gICAgVmlld3BvcnQucHJvdG90eXBlLm9uVGhlbWVDaGFuZ2VkID0gZnVuY3Rpb24gKGNvbG9ycykge1xuICAgICAgICB0aGlzLnZpZXdwb3J0RWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcnMuYmFja2dyb3VuZDtcbiAgICB9O1xuICAgIFZpZXdwb3J0LnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5jaGFyTWVhc3VyZS5oZWlnaHQgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dIZWlnaHQgPSB0aGlzLnRlcm1pbmFsLnJlbmRlcmVyLmRpbWVuc2lvbnMuc2NhbGVkQ2VsbEhlaWdodCAvIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xuICAgICAgICAgICAgaWYgKHRoaXMubGFzdFJlY29yZGVkVmlld3BvcnRIZWlnaHQgIT09IHRoaXMudGVybWluYWwucmVuZGVyZXIuZGltZW5zaW9ucy5jYW52YXNIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RSZWNvcmRlZFZpZXdwb3J0SGVpZ2h0ID0gdGhpcy50ZXJtaW5hbC5yZW5kZXJlci5kaW1lbnNpb25zLmNhbnZhc0hlaWdodDtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdwb3J0RWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLmxhc3RSZWNvcmRlZFZpZXdwb3J0SGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBuZXdCdWZmZXJIZWlnaHQgPSBNYXRoLnJvdW5kKHRoaXMuY3VycmVudFJvd0hlaWdodCAqIHRoaXMubGFzdFJlY29yZGVkQnVmZmVyTGVuZ3RoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxhc3RSZWNvcmRlZEJ1ZmZlckhlaWdodCAhPT0gbmV3QnVmZmVySGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0UmVjb3JkZWRCdWZmZXJIZWlnaHQgPSBuZXdCdWZmZXJIZWlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxBcmVhLnN0eWxlLmhlaWdodCA9IHRoaXMubGFzdFJlY29yZGVkQnVmZmVySGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld3BvcnQucHJvdG90eXBlLnN5bmNTY3JvbGxBcmVhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5sYXN0UmVjb3JkZWRCdWZmZXJMZW5ndGggIT09IHRoaXMudGVybWluYWwuYnVmZmVyLmxpbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5sYXN0UmVjb3JkZWRCdWZmZXJMZW5ndGggPSB0aGlzLnRlcm1pbmFsLmJ1ZmZlci5saW5lcy5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmxhc3RSZWNvcmRlZFZpZXdwb3J0SGVpZ2h0ICE9PSB0aGlzLnRlcm1pbmFsLnJlbmRlcmVyLmRpbWVuc2lvbnMuY2FudmFzSGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRlcm1pbmFsLnJlbmRlcmVyLmRpbWVuc2lvbnMuc2NhbGVkQ2VsbEhlaWdodCAvIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICE9PSB0aGlzLmN1cnJlbnRSb3dIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgc2Nyb2xsVG9wID0gdGhpcy50ZXJtaW5hbC5idWZmZXIueWRpc3AgKiB0aGlzLmN1cnJlbnRSb3dIZWlnaHQ7XG4gICAgICAgIGlmICh0aGlzLnZpZXdwb3J0RWxlbWVudC5zY3JvbGxUb3AgIT09IHNjcm9sbFRvcCkge1xuICAgICAgICAgICAgdGhpcy52aWV3cG9ydEVsZW1lbnQuc2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3cG9ydC5wcm90b3R5cGUub25TY3JvbGwgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgdmFyIG5ld1JvdyA9IE1hdGgucm91bmQodGhpcy52aWV3cG9ydEVsZW1lbnQuc2Nyb2xsVG9wIC8gdGhpcy5jdXJyZW50Um93SGVpZ2h0KTtcbiAgICAgICAgdmFyIGRpZmYgPSBuZXdSb3cgLSB0aGlzLnRlcm1pbmFsLmJ1ZmZlci55ZGlzcDtcbiAgICAgICAgdGhpcy50ZXJtaW5hbC5zY3JvbGxMaW5lcyhkaWZmLCB0cnVlKTtcbiAgICB9O1xuICAgIFZpZXdwb3J0LnByb3RvdHlwZS5vbldoZWVsID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIGlmIChldi5kZWx0YVkgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXVsdGlwbGllciA9IDE7XG4gICAgICAgIGlmIChldi5kZWx0YU1vZGUgPT09IFdoZWVsRXZlbnQuRE9NX0RFTFRBX0xJTkUpIHtcbiAgICAgICAgICAgIG11bHRpcGxpZXIgPSB0aGlzLmN1cnJlbnRSb3dIZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXYuZGVsdGFNb2RlID09PSBXaGVlbEV2ZW50LkRPTV9ERUxUQV9QQUdFKSB7XG4gICAgICAgICAgICBtdWx0aXBsaWVyID0gdGhpcy5jdXJyZW50Um93SGVpZ2h0ICogdGhpcy50ZXJtaW5hbC5yb3dzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmlld3BvcnRFbGVtZW50LnNjcm9sbFRvcCArPSBldi5kZWx0YVkgKiBtdWx0aXBsaWVyO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG4gICAgO1xuICAgIFZpZXdwb3J0LnByb3RvdHlwZS5vblRvdWNoU3RhcnQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgdGhpcy5sYXN0VG91Y2hZID0gZXYudG91Y2hlc1swXS5wYWdlWTtcbiAgICB9O1xuICAgIDtcbiAgICBWaWV3cG9ydC5wcm90b3R5cGUub25Ub3VjaE1vdmUgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgdmFyIGRlbHRhWSA9IHRoaXMubGFzdFRvdWNoWSAtIGV2LnRvdWNoZXNbMF0ucGFnZVk7XG4gICAgICAgIHRoaXMubGFzdFRvdWNoWSA9IGV2LnRvdWNoZXNbMF0ucGFnZVk7XG4gICAgICAgIGlmIChkZWx0YVkgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZpZXdwb3J0RWxlbWVudC5zY3JvbGxUb3AgKz0gZGVsdGFZO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG4gICAgO1xuICAgIHJldHVybiBWaWV3cG9ydDtcbn0oKSk7XG5leHBvcnRzLlZpZXdwb3J0ID0gVmlld3BvcnQ7XG5cblxuXG59LHt9XSwxNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIHByZXBhcmVUZXh0Rm9yVGVybWluYWwodGV4dCwgaXNNU1dpbmRvd3MpIHtcbiAgICBpZiAoaXNNU1dpbmRvd3MpIHtcbiAgICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvXFxyP1xcbi9nLCAnXFxyJyk7XG4gICAgfVxuICAgIHJldHVybiB0ZXh0O1xufVxuZXhwb3J0cy5wcmVwYXJlVGV4dEZvclRlcm1pbmFsID0gcHJlcGFyZVRleHRGb3JUZXJtaW5hbDtcbmZ1bmN0aW9uIGJyYWNrZXRUZXh0Rm9yUGFzdGUodGV4dCwgYnJhY2tldGVkUGFzdGVNb2RlKSB7XG4gICAgaWYgKGJyYWNrZXRlZFBhc3RlTW9kZSkge1xuICAgICAgICByZXR1cm4gJ1xceDFiWzIwMH4nICsgdGV4dCArICdcXHgxYlsyMDF+JztcbiAgICB9XG4gICAgcmV0dXJuIHRleHQ7XG59XG5leHBvcnRzLmJyYWNrZXRUZXh0Rm9yUGFzdGUgPSBicmFja2V0VGV4dEZvclBhc3RlO1xuZnVuY3Rpb24gY29weUhhbmRsZXIoZXYsIHRlcm0sIHNlbGVjdGlvbk1hbmFnZXIpIHtcbiAgICBpZiAodGVybS5icm93c2VyLmlzTVNJRSkge1xuICAgICAgICB3aW5kb3cuY2xpcGJvYXJkRGF0YS5zZXREYXRhKCdUZXh0Jywgc2VsZWN0aW9uTWFuYWdlci5zZWxlY3Rpb25UZXh0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGV2LmNsaXBib2FyZERhdGEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHNlbGVjdGlvbk1hbmFnZXIuc2VsZWN0aW9uVGV4dCk7XG4gICAgfVxuICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG59XG5leHBvcnRzLmNvcHlIYW5kbGVyID0gY29weUhhbmRsZXI7XG5mdW5jdGlvbiBwYXN0ZUhhbmRsZXIoZXYsIHRlcm0pIHtcbiAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB2YXIgdGV4dDtcbiAgICB2YXIgZGlzcGF0Y2hQYXN0ZSA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgIHRleHQgPSBwcmVwYXJlVGV4dEZvclRlcm1pbmFsKHRleHQsIHRlcm0uYnJvd3Nlci5pc01TV2luZG93cyk7XG4gICAgICAgIHRleHQgPSBicmFja2V0VGV4dEZvclBhc3RlKHRleHQsIHRlcm0uYnJhY2tldGVkUGFzdGVNb2RlKTtcbiAgICAgICAgdGVybS5oYW5kbGVyKHRleHQpO1xuICAgICAgICB0ZXJtLnRleHRhcmVhLnZhbHVlID0gJyc7XG4gICAgICAgIHRlcm0uZW1pdCgncGFzdGUnLCB0ZXh0KTtcbiAgICAgICAgdGVybS5jYW5jZWwoZXYpO1xuICAgIH07XG4gICAgaWYgKHRlcm0uYnJvd3Nlci5pc01TSUUpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5jbGlwYm9hcmREYXRhKSB7XG4gICAgICAgICAgICB0ZXh0ID0gd2luZG93LmNsaXBib2FyZERhdGEuZ2V0RGF0YSgnVGV4dCcpO1xuICAgICAgICAgICAgZGlzcGF0Y2hQYXN0ZSh0ZXh0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGV2LmNsaXBib2FyZERhdGEpIHtcbiAgICAgICAgICAgIHRleHQgPSBldi5jbGlwYm9hcmREYXRhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcbiAgICAgICAgICAgIGRpc3BhdGNoUGFzdGUodGV4dCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnBhc3RlSGFuZGxlciA9IHBhc3RlSGFuZGxlcjtcbmZ1bmN0aW9uIG1vdmVUZXh0QXJlYVVuZGVyTW91c2VDdXJzb3IoZXYsIHRleHRhcmVhKSB7XG4gICAgdGV4dGFyZWEuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgIHRleHRhcmVhLnN0eWxlLndpZHRoID0gJzIwcHgnO1xuICAgIHRleHRhcmVhLnN0eWxlLmhlaWdodCA9ICcyMHB4JztcbiAgICB0ZXh0YXJlYS5zdHlsZS5sZWZ0ID0gKGV2LmNsaWVudFggLSAxMCkgKyAncHgnO1xuICAgIHRleHRhcmVhLnN0eWxlLnRvcCA9IChldi5jbGllbnRZIC0gMTApICsgJ3B4JztcbiAgICB0ZXh0YXJlYS5zdHlsZS56SW5kZXggPSAnMTAwMCc7XG4gICAgdGV4dGFyZWEuZm9jdXMoKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGV4dGFyZWEuc3R5bGUucG9zaXRpb24gPSBudWxsO1xuICAgICAgICB0ZXh0YXJlYS5zdHlsZS53aWR0aCA9IG51bGw7XG4gICAgICAgIHRleHRhcmVhLnN0eWxlLmhlaWdodCA9IG51bGw7XG4gICAgICAgIHRleHRhcmVhLnN0eWxlLmxlZnQgPSBudWxsO1xuICAgICAgICB0ZXh0YXJlYS5zdHlsZS50b3AgPSBudWxsO1xuICAgICAgICB0ZXh0YXJlYS5zdHlsZS56SW5kZXggPSBudWxsO1xuICAgIH0sIDQpO1xufVxuZXhwb3J0cy5tb3ZlVGV4dEFyZWFVbmRlck1vdXNlQ3Vyc29yID0gbW92ZVRleHRBcmVhVW5kZXJNb3VzZUN1cnNvcjtcbmZ1bmN0aW9uIHJpZ2h0Q2xpY2tIYW5kbGVyKGV2LCB0ZXh0YXJlYSwgc2VsZWN0aW9uTWFuYWdlcikge1xuICAgIG1vdmVUZXh0QXJlYVVuZGVyTW91c2VDdXJzb3IoZXYsIHRleHRhcmVhKTtcbiAgICB0ZXh0YXJlYS52YWx1ZSA9IHNlbGVjdGlvbk1hbmFnZXIuc2VsZWN0aW9uVGV4dDtcbiAgICB0ZXh0YXJlYS5zZWxlY3QoKTtcbn1cbmV4cG9ydHMucmlnaHRDbGlja0hhbmRsZXIgPSByaWdodENsaWNrSGFuZGxlcjtcblxuXG5cbn0se31dLDE3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEhPVkVSX0RVUkFUSU9OID0gNTAwO1xudmFyIE1vdXNlWm9uZU1hbmFnZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1vdXNlWm9uZU1hbmFnZXIoX3Rlcm1pbmFsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmFsID0gX3Rlcm1pbmFsO1xuICAgICAgICB0aGlzLl96b25lcyA9IFtdO1xuICAgICAgICB0aGlzLl9hcmVab25lc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90b29sdGlwVGltZW91dCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRab25lID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbGFzdEhvdmVyQ29vcmRzID0gW251bGwsIG51bGxdO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5fb25Nb3VzZURvd24oZSk7IH0pO1xuICAgICAgICB0aGlzLl9tb3VzZU1vdmVMaXN0ZW5lciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5fb25Nb3VzZU1vdmUoZSk7IH07XG4gICAgICAgIHRoaXMuX2NsaWNrTGlzdGVuZXIgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuX29uQ2xpY2soZSk7IH07XG4gICAgfVxuICAgIE1vdXNlWm9uZU1hbmFnZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh6b25lKSB7XG4gICAgICAgIHRoaXMuX3pvbmVzLnB1c2goem9uZSk7XG4gICAgICAgIGlmICh0aGlzLl96b25lcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2YXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1vdXNlWm9uZU1hbmFnZXIucHJvdG90eXBlLmNsZWFyQWxsID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgaWYgKHRoaXMuX3pvbmVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZW5kKSB7XG4gICAgICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgICAgICBlbmQgPSB0aGlzLl90ZXJtaW5hbC5yb3dzIC0gMTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3pvbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgem9uZSA9IHRoaXMuX3pvbmVzW2ldO1xuICAgICAgICAgICAgaWYgKHpvbmUueSA+IHN0YXJ0ICYmIHpvbmUueSA8PSBlbmQgKyAxKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRab25lICYmIHRoaXMuX2N1cnJlbnRab25lID09PSB6b25lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRab25lLmxlYXZlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFpvbmUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl96b25lcy5zcGxpY2UoaS0tLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fem9uZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWFjdGl2YXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1vdXNlWm9uZU1hbmFnZXIucHJvdG90eXBlLl9hY3RpdmF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9hcmVab25lc0FjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5fYXJlWm9uZXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLl9tb3VzZU1vdmVMaXN0ZW5lcik7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fY2xpY2tMaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1vdXNlWm9uZU1hbmFnZXIucHJvdG90eXBlLl9kZWFjdGl2YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYXJlWm9uZXNBY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuX2FyZVpvbmVzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl90ZXJtaW5hbC5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdXNlTW92ZUxpc3RlbmVyKTtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9jbGlja0xpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTW91c2Vab25lTWFuYWdlci5wcm90b3R5cGUuX29uTW91c2VNb3ZlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RIb3ZlckNvb3Jkc1swXSAhPT0gZS5wYWdlWCB8fCB0aGlzLl9sYXN0SG92ZXJDb29yZHNbMV0gIT09IGUucGFnZVkpIHtcbiAgICAgICAgICAgIHRoaXMuX29uSG92ZXIoZSk7XG4gICAgICAgICAgICB0aGlzLl9sYXN0SG92ZXJDb29yZHMgPSBbZS5wYWdlWCwgZS5wYWdlWV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1vdXNlWm9uZU1hbmFnZXIucHJvdG90eXBlLl9vbkhvdmVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHpvbmUgPSB0aGlzLl9maW5kWm9uZUV2ZW50QXQoZSk7XG4gICAgICAgIGlmICh6b25lID09PSB0aGlzLl9jdXJyZW50Wm9uZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9jdXJyZW50Wm9uZSkge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFpvbmUubGVhdmVDYWxsYmFjaygpO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFpvbmUgPSBudWxsO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Rvb2x0aXBUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3Rvb2x0aXBUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXpvbmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdXJyZW50Wm9uZSA9IHpvbmU7XG4gICAgICAgIGlmICh6b25lLmhvdmVyQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHpvbmUuaG92ZXJDYWxsYmFjayhlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90b29sdGlwVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX29uVG9vbHRpcChlKTsgfSwgSE9WRVJfRFVSQVRJT04pO1xuICAgIH07XG4gICAgTW91c2Vab25lTWFuYWdlci5wcm90b3R5cGUuX29uVG9vbHRpcCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuX3Rvb2x0aXBUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgdmFyIHpvbmUgPSB0aGlzLl9maW5kWm9uZUV2ZW50QXQoZSk7XG4gICAgICAgIGlmICh6b25lICYmIHpvbmUudG9vbHRpcENhbGxiYWNrKSB7XG4gICAgICAgICAgICB6b25lLnRvb2x0aXBDYWxsYmFjayhlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTW91c2Vab25lTWFuYWdlci5wcm90b3R5cGUuX29uTW91c2VEb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9hcmVab25lc0FjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB6b25lID0gdGhpcy5fZmluZFpvbmVFdmVudEF0KGUpO1xuICAgICAgICBpZiAoem9uZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTW91c2Vab25lTWFuYWdlci5wcm90b3R5cGUuX29uQ2xpY2sgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgem9uZSA9IHRoaXMuX2ZpbmRab25lRXZlbnRBdChlKTtcbiAgICAgICAgaWYgKHpvbmUpIHtcbiAgICAgICAgICAgIHpvbmUuY2xpY2tDYWxsYmFjayhlKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1vdXNlWm9uZU1hbmFnZXIucHJvdG90eXBlLl9maW5kWm9uZUV2ZW50QXQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgY29vcmRzID0gdGhpcy5fdGVybWluYWwubW91c2VIZWxwZXIuZ2V0Q29vcmRzKGUsIHRoaXMuX3Rlcm1pbmFsLmVsZW1lbnQsIHRoaXMuX3Rlcm1pbmFsLmNoYXJNZWFzdXJlLCB0aGlzLl90ZXJtaW5hbC5vcHRpb25zLmxpbmVIZWlnaHQsIHRoaXMuX3Rlcm1pbmFsLmNvbHMsIHRoaXMuX3Rlcm1pbmFsLnJvd3MpO1xuICAgICAgICBpZiAoIWNvb3Jkcykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl96b25lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHpvbmUgPSB0aGlzLl96b25lc1tpXTtcbiAgICAgICAgICAgIGlmICh6b25lLnkgPT09IGNvb3Jkc1sxXSAmJiB6b25lLngxIDw9IGNvb3Jkc1swXSAmJiB6b25lLngyID4gY29vcmRzWzBdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHpvbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBNb3VzZVpvbmVNYW5hZ2VyO1xufSgpKTtcbmV4cG9ydHMuTW91c2Vab25lTWFuYWdlciA9IE1vdXNlWm9uZU1hbmFnZXI7XG52YXIgTW91c2Vab25lID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNb3VzZVpvbmUoeDEsIHgyLCB5LCBjbGlja0NhbGxiYWNrLCBob3ZlckNhbGxiYWNrLCB0b29sdGlwQ2FsbGJhY2ssIGxlYXZlQ2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy54MSA9IHgxO1xuICAgICAgICB0aGlzLngyID0geDI7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHRoaXMuY2xpY2tDYWxsYmFjayA9IGNsaWNrQ2FsbGJhY2s7XG4gICAgICAgIHRoaXMuaG92ZXJDYWxsYmFjayA9IGhvdmVyQ2FsbGJhY2s7XG4gICAgICAgIHRoaXMudG9vbHRpcENhbGxiYWNrID0gdG9vbHRpcENhbGxiYWNrO1xuICAgICAgICB0aGlzLmxlYXZlQ2FsbGJhY2sgPSBsZWF2ZUNhbGxiYWNrO1xuICAgIH1cbiAgICByZXR1cm4gTW91c2Vab25lO1xufSgpKTtcbmV4cG9ydHMuTW91c2Vab25lID0gTW91c2Vab25lO1xuXG5cblxufSx7fV0sMTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQ2hhckF0bGFzXzEgPSByZXF1aXJlKFwiLi9DaGFyQXRsYXNcIik7XG52YXIgQnVmZmVyXzEgPSByZXF1aXJlKFwiLi4vQnVmZmVyXCIpO1xuZXhwb3J0cy5JTlZFUlRFRF9ERUZBVUxUX0NPTE9SID0gLTE7XG52YXIgRElNX09QQUNJVFkgPSAwLjU7XG52YXIgQmFzZVJlbmRlckxheWVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCYXNlUmVuZGVyTGF5ZXIoY29udGFpbmVyLCBpZCwgekluZGV4LCBfYWxwaGEsIF9jb2xvcnMpIHtcbiAgICAgICAgdGhpcy5fYWxwaGEgPSBfYWxwaGE7XG4gICAgICAgIHRoaXMuX2NvbG9ycyA9IF9jb2xvcnM7XG4gICAgICAgIHRoaXMuX3NjYWxlZENoYXJXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuX3NjYWxlZENoYXJIZWlnaHQgPSAwO1xuICAgICAgICB0aGlzLl9zY2FsZWRDZWxsV2lkdGggPSAwO1xuICAgICAgICB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0ID0gMDtcbiAgICAgICAgdGhpcy5fc2NhbGVkQ2hhckxlZnQgPSAwO1xuICAgICAgICB0aGlzLl9zY2FsZWRDaGFyVG9wID0gMDtcbiAgICAgICAgdGhpcy5fY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRoaXMuX2NhbnZhcy5pZCA9IFwieHRlcm0tXCIgKyBpZCArIFwiLWxheWVyXCI7XG4gICAgICAgIHRoaXMuX2NhbnZhcy5zdHlsZS56SW5kZXggPSB6SW5kZXgudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5fY3R4ID0gdGhpcy5fY2FudmFzLmdldENvbnRleHQoJzJkJywgeyBhbHBoYTogX2FscGhhIH0pO1xuICAgICAgICB0aGlzLl9jdHguc2NhbGUod2luZG93LmRldmljZVBpeGVsUmF0aW8sIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtcbiAgICAgICAgaWYgKCFfYWxwaGEpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJBbGwoKTtcbiAgICAgICAgfVxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5fY2FudmFzKTtcbiAgICB9XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5vbk9wdGlvbnNDaGFuZ2VkID0gZnVuY3Rpb24gKHRlcm1pbmFsKSB7IH07XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5vbkJsdXIgPSBmdW5jdGlvbiAodGVybWluYWwpIHsgfTtcbiAgICBCYXNlUmVuZGVyTGF5ZXIucHJvdG90eXBlLm9uRm9jdXMgPSBmdW5jdGlvbiAodGVybWluYWwpIHsgfTtcbiAgICBCYXNlUmVuZGVyTGF5ZXIucHJvdG90eXBlLm9uQ3Vyc29yTW92ZSA9IGZ1bmN0aW9uICh0ZXJtaW5hbCkgeyB9O1xuICAgIEJhc2VSZW5kZXJMYXllci5wcm90b3R5cGUub25HcmlkQ2hhbmdlZCA9IGZ1bmN0aW9uICh0ZXJtaW5hbCwgc3RhcnRSb3csIGVuZFJvdykgeyB9O1xuICAgIEJhc2VSZW5kZXJMYXllci5wcm90b3R5cGUub25TZWxlY3Rpb25DaGFuZ2VkID0gZnVuY3Rpb24gKHRlcm1pbmFsLCBzdGFydCwgZW5kKSB7IH07XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5vblRoZW1lQ2hhbmdlZCA9IGZ1bmN0aW9uICh0ZXJtaW5hbCwgY29sb3JTZXQpIHtcbiAgICAgICAgdGhpcy5fcmVmcmVzaENoYXJBdGxhcyh0ZXJtaW5hbCwgY29sb3JTZXQpO1xuICAgIH07XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5fcmVmcmVzaENoYXJBdGxhcyA9IGZ1bmN0aW9uICh0ZXJtaW5hbCwgY29sb3JTZXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuX3NjYWxlZENoYXJXaWR0aCA8PSAwICYmIHRoaXMuX3NjYWxlZENoYXJIZWlnaHQgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NoYXJBdGxhcyA9IG51bGw7XG4gICAgICAgIHZhciByZXN1bHQgPSBDaGFyQXRsYXNfMS5hY3F1aXJlQ2hhckF0bGFzKHRlcm1pbmFsLCB0aGlzLl9jb2xvcnMsIHRoaXMuX3NjYWxlZENoYXJXaWR0aCwgdGhpcy5fc2NhbGVkQ2hhckhlaWdodCk7XG4gICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBIVE1MQ2FudmFzRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5fY2hhckF0bGFzID0gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0LnRoZW4oZnVuY3Rpb24gKGJpdG1hcCkgeyByZXR1cm4gX3RoaXMuX2NoYXJBdGxhcyA9IGJpdG1hcDsgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJhc2VSZW5kZXJMYXllci5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKHRlcm1pbmFsLCBkaW0sIGNoYXJTaXplQ2hhbmdlZCkge1xuICAgICAgICB0aGlzLl9zY2FsZWRDZWxsV2lkdGggPSBkaW0uc2NhbGVkQ2VsbFdpZHRoO1xuICAgICAgICB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0ID0gZGltLnNjYWxlZENlbGxIZWlnaHQ7XG4gICAgICAgIHRoaXMuX3NjYWxlZENoYXJXaWR0aCA9IGRpbS5zY2FsZWRDaGFyV2lkdGg7XG4gICAgICAgIHRoaXMuX3NjYWxlZENoYXJIZWlnaHQgPSBkaW0uc2NhbGVkQ2hhckhlaWdodDtcbiAgICAgICAgdGhpcy5fc2NhbGVkQ2hhckxlZnQgPSBkaW0uc2NhbGVkQ2hhckxlZnQ7XG4gICAgICAgIHRoaXMuX3NjYWxlZENoYXJUb3AgPSBkaW0uc2NhbGVkQ2hhclRvcDtcbiAgICAgICAgdGhpcy5fY2FudmFzLndpZHRoID0gZGltLnNjYWxlZENhbnZhc1dpZHRoO1xuICAgICAgICB0aGlzLl9jYW52YXMuaGVpZ2h0ID0gZGltLnNjYWxlZENhbnZhc0hlaWdodDtcbiAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLndpZHRoID0gZGltLmNhbnZhc1dpZHRoICsgXCJweFwiO1xuICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUuaGVpZ2h0ID0gZGltLmNhbnZhc0hlaWdodCArIFwicHhcIjtcbiAgICAgICAgaWYgKCF0aGlzLl9hbHBoYSkge1xuICAgICAgICAgICAgdGhpcy5jbGVhckFsbCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGFyU2l6ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hDaGFyQXRsYXModGVybWluYWwsIHRoaXMuX2NvbG9ycyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJhc2VSZW5kZXJMYXllci5wcm90b3R5cGUuZmlsbENlbGxzID0gZnVuY3Rpb24gKHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5fY3R4LmZpbGxSZWN0KHggKiB0aGlzLl9zY2FsZWRDZWxsV2lkdGgsIHkgKiB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0LCB3aWR0aCAqIHRoaXMuX3NjYWxlZENlbGxXaWR0aCwgaGVpZ2h0ICogdGhpcy5fc2NhbGVkQ2VsbEhlaWdodCk7XG4gICAgfTtcbiAgICBCYXNlUmVuZGVyTGF5ZXIucHJvdG90eXBlLmZpbGxCb3R0b21MaW5lQXRDZWxscyA9IGZ1bmN0aW9uICh4LCB5LCB3aWR0aCkge1xuICAgICAgICBpZiAod2lkdGggPT09IHZvaWQgMCkgeyB3aWR0aCA9IDE7IH1cbiAgICAgICAgdGhpcy5fY3R4LmZpbGxSZWN0KHggKiB0aGlzLl9zY2FsZWRDZWxsV2lkdGgsICh5ICsgMSkgKiB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0IC0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gLSAxLCB3aWR0aCAqIHRoaXMuX3NjYWxlZENlbGxXaWR0aCwgd2luZG93LmRldmljZVBpeGVsUmF0aW8pO1xuICAgIH07XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5maWxsTGVmdExpbmVBdENlbGwgPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICB0aGlzLl9jdHguZmlsbFJlY3QoeCAqIHRoaXMuX3NjYWxlZENlbGxXaWR0aCwgeSAqIHRoaXMuX3NjYWxlZENlbGxIZWlnaHQsIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLCB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0KTtcbiAgICB9O1xuICAgIEJhc2VSZW5kZXJMYXllci5wcm90b3R5cGUuc3Ryb2tlUmVjdEF0Q2VsbCA9IGZ1bmN0aW9uICh4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuX2N0eC5saW5lV2lkdGggPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbztcbiAgICAgICAgdGhpcy5fY3R4LnN0cm9rZVJlY3QoeCAqIHRoaXMuX3NjYWxlZENlbGxXaWR0aCArIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIC8gMiwgeSAqIHRoaXMuX3NjYWxlZENlbGxIZWlnaHQgKyAod2luZG93LmRldmljZVBpeGVsUmF0aW8gLyAyKSwgd2lkdGggKiB0aGlzLl9zY2FsZWRDZWxsV2lkdGggLSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgKGhlaWdodCAqIHRoaXMuX3NjYWxlZENlbGxIZWlnaHQpIC0gd2luZG93LmRldmljZVBpeGVsUmF0aW8pO1xuICAgIH07XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5jbGVhckFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FscGhhKSB7XG4gICAgICAgICAgICB0aGlzLl9jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuX2NhbnZhcy53aWR0aCwgdGhpcy5fY2FudmFzLmhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmJhY2tncm91bmQ7XG4gICAgICAgICAgICB0aGlzLl9jdHguZmlsbFJlY3QoMCwgMCwgdGhpcy5fY2FudmFzLndpZHRoLCB0aGlzLl9jYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5jbGVhckNlbGxzID0gZnVuY3Rpb24gKHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FscGhhKSB7XG4gICAgICAgICAgICB0aGlzLl9jdHguY2xlYXJSZWN0KHggKiB0aGlzLl9zY2FsZWRDZWxsV2lkdGgsIHkgKiB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0LCB3aWR0aCAqIHRoaXMuX3NjYWxlZENlbGxXaWR0aCwgaGVpZ2h0ICogdGhpcy5fc2NhbGVkQ2VsbEhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmJhY2tncm91bmQ7XG4gICAgICAgICAgICB0aGlzLl9jdHguZmlsbFJlY3QoeCAqIHRoaXMuX3NjYWxlZENlbGxXaWR0aCwgeSAqIHRoaXMuX3NjYWxlZENlbGxIZWlnaHQsIHdpZHRoICogdGhpcy5fc2NhbGVkQ2VsbFdpZHRoLCBoZWlnaHQgKiB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmFzZVJlbmRlckxheWVyLnByb3RvdHlwZS5maWxsQ2hhclRydWVDb2xvciA9IGZ1bmN0aW9uICh0ZXJtaW5hbCwgY2hhckRhdGEsIHgsIHkpIHtcbiAgICAgICAgdGhpcy5fY3R4LmZvbnQgPSB0ZXJtaW5hbC5vcHRpb25zLmZvbnRTaXplICogd2luZG93LmRldmljZVBpeGVsUmF0aW8gKyBcInB4IFwiICsgdGVybWluYWwub3B0aW9ucy5mb250RmFtaWx5O1xuICAgICAgICB0aGlzLl9jdHgudGV4dEJhc2VsaW5lID0gJ3RvcCc7XG4gICAgICAgIHRoaXMuX2NsaXBSb3codGVybWluYWwsIHkpO1xuICAgICAgICB0aGlzLl9jdHguZmlsbFRleHQoY2hhckRhdGFbQnVmZmVyXzEuQ0hBUl9EQVRBX0NIQVJfSU5ERVhdLCB4ICogdGhpcy5fc2NhbGVkQ2VsbFdpZHRoICsgdGhpcy5fc2NhbGVkQ2hhckxlZnQsIHkgKiB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0ICsgdGhpcy5fc2NhbGVkQ2hhclRvcCk7XG4gICAgfTtcbiAgICBCYXNlUmVuZGVyTGF5ZXIucHJvdG90eXBlLmRyYXdDaGFyID0gZnVuY3Rpb24gKHRlcm1pbmFsLCBjaGFyLCBjb2RlLCB3aWR0aCwgeCwgeSwgZmcsIGJnLCBib2xkLCBkaW0pIHtcbiAgICAgICAgdmFyIGNvbG9ySW5kZXggPSAwO1xuICAgICAgICBpZiAoZmcgPCAyNTYpIHtcbiAgICAgICAgICAgIGNvbG9ySW5kZXggPSBmZyArIDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoYm9sZCAmJiB0ZXJtaW5hbC5vcHRpb25zLmVuYWJsZUJvbGQpIHtcbiAgICAgICAgICAgICAgICBjb2xvckluZGV4ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNBc2NpaSA9IGNvZGUgPCAyNTY7XG4gICAgICAgIHZhciBpc0Jhc2ljQ29sb3IgPSAoY29sb3JJbmRleCA+IDEgJiYgZmcgPCAxNikgJiYgKGZnIDwgOCB8fCBib2xkKTtcbiAgICAgICAgdmFyIGlzRGVmYXVsdENvbG9yID0gZmcgPj0gMjU2O1xuICAgICAgICB2YXIgaXNEZWZhdWx0QmFja2dyb3VuZCA9IGJnID49IDI1NjtcbiAgICAgICAgaWYgKHRoaXMuX2NoYXJBdGxhcyAmJiBpc0FzY2lpICYmIChpc0Jhc2ljQ29sb3IgfHwgaXNEZWZhdWx0Q29sb3IpICYmIGlzRGVmYXVsdEJhY2tncm91bmQpIHtcbiAgICAgICAgICAgIHZhciBjaGFyQXRsYXNDZWxsV2lkdGggPSB0aGlzLl9zY2FsZWRDaGFyV2lkdGggKyBDaGFyQXRsYXNfMS5DSEFSX0FUTEFTX0NFTExfU1BBQ0lORztcbiAgICAgICAgICAgIHZhciBjaGFyQXRsYXNDZWxsSGVpZ2h0ID0gdGhpcy5fc2NhbGVkQ2hhckhlaWdodCArIENoYXJBdGxhc18xLkNIQVJfQVRMQVNfQ0VMTF9TUEFDSU5HO1xuICAgICAgICAgICAgaWYgKGRpbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5nbG9iYWxBbHBoYSA9IERJTV9PUEFDSVRZO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGJvbGQgJiYgIXRlcm1pbmFsLm9wdGlvbnMuZW5hYmxlQm9sZCkge1xuICAgICAgICAgICAgICAgIGlmIChjb2xvckluZGV4ID4gMSkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvckluZGV4IC09IDg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fY3R4LmRyYXdJbWFnZSh0aGlzLl9jaGFyQXRsYXMsIGNvZGUgKiBjaGFyQXRsYXNDZWxsV2lkdGgsIGNvbG9ySW5kZXggKiBjaGFyQXRsYXNDZWxsSGVpZ2h0LCBjaGFyQXRsYXNDZWxsV2lkdGgsIHRoaXMuX3NjYWxlZENoYXJIZWlnaHQsIHggKiB0aGlzLl9zY2FsZWRDZWxsV2lkdGggKyB0aGlzLl9zY2FsZWRDaGFyTGVmdCwgeSAqIHRoaXMuX3NjYWxlZENlbGxIZWlnaHQgKyB0aGlzLl9zY2FsZWRDaGFyVG9wLCBjaGFyQXRsYXNDZWxsV2lkdGgsIHRoaXMuX3NjYWxlZENoYXJIZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZHJhd1VuY2FjaGVkQ2hhcih0ZXJtaW5hbCwgY2hhciwgd2lkdGgsIGZnLCB4LCB5LCBib2xkLCBkaW0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCYXNlUmVuZGVyTGF5ZXIucHJvdG90eXBlLl9kcmF3VW5jYWNoZWRDaGFyID0gZnVuY3Rpb24gKHRlcm1pbmFsLCBjaGFyLCB3aWR0aCwgZmcsIHgsIHksIGJvbGQsIGRpbSkge1xuICAgICAgICB0aGlzLl9jdHguc2F2ZSgpO1xuICAgICAgICB0aGlzLl9jdHguZm9udCA9IHRlcm1pbmFsLm9wdGlvbnMuZm9udFNpemUgKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyArIFwicHggXCIgKyB0ZXJtaW5hbC5vcHRpb25zLmZvbnRGYW1pbHk7XG4gICAgICAgIGlmIChib2xkICYmIHRlcm1pbmFsLm9wdGlvbnMuZW5hYmxlQm9sZCkge1xuICAgICAgICAgICAgdGhpcy5fY3R4LmZvbnQgPSBcImJvbGQgXCIgKyB0aGlzLl9jdHguZm9udDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdHgudGV4dEJhc2VsaW5lID0gJ3RvcCc7XG4gICAgICAgIGlmIChmZyA9PT0gZXhwb3J0cy5JTlZFUlRFRF9ERUZBVUxUX0NPTE9SKSB7XG4gICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmJhY2tncm91bmQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZmcgPCAyNTYpIHtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcnMuYW5zaVtmZ107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmZvcmVncm91bmQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2xpcFJvdyh0ZXJtaW5hbCwgeSk7XG4gICAgICAgIGlmIChkaW0pIHtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5nbG9iYWxBbHBoYSA9IERJTV9PUEFDSVRZO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2N0eC5maWxsVGV4dChjaGFyLCB4ICogdGhpcy5fc2NhbGVkQ2VsbFdpZHRoICsgdGhpcy5fc2NhbGVkQ2hhckxlZnQsIHkgKiB0aGlzLl9zY2FsZWRDZWxsSGVpZ2h0ICsgdGhpcy5fc2NhbGVkQ2hhclRvcCk7XG4gICAgICAgIHRoaXMuX2N0eC5yZXN0b3JlKCk7XG4gICAgfTtcbiAgICBCYXNlUmVuZGVyTGF5ZXIucHJvdG90eXBlLl9jbGlwUm93ID0gZnVuY3Rpb24gKHRlcm1pbmFsLCB5KSB7XG4gICAgICAgIHRoaXMuX2N0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgdGhpcy5fY3R4LnJlY3QoMCwgeSAqIHRoaXMuX3NjYWxlZENlbGxIZWlnaHQsIHRlcm1pbmFsLmNvbHMgKiB0aGlzLl9zY2FsZWRDZWxsV2lkdGgsIHRoaXMuX3NjYWxlZENlbGxIZWlnaHQpO1xuICAgICAgICB0aGlzLl9jdHguY2xpcCgpO1xuICAgIH07XG4gICAgcmV0dXJuIEJhc2VSZW5kZXJMYXllcjtcbn0oKSk7XG5leHBvcnRzLkJhc2VSZW5kZXJMYXllciA9IEJhc2VSZW5kZXJMYXllcjtcblxuXG5cbn0se1wiLi4vQnVmZmVyXCI6MSxcIi4vQ2hhckF0bGFzXCI6MTl9XSwxOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBCcm93c2VyXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvQnJvd3NlclwiKTtcbmV4cG9ydHMuQ0hBUl9BVExBU19DRUxMX1NQQUNJTkcgPSAxO1xudmFyIGNoYXJBdGxhc0NhY2hlID0gW107XG5mdW5jdGlvbiBhY3F1aXJlQ2hhckF0bGFzKHRlcm1pbmFsLCBjb2xvcnMsIHNjYWxlZENoYXJXaWR0aCwgc2NhbGVkQ2hhckhlaWdodCkge1xuICAgIHZhciBuZXdDb25maWcgPSBnZW5lcmF0ZUNvbmZpZyhzY2FsZWRDaGFyV2lkdGgsIHNjYWxlZENoYXJIZWlnaHQsIHRlcm1pbmFsLCBjb2xvcnMpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckF0bGFzQ2FjaGUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gY2hhckF0bGFzQ2FjaGVbaV07XG4gICAgICAgIHZhciBvd25lZEJ5SW5kZXggPSBlbnRyeS5vd25lZEJ5LmluZGV4T2YodGVybWluYWwpO1xuICAgICAgICBpZiAob3duZWRCeUluZGV4ID49IDApIHtcbiAgICAgICAgICAgIGlmIChjb25maWdFcXVhbHMoZW50cnkuY29uZmlnLCBuZXdDb25maWcpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5LmJpdG1hcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5vd25lZEJ5Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyQXRsYXNDYWNoZS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlbnRyeS5vd25lZEJ5LnNwbGljZShvd25lZEJ5SW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJBdGxhc0NhY2hlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IGNoYXJBdGxhc0NhY2hlW2ldO1xuICAgICAgICBpZiAoY29uZmlnRXF1YWxzKGVudHJ5LmNvbmZpZywgbmV3Q29uZmlnKSkge1xuICAgICAgICAgICAgZW50cnkub3duZWRCeS5wdXNoKHRlcm1pbmFsKTtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeS5iaXRtYXA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIG5ld0VudHJ5ID0ge1xuICAgICAgICBiaXRtYXA6IGdlbmVyYXRvci5nZW5lcmF0ZShzY2FsZWRDaGFyV2lkdGgsIHNjYWxlZENoYXJIZWlnaHQsIHRlcm1pbmFsLm9wdGlvbnMuZm9udFNpemUsIHRlcm1pbmFsLm9wdGlvbnMuZm9udEZhbWlseSwgY29sb3JzLmJhY2tncm91bmQsIGNvbG9ycy5mb3JlZ3JvdW5kLCBjb2xvcnMuYW5zaSksXG4gICAgICAgIGNvbmZpZzogbmV3Q29uZmlnLFxuICAgICAgICBvd25lZEJ5OiBbdGVybWluYWxdXG4gICAgfTtcbiAgICBjaGFyQXRsYXNDYWNoZS5wdXNoKG5ld0VudHJ5KTtcbiAgICByZXR1cm4gbmV3RW50cnkuYml0bWFwO1xufVxuZXhwb3J0cy5hY3F1aXJlQ2hhckF0bGFzID0gYWNxdWlyZUNoYXJBdGxhcztcbmZ1bmN0aW9uIGdlbmVyYXRlQ29uZmlnKHNjYWxlZENoYXJXaWR0aCwgc2NhbGVkQ2hhckhlaWdodCwgdGVybWluYWwsIGNvbG9ycykge1xuICAgIHZhciBjbG9uZWRDb2xvcnMgPSB7XG4gICAgICAgIGZvcmVncm91bmQ6IGNvbG9ycy5mb3JlZ3JvdW5kLFxuICAgICAgICBiYWNrZ3JvdW5kOiBjb2xvcnMuYmFja2dyb3VuZCxcbiAgICAgICAgY3Vyc29yOiBudWxsLFxuICAgICAgICBjdXJzb3JBY2NlbnQ6IG51bGwsXG4gICAgICAgIHNlbGVjdGlvbjogbnVsbCxcbiAgICAgICAgYW5zaTogY29sb3JzLmFuc2kuc2xpY2UoMCwgMTYpXG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzY2FsZWRDaGFyV2lkdGg6IHNjYWxlZENoYXJXaWR0aCxcbiAgICAgICAgc2NhbGVkQ2hhckhlaWdodDogc2NhbGVkQ2hhckhlaWdodCxcbiAgICAgICAgZm9udEZhbWlseTogdGVybWluYWwub3B0aW9ucy5mb250RmFtaWx5LFxuICAgICAgICBmb250U2l6ZTogdGVybWluYWwub3B0aW9ucy5mb250U2l6ZSxcbiAgICAgICAgY29sb3JzOiBjbG9uZWRDb2xvcnNcbiAgICB9O1xufVxuZnVuY3Rpb24gY29uZmlnRXF1YWxzKGEsIGIpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGEuY29sb3JzLmFuc2kubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGEuY29sb3JzLmFuc2lbaV0gIT09IGIuY29sb3JzLmFuc2lbaV0pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYS5mb250RmFtaWx5ID09PSBiLmZvbnRGYW1pbHkgJiZcbiAgICAgICAgYS5mb250U2l6ZSA9PT0gYi5mb250U2l6ZSAmJlxuICAgICAgICBhLnNjYWxlZENoYXJXaWR0aCA9PT0gYi5zY2FsZWRDaGFyV2lkdGggJiZcbiAgICAgICAgYS5zY2FsZWRDaGFySGVpZ2h0ID09PSBiLnNjYWxlZENoYXJIZWlnaHQgJiZcbiAgICAgICAgYS5jb2xvcnMuZm9yZWdyb3VuZCA9PT0gYi5jb2xvcnMuZm9yZWdyb3VuZCAmJlxuICAgICAgICBhLmNvbG9ycy5iYWNrZ3JvdW5kID09PSBiLmNvbG9ycy5iYWNrZ3JvdW5kO1xufVxudmFyIGdlbmVyYXRvcjtcbmZ1bmN0aW9uIGluaXRpYWxpemUoZG9jdW1lbnQpIHtcbiAgICBpZiAoIWdlbmVyYXRvcikge1xuICAgICAgICBnZW5lcmF0b3IgPSBuZXcgQ2hhckF0bGFzR2VuZXJhdG9yKGRvY3VtZW50KTtcbiAgICB9XG59XG5leHBvcnRzLmluaXRpYWxpemUgPSBpbml0aWFsaXplO1xudmFyIENoYXJBdGxhc0dlbmVyYXRvciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2hhckF0bGFzR2VuZXJhdG9yKF9kb2N1bWVudCkge1xuICAgICAgICB0aGlzLl9kb2N1bWVudCA9IF9kb2N1bWVudDtcbiAgICAgICAgdGhpcy5fY2FudmFzID0gdGhpcy5fZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRoaXMuX2N0eCA9IHRoaXMuX2NhbnZhcy5nZXRDb250ZXh0KCcyZCcsIHsgYWxwaGE6IGZhbHNlIH0pO1xuICAgICAgICB0aGlzLl9jdHguc2NhbGUod2luZG93LmRldmljZVBpeGVsUmF0aW8sIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtcbiAgICB9XG4gICAgQ2hhckF0bGFzR2VuZXJhdG9yLnByb3RvdHlwZS5nZW5lcmF0ZSA9IGZ1bmN0aW9uIChzY2FsZWRDaGFyV2lkdGgsIHNjYWxlZENoYXJIZWlnaHQsIGZvbnRTaXplLCBmb250RmFtaWx5LCBiYWNrZ3JvdW5kLCBmb3JlZ3JvdW5kLCBhbnNpQ29sb3JzKSB7XG4gICAgICAgIHZhciBjZWxsV2lkdGggPSBzY2FsZWRDaGFyV2lkdGggKyBleHBvcnRzLkNIQVJfQVRMQVNfQ0VMTF9TUEFDSU5HO1xuICAgICAgICB2YXIgY2VsbEhlaWdodCA9IHNjYWxlZENoYXJIZWlnaHQgKyBleHBvcnRzLkNIQVJfQVRMQVNfQ0VMTF9TUEFDSU5HO1xuICAgICAgICB0aGlzLl9jYW52YXMud2lkdGggPSAyNTUgKiBjZWxsV2lkdGg7XG4gICAgICAgIHRoaXMuX2NhbnZhcy5oZWlnaHQgPSAoMiArIDE2KSAqIGNlbGxIZWlnaHQ7XG4gICAgICAgIHRoaXMuX2N0eC5maWxsU3R5bGUgPSBiYWNrZ3JvdW5kO1xuICAgICAgICB0aGlzLl9jdHguZmlsbFJlY3QoMCwgMCwgdGhpcy5fY2FudmFzLndpZHRoLCB0aGlzLl9jYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5fY3R4LnNhdmUoKTtcbiAgICAgICAgdGhpcy5fY3R4LmZpbGxTdHlsZSA9IGZvcmVncm91bmQ7XG4gICAgICAgIHRoaXMuX2N0eC5mb250ID0gZm9udFNpemUgKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyArIFwicHggXCIgKyBmb250RmFtaWx5O1xuICAgICAgICB0aGlzLl9jdHgudGV4dEJhc2VsaW5lID0gJ3RvcCc7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5zYXZlKCk7XG4gICAgICAgICAgICB0aGlzLl9jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICB0aGlzLl9jdHgucmVjdChpICogY2VsbFdpZHRoLCAwLCBjZWxsV2lkdGgsIGNlbGxIZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5fY3R4LmNsaXAoKTtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5maWxsVGV4dChTdHJpbmcuZnJvbUNoYXJDb2RlKGkpLCBpICogY2VsbFdpZHRoLCAwKTtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3R4LnNhdmUoKTtcbiAgICAgICAgdGhpcy5fY3R4LmZvbnQgPSBcImJvbGQgXCIgKyB0aGlzLl9jdHguZm9udDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5fY3R4LnNhdmUoKTtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5yZWN0KGkgKiBjZWxsV2lkdGgsIGNlbGxIZWlnaHQsIGNlbGxXaWR0aCwgY2VsbEhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLl9jdHguY2xpcCgpO1xuICAgICAgICAgICAgdGhpcy5fY3R4LmZpbGxUZXh0KFN0cmluZy5mcm9tQ2hhckNvZGUoaSksIGkgKiBjZWxsV2lkdGgsIGNlbGxIZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5fY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdHgucmVzdG9yZSgpO1xuICAgICAgICB0aGlzLl9jdHguZm9udCA9IGZvbnRTaXplICogd2luZG93LmRldmljZVBpeGVsUmF0aW8gKyBcInB4IFwiICsgZm9udEZhbWlseTtcbiAgICAgICAgZm9yICh2YXIgY29sb3JJbmRleCA9IDA7IGNvbG9ySW5kZXggPCAxNjsgY29sb3JJbmRleCsrKSB7XG4gICAgICAgICAgICBpZiAoY29sb3JJbmRleCA9PT0gOCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5mb250ID0gXCJib2xkIFwiICsgdGhpcy5fY3R4LmZvbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgeSA9IChjb2xvckluZGV4ICsgMikgKiBjZWxsSGVpZ2h0O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5yZWN0KGkgKiBjZWxsV2lkdGgsIHksIGNlbGxXaWR0aCwgY2VsbEhlaWdodCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3R4LmNsaXAoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gYW5zaUNvbG9yc1tjb2xvckluZGV4XTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdHguZmlsbFRleHQoU3RyaW5nLmZyb21DaGFyQ29kZShpKSwgaSAqIGNlbGxXaWR0aCwgeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdHgucmVzdG9yZSgpO1xuICAgICAgICBpZiAoISgnY3JlYXRlSW1hZ2VCaXRtYXAnIGluIHdpbmRvdykgfHwgQnJvd3Nlcl8xLmlzRmlyZWZveCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2NhbnZhcztcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhcyA9IHRoaXMuX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICAgICAgdGhpcy5fY3R4ID0gdGhpcy5fY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICAgICAgICB0aGlzLl9jdHguc2NhbGUod2luZG93LmRldmljZVBpeGVsUmF0aW8sIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoYXJBdGxhc0ltYWdlRGF0YSA9IHRoaXMuX2N0eC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5fY2FudmFzLndpZHRoLCB0aGlzLl9jYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgdmFyIHIgPSBwYXJzZUludChiYWNrZ3JvdW5kLnN1YnN0cigxLCAyKSwgMTYpO1xuICAgICAgICB2YXIgZyA9IHBhcnNlSW50KGJhY2tncm91bmQuc3Vic3RyKDMsIDIpLCAxNik7XG4gICAgICAgIHZhciBiID0gcGFyc2VJbnQoYmFja2dyb3VuZC5zdWJzdHIoNSwgMiksIDE2KTtcbiAgICAgICAgdGhpcy5fY2xlYXJDb2xvcihjaGFyQXRsYXNJbWFnZURhdGEsIHIsIGcsIGIpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IHdpbmRvdy5jcmVhdGVJbWFnZUJpdG1hcChjaGFyQXRsYXNJbWFnZURhdGEpO1xuICAgICAgICB0aGlzLl9jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuX2NhbnZhcy53aWR0aCwgdGhpcy5fY2FudmFzLmhlaWdodCk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgQ2hhckF0bGFzR2VuZXJhdG9yLnByb3RvdHlwZS5fY2xlYXJDb2xvciA9IGZ1bmN0aW9uIChpbWFnZURhdGEsIHIsIGcsIGIpIHtcbiAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgaW1hZ2VEYXRhLmRhdGEubGVuZ3RoOyBvZmZzZXQgKz0gNCkge1xuICAgICAgICAgICAgaWYgKGltYWdlRGF0YS5kYXRhW29mZnNldF0gPT09IHIgJiZcbiAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtvZmZzZXQgKyAxXSA9PT0gZyAmJlxuICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW29mZnNldCArIDJdID09PSBiKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbb2Zmc2V0ICsgM10gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ2hhckF0bGFzR2VuZXJhdG9yO1xufSgpKTtcblxuXG5cbn0se1wiLi4vdXRpbHMvQnJvd3NlclwiOjI4fV0sMjA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgREVGQVVMVF9GT1JFR1JPVU5EID0gJyNmZmZmZmYnO1xudmFyIERFRkFVTFRfQkFDS0dST1VORCA9ICcjMDAwMDAwJztcbnZhciBERUZBVUxUX0NVUlNPUiA9ICcjZmZmZmZmJztcbnZhciBERUZBVUxUX0NVUlNPUl9BQ0NFTlQgPSAnIzAwMDAwMCc7XG52YXIgREVGQVVMVF9TRUxFQ1RJT04gPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpJztcbmV4cG9ydHMuREVGQVVMVF9BTlNJX0NPTE9SUyA9IFtcbiAgICAnIzJlMzQzNicsXG4gICAgJyNjYzAwMDAnLFxuICAgICcjNGU5YTA2JyxcbiAgICAnI2M0YTAwMCcsXG4gICAgJyMzNDY1YTQnLFxuICAgICcjNzU1MDdiJyxcbiAgICAnIzA2OTg5YScsXG4gICAgJyNkM2Q3Y2YnLFxuICAgICcjNTU1NzUzJyxcbiAgICAnI2VmMjkyOScsXG4gICAgJyM4YWUyMzQnLFxuICAgICcjZmNlOTRmJyxcbiAgICAnIzcyOWZjZicsXG4gICAgJyNhZDdmYTgnLFxuICAgICcjMzRlMmUyJyxcbiAgICAnI2VlZWVlYydcbl07XG5mdW5jdGlvbiBnZW5lcmF0ZTI1NkNvbG9ycyhmaXJzdDE2Q29sb3JzKSB7XG4gICAgdmFyIGNvbG9ycyA9IGZpcnN0MTZDb2xvcnMuc2xpY2UoKTtcbiAgICB2YXIgdiA9IFsweDAwLCAweDVmLCAweDg3LCAweGFmLCAweGQ3LCAweGZmXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDIxNjsgaSsrKSB7XG4gICAgICAgIHZhciByID0gdG9QYWRkZWRIZXgodlsoaSAvIDM2KSAlIDYgfCAwXSk7XG4gICAgICAgIHZhciBnID0gdG9QYWRkZWRIZXgodlsoaSAvIDYpICUgNiB8IDBdKTtcbiAgICAgICAgdmFyIGIgPSB0b1BhZGRlZEhleCh2W2kgJSA2XSk7XG4gICAgICAgIGNvbG9ycy5wdXNoKFwiI1wiICsgciArIGcgKyBiKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNDsgaSsrKSB7XG4gICAgICAgIHZhciBjID0gdG9QYWRkZWRIZXgoOCArIGkgKiAxMCk7XG4gICAgICAgIGNvbG9ycy5wdXNoKFwiI1wiICsgYyArIGMgKyBjKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbG9ycztcbn1cbmZ1bmN0aW9uIHRvUGFkZGVkSGV4KGMpIHtcbiAgICB2YXIgcyA9IGMudG9TdHJpbmcoMTYpO1xuICAgIHJldHVybiBzLmxlbmd0aCA8IDIgPyAnMCcgKyBzIDogcztcbn1cbnZhciBDb2xvck1hbmFnZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvbG9yTWFuYWdlcigpIHtcbiAgICAgICAgdGhpcy5jb2xvcnMgPSB7XG4gICAgICAgICAgICBmb3JlZ3JvdW5kOiBERUZBVUxUX0ZPUkVHUk9VTkQsXG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiBERUZBVUxUX0JBQ0tHUk9VTkQsXG4gICAgICAgICAgICBjdXJzb3I6IERFRkFVTFRfQ1VSU09SLFxuICAgICAgICAgICAgY3Vyc29yQWNjZW50OiBERUZBVUxUX0NVUlNPUl9BQ0NFTlQsXG4gICAgICAgICAgICBzZWxlY3Rpb246IERFRkFVTFRfU0VMRUNUSU9OLFxuICAgICAgICAgICAgYW5zaTogZ2VuZXJhdGUyNTZDb2xvcnMoZXhwb3J0cy5ERUZBVUxUX0FOU0lfQ09MT1JTKVxuICAgICAgICB9O1xuICAgIH1cbiAgICBDb2xvck1hbmFnZXIucHJvdG90eXBlLnNldFRoZW1lID0gZnVuY3Rpb24gKHRoZW1lKSB7XG4gICAgICAgIHRoaXMuY29sb3JzLmZvcmVncm91bmQgPSB0aGVtZS5mb3JlZ3JvdW5kIHx8IERFRkFVTFRfRk9SRUdST1VORDtcbiAgICAgICAgdGhpcy5jb2xvcnMuYmFja2dyb3VuZCA9IHRoaXMuX3ZhbGlkYXRlQ29sb3IodGhlbWUuYmFja2dyb3VuZCwgREVGQVVMVF9CQUNLR1JPVU5EKTtcbiAgICAgICAgdGhpcy5jb2xvcnMuY3Vyc29yID0gdGhlbWUuY3Vyc29yIHx8IERFRkFVTFRfQ1VSU09SO1xuICAgICAgICB0aGlzLmNvbG9ycy5jdXJzb3JBY2NlbnQgPSB0aGVtZS5jdXJzb3JBY2NlbnQgfHwgREVGQVVMVF9DVVJTT1JfQUNDRU5UO1xuICAgICAgICB0aGlzLmNvbG9ycy5zZWxlY3Rpb24gPSB0aGVtZS5zZWxlY3Rpb24gfHwgREVGQVVMVF9TRUxFQ1RJT047XG4gICAgICAgIHRoaXMuY29sb3JzLmFuc2lbMF0gPSB0aGVtZS5ibGFjayB8fCBleHBvcnRzLkRFRkFVTFRfQU5TSV9DT0xPUlNbMF07XG4gICAgICAgIHRoaXMuY29sb3JzLmFuc2lbMV0gPSB0aGVtZS5yZWQgfHwgZXhwb3J0cy5ERUZBVUxUX0FOU0lfQ09MT1JTWzFdO1xuICAgICAgICB0aGlzLmNvbG9ycy5hbnNpWzJdID0gdGhlbWUuZ3JlZW4gfHwgZXhwb3J0cy5ERUZBVUxUX0FOU0lfQ09MT1JTWzJdO1xuICAgICAgICB0aGlzLmNvbG9ycy5hbnNpWzNdID0gdGhlbWUueWVsbG93IHx8IGV4cG9ydHMuREVGQVVMVF9BTlNJX0NPTE9SU1szXTtcbiAgICAgICAgdGhpcy5jb2xvcnMuYW5zaVs0XSA9IHRoZW1lLmJsdWUgfHwgZXhwb3J0cy5ERUZBVUxUX0FOU0lfQ09MT1JTWzRdO1xuICAgICAgICB0aGlzLmNvbG9ycy5hbnNpWzVdID0gdGhlbWUubWFnZW50YSB8fCBleHBvcnRzLkRFRkFVTFRfQU5TSV9DT0xPUlNbNV07XG4gICAgICAgIHRoaXMuY29sb3JzLmFuc2lbNl0gPSB0aGVtZS5jeWFuIHx8IGV4cG9ydHMuREVGQVVMVF9BTlNJX0NPTE9SU1s2XTtcbiAgICAgICAgdGhpcy5jb2xvcnMuYW5zaVs3XSA9IHRoZW1lLndoaXRlIHx8IGV4cG9ydHMuREVGQVVMVF9BTlNJX0NPTE9SU1s3XTtcbiAgICAgICAgdGhpcy5jb2xvcnMuYW5zaVs4XSA9IHRoZW1lLmJyaWdodEJsYWNrIHx8IGV4cG9ydHMuREVGQVVMVF9BTlNJX0NPTE9SU1s4XTtcbiAgICAgICAgdGhpcy5jb2xvcnMuYW5zaVs5XSA9IHRoZW1lLmJyaWdodFJlZCB8fCBleHBvcnRzLkRFRkFVTFRfQU5TSV9DT0xPUlNbOV07XG4gICAgICAgIHRoaXMuY29sb3JzLmFuc2lbMTBdID0gdGhlbWUuYnJpZ2h0R3JlZW4gfHwgZXhwb3J0cy5ERUZBVUxUX0FOU0lfQ09MT1JTWzEwXTtcbiAgICAgICAgdGhpcy5jb2xvcnMuYW5zaVsxMV0gPSB0aGVtZS5icmlnaHRZZWxsb3cgfHwgZXhwb3J0cy5ERUZBVUxUX0FOU0lfQ09MT1JTWzExXTtcbiAgICAgICAgdGhpcy5jb2xvcnMuYW5zaVsxMl0gPSB0aGVtZS5icmlnaHRCbHVlIHx8IGV4cG9ydHMuREVGQVVMVF9BTlNJX0NPTE9SU1sxMl07XG4gICAgICAgIHRoaXMuY29sb3JzLmFuc2lbMTNdID0gdGhlbWUuYnJpZ2h0TWFnZW50YSB8fCBleHBvcnRzLkRFRkFVTFRfQU5TSV9DT0xPUlNbMTNdO1xuICAgICAgICB0aGlzLmNvbG9ycy5hbnNpWzE0XSA9IHRoZW1lLmJyaWdodEN5YW4gfHwgZXhwb3J0cy5ERUZBVUxUX0FOU0lfQ09MT1JTWzE0XTtcbiAgICAgICAgdGhpcy5jb2xvcnMuYW5zaVsxNV0gPSB0aGVtZS5icmlnaHRXaGl0ZSB8fCBleHBvcnRzLkRFRkFVTFRfQU5TSV9DT0xPUlNbMTVdO1xuICAgIH07XG4gICAgQ29sb3JNYW5hZ2VyLnByb3RvdHlwZS5fdmFsaWRhdGVDb2xvciA9IGZ1bmN0aW9uIChjb2xvciwgZmFsbGJhY2spIHtcbiAgICAgICAgaWYgKCFjb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbGxiYWNrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2xvci5sZW5ndGggPT09IDcgJiYgY29sb3IuY2hhckF0KDApID09PSAnIycpIHtcbiAgICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sb3IubGVuZ3RoID09PSA0ICYmIGNvbG9yLmNoYXJBdCgwKSA9PT0gJyMnKSB7XG4gICAgICAgICAgICB2YXIgciA9IGNvbG9yLmNoYXJBdCgxKTtcbiAgICAgICAgICAgIHZhciBnID0gY29sb3IuY2hhckF0KDIpO1xuICAgICAgICAgICAgdmFyIGIgPSBjb2xvci5jaGFyQXQoMyk7XG4gICAgICAgICAgICByZXR1cm4gXCIjXCIgKyByICsgciArIGcgKyBnICsgYiArIGI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbGxiYWNrO1xuICAgIH07XG4gICAgcmV0dXJuIENvbG9yTWFuYWdlcjtcbn0oKSk7XG5leHBvcnRzLkNvbG9yTWFuYWdlciA9IENvbG9yTWFuYWdlcjtcblxuXG5cbn0se31dLDIxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQnVmZmVyXzEgPSByZXF1aXJlKFwiLi4vQnVmZmVyXCIpO1xudmFyIEJhc2VSZW5kZXJMYXllcl8xID0gcmVxdWlyZShcIi4vQmFzZVJlbmRlckxheWVyXCIpO1xudmFyIEJMSU5LX0lOVEVSVkFMID0gNjAwO1xudmFyIEN1cnNvclJlbmRlckxheWVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ3Vyc29yUmVuZGVyTGF5ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ3Vyc29yUmVuZGVyTGF5ZXIoY29udGFpbmVyLCB6SW5kZXgsIGNvbG9ycykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBjb250YWluZXIsICdjdXJzb3InLCB6SW5kZXgsIHRydWUsIGNvbG9ycykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3N0YXRlID0ge1xuICAgICAgICAgICAgeDogbnVsbCxcbiAgICAgICAgICAgIHk6IG51bGwsXG4gICAgICAgICAgICBpc0ZvY3VzZWQ6IG51bGwsXG4gICAgICAgICAgICBzdHlsZTogbnVsbCxcbiAgICAgICAgICAgIHdpZHRoOiBudWxsLFxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5fY3Vyc29yUmVuZGVyZXJzID0ge1xuICAgICAgICAgICAgJ2Jhcic6IF90aGlzLl9yZW5kZXJCYXJDdXJzb3IuYmluZChfdGhpcyksXG4gICAgICAgICAgICAnYmxvY2snOiBfdGhpcy5fcmVuZGVyQmxvY2tDdXJzb3IuYmluZChfdGhpcyksXG4gICAgICAgICAgICAndW5kZXJsaW5lJzogX3RoaXMuX3JlbmRlclVuZGVybGluZUN1cnNvci5iaW5kKF90aGlzKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEN1cnNvclJlbmRlckxheWVyLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbiAodGVybWluYWwsIGRpbSwgY2hhclNpemVDaGFuZ2VkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzaXplLmNhbGwodGhpcywgdGVybWluYWwsIGRpbSwgY2hhclNpemVDaGFuZ2VkKTtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSB7XG4gICAgICAgICAgICB4OiBudWxsLFxuICAgICAgICAgICAgeTogbnVsbCxcbiAgICAgICAgICAgIGlzRm9jdXNlZDogbnVsbCxcbiAgICAgICAgICAgIHN0eWxlOiBudWxsLFxuICAgICAgICAgICAgd2lkdGg6IG51bGwsXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBDdXJzb3JSZW5kZXJMYXllci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAodGVybWluYWwpIHtcbiAgICAgICAgdGhpcy5fY2xlYXJDdXJzb3IoKTtcbiAgICAgICAgaWYgKHRoaXMuX2N1cnNvckJsaW5rU3RhdGVNYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlci5kaXNwb3NlKCk7XG4gICAgICAgICAgICB0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLm9uT3B0aW9uc0NoYW5nZWQodGVybWluYWwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDdXJzb3JSZW5kZXJMYXllci5wcm90b3R5cGUub25CbHVyID0gZnVuY3Rpb24gKHRlcm1pbmFsKSB7XG4gICAgICAgIGlmICh0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5fY3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIucGF1c2UoKTtcbiAgICAgICAgfVxuICAgICAgICB0ZXJtaW5hbC5yZWZyZXNoKHRlcm1pbmFsLmJ1ZmZlci55LCB0ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgfTtcbiAgICBDdXJzb3JSZW5kZXJMYXllci5wcm90b3R5cGUub25Gb2N1cyA9IGZ1bmN0aW9uICh0ZXJtaW5hbCkge1xuICAgICAgICBpZiAodGhpcy5fY3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2N1cnNvckJsaW5rU3RhdGVNYW5hZ2VyLnJlc3VtZSh0ZXJtaW5hbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0ZXJtaW5hbC5yZWZyZXNoKHRlcm1pbmFsLmJ1ZmZlci55LCB0ZXJtaW5hbC5idWZmZXIueSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEN1cnNvclJlbmRlckxheWVyLnByb3RvdHlwZS5vbk9wdGlvbnNDaGFuZ2VkID0gZnVuY3Rpb24gKHRlcm1pbmFsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0ZXJtaW5hbC5vcHRpb25zLmN1cnNvckJsaW5rKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2N1cnNvckJsaW5rU3RhdGVNYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIgPSBuZXcgQ3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIodGVybWluYWwsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3JlbmRlcih0ZXJtaW5hbCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlci5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGVybWluYWwucmVmcmVzaCh0ZXJtaW5hbC5idWZmZXIueSwgdGVybWluYWwuYnVmZmVyLnkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDdXJzb3JSZW5kZXJMYXllci5wcm90b3R5cGUub25DdXJzb3JNb3ZlID0gZnVuY3Rpb24gKHRlcm1pbmFsKSB7XG4gICAgICAgIGlmICh0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5fY3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIucmVzdGFydEJsaW5rQW5pbWF0aW9uKHRlcm1pbmFsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3Vyc29yUmVuZGVyTGF5ZXIucHJvdG90eXBlLm9uR3JpZENoYW5nZWQgPSBmdW5jdGlvbiAodGVybWluYWwsIHN0YXJ0Um93LCBlbmRSb3cpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlciB8fCB0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlci5pc1BhdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyKHRlcm1pbmFsLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEN1cnNvclJlbmRlckxheWVyLnByb3RvdHlwZS5fcmVuZGVyID0gZnVuY3Rpb24gKHRlcm1pbmFsLCB0cmlnZ2VyZWRCeUFuaW1hdGlvbkZyYW1lKSB7XG4gICAgICAgIGlmICghdGVybWluYWwuY3Vyc29yU3RhdGUgfHwgdGVybWluYWwuY3Vyc29ySGlkZGVuKSB7XG4gICAgICAgICAgICB0aGlzLl9jbGVhckN1cnNvcigpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjdXJzb3JZID0gdGVybWluYWwuYnVmZmVyLnliYXNlICsgdGVybWluYWwuYnVmZmVyLnk7XG4gICAgICAgIHZhciB2aWV3cG9ydFJlbGF0aXZlQ3Vyc29yWSA9IGN1cnNvclkgLSB0ZXJtaW5hbC5idWZmZXIueWRpc3A7XG4gICAgICAgIGlmICh2aWV3cG9ydFJlbGF0aXZlQ3Vyc29yWSA8IDAgfHwgdmlld3BvcnRSZWxhdGl2ZUN1cnNvclkgPj0gdGVybWluYWwucm93cykge1xuICAgICAgICAgICAgdGhpcy5fY2xlYXJDdXJzb3IoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhckRhdGEgPSB0ZXJtaW5hbC5idWZmZXIubGluZXMuZ2V0KGN1cnNvclkpW3Rlcm1pbmFsLmJ1ZmZlci54XTtcbiAgICAgICAgaWYgKCFjaGFyRGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGVybWluYWwuaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICB0aGlzLl9jbGVhckN1cnNvcigpO1xuICAgICAgICAgICAgdGhpcy5fY3R4LnNhdmUoKTtcbiAgICAgICAgICAgIHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcnMuY3Vyc29yO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyQmx1ckN1cnNvcih0ZXJtaW5hbCwgdGVybWluYWwuYnVmZmVyLngsIHZpZXdwb3J0UmVsYXRpdmVDdXJzb3JZLCBjaGFyRGF0YSk7XG4gICAgICAgICAgICB0aGlzLl9jdHgucmVzdG9yZSgpO1xuICAgICAgICAgICAgdGhpcy5fc3RhdGUueCA9IHRlcm1pbmFsLmJ1ZmZlci54O1xuICAgICAgICAgICAgdGhpcy5fc3RhdGUueSA9IHZpZXdwb3J0UmVsYXRpdmVDdXJzb3JZO1xuICAgICAgICAgICAgdGhpcy5fc3RhdGUuaXNGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9zdGF0ZS5zdHlsZSA9IHRlcm1pbmFsLm9wdGlvbnMuY3Vyc29yU3R5bGU7XG4gICAgICAgICAgICB0aGlzLl9zdGF0ZS53aWR0aCA9IGNoYXJEYXRhW0J1ZmZlcl8xLkNIQVJfREFUQV9XSURUSF9JTkRFWF07XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2N1cnNvckJsaW5rU3RhdGVNYW5hZ2VyICYmICF0aGlzLl9jdXJzb3JCbGlua1N0YXRlTWFuYWdlci5pc0N1cnNvclZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ3Vyc29yKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGUueCA9PT0gdGVybWluYWwuYnVmZmVyLnggJiZcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZS55ID09PSB2aWV3cG9ydFJlbGF0aXZlQ3Vyc29yWSAmJlxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlLmlzRm9jdXNlZCA9PT0gdGVybWluYWwuaXNGb2N1c2VkICYmXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUuc3R5bGUgPT09IHRlcm1pbmFsLm9wdGlvbnMuY3Vyc29yU3R5bGUgJiZcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZS53aWR0aCA9PT0gY2hhckRhdGFbQnVmZmVyXzEuQ0hBUl9EQVRBX1dJRFRIX0lOREVYXSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ3Vyc29yKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3R4LnNhdmUoKTtcbiAgICAgICAgdGhpcy5fY3Vyc29yUmVuZGVyZXJzW3Rlcm1pbmFsLm9wdGlvbnMuY3Vyc29yU3R5bGUgfHwgJ2Jsb2NrJ10odGVybWluYWwsIHRlcm1pbmFsLmJ1ZmZlci54LCB2aWV3cG9ydFJlbGF0aXZlQ3Vyc29yWSwgY2hhckRhdGEpO1xuICAgICAgICB0aGlzLl9jdHgucmVzdG9yZSgpO1xuICAgICAgICB0aGlzLl9zdGF0ZS54ID0gdGVybWluYWwuYnVmZmVyLng7XG4gICAgICAgIHRoaXMuX3N0YXRlLnkgPSB2aWV3cG9ydFJlbGF0aXZlQ3Vyc29yWTtcbiAgICAgICAgdGhpcy5fc3RhdGUuaXNGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3N0YXRlLnN0eWxlID0gdGVybWluYWwub3B0aW9ucy5jdXJzb3JTdHlsZTtcbiAgICAgICAgdGhpcy5fc3RhdGUud2lkdGggPSBjaGFyRGF0YVtCdWZmZXJfMS5DSEFSX0RBVEFfV0lEVEhfSU5ERVhdO1xuICAgIH07XG4gICAgQ3Vyc29yUmVuZGVyTGF5ZXIucHJvdG90eXBlLl9jbGVhckN1cnNvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyQ2VsbHModGhpcy5fc3RhdGUueCwgdGhpcy5fc3RhdGUueSwgdGhpcy5fc3RhdGUud2lkdGgsIDEpO1xuICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgeDogbnVsbCxcbiAgICAgICAgICAgICAgICB5OiBudWxsLFxuICAgICAgICAgICAgICAgIGlzRm9jdXNlZDogbnVsbCxcbiAgICAgICAgICAgICAgICBzdHlsZTogbnVsbCxcbiAgICAgICAgICAgICAgICB3aWR0aDogbnVsbCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEN1cnNvclJlbmRlckxheWVyLnByb3RvdHlwZS5fcmVuZGVyQmFyQ3Vyc29yID0gZnVuY3Rpb24gKHRlcm1pbmFsLCB4LCB5LCBjaGFyRGF0YSkge1xuICAgICAgICB0aGlzLl9jdHguc2F2ZSgpO1xuICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmN1cnNvcjtcbiAgICAgICAgdGhpcy5maWxsTGVmdExpbmVBdENlbGwoeCwgeSk7XG4gICAgICAgIHRoaXMuX2N0eC5yZXN0b3JlKCk7XG4gICAgfTtcbiAgICBDdXJzb3JSZW5kZXJMYXllci5wcm90b3R5cGUuX3JlbmRlckJsb2NrQ3Vyc29yID0gZnVuY3Rpb24gKHRlcm1pbmFsLCB4LCB5LCBjaGFyRGF0YSkge1xuICAgICAgICB0aGlzLl9jdHguc2F2ZSgpO1xuICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmN1cnNvcjtcbiAgICAgICAgdGhpcy5maWxsQ2VsbHMoeCwgeSwgY2hhckRhdGFbQnVmZmVyXzEuQ0hBUl9EQVRBX1dJRFRIX0lOREVYXSwgMSk7XG4gICAgICAgIHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcnMuY3Vyc29yQWNjZW50O1xuICAgICAgICB0aGlzLmZpbGxDaGFyVHJ1ZUNvbG9yKHRlcm1pbmFsLCBjaGFyRGF0YSwgeCwgeSk7XG4gICAgICAgIHRoaXMuX2N0eC5yZXN0b3JlKCk7XG4gICAgfTtcbiAgICBDdXJzb3JSZW5kZXJMYXllci5wcm90b3R5cGUuX3JlbmRlclVuZGVybGluZUN1cnNvciA9IGZ1bmN0aW9uICh0ZXJtaW5hbCwgeCwgeSwgY2hhckRhdGEpIHtcbiAgICAgICAgdGhpcy5fY3R4LnNhdmUoKTtcbiAgICAgICAgdGhpcy5fY3R4LmZpbGxTdHlsZSA9IHRoaXMuX2NvbG9ycy5jdXJzb3I7XG4gICAgICAgIHRoaXMuZmlsbEJvdHRvbUxpbmVBdENlbGxzKHgsIHkpO1xuICAgICAgICB0aGlzLl9jdHgucmVzdG9yZSgpO1xuICAgIH07XG4gICAgQ3Vyc29yUmVuZGVyTGF5ZXIucHJvdG90eXBlLl9yZW5kZXJCbHVyQ3Vyc29yID0gZnVuY3Rpb24gKHRlcm1pbmFsLCB4LCB5LCBjaGFyRGF0YSkge1xuICAgICAgICB0aGlzLl9jdHguc2F2ZSgpO1xuICAgICAgICB0aGlzLl9jdHguc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcnMuY3Vyc29yO1xuICAgICAgICB0aGlzLnN0cm9rZVJlY3RBdENlbGwoeCwgeSwgY2hhckRhdGFbQnVmZmVyXzEuQ0hBUl9EQVRBX1dJRFRIX0lOREVYXSwgMSk7XG4gICAgICAgIHRoaXMuX2N0eC5yZXN0b3JlKCk7XG4gICAgfTtcbiAgICByZXR1cm4gQ3Vyc29yUmVuZGVyTGF5ZXI7XG59KEJhc2VSZW5kZXJMYXllcl8xLkJhc2VSZW5kZXJMYXllcikpO1xuZXhwb3J0cy5DdXJzb3JSZW5kZXJMYXllciA9IEN1cnNvclJlbmRlckxheWVyO1xudmFyIEN1cnNvckJsaW5rU3RhdGVNYW5hZ2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDdXJzb3JCbGlua1N0YXRlTWFuYWdlcih0ZXJtaW5hbCwgcmVuZGVyQ2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5yZW5kZXJDYWxsYmFjayA9IHJlbmRlckNhbGxiYWNrO1xuICAgICAgICB0aGlzLmlzQ3Vyc29yVmlzaWJsZSA9IHRydWU7XG4gICAgICAgIGlmICh0ZXJtaW5hbC5pc0ZvY3VzZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3RhcnRJbnRlcnZhbCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDdXJzb3JCbGlua1N0YXRlTWFuYWdlci5wcm90b3R5cGUsIFwiaXNQYXVzZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICEodGhpcy5fYmxpbmtTdGFydFRpbWVvdXQgfHwgdGhpcy5fYmxpbmtJbnRlcnZhbCk7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEN1cnNvckJsaW5rU3RhdGVNYW5hZ2VyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYmxpbmtJbnRlcnZhbCkge1xuICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5fYmxpbmtJbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLl9ibGlua0ludGVydmFsID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fYmxpbmtTdGFydFRpbWVvdXQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fYmxpbmtTdGFydFRpbWVvdXQpO1xuICAgICAgICAgICAgdGhpcy5fYmxpbmtTdGFydFRpbWVvdXQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9hbmltYXRpb25GcmFtZSkge1xuICAgICAgICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuX2FuaW1hdGlvbkZyYW1lKTtcbiAgICAgICAgICAgIHRoaXMuX2FuaW1hdGlvbkZyYW1lID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXIucHJvdG90eXBlLnJlc3RhcnRCbGlua0FuaW1hdGlvbiA9IGZ1bmN0aW9uICh0ZXJtaW5hbCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5pc1BhdXNlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FuaW1hdGlvblRpbWVSZXN0YXJ0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICB0aGlzLmlzQ3Vyc29yVmlzaWJsZSA9IHRydWU7XG4gICAgICAgIGlmICghdGhpcy5fYW5pbWF0aW9uRnJhbWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2FuaW1hdGlvbkZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucmVuZGVyQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5fYW5pbWF0aW9uRnJhbWUgPSBudWxsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEN1cnNvckJsaW5rU3RhdGVNYW5hZ2VyLnByb3RvdHlwZS5fcmVzdGFydEludGVydmFsID0gZnVuY3Rpb24gKHRpbWVUb1N0YXJ0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aW1lVG9TdGFydCA9PT0gdm9pZCAwKSB7IHRpbWVUb1N0YXJ0ID0gQkxJTktfSU5URVJWQUw7IH1cbiAgICAgICAgaWYgKHRoaXMuX2JsaW5rSW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX2JsaW5rSW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2JsaW5rU3RhcnRUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuX2FuaW1hdGlvblRpbWVSZXN0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IEJMSU5LX0lOVEVSVkFMIC0gKERhdGUubm93KCkgLSBfdGhpcy5fYW5pbWF0aW9uVGltZVJlc3RhcnRlZCk7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2FuaW1hdGlvblRpbWVSZXN0YXJ0ZWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmICh0aW1lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fcmVzdGFydEludGVydmFsKHRpbWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuaXNDdXJzb3JWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy5fYW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5yZW5kZXJDYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIF90aGlzLl9hbmltYXRpb25GcmFtZSA9IG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF90aGlzLl9ibGlua0ludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fYW5pbWF0aW9uVGltZVJlc3RhcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGltZSA9IEJMSU5LX0lOVEVSVkFMIC0gKERhdGUubm93KCkgLSBfdGhpcy5fYW5pbWF0aW9uVGltZVJlc3RhcnRlZCk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9hbmltYXRpb25UaW1lUmVzdGFydGVkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3Jlc3RhcnRJbnRlcnZhbCh0aW1lKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5pc0N1cnNvclZpc2libGUgPSAhX3RoaXMuaXNDdXJzb3JWaXNpYmxlO1xuICAgICAgICAgICAgICAgIF90aGlzLl9hbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW5kZXJDYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYW5pbWF0aW9uRnJhbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgQkxJTktfSU5URVJWQUwpO1xuICAgICAgICB9LCB0aW1lVG9TdGFydCk7XG4gICAgfTtcbiAgICBDdXJzb3JCbGlua1N0YXRlTWFuYWdlci5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNDdXJzb3JWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuX2JsaW5rSW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX2JsaW5rSW50ZXJ2YWwpO1xuICAgICAgICAgICAgdGhpcy5fYmxpbmtJbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2JsaW5rU3RhcnRUaW1lb3V0KSB7XG4gICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuX2JsaW5rU3RhcnRUaW1lb3V0KTtcbiAgICAgICAgICAgIHRoaXMuX2JsaW5rU3RhcnRUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fYW5pbWF0aW9uRnJhbWUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl9hbmltYXRpb25GcmFtZSk7XG4gICAgICAgICAgICB0aGlzLl9hbmltYXRpb25GcmFtZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEN1cnNvckJsaW5rU3RhdGVNYW5hZ2VyLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAodGVybWluYWwpIHtcbiAgICAgICAgdGhpcy5fYW5pbWF0aW9uVGltZVJlc3RhcnRlZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3Jlc3RhcnRJbnRlcnZhbCgpO1xuICAgICAgICB0aGlzLnJlc3RhcnRCbGlua0FuaW1hdGlvbih0ZXJtaW5hbCk7XG4gICAgfTtcbiAgICByZXR1cm4gQ3Vyc29yQmxpbmtTdGF0ZU1hbmFnZXI7XG59KCkpO1xuXG5cblxufSx7XCIuLi9CdWZmZXJcIjoxLFwiLi9CYXNlUmVuZGVyTGF5ZXJcIjoxOH1dLDIyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEdyaWRDYWNoZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gR3JpZENhY2hlKCkge1xuICAgICAgICB0aGlzLmNhY2hlID0gW107XG4gICAgfVxuICAgIEdyaWRDYWNoZS5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYWNoZS5sZW5ndGggPD0geCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUucHVzaChbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciB5ID0gdGhpcy5jYWNoZVt4XS5sZW5ndGg7IHkgPCBoZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVbeF0ucHVzaChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2FjaGVbeF0ubGVuZ3RoID0gaGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2FjaGUubGVuZ3RoID0gd2lkdGg7XG4gICAgfTtcbiAgICBHcmlkQ2FjaGUucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHRoaXMuY2FjaGUubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgdGhpcy5jYWNoZVt4XS5sZW5ndGg7IHkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVbeF1beV0gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gR3JpZENhY2hlO1xufSgpKTtcbmV4cG9ydHMuR3JpZENhY2hlID0gR3JpZENhY2hlO1xuXG5cblxufSx7fV0sMjM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBCYXNlUmVuZGVyTGF5ZXJfMSA9IHJlcXVpcmUoXCIuL0Jhc2VSZW5kZXJMYXllclwiKTtcbnZhciBUeXBlc18xID0gcmVxdWlyZShcIi4uL1R5cGVzXCIpO1xudmFyIExpbmtSZW5kZXJMYXllciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExpbmtSZW5kZXJMYXllciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaW5rUmVuZGVyTGF5ZXIoY29udGFpbmVyLCB6SW5kZXgsIGNvbG9ycywgdGVybWluYWwpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgY29udGFpbmVyLCAnbGluaycsIHpJbmRleCwgdHJ1ZSwgY29sb3JzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fc3RhdGUgPSBudWxsO1xuICAgICAgICB0ZXJtaW5hbC5saW5raWZpZXIub24oVHlwZXNfMS5MaW5rSG92ZXJFdmVudFR5cGVzLkhPVkVSLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuX29uTGlua0hvdmVyKGUpOyB9KTtcbiAgICAgICAgdGVybWluYWwubGlua2lmaWVyLm9uKFR5cGVzXzEuTGlua0hvdmVyRXZlbnRUeXBlcy5MRUFWRSwgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLl9vbkxpbmtMZWF2ZShlKTsgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgTGlua1JlbmRlckxheWVyLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbiAodGVybWluYWwsIGRpbSwgY2hhclNpemVDaGFuZ2VkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzaXplLmNhbGwodGhpcywgdGVybWluYWwsIGRpbSwgY2hhclNpemVDaGFuZ2VkKTtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBudWxsO1xuICAgIH07XG4gICAgTGlua1JlbmRlckxheWVyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICh0ZXJtaW5hbCkge1xuICAgICAgICB0aGlzLl9jbGVhckN1cnJlbnRMaW5rKCk7XG4gICAgfTtcbiAgICBMaW5rUmVuZGVyTGF5ZXIucHJvdG90eXBlLl9jbGVhckN1cnJlbnRMaW5rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fc3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDZWxscyh0aGlzLl9zdGF0ZS54LCB0aGlzLl9zdGF0ZS55LCB0aGlzLl9zdGF0ZS5sZW5ndGgsIDEpO1xuICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaW5rUmVuZGVyTGF5ZXIucHJvdG90eXBlLl9vbkxpbmtIb3ZlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcnMuZm9yZWdyb3VuZDtcbiAgICAgICAgdGhpcy5maWxsQm90dG9tTGluZUF0Q2VsbHMoZS54LCBlLnksIGUubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBlO1xuICAgIH07XG4gICAgTGlua1JlbmRlckxheWVyLnByb3RvdHlwZS5fb25MaW5rTGVhdmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLl9jbGVhckN1cnJlbnRMaW5rKCk7XG4gICAgfTtcbiAgICByZXR1cm4gTGlua1JlbmRlckxheWVyO1xufShCYXNlUmVuZGVyTGF5ZXJfMS5CYXNlUmVuZGVyTGF5ZXIpKTtcbmV4cG9ydHMuTGlua1JlbmRlckxheWVyID0gTGlua1JlbmRlckxheWVyO1xuXG5cblxufSx7XCIuLi9UeXBlc1wiOjE0LFwiLi9CYXNlUmVuZGVyTGF5ZXJcIjoxOH1dLDI0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgVGV4dFJlbmRlckxheWVyXzEgPSByZXF1aXJlKFwiLi9UZXh0UmVuZGVyTGF5ZXJcIik7XG52YXIgU2VsZWN0aW9uUmVuZGVyTGF5ZXJfMSA9IHJlcXVpcmUoXCIuL1NlbGVjdGlvblJlbmRlckxheWVyXCIpO1xudmFyIEN1cnNvclJlbmRlckxheWVyXzEgPSByZXF1aXJlKFwiLi9DdXJzb3JSZW5kZXJMYXllclwiKTtcbnZhciBDb2xvck1hbmFnZXJfMSA9IHJlcXVpcmUoXCIuL0NvbG9yTWFuYWdlclwiKTtcbnZhciBMaW5rUmVuZGVyTGF5ZXJfMSA9IHJlcXVpcmUoXCIuL0xpbmtSZW5kZXJMYXllclwiKTtcbnZhciBFdmVudEVtaXR0ZXJfMSA9IHJlcXVpcmUoXCIuLi9FdmVudEVtaXR0ZXJcIik7XG52YXIgU2NyZWVuRHByTW9uaXRvcl8xID0gcmVxdWlyZShcIi4uL3V0aWxzL1NjcmVlbkRwck1vbml0b3JcIik7XG52YXIgUmVuZGVyZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhSZW5kZXJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSZW5kZXJlcihfdGVybWluYWwsIHRoZW1lKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl90ZXJtaW5hbCA9IF90ZXJtaW5hbDtcbiAgICAgICAgX3RoaXMuX3JlZnJlc2hSb3dzUXVldWUgPSBbXTtcbiAgICAgICAgX3RoaXMuX3JlZnJlc2hBbmltYXRpb25GcmFtZSA9IG51bGw7XG4gICAgICAgIF90aGlzLl9pc1BhdXNlZCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fbmVlZHNGdWxsUmVmcmVzaCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5jb2xvck1hbmFnZXIgPSBuZXcgQ29sb3JNYW5hZ2VyXzEuQ29sb3JNYW5hZ2VyKCk7XG4gICAgICAgIGlmICh0aGVtZSkge1xuICAgICAgICAgICAgX3RoaXMuY29sb3JNYW5hZ2VyLnNldFRoZW1lKHRoZW1lKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5fcmVuZGVyTGF5ZXJzID0gW1xuICAgICAgICAgICAgbmV3IFRleHRSZW5kZXJMYXllcl8xLlRleHRSZW5kZXJMYXllcihfdGhpcy5fdGVybWluYWwuZWxlbWVudCwgMCwgX3RoaXMuY29sb3JNYW5hZ2VyLmNvbG9ycyksXG4gICAgICAgICAgICBuZXcgU2VsZWN0aW9uUmVuZGVyTGF5ZXJfMS5TZWxlY3Rpb25SZW5kZXJMYXllcihfdGhpcy5fdGVybWluYWwuZWxlbWVudCwgMSwgX3RoaXMuY29sb3JNYW5hZ2VyLmNvbG9ycyksXG4gICAgICAgICAgICBuZXcgTGlua1JlbmRlckxheWVyXzEuTGlua1JlbmRlckxheWVyKF90aGlzLl90ZXJtaW5hbC5lbGVtZW50LCAyLCBfdGhpcy5jb2xvck1hbmFnZXIuY29sb3JzLCBfdGhpcy5fdGVybWluYWwpLFxuICAgICAgICAgICAgbmV3IEN1cnNvclJlbmRlckxheWVyXzEuQ3Vyc29yUmVuZGVyTGF5ZXIoX3RoaXMuX3Rlcm1pbmFsLmVsZW1lbnQsIDMsIF90aGlzLmNvbG9yTWFuYWdlci5jb2xvcnMpXG4gICAgICAgIF07XG4gICAgICAgIF90aGlzLmRpbWVuc2lvbnMgPSB7XG4gICAgICAgICAgICBzY2FsZWRDaGFyV2lkdGg6IG51bGwsXG4gICAgICAgICAgICBzY2FsZWRDaGFySGVpZ2h0OiBudWxsLFxuICAgICAgICAgICAgc2NhbGVkQ2VsbFdpZHRoOiBudWxsLFxuICAgICAgICAgICAgc2NhbGVkQ2VsbEhlaWdodDogbnVsbCxcbiAgICAgICAgICAgIHNjYWxlZENoYXJMZWZ0OiBudWxsLFxuICAgICAgICAgICAgc2NhbGVkQ2hhclRvcDogbnVsbCxcbiAgICAgICAgICAgIHNjYWxlZENhbnZhc1dpZHRoOiBudWxsLFxuICAgICAgICAgICAgc2NhbGVkQ2FudmFzSGVpZ2h0OiBudWxsLFxuICAgICAgICAgICAgY2FudmFzV2lkdGg6IG51bGwsXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQ6IG51bGwsXG4gICAgICAgICAgICBhY3R1YWxDZWxsV2lkdGg6IG51bGwsXG4gICAgICAgICAgICBhY3R1YWxDZWxsSGVpZ2h0OiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLl9kZXZpY2VQaXhlbFJhdGlvID0gd2luZG93LmRldmljZVBpeGVsUmF0aW87XG4gICAgICAgIF90aGlzLl91cGRhdGVEaW1lbnNpb25zKCk7XG4gICAgICAgIF90aGlzLl9zY3JlZW5EcHJNb25pdG9yID0gbmV3IFNjcmVlbkRwck1vbml0b3JfMS5TY3JlZW5EcHJNb25pdG9yKCk7XG4gICAgICAgIF90aGlzLl9zY3JlZW5EcHJNb25pdG9yLnNldExpc3RlbmVyKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLm9uV2luZG93UmVzaXplKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTsgfSk7XG4gICAgICAgIGlmICgnSW50ZXJzZWN0aW9uT2JzZXJ2ZXInIGluIHdpbmRvdykge1xuICAgICAgICAgICAgdmFyIG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5vbkludGVyc2VjdGlvbkNoYW5nZShlWzBdKTsgfSwgeyB0aHJlc2hvbGQ6IDAgfSk7XG4gICAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKF90aGlzLl90ZXJtaW5hbC5lbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFJlbmRlcmVyLnByb3RvdHlwZS5vbkludGVyc2VjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICB0aGlzLl9pc1BhdXNlZCA9IGVudHJ5LmludGVyc2VjdGlvblJhdGlvID09PSAwO1xuICAgICAgICBpZiAoIXRoaXMuX2lzUGF1c2VkICYmIHRoaXMuX25lZWRzRnVsbFJlZnJlc2gpIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnJlZnJlc2goMCwgdGhpcy5fdGVybWluYWwucm93cyAtIDEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZW5kZXJlci5wcm90b3R5cGUub25XaW5kb3dSZXNpemUgPSBmdW5jdGlvbiAoZGV2aWNlUGl4ZWxSYXRpbykge1xuICAgICAgICBpZiAodGhpcy5fZGV2aWNlUGl4ZWxSYXRpbyAhPT0gZGV2aWNlUGl4ZWxSYXRpbykge1xuICAgICAgICAgICAgdGhpcy5fZGV2aWNlUGl4ZWxSYXRpbyA9IGRldmljZVBpeGVsUmF0aW87XG4gICAgICAgICAgICB0aGlzLm9uUmVzaXplKHRoaXMuX3Rlcm1pbmFsLmNvbHMsIHRoaXMuX3Rlcm1pbmFsLnJvd3MsIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZW5kZXJlci5wcm90b3R5cGUuc2V0VGhlbWUgPSBmdW5jdGlvbiAodGhlbWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5jb2xvck1hbmFnZXIuc2V0VGhlbWUodGhlbWUpO1xuICAgICAgICB0aGlzLl9yZW5kZXJMYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgbC5vblRoZW1lQ2hhbmdlZChfdGhpcy5fdGVybWluYWwsIF90aGlzLmNvbG9yTWFuYWdlci5jb2xvcnMpO1xuICAgICAgICAgICAgbC5yZXNldChfdGhpcy5fdGVybWluYWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX2lzUGF1c2VkKSB7XG4gICAgICAgICAgICB0aGlzLl9uZWVkc0Z1bGxSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3Rlcm1pbmFsLnJlZnJlc2goMCwgdGhpcy5fdGVybWluYWwucm93cyAtIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yTWFuYWdlci5jb2xvcnM7XG4gICAgfTtcbiAgICBSZW5kZXJlci5wcm90b3R5cGUub25SZXNpemUgPSBmdW5jdGlvbiAoY29scywgcm93cywgZGlkQ2hhclNpemVDaGFuZ2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fdXBkYXRlRGltZW5zaW9ucygpO1xuICAgICAgICB0aGlzLl9yZW5kZXJMYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobCkgeyByZXR1cm4gbC5yZXNpemUoX3RoaXMuX3Rlcm1pbmFsLCBfdGhpcy5kaW1lbnNpb25zLCBkaWRDaGFyU2l6ZUNoYW5nZSk7IH0pO1xuICAgICAgICBpZiAodGhpcy5faXNQYXVzZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX25lZWRzRnVsbFJlZnJlc2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdGVybWluYWwucmVmcmVzaCgwLCB0aGlzLl90ZXJtaW5hbC5yb3dzIC0gMSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbWl0KCdyZXNpemUnLCB7XG4gICAgICAgICAgICB3aWR0aDogdGhpcy5kaW1lbnNpb25zLmNhbnZhc1dpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmRpbWVuc2lvbnMuY2FudmFzSGVpZ2h0XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUmVuZGVyZXIucHJvdG90eXBlLm9uQ2hhclNpemVDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm9uUmVzaXplKHRoaXMuX3Rlcm1pbmFsLmNvbHMsIHRoaXMuX3Rlcm1pbmFsLnJvd3MsIHRydWUpO1xuICAgIH07XG4gICAgUmVuZGVyZXIucHJvdG90eXBlLm9uQmx1ciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fcnVuT3BlcmF0aW9uKGZ1bmN0aW9uIChsKSB7IHJldHVybiBsLm9uQmx1cihfdGhpcy5fdGVybWluYWwpOyB9KTtcbiAgICB9O1xuICAgIFJlbmRlcmVyLnByb3RvdHlwZS5vbkZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9ydW5PcGVyYXRpb24oZnVuY3Rpb24gKGwpIHsgcmV0dXJuIGwub25Gb2N1cyhfdGhpcy5fdGVybWluYWwpOyB9KTtcbiAgICB9O1xuICAgIFJlbmRlcmVyLnByb3RvdHlwZS5vblNlbGVjdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9ydW5PcGVyYXRpb24oZnVuY3Rpb24gKGwpIHsgcmV0dXJuIGwub25TZWxlY3Rpb25DaGFuZ2VkKF90aGlzLl90ZXJtaW5hbCwgc3RhcnQsIGVuZCk7IH0pO1xuICAgIH07XG4gICAgUmVuZGVyZXIucHJvdG90eXBlLm9uQ3Vyc29yTW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fcnVuT3BlcmF0aW9uKGZ1bmN0aW9uIChsKSB7IHJldHVybiBsLm9uQ3Vyc29yTW92ZShfdGhpcy5fdGVybWluYWwpOyB9KTtcbiAgICB9O1xuICAgIFJlbmRlcmVyLnByb3RvdHlwZS5vbk9wdGlvbnNDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9ydW5PcGVyYXRpb24oZnVuY3Rpb24gKGwpIHsgcmV0dXJuIGwub25PcHRpb25zQ2hhbmdlZChfdGhpcy5fdGVybWluYWwpOyB9KTtcbiAgICB9O1xuICAgIFJlbmRlcmVyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fcnVuT3BlcmF0aW9uKGZ1bmN0aW9uIChsKSB7IHJldHVybiBsLnJlc2V0KF90aGlzLl90ZXJtaW5hbCk7IH0pO1xuICAgIH07XG4gICAgUmVuZGVyZXIucHJvdG90eXBlLl9ydW5PcGVyYXRpb24gPSBmdW5jdGlvbiAob3BlcmF0aW9uKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1BhdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5fbmVlZHNGdWxsUmVmcmVzaCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJMYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobCkgeyByZXR1cm4gb3BlcmF0aW9uKGwpOyB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVuZGVyZXIucHJvdG90eXBlLnF1ZXVlUmVmcmVzaCA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1BhdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5fbmVlZHNGdWxsUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVmcmVzaFJvd3NRdWV1ZS5wdXNoKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCB9KTtcbiAgICAgICAgaWYgKCF0aGlzLl9yZWZyZXNoQW5pbWF0aW9uRnJhbWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hBbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fcmVmcmVzaExvb3AuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlbmRlcmVyLnByb3RvdHlwZS5fcmVmcmVzaExvb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzdGFydDtcbiAgICAgICAgdmFyIGVuZDtcbiAgICAgICAgaWYgKHRoaXMuX3JlZnJlc2hSb3dzUXVldWUubGVuZ3RoID4gNCkge1xuICAgICAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgICAgICAgZW5kID0gdGhpcy5fdGVybWluYWwucm93cyAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdGFydCA9IHRoaXMuX3JlZnJlc2hSb3dzUXVldWVbMF0uc3RhcnQ7XG4gICAgICAgICAgICBlbmQgPSB0aGlzLl9yZWZyZXNoUm93c1F1ZXVlWzBdLmVuZDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5fcmVmcmVzaFJvd3NRdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZWZyZXNoUm93c1F1ZXVlW2ldLnN0YXJ0IDwgc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSB0aGlzLl9yZWZyZXNoUm93c1F1ZXVlW2ldLnN0YXJ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVmcmVzaFJvd3NRdWV1ZVtpXS5lbmQgPiBlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gdGhpcy5fcmVmcmVzaFJvd3NRdWV1ZVtpXS5lbmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlZnJlc2hSb3dzUXVldWUgPSBbXTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaEFuaW1hdGlvbkZyYW1lID0gbnVsbDtcbiAgICAgICAgc3RhcnQgPSBNYXRoLm1heChzdGFydCwgMCk7XG4gICAgICAgIGVuZCA9IE1hdGgubWluKGVuZCwgdGhpcy5fdGVybWluYWwucm93cyAtIDEpO1xuICAgICAgICB0aGlzLl9yZW5kZXJMYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobCkgeyByZXR1cm4gbC5vbkdyaWRDaGFuZ2VkKF90aGlzLl90ZXJtaW5hbCwgc3RhcnQsIGVuZCk7IH0pO1xuICAgICAgICB0aGlzLl90ZXJtaW5hbC5lbWl0KCdyZWZyZXNoJywgeyBzdGFydDogc3RhcnQsIGVuZDogZW5kIH0pO1xuICAgIH07XG4gICAgUmVuZGVyZXIucHJvdG90eXBlLl91cGRhdGVEaW1lbnNpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3Rlcm1pbmFsLmNoYXJNZWFzdXJlLndpZHRoIHx8ICF0aGlzLl90ZXJtaW5hbC5jaGFyTWVhc3VyZS5oZWlnaHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpbWVuc2lvbnMuc2NhbGVkQ2hhcldpZHRoID0gTWF0aC5mbG9vcih0aGlzLl90ZXJtaW5hbC5jaGFyTWVhc3VyZS53aWR0aCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtcbiAgICAgICAgdGhpcy5kaW1lbnNpb25zLnNjYWxlZENoYXJIZWlnaHQgPSBNYXRoLmNlaWwodGhpcy5fdGVybWluYWwuY2hhck1lYXN1cmUuaGVpZ2h0ICogd2luZG93LmRldmljZVBpeGVsUmF0aW8pO1xuICAgICAgICB0aGlzLmRpbWVuc2lvbnMuc2NhbGVkQ2VsbEhlaWdodCA9IE1hdGguZmxvb3IodGhpcy5kaW1lbnNpb25zLnNjYWxlZENoYXJIZWlnaHQgKiB0aGlzLl90ZXJtaW5hbC5vcHRpb25zLmxpbmVIZWlnaHQpO1xuICAgICAgICB0aGlzLmRpbWVuc2lvbnMuc2NhbGVkQ2hhclRvcCA9IHRoaXMuX3Rlcm1pbmFsLm9wdGlvbnMubGluZUhlaWdodCA9PT0gMSA/IDAgOiBNYXRoLnJvdW5kKCh0aGlzLmRpbWVuc2lvbnMuc2NhbGVkQ2VsbEhlaWdodCAtIHRoaXMuZGltZW5zaW9ucy5zY2FsZWRDaGFySGVpZ2h0KSAvIDIpO1xuICAgICAgICB0aGlzLmRpbWVuc2lvbnMuc2NhbGVkQ2VsbFdpZHRoID0gdGhpcy5kaW1lbnNpb25zLnNjYWxlZENoYXJXaWR0aCArIE1hdGgucm91bmQodGhpcy5fdGVybWluYWwub3B0aW9ucy5sZXR0ZXJTcGFjaW5nKTtcbiAgICAgICAgdGhpcy5kaW1lbnNpb25zLnNjYWxlZENoYXJMZWZ0ID0gTWF0aC5mbG9vcih0aGlzLl90ZXJtaW5hbC5vcHRpb25zLmxldHRlclNwYWNpbmcgLyAyKTtcbiAgICAgICAgdGhpcy5kaW1lbnNpb25zLnNjYWxlZENhbnZhc0hlaWdodCA9IHRoaXMuX3Rlcm1pbmFsLnJvd3MgKiB0aGlzLmRpbWVuc2lvbnMuc2NhbGVkQ2VsbEhlaWdodDtcbiAgICAgICAgdGhpcy5kaW1lbnNpb25zLnNjYWxlZENhbnZhc1dpZHRoID0gdGhpcy5fdGVybWluYWwuY29scyAqIHRoaXMuZGltZW5zaW9ucy5zY2FsZWRDZWxsV2lkdGg7XG4gICAgICAgIHRoaXMuZGltZW5zaW9ucy5jYW52YXNIZWlnaHQgPSBNYXRoLnJvdW5kKHRoaXMuZGltZW5zaW9ucy5zY2FsZWRDYW52YXNIZWlnaHQgLyB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7XG4gICAgICAgIHRoaXMuZGltZW5zaW9ucy5jYW52YXNXaWR0aCA9IE1hdGgucm91bmQodGhpcy5kaW1lbnNpb25zLnNjYWxlZENhbnZhc1dpZHRoIC8gd2luZG93LmRldmljZVBpeGVsUmF0aW8pO1xuICAgICAgICB0aGlzLmRpbWVuc2lvbnMuYWN0dWFsQ2VsbEhlaWdodCA9IHRoaXMuZGltZW5zaW9ucy5jYW52YXNIZWlnaHQgLyB0aGlzLl90ZXJtaW5hbC5yb3dzO1xuICAgICAgICB0aGlzLmRpbWVuc2lvbnMuYWN0dWFsQ2VsbFdpZHRoID0gdGhpcy5kaW1lbnNpb25zLmNhbnZhc1dpZHRoIC8gdGhpcy5fdGVybWluYWwuY29scztcbiAgICB9O1xuICAgIHJldHVybiBSZW5kZXJlcjtcbn0oRXZlbnRFbWl0dGVyXzEuRXZlbnRFbWl0dGVyKSk7XG5leHBvcnRzLlJlbmRlcmVyID0gUmVuZGVyZXI7XG5cblxuXG59LHtcIi4uL0V2ZW50RW1pdHRlclwiOjcsXCIuLi91dGlscy9TY3JlZW5EcHJNb25pdG9yXCI6MzMsXCIuL0NvbG9yTWFuYWdlclwiOjIwLFwiLi9DdXJzb3JSZW5kZXJMYXllclwiOjIxLFwiLi9MaW5rUmVuZGVyTGF5ZXJcIjoyMyxcIi4vU2VsZWN0aW9uUmVuZGVyTGF5ZXJcIjoyNSxcIi4vVGV4dFJlbmRlckxheWVyXCI6MjZ9XSwyNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEJhc2VSZW5kZXJMYXllcl8xID0gcmVxdWlyZShcIi4vQmFzZVJlbmRlckxheWVyXCIpO1xudmFyIFNlbGVjdGlvblJlbmRlckxheWVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VsZWN0aW9uUmVuZGVyTGF5ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VsZWN0aW9uUmVuZGVyTGF5ZXIoY29udGFpbmVyLCB6SW5kZXgsIGNvbG9ycykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBjb250YWluZXIsICdzZWxlY3Rpb24nLCB6SW5kZXgsIHRydWUsIGNvbG9ycykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3N0YXRlID0ge1xuICAgICAgICAgICAgc3RhcnQ6IG51bGwsXG4gICAgICAgICAgICBlbmQ6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTZWxlY3Rpb25SZW5kZXJMYXllci5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKHRlcm1pbmFsLCBkaW0sIGNoYXJTaXplQ2hhbmdlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMsIHRlcm1pbmFsLCBkaW0sIGNoYXJTaXplQ2hhbmdlZCk7XG4gICAgICAgIHRoaXMuX3N0YXRlID0ge1xuICAgICAgICAgICAgc3RhcnQ6IG51bGwsXG4gICAgICAgICAgICBlbmQ6IG51bGxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFNlbGVjdGlvblJlbmRlckxheWVyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICh0ZXJtaW5hbCkge1xuICAgICAgICBpZiAodGhpcy5fc3RhdGUuc3RhcnQgJiYgdGhpcy5fc3RhdGUuZW5kKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogbnVsbCxcbiAgICAgICAgICAgICAgICBlbmQ6IG51bGxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsZWFyQWxsKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvblJlbmRlckxheWVyLnByb3RvdHlwZS5vblNlbGVjdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAodGVybWluYWwsIHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlLnN0YXJ0ID09PSBzdGFydCB8fCB0aGlzLl9zdGF0ZS5lbmQgPT09IGVuZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xlYXJBbGwoKTtcbiAgICAgICAgaWYgKCFzdGFydCB8fCAhZW5kKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZpZXdwb3J0U3RhcnRSb3cgPSBzdGFydFsxXSAtIHRlcm1pbmFsLmJ1ZmZlci55ZGlzcDtcbiAgICAgICAgdmFyIHZpZXdwb3J0RW5kUm93ID0gZW5kWzFdIC0gdGVybWluYWwuYnVmZmVyLnlkaXNwO1xuICAgICAgICB2YXIgdmlld3BvcnRDYXBwZWRTdGFydFJvdyA9IE1hdGgubWF4KHZpZXdwb3J0U3RhcnRSb3csIDApO1xuICAgICAgICB2YXIgdmlld3BvcnRDYXBwZWRFbmRSb3cgPSBNYXRoLm1pbih2aWV3cG9ydEVuZFJvdywgdGVybWluYWwucm93cyAtIDEpO1xuICAgICAgICBpZiAodmlld3BvcnRDYXBwZWRTdGFydFJvdyA+PSB0ZXJtaW5hbC5yb3dzIHx8IHZpZXdwb3J0Q2FwcGVkRW5kUm93IDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdGFydENvbCA9IHZpZXdwb3J0U3RhcnRSb3cgPT09IHZpZXdwb3J0Q2FwcGVkU3RhcnRSb3cgPyBzdGFydFswXSA6IDA7XG4gICAgICAgIHZhciBzdGFydFJvd0VuZENvbCA9IHZpZXdwb3J0Q2FwcGVkU3RhcnRSb3cgPT09IHZpZXdwb3J0Q2FwcGVkRW5kUm93ID8gZW5kWzBdIDogdGVybWluYWwuY29scztcbiAgICAgICAgdGhpcy5fY3R4LmZpbGxTdHlsZSA9IHRoaXMuX2NvbG9ycy5zZWxlY3Rpb247XG4gICAgICAgIHRoaXMuZmlsbENlbGxzKHN0YXJ0Q29sLCB2aWV3cG9ydENhcHBlZFN0YXJ0Um93LCBzdGFydFJvd0VuZENvbCAtIHN0YXJ0Q29sLCAxKTtcbiAgICAgICAgdmFyIG1pZGRsZVJvd3NDb3VudCA9IE1hdGgubWF4KHZpZXdwb3J0Q2FwcGVkRW5kUm93IC0gdmlld3BvcnRDYXBwZWRTdGFydFJvdyAtIDEsIDApO1xuICAgICAgICB0aGlzLmZpbGxDZWxscygwLCB2aWV3cG9ydENhcHBlZFN0YXJ0Um93ICsgMSwgdGVybWluYWwuY29scywgbWlkZGxlUm93c0NvdW50KTtcbiAgICAgICAgaWYgKHZpZXdwb3J0Q2FwcGVkU3RhcnRSb3cgIT09IHZpZXdwb3J0Q2FwcGVkRW5kUm93KSB7XG4gICAgICAgICAgICB2YXIgZW5kQ29sID0gdmlld3BvcnRFbmRSb3cgPT09IHZpZXdwb3J0Q2FwcGVkRW5kUm93ID8gZW5kWzBdIDogdGVybWluYWwuY29scztcbiAgICAgICAgICAgIHRoaXMuZmlsbENlbGxzKDAsIHZpZXdwb3J0Q2FwcGVkRW5kUm93LCBlbmRDb2wsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N0YXRlLnN0YXJ0ID0gW3N0YXJ0WzBdLCBzdGFydFsxXV07XG4gICAgICAgIHRoaXMuX3N0YXRlLmVuZCA9IFtlbmRbMF0sIGVuZFsxXV07XG4gICAgfTtcbiAgICByZXR1cm4gU2VsZWN0aW9uUmVuZGVyTGF5ZXI7XG59KEJhc2VSZW5kZXJMYXllcl8xLkJhc2VSZW5kZXJMYXllcikpO1xuZXhwb3J0cy5TZWxlY3Rpb25SZW5kZXJMYXllciA9IFNlbGVjdGlvblJlbmRlckxheWVyO1xuXG5cblxufSx7XCIuL0Jhc2VSZW5kZXJMYXllclwiOjE4fV0sMjY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBCdWZmZXJfMSA9IHJlcXVpcmUoXCIuLi9CdWZmZXJcIik7XG52YXIgVHlwZXNfMSA9IHJlcXVpcmUoXCIuL1R5cGVzXCIpO1xudmFyIEdyaWRDYWNoZV8xID0gcmVxdWlyZShcIi4vR3JpZENhY2hlXCIpO1xudmFyIEJhc2VSZW5kZXJMYXllcl8xID0gcmVxdWlyZShcIi4vQmFzZVJlbmRlckxheWVyXCIpO1xudmFyIE9WRVJMQVBfT1dORURfQ0hBUl9EQVRBID0gW251bGwsICcnLCAwLCAtMV07XG52YXIgVGV4dFJlbmRlckxheWVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dFJlbmRlckxheWVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRSZW5kZXJMYXllcihjb250YWluZXIsIHpJbmRleCwgY29sb3JzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGNvbnRhaW5lciwgJ3RleHQnLCB6SW5kZXgsIGZhbHNlLCBjb2xvcnMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9jaGFyYWN0ZXJPdmVybGFwQ2FjaGUgPSB7fTtcbiAgICAgICAgX3RoaXMuX3N0YXRlID0gbmV3IEdyaWRDYWNoZV8xLkdyaWRDYWNoZSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFRleHRSZW5kZXJMYXllci5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKHRlcm1pbmFsLCBkaW0sIGNoYXJTaXplQ2hhbmdlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMsIHRlcm1pbmFsLCBkaW0sIGNoYXJTaXplQ2hhbmdlZCk7XG4gICAgICAgIHZhciB0ZXJtaW5hbEZvbnQgPSB0ZXJtaW5hbC5vcHRpb25zLmZvbnRTaXplICogd2luZG93LmRldmljZVBpeGVsUmF0aW8gKyBcInB4IFwiICsgdGVybWluYWwub3B0aW9ucy5mb250RmFtaWx5O1xuICAgICAgICBpZiAodGhpcy5fY2hhcmFjdGVyV2lkdGggIT09IGRpbS5zY2FsZWRDaGFyV2lkdGggfHwgdGhpcy5fY2hhcmFjdGVyRm9udCAhPT0gdGVybWluYWxGb250KSB7XG4gICAgICAgICAgICB0aGlzLl9jaGFyYWN0ZXJXaWR0aCA9IGRpbS5zY2FsZWRDaGFyV2lkdGg7XG4gICAgICAgICAgICB0aGlzLl9jaGFyYWN0ZXJGb250ID0gdGVybWluYWxGb250O1xuICAgICAgICAgICAgdGhpcy5fY2hhcmFjdGVyT3ZlcmxhcENhY2hlID0ge307XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc3RhdGUuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5fc3RhdGUucmVzaXplKHRlcm1pbmFsLmNvbHMsIHRlcm1pbmFsLnJvd3MpO1xuICAgIH07XG4gICAgVGV4dFJlbmRlckxheWVyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICh0ZXJtaW5hbCkge1xuICAgICAgICB0aGlzLl9zdGF0ZS5jbGVhcigpO1xuICAgICAgICB0aGlzLmNsZWFyQWxsKCk7XG4gICAgfTtcbiAgICBUZXh0UmVuZGVyTGF5ZXIucHJvdG90eXBlLm9uR3JpZENoYW5nZWQgPSBmdW5jdGlvbiAodGVybWluYWwsIHN0YXJ0Um93LCBlbmRSb3cpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlLmNhY2hlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIHkgPSBzdGFydFJvdzsgeSA8PSBlbmRSb3c7IHkrKykge1xuICAgICAgICAgICAgdmFyIHJvdyA9IHkgKyB0ZXJtaW5hbC5idWZmZXIueWRpc3A7XG4gICAgICAgICAgICB2YXIgbGluZSA9IHRlcm1pbmFsLmJ1ZmZlci5saW5lcy5nZXQocm93KTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDZWxscygwLCB5LCB0ZXJtaW5hbC5jb2xzLCAxKTtcbiAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGVybWluYWwuY29sczsgeCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoYXJEYXRhID0gbGluZVt4XTtcbiAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGNoYXJEYXRhW0J1ZmZlcl8xLkNIQVJfREFUQV9DT0RFX0lOREVYXTtcbiAgICAgICAgICAgICAgICB2YXIgY2hhciA9IGNoYXJEYXRhW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXTtcbiAgICAgICAgICAgICAgICB2YXIgYXR0ciA9IGNoYXJEYXRhW0J1ZmZlcl8xLkNIQVJfREFUQV9BVFRSX0lOREVYXTtcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBjaGFyRGF0YVtCdWZmZXJfMS5DSEFSX0RBVEFfV0lEVEhfSU5ERVhdO1xuICAgICAgICAgICAgICAgIGlmICh3aWR0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IDMyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZpb3VzQ2hhciA9IGxpbmVbeCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzT3ZlcmxhcHBpbmcocHJldmlvdXNDaGFyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBmbGFncyA9IGF0dHIgPj4gMTg7XG4gICAgICAgICAgICAgICAgdmFyIGJnID0gYXR0ciAmIDB4MWZmO1xuICAgICAgICAgICAgICAgIHZhciBpc0RlZmF1bHRCYWNrZ3JvdW5kID0gYmcgPj0gMjU2O1xuICAgICAgICAgICAgICAgIHZhciBpc0ludmlzaWJsZSA9IGZsYWdzICYgVHlwZXNfMS5GTEFHUy5JTlZJU0lCTEU7XG4gICAgICAgICAgICAgICAgdmFyIGlzSW52ZXJ0ZWQgPSBmbGFncyAmIFR5cGVzXzEuRkxBR1MuSU5WRVJTRTtcbiAgICAgICAgICAgICAgICBpZiAoIWNvZGUgfHwgKGNvZGUgPT09IDMyICYmIGlzRGVmYXVsdEJhY2tncm91bmQgJiYgIWlzSW52ZXJ0ZWQpIHx8IGlzSW52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAod2lkdGggIT09IDAgJiYgdGhpcy5faXNPdmVybGFwcGluZyhjaGFyRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHggPCBsaW5lLmxlbmd0aCAtIDEgJiYgbGluZVt4ICsgMV1bQnVmZmVyXzEuQ0hBUl9EQVRBX0NPREVfSU5ERVhdID09PSAzMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSAyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBmZyA9IChhdHRyID4+IDkpICYgMHgxZmY7XG4gICAgICAgICAgICAgICAgaWYgKGlzSW52ZXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBiZztcbiAgICAgICAgICAgICAgICAgICAgYmcgPSBmZztcbiAgICAgICAgICAgICAgICAgICAgZmcgPSB0ZW1wO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmcgPT09IDI1Nikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmcgPSBCYXNlUmVuZGVyTGF5ZXJfMS5JTlZFUlRFRF9ERUZBVUxUX0NPTE9SO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChiZyA9PT0gMjU3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiZyA9IEJhc2VSZW5kZXJMYXllcl8xLklOVkVSVEVEX0RFRkFVTFRfQ09MT1I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHdpZHRoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChiZyA8IDI1Nikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdHguc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gKGJnID09PSBCYXNlUmVuZGVyTGF5ZXJfMS5JTlZFUlRFRF9ERUZBVUxUX0NPTE9SID8gdGhpcy5fY29sb3JzLmZvcmVncm91bmQgOiB0aGlzLl9jb2xvcnMuYW5zaVtiZ10pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGxDZWxscyh4LCB5LCB3aWR0aCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgaWYgKGZsYWdzICYgVHlwZXNfMS5GTEFHUy5CT0xEKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5mb250ID0gXCJib2xkIFwiICsgdGhpcy5fY3R4LmZvbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmZyA8IDgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZnICs9IDg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZsYWdzICYgVHlwZXNfMS5GTEFHUy5VTkRFUkxJTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZnID09PSBCYXNlUmVuZGVyTGF5ZXJfMS5JTlZFUlRFRF9ERUZBVUxUX0NPTE9SKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmJhY2tncm91bmQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZmcgPCAyNTYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcnMuYW5zaVtmZ107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gdGhpcy5fY29sb3JzLmZvcmVncm91bmQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxsQm90dG9tTGluZUF0Q2VsbHMoeCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZHJhd0NoYXIodGVybWluYWwsIGNoYXIsIGNvZGUsIHdpZHRoLCB4LCB5LCBmZywgYmcsICEhKGZsYWdzICYgVHlwZXNfMS5GTEFHUy5CT0xEKSwgISEoZmxhZ3MgJiBUeXBlc18xLkZMQUdTLkRJTSkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRSZW5kZXJMYXllci5wcm90b3R5cGUuX2lzT3ZlcmxhcHBpbmcgPSBmdW5jdGlvbiAoY2hhckRhdGEpIHtcbiAgICAgICAgaWYgKGNoYXJEYXRhW0J1ZmZlcl8xLkNIQVJfREFUQV9XSURUSF9JTkRFWF0gIT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29kZSA9IGNoYXJEYXRhW0J1ZmZlcl8xLkNIQVJfREFUQV9DT0RFX0lOREVYXTtcbiAgICAgICAgaWYgKGNvZGUgPCAyNTYpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhciA9IGNoYXJEYXRhW0J1ZmZlcl8xLkNIQVJfREFUQV9DSEFSX0lOREVYXTtcbiAgICAgICAgaWYgKHRoaXMuX2NoYXJhY3Rlck92ZXJsYXBDYWNoZS5oYXNPd25Qcm9wZXJ0eShjaGFyKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoYXJhY3Rlck92ZXJsYXBDYWNoZVtjaGFyXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdHguc2F2ZSgpO1xuICAgICAgICB0aGlzLl9jdHguZm9udCA9IHRoaXMuX2NoYXJhY3RlckZvbnQ7XG4gICAgICAgIHZhciBvdmVybGFwcyA9IE1hdGguZmxvb3IodGhpcy5fY3R4Lm1lYXN1cmVUZXh0KGNoYXIpLndpZHRoKSA+IHRoaXMuX2NoYXJhY3RlcldpZHRoO1xuICAgICAgICB0aGlzLl9jdHgucmVzdG9yZSgpO1xuICAgICAgICB0aGlzLl9jaGFyYWN0ZXJPdmVybGFwQ2FjaGVbY2hhcl0gPSBvdmVybGFwcztcbiAgICAgICAgcmV0dXJuIG92ZXJsYXBzO1xuICAgIH07XG4gICAgVGV4dFJlbmRlckxheWVyLnByb3RvdHlwZS5fY2xlYXJDaGFyID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgdmFyIGNvbHNUb0NsZWFyID0gMTtcbiAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5fc3RhdGUuY2FjaGVbeF1beV07XG4gICAgICAgIGlmIChzdGF0ZSAmJiBzdGF0ZVtCdWZmZXJfMS5DSEFSX0RBVEFfV0lEVEhfSU5ERVhdID09PSAyKSB7XG4gICAgICAgICAgICBjb2xzVG9DbGVhciA9IDI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbGVhckNlbGxzKHgsIHksIGNvbHNUb0NsZWFyLCAxKTtcbiAgICB9O1xuICAgIHJldHVybiBUZXh0UmVuZGVyTGF5ZXI7XG59KEJhc2VSZW5kZXJMYXllcl8xLkJhc2VSZW5kZXJMYXllcikpO1xuZXhwb3J0cy5UZXh0UmVuZGVyTGF5ZXIgPSBUZXh0UmVuZGVyTGF5ZXI7XG5cblxuXG59LHtcIi4uL0J1ZmZlclwiOjEsXCIuL0Jhc2VSZW5kZXJMYXllclwiOjE4LFwiLi9HcmlkQ2FjaGVcIjoyMixcIi4vVHlwZXNcIjoyN31dLDI3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEZMQUdTO1xuKGZ1bmN0aW9uIChGTEFHUykge1xuICAgIEZMQUdTW0ZMQUdTW1wiQk9MRFwiXSA9IDFdID0gXCJCT0xEXCI7XG4gICAgRkxBR1NbRkxBR1NbXCJVTkRFUkxJTkVcIl0gPSAyXSA9IFwiVU5ERVJMSU5FXCI7XG4gICAgRkxBR1NbRkxBR1NbXCJCTElOS1wiXSA9IDRdID0gXCJCTElOS1wiO1xuICAgIEZMQUdTW0ZMQUdTW1wiSU5WRVJTRVwiXSA9IDhdID0gXCJJTlZFUlNFXCI7XG4gICAgRkxBR1NbRkxBR1NbXCJJTlZJU0lCTEVcIl0gPSAxNl0gPSBcIklOVklTSUJMRVwiO1xuICAgIEZMQUdTW0ZMQUdTW1wiRElNXCJdID0gMzJdID0gXCJESU1cIjtcbn0pKEZMQUdTID0gZXhwb3J0cy5GTEFHUyB8fCAoZXhwb3J0cy5GTEFHUyA9IHt9KSk7XG47XG5cblxuXG59LHt9XSwyODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBHZW5lcmljXzEgPSByZXF1aXJlKFwiLi9HZW5lcmljXCIpO1xudmFyIGlzTm9kZSA9ICh0eXBlb2YgbmF2aWdhdG9yID09PSAndW5kZWZpbmVkJykgPyB0cnVlIDogZmFsc2U7XG52YXIgdXNlckFnZW50ID0gKGlzTm9kZSkgPyAnbm9kZScgOiBuYXZpZ2F0b3IudXNlckFnZW50O1xudmFyIHBsYXRmb3JtID0gKGlzTm9kZSkgPyAnbm9kZScgOiBuYXZpZ2F0b3IucGxhdGZvcm07XG5leHBvcnRzLmlzRmlyZWZveCA9ICEhfnVzZXJBZ2VudC5pbmRleE9mKCdGaXJlZm94Jyk7XG5leHBvcnRzLmlzTVNJRSA9ICEhfnVzZXJBZ2VudC5pbmRleE9mKCdNU0lFJykgfHwgISF+dXNlckFnZW50LmluZGV4T2YoJ1RyaWRlbnQnKTtcbmV4cG9ydHMuaXNNYWMgPSBHZW5lcmljXzEuY29udGFpbnMoWydNYWNpbnRvc2gnLCAnTWFjSW50ZWwnLCAnTWFjUFBDJywgJ01hYzY4SyddLCBwbGF0Zm9ybSk7XG5leHBvcnRzLmlzSXBhZCA9IHBsYXRmb3JtID09PSAnaVBhZCc7XG5leHBvcnRzLmlzSXBob25lID0gcGxhdGZvcm0gPT09ICdpUGhvbmUnO1xuZXhwb3J0cy5pc01TV2luZG93cyA9IEdlbmVyaWNfMS5jb250YWlucyhbJ1dpbmRvd3MnLCAnV2luMTYnLCAnV2luMzInLCAnV2luQ0UnXSwgcGxhdGZvcm0pO1xuZXhwb3J0cy5pc0xpbnV4ID0gcGxhdGZvcm0uaW5kZXhPZignTGludXgnKSA+PSAwO1xuXG5cblxufSx7XCIuL0dlbmVyaWNcIjozMX1dLDI5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgRXZlbnRFbWl0dGVyXzEgPSByZXF1aXJlKFwiLi4vRXZlbnRFbWl0dGVyXCIpO1xudmFyIENoYXJNZWFzdXJlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2hhck1lYXN1cmUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ2hhck1lYXN1cmUoZG9jdW1lbnQsIHBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2RvY3VtZW50ID0gZG9jdW1lbnQ7XG4gICAgICAgIF90aGlzLl9wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudDtcbiAgICAgICAgX3RoaXMuX21lYXN1cmVFbGVtZW50ID0gX3RoaXMuX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgX3RoaXMuX21lYXN1cmVFbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgX3RoaXMuX21lYXN1cmVFbGVtZW50LnN0eWxlLnRvcCA9ICcwJztcbiAgICAgICAgX3RoaXMuX21lYXN1cmVFbGVtZW50LnN0eWxlLmxlZnQgPSAnLTk5OTllbSc7XG4gICAgICAgIF90aGlzLl9tZWFzdXJlRWxlbWVudC5zdHlsZS5saW5lSGVpZ2h0ID0gJ25vcm1hbCc7XG4gICAgICAgIF90aGlzLl9tZWFzdXJlRWxlbWVudC50ZXh0Q29udGVudCA9ICdXJztcbiAgICAgICAgX3RoaXMuX21lYXN1cmVFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgICAgICBfdGhpcy5fcGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChfdGhpcy5fbWVhc3VyZUVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGFyTWVhc3VyZS5wcm90b3R5cGUsIFwid2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENoYXJNZWFzdXJlLnByb3RvdHlwZSwgXCJoZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENoYXJNZWFzdXJlLnByb3RvdHlwZS5tZWFzdXJlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5fbWVhc3VyZUVsZW1lbnQuc3R5bGUuZm9udEZhbWlseSA9IG9wdGlvbnMuZm9udEZhbWlseTtcbiAgICAgICAgdGhpcy5fbWVhc3VyZUVsZW1lbnQuc3R5bGUuZm9udFNpemUgPSBvcHRpb25zLmZvbnRTaXplICsgXCJweFwiO1xuICAgICAgICB2YXIgZ2VvbWV0cnkgPSB0aGlzLl9tZWFzdXJlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgaWYgKGdlb21ldHJ5LndpZHRoID09PSAwIHx8IGdlb21ldHJ5LmhlaWdodCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl93aWR0aCAhPT0gZ2VvbWV0cnkud2lkdGggfHwgdGhpcy5faGVpZ2h0ICE9PSBnZW9tZXRyeS5oZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuX3dpZHRoID0gZ2VvbWV0cnkud2lkdGg7XG4gICAgICAgICAgICB0aGlzLl9oZWlnaHQgPSBNYXRoLmNlaWwoZ2VvbWV0cnkuaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnY2hhcnNpemVjaGFuZ2VkJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBDaGFyTWVhc3VyZTtcbn0oRXZlbnRFbWl0dGVyXzEuRXZlbnRFbWl0dGVyKSk7XG5leHBvcnRzLkNoYXJNZWFzdXJlID0gQ2hhck1lYXN1cmU7XG5cblxuXG59LHtcIi4uL0V2ZW50RW1pdHRlclwiOjd9XSwzMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEV2ZW50RW1pdHRlcl8xID0gcmVxdWlyZShcIi4uL0V2ZW50RW1pdHRlclwiKTtcbnZhciBDaXJjdWxhckxpc3QgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDaXJjdWxhckxpc3QsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ2lyY3VsYXJMaXN0KF9tYXhMZW5ndGgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX21heExlbmd0aCA9IF9tYXhMZW5ndGg7XG4gICAgICAgIF90aGlzLl9hcnJheSA9IG5ldyBBcnJheShfdGhpcy5fbWF4TGVuZ3RoKTtcbiAgICAgICAgX3RoaXMuX3N0YXJ0SW5kZXggPSAwO1xuICAgICAgICBfdGhpcy5fbGVuZ3RoID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2lyY3VsYXJMaXN0LnByb3RvdHlwZSwgXCJtYXhMZW5ndGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXhMZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKG5ld01heExlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21heExlbmd0aCA9PT0gbmV3TWF4TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IEFycmF5KG5ld01heExlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE1hdGgubWluKG5ld01heExlbmd0aCwgdGhpcy5sZW5ndGgpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBuZXdBcnJheVtpXSA9IHRoaXMuX2FycmF5W3RoaXMuX2dldEN5Y2xpY0luZGV4KGkpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2FycmF5ID0gbmV3QXJyYXk7XG4gICAgICAgICAgICB0aGlzLl9tYXhMZW5ndGggPSBuZXdNYXhMZW5ndGg7XG4gICAgICAgICAgICB0aGlzLl9zdGFydEluZGV4ID0gMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENpcmN1bGFyTGlzdC5wcm90b3R5cGUsIFwibGVuZ3RoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdMZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChuZXdMZW5ndGggPiB0aGlzLl9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbGVuZ3RoOyBpIDwgbmV3TGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJyYXlbaV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbGVuZ3RoID0gbmV3TGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2lyY3VsYXJMaXN0LnByb3RvdHlwZSwgXCJmb3JFYWNoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYWxsYmFja2ZuKSB7XG4gICAgICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBfdGhpcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaV8xID0gMDsgaV8xIDwgbGVuZ3RoOyBpXzErKykge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFja2ZuKF90aGlzLmdldChpXzEpLCBpXzEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENpcmN1bGFyTGlzdC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheVt0aGlzLl9nZXRDeWNsaWNJbmRleChpbmRleCldO1xuICAgIH07XG4gICAgQ2lyY3VsYXJMaXN0LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2FycmF5W3RoaXMuX2dldEN5Y2xpY0luZGV4KGluZGV4KV0gPSB2YWx1ZTtcbiAgICB9O1xuICAgIENpcmN1bGFyTGlzdC5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9hcnJheVt0aGlzLl9nZXRDeWNsaWNJbmRleCh0aGlzLl9sZW5ndGgpXSA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy5fbGVuZ3RoID09PSB0aGlzLl9tYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXJ0SW5kZXgrKztcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGFydEluZGV4ID09PSB0aGlzLl9tYXhMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFydEluZGV4ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZW1pdCgndHJpbScsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbGVuZ3RoKys7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENpcmN1bGFyTGlzdC5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXlbdGhpcy5fZ2V0Q3ljbGljSW5kZXgodGhpcy5fbGVuZ3RoLS0gLSAxKV07XG4gICAgfTtcbiAgICBDaXJjdWxhckxpc3QucHJvdG90eXBlLnNwbGljZSA9IGZ1bmN0aW9uIChzdGFydCwgZGVsZXRlQ291bnQpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBpdGVtc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVsZXRlQ291bnQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHRoaXMuX2xlbmd0aCAtIGRlbGV0ZUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hcnJheVt0aGlzLl9nZXRDeWNsaWNJbmRleChpKV0gPSB0aGlzLl9hcnJheVt0aGlzLl9nZXRDeWNsaWNJbmRleChpICsgZGVsZXRlQ291bnQpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2xlbmd0aCAtPSBkZWxldGVDb3VudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbXMgJiYgaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbGVuZ3RoIC0gMTsgaSA+PSBzdGFydDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXJyYXlbdGhpcy5fZ2V0Q3ljbGljSW5kZXgoaSArIGl0ZW1zLmxlbmd0aCldID0gdGhpcy5fYXJyYXlbdGhpcy5fZ2V0Q3ljbGljSW5kZXgoaSldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FycmF5W3RoaXMuX2dldEN5Y2xpY0luZGV4KHN0YXJ0ICsgaSldID0gaXRlbXNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fbGVuZ3RoICsgaXRlbXMubGVuZ3RoID4gdGhpcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRUb1RyaW0gPSAodGhpcy5fbGVuZ3RoICsgaXRlbXMubGVuZ3RoKSAtIHRoaXMubWF4TGVuZ3RoO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0SW5kZXggKz0gY291bnRUb1RyaW07XG4gICAgICAgICAgICAgICAgdGhpcy5fbGVuZ3RoID0gdGhpcy5tYXhMZW5ndGg7XG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0KCd0cmltJywgY291bnRUb1RyaW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGVuZ3RoICs9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2lyY3VsYXJMaXN0LnByb3RvdHlwZS50cmltU3RhcnQgPSBmdW5jdGlvbiAoY291bnQpIHtcbiAgICAgICAgaWYgKGNvdW50ID4gdGhpcy5fbGVuZ3RoKSB7XG4gICAgICAgICAgICBjb3VudCA9IHRoaXMuX2xlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zdGFydEluZGV4ICs9IGNvdW50O1xuICAgICAgICB0aGlzLl9sZW5ndGggLT0gY291bnQ7XG4gICAgICAgIHRoaXMuZW1pdCgndHJpbScsIGNvdW50KTtcbiAgICB9O1xuICAgIENpcmN1bGFyTGlzdC5wcm90b3R5cGUuc2hpZnRFbGVtZW50cyA9IGZ1bmN0aW9uIChzdGFydCwgY291bnQsIG9mZnNldCkge1xuICAgICAgICBpZiAoY291bnQgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydCA8IDAgfHwgc3RhcnQgPj0gdGhpcy5fbGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N0YXJ0IGFyZ3VtZW50IG91dCBvZiByYW5nZScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydCArIG9mZnNldCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHNoaWZ0IGVsZW1lbnRzIGluIGxpc3QgYmV5b25kIGluZGV4IDAnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2Zmc2V0ID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGNvdW50IC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldChzdGFydCArIGkgKyBvZmZzZXQsIHRoaXMuZ2V0KHN0YXJ0ICsgaSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGV4cGFuZExpc3RCeSA9IChzdGFydCArIGNvdW50ICsgb2Zmc2V0KSAtIHRoaXMuX2xlbmd0aDtcbiAgICAgICAgICAgIGlmIChleHBhbmRMaXN0QnkgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGVuZ3RoICs9IGV4cGFuZExpc3RCeTtcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5fbGVuZ3RoID4gdGhpcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGVuZ3RoLS07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0SW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCd0cmltJywgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoc3RhcnQgKyBpICsgb2Zmc2V0LCB0aGlzLmdldChzdGFydCArIGkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2lyY3VsYXJMaXN0LnByb3RvdHlwZS5fZ2V0Q3ljbGljSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLl9zdGFydEluZGV4ICsgaW5kZXgpICUgdGhpcy5tYXhMZW5ndGg7XG4gICAgfTtcbiAgICByZXR1cm4gQ2lyY3VsYXJMaXN0O1xufShFdmVudEVtaXR0ZXJfMS5FdmVudEVtaXR0ZXIpKTtcbmV4cG9ydHMuQ2lyY3VsYXJMaXN0ID0gQ2lyY3VsYXJMaXN0O1xuXG5cblxufSx7XCIuLi9FdmVudEVtaXR0ZXJcIjo3fV0sMzE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBjb250YWlucyhhcnIsIGVsKSB7XG4gICAgcmV0dXJuIGFyci5pbmRleE9mKGVsKSA+PSAwO1xufVxuZXhwb3J0cy5jb250YWlucyA9IGNvbnRhaW5zO1xuO1xuXG5cblxufSx7fV0sMzI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgTW91c2VIZWxwZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1vdXNlSGVscGVyKF9yZW5kZXJlcikge1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IF9yZW5kZXJlcjtcbiAgICB9XG4gICAgTW91c2VIZWxwZXIuZ2V0Q29vcmRzUmVsYXRpdmVUb0VsZW1lbnQgPSBmdW5jdGlvbiAoZXZlbnQsIGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnBhZ2VYID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvcmlnaW5hbEVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB2YXIgeCA9IGV2ZW50LnBhZ2VYO1xuICAgICAgICB2YXIgeSA9IGV2ZW50LnBhZ2VZO1xuICAgICAgICB3aGlsZSAoZWxlbWVudCkge1xuICAgICAgICAgICAgeCAtPSBlbGVtZW50Lm9mZnNldExlZnQ7XG4gICAgICAgICAgICB5IC09IGVsZW1lbnQub2Zmc2V0VG9wO1xuICAgICAgICAgICAgZWxlbWVudCA9ICdvZmZzZXRQYXJlbnQnIGluIGVsZW1lbnQgPyBlbGVtZW50Lm9mZnNldFBhcmVudCA6IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50ID0gb3JpZ2luYWxFbGVtZW50O1xuICAgICAgICB3aGlsZSAoZWxlbWVudCAmJiBlbGVtZW50ICE9PSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgeCArPSBlbGVtZW50LnNjcm9sbExlZnQ7XG4gICAgICAgICAgICB5ICs9IGVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3gsIHldO1xuICAgIH07XG4gICAgTW91c2VIZWxwZXIucHJvdG90eXBlLmdldENvb3JkcyA9IGZ1bmN0aW9uIChldmVudCwgZWxlbWVudCwgY2hhck1lYXN1cmUsIGxpbmVIZWlnaHQsIGNvbENvdW50LCByb3dDb3VudCwgaXNTZWxlY3Rpb24pIHtcbiAgICAgICAgaWYgKCFjaGFyTWVhc3VyZS53aWR0aCB8fCAhY2hhck1lYXN1cmUuaGVpZ2h0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29vcmRzID0gTW91c2VIZWxwZXIuZ2V0Q29vcmRzUmVsYXRpdmVUb0VsZW1lbnQoZXZlbnQsIGVsZW1lbnQpO1xuICAgICAgICBpZiAoIWNvb3Jkcykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29vcmRzWzBdID0gTWF0aC5jZWlsKChjb29yZHNbMF0gKyAoaXNTZWxlY3Rpb24gPyB0aGlzLl9yZW5kZXJlci5kaW1lbnNpb25zLmFjdHVhbENlbGxXaWR0aCAvIDIgOiAwKSkgLyB0aGlzLl9yZW5kZXJlci5kaW1lbnNpb25zLmFjdHVhbENlbGxXaWR0aCk7XG4gICAgICAgIGNvb3Jkc1sxXSA9IE1hdGguY2VpbChjb29yZHNbMV0gLyB0aGlzLl9yZW5kZXJlci5kaW1lbnNpb25zLmFjdHVhbENlbGxIZWlnaHQpO1xuICAgICAgICBjb29yZHNbMF0gPSBNYXRoLm1pbihNYXRoLm1heChjb29yZHNbMF0sIDEpLCBjb2xDb3VudCArIChpc1NlbGVjdGlvbiA/IDEgOiAwKSk7XG4gICAgICAgIGNvb3Jkc1sxXSA9IE1hdGgubWluKE1hdGgubWF4KGNvb3Jkc1sxXSwgMSksIHJvd0NvdW50KTtcbiAgICAgICAgcmV0dXJuIGNvb3JkcztcbiAgICB9O1xuICAgIE1vdXNlSGVscGVyLnByb3RvdHlwZS5nZXRSYXdCeXRlQ29vcmRzID0gZnVuY3Rpb24gKGV2ZW50LCBlbGVtZW50LCBjaGFyTWVhc3VyZSwgbGluZUhlaWdodCwgY29sQ291bnQsIHJvd0NvdW50KSB7XG4gICAgICAgIHZhciBjb29yZHMgPSB0aGlzLmdldENvb3JkcyhldmVudCwgZWxlbWVudCwgY2hhck1lYXN1cmUsIGxpbmVIZWlnaHQsIGNvbENvdW50LCByb3dDb3VudCk7XG4gICAgICAgIHZhciB4ID0gY29vcmRzWzBdO1xuICAgICAgICB2YXIgeSA9IGNvb3Jkc1sxXTtcbiAgICAgICAgeCArPSAzMjtcbiAgICAgICAgeSArPSAzMjtcbiAgICAgICAgcmV0dXJuIHsgeDogeCwgeTogeSB9O1xuICAgIH07XG4gICAgcmV0dXJuIE1vdXNlSGVscGVyO1xufSgpKTtcbmV4cG9ydHMuTW91c2VIZWxwZXIgPSBNb3VzZUhlbHBlcjtcblxuXG5cbn0se31dLDMzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFNjcmVlbkRwck1vbml0b3IgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNjcmVlbkRwck1vbml0b3IoKSB7XG4gICAgfVxuICAgIFNjcmVlbkRwck1vbml0b3IucHJvdG90eXBlLnNldExpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLl9saXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5jbGVhckxpc3RlbmVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICAgICAgdGhpcy5fb3V0ZXJMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLl9saXN0ZW5lcih3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgX3RoaXMuX2N1cnJlbnREZXZpY2VQaXhlbFJhdGlvKTtcbiAgICAgICAgICAgIF90aGlzLl91cGRhdGVEcHIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fdXBkYXRlRHByKCk7XG4gICAgfTtcbiAgICBTY3JlZW5EcHJNb25pdG9yLnByb3RvdHlwZS5fdXBkYXRlRHByID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVzb2x1dGlvbk1lZGlhTWF0Y2hMaXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHV0aW9uTWVkaWFNYXRjaExpc3QucmVtb3ZlTGlzdGVuZXIodGhpcy5fb3V0ZXJMaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VycmVudERldmljZVBpeGVsUmF0aW8gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbztcbiAgICAgICAgdGhpcy5fcmVzb2x1dGlvbk1lZGlhTWF0Y2hMaXN0ID0gd2luZG93Lm1hdGNoTWVkaWEoXCJzY3JlZW4gYW5kIChyZXNvbHV0aW9uOiBcIiArIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICsgXCJkcHB4KVwiKTtcbiAgICAgICAgdGhpcy5fcmVzb2x1dGlvbk1lZGlhTWF0Y2hMaXN0LmFkZExpc3RlbmVyKHRoaXMuX291dGVyTGlzdGVuZXIpO1xuICAgIH07XG4gICAgU2NyZWVuRHByTW9uaXRvci5wcm90b3R5cGUuY2xlYXJMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9saXN0ZW5lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jlc29sdXRpb25NZWRpYU1hdGNoTGlzdC5yZW1vdmVMaXN0ZW5lcih0aGlzLl9vdXRlckxpc3RlbmVyKTtcbiAgICAgICAgdGhpcy5fbGlzdGVuZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9vdXRlckxpc3RlbmVyID0gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBTY3JlZW5EcHJNb25pdG9yO1xufSgpKTtcbmV4cG9ydHMuU2NyZWVuRHByTW9uaXRvciA9IFNjcmVlbkRwck1vbml0b3I7XG5cblxuXG59LHt9XSwzNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuQmVsbFNvdW5kID0gJ2RhdGE6YXVkaW8vd2F2O2Jhc2U2NCxVa2xHUmlnQkFBQlhRVlpGWm0xMElCQUFBQUFCQUFFQVJLd0FBSWhZQVFBQ0FCQUFaR0YwWVFRQkFBRHBBRmdDd0FNbEJab0cvd2RtQ2NvS1JBeXBEUThQYlJEQkVRUVRPeFJ0RlljV2xCZVBHSVVaWGhvaUc4OGJjQno3SEhJZHpoMFdIbE1lWng1MUhta2VVeDRXSHM4ZGFoMEFIWHdjM2hzOUc0c2F4Um55R0JJWUdCY1FGdjhVNFJQQUVvWVJRQkFDRDcwTld3d0hDNmdKT3dqV0Jsb0Y3Z09CQWhBQmtmOGIvcXY4Ui92ZStYZjRJZmU3OVcvMEpmUFo4Wi93ZGU5TjdpanRFK3dVNnh2cU0rbGI2SDdudytZWDVtcmx4dVF6NU16amUrTWE0OWZpb2VLRDRuWGlZZUp5NHBIaXRPTDA0ai9qbitNTjVJUGtGT1dzNVUzbURlZk01NS9vZ09sMzZtN3JkT3lFN2FidXl1OEQ4VW55ai9QZzlELzJxZmNiK1luNi92dUsvUWovbEFBbEFnPT0nO1xuXG5cblxufSx7fV0sMzU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgVGVybWluYWxfMSA9IHJlcXVpcmUoXCIuL1Rlcm1pbmFsXCIpO1xubW9kdWxlLmV4cG9ydHMgPSBUZXJtaW5hbF8xLlRlcm1pbmFsO1xuXG5cblxufSx7XCIuL1Rlcm1pbmFsXCI6MTN9XX0se30sWzM1XSkoMzUpXG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXh0ZXJtLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./xterm.js/xterm.js\n");

/***/ })

/******/ });